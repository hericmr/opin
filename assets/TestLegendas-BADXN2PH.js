import{r as g,j as e}from"./index-Beoy-PWP.js";import{testLegendasTable as h,addLegendaFoto as b,getLegendaByImageUrl as u,updateLegendaFoto as f}from"./legendasService-DRQOPz6w.js";const T=()=>{const[r,o]=g.useState([]),[l,i]=g.useState(!1),a=(t,s="info")=>{const d=new Date().toLocaleTimeString();o(n=>[...n,{timestamp:d,message:t,type:s}])},m=async()=>{i(!0),o([]);try{a("=== INICIANDO TESTES DE LEGENDAS ===","header"),a("Teste 1: Verificando estrutura da tabela..."),await h(),a("✅ Teste da estrutura da tabela concluído"),a("Teste 2: Criando legenda de teste...");const t={escola_id:1,imagem_url:"test/test-image.jpg",legenda:"Legenda de teste",descricao_detalhada:"Descrição detalhada de teste",autor_foto:"Teste Autor",data_foto:"2024-01-01",categoria:"teste",ativo:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},s=await b(t);a(`✅ Legenda criada com ID: ${s.id}`),a("Teste 3: Buscando legenda criada...");const d=await u("test/test-image.jpg",1);d?a(`✅ Legenda encontrada: ${d.legenda}`):a("❌ Legenda não encontrada","error"),a("Teste 4: Atualizando legenda...");const n={legenda:"Legenda atualizada",updated_at:new Date().toISOString()},p=await f(s.id,n);a(`✅ Legenda atualizada: ${p.legenda}`),a("Teste 5: Verificando se a atualização foi salva...");const c=await u("test/test-image.jpg",1);c&&c.legenda==="Legenda atualizada"?a("✅ Atualização salva corretamente"):a("❌ Atualização não foi salva corretamente","error"),a("=== TESTES CONCLUÍDOS COM SUCESSO ===","success")}catch(t){a(`❌ ERRO NOS TESTES: ${t.message}`,"error"),console.error("Erro nos testes:",t)}finally{i(!1)}},x=()=>{o([])};return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Teste de Funcionalidade de Legendas"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:m,disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 mr-4",children:l?"Executando Testes...":"Executar Testes"}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Limpar Logs"})]}),e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 max-h-96 overflow-y-auto",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Logs dos Testes:"}),r.length===0?e.jsx("p",{className:"text-gray-500",children:"Nenhum teste executado ainda."}):e.jsx("div",{className:"space-y-1",children:r.map((t,s)=>e.jsxs("div",{className:`text-sm font-mono ${t.type==="error"?"text-red-600":t.type==="success"?"text-green-600":t.type==="header"?"text-blue-600 font-bold":"text-gray-800"}`,children:["[",t.timestamp,"] ",t.message]},s))})]}),e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Instruções:"}),e.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:'Clique em "Executar Testes" para verificar se a funcionalidade de legendas está funcionando'}),e.jsx("li",{children:"Verifique os logs para identificar possíveis problemas"}),e.jsx("li",{children:"Se houver erros, execute o script SQL no Supabase para corrigir a estrutura da tabela"}),e.jsx("li",{children:"Teste novamente após corrigir problemas no banco de dados"})]})]})]})};export{T as default};
