import{r,j as t,L as j,u as E,a as R,b as C,S as T,X as A,A as I,m as P,M as F,c as b,F as $,U as D,B as U}from"./index--81IpRyR.js";const z=({dataPoints:h})=>{const[a,l]=r.useState(""),[i,n]=r.useState(!1),o=r.useRef(null),x=r.useRef(null),c=E(),{setSearch:d}=R(),{searchResults:m,isSearching:v,performSearch:f}=C(h);r.useEffect(()=>{const e=s=>{o.current&&!o.current.contains(s.target)&&n(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),r.useEffect(()=>{if(a.length<2){n(!1);return}const s=setTimeout(async()=>{try{await f(a),n(!0)}catch(g){console.error("Erro na busca:",g)}},300);return()=>clearTimeout(s)},[a,f]);const u=e=>{e.preventDefault();const s=a.trim();s&&(d(s),c(`/search?q=${encodeURIComponent(s)}`))},w=e=>{e.data&&e.coordinates?(d(e.title,e.coordinates,e.title),c("/mapa",{state:{searchTerm:e.title,coordinates:e.coordinates,highlightSchool:e.title,schoolData:e.data}})):e.coordinates?(d(e.title,e.coordinates,e.title),c("/mapa",{state:{searchTerm:e.title,coordinates:e.coordinates,highlightSchool:e.title}})):(d(e.title),c(`/search?q=${encodeURIComponent(e.title)}`)),n(!1),l("")},N=e=>{const s=e.target.value;l(s)},y=e=>{e.key==="Enter"?(e.preventDefault(),u(e)):e.key==="Escape"&&(n(!1),l(""))},S=e=>{switch(e){case"school":return t.jsx(b,{className:"w-4 h-4"});case"land":return t.jsx(U,{className:"w-4 h-4"});case"teacher":return t.jsx(D,{className:"w-4 h-4"});case"history":return t.jsx($,{className:"w-4 h-4"});default:return t.jsx(b,{className:"w-4 h-4"})}},k=(e,s)=>{if(!s)return e;const g=new RegExp(`(${s})`,"gi");return e.split(g).map((p,L)=>g.test(p)?t.jsx("span",{className:"bg-yellow-200 font-semibold",children:p},L):p)};return t.jsxs("div",{ref:o,className:"relative w-full",children:[t.jsx("form",{onSubmit:u,className:"relative",children:t.jsxs("div",{className:"rounded-full bg-white/90 border border-green-200 px-4 py-2 flex items-center gap-2",children:[t.jsx(T,{className:"w-5 h-5 text-green-700 flex-shrink-0"}),t.jsx("input",{ref:x,type:"text",placeholder:"Pesquisar escolas, territórios...",value:a,onChange:N,onKeyDown:y,onFocus:()=>{a.length>=2&&m.length>0&&n(!0)},className:"w-full bg-transparent outline-none text-green-900 placeholder:text-green-800/60"}),a&&t.jsx("button",{type:"button",onClick:()=>{l(""),n(!1)},className:"text-green-700 hover:text-green-900 flex-shrink-0",children:t.jsx(A,{className:"w-4 h-4"})})]})}),t.jsx(I,{children:i&&m.length>0&&t.jsx(P.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute top-full mt-2 w-full bg-white rounded-lg shadow-xl border border-green-200 z-50 max-h-96 overflow-y-auto",children:t.jsx("div",{className:"p-2",children:v?t.jsx("div",{className:"p-4 text-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"Buscando..."})}):t.jsx("div",{className:"space-y-1",children:m.slice(0,8).map(e=>t.jsxs("button",{onClick:()=>w(e),className:"w-full p-3 text-left hover:bg-green-50 rounded-lg transition-colors flex items-center gap-3 group",children:[t.jsx("div",{className:"text-green-600 group-hover:text-green-700 transition-colors flex-shrink-0",children:S(e.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-green-900 text-sm truncate",children:k(e.title,a)}),t.jsx("p",{className:"text-xs text-green-700 truncate",children:e.subtitle})]}),e.coordinates&&t.jsx(F,{className:"w-4 h-4 text-green-400 group-hover:text-green-600 transition-colors flex-shrink-0"})]},e.id))})})})})]})};function q({dataPoints:h=[]}){const a="/opin//site_bg.png",l=r.useRef(null),[i,n]=r.useState(null);return r.useEffect(()=>{const o=()=>{l.current&&n(l.current.offsetWidth)},x=requestAnimationFrame(()=>{o()});return window.addEventListener("resize",o),()=>{cancelAnimationFrame(x),window.removeEventListener("resize",o)}},[]),t.jsx("div",{className:"flex-1 overflow-auto bg-white text-green-900",children:t.jsxs("section",{className:"relative min-h-screen h-screen w-full bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url('${a}')`},children:[t.jsx("div",{className:"absolute inset-0 bg-green-950/40"}),t.jsx("div",{className:"relative max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 items-start lg:items-center h-full px-4 lg:px-12",children:t.jsxs("div",{className:"pt-28 lg:pt-0 text-white",style:{textAlign:"left"},children:[t.jsx("div",{className:"mb-2",style:{width:i?`${i}px`:"auto",marginLeft:0,paddingLeft:0,textAlign:"left"},children:t.jsx("img",{src:"/opin//logo_index.png",alt:"OPIN - Observatório dos Professores Indígenas",className:"h-20 md:h-28 lg:h-36 xl:h-44 object-contain object-left",style:{width:i?`${i}px`:"auto",maxWidth:"100%",display:"block",marginLeft:0,paddingLeft:0,marginRight:"auto",objectPosition:"left"}})}),t.jsxs("div",{className:"mt-0.5",style:{marginLeft:0,paddingLeft:0,textAlign:"left"},children:[t.jsx("p",{ref:l,className:"uppercase tracking-wide text-green-100 text-sm md:text-base lg:text-lg",style:{fontFamily:"Cinzel, serif",marginLeft:0,paddingLeft:0,textAlign:"left"},children:"Observatório dos Professores Indígenas"}),t.jsx("p",{className:"uppercase tracking-wide text-green-100 text-sm md:text-base lg:text-lg",style:{fontFamily:"Cinzel, serif"},children:"do Estado de São Paulo"})]}),t.jsx("p",{className:"mt-4 text-green-100/90 text-lg max-w-2xl",children:"Um espaço de memória, território e educação. Histórias, escolas e experiências narradas pelos próprios professores e comunidades indígenas do Estado de São Paulo."}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-6 gap-3 w-full",children:[t.jsx("div",{className:"col-span-1 lg:col-span-4",children:t.jsx(z,{dataPoints:h})}),t.jsxs("div",{className:"col-span-1 lg:col-span-2 flex flex-col gap-3",children:[t.jsx(j,{to:"/mapa",className:"block rounded-full bg-green-500 text-green-950 font-semibold px-4 py-2.5 text-center hover:bg-green-400 transition",children:"Explorar Mapa"}),t.jsx(j,{to:"/dashboard",className:"block rounded-full bg-green-600 text-white font-semibold px-4 py-2.5 text-center hover:bg-green-500 transition",children:"Alguns dados"})]})]})]})})]})})}export{q as default};
