import{c as X,B as Ra,r as p,R as ee,l as _e,j as l,u as Gr,a as Bn,L as Wn,A as Fi,m as dt,S as Di,X as Ft,M as Vn,b as Dt,F as Xn,U as Tr,d as Ds,e as Lr,s as fe,C as zi,g as Rr,f as Kn,h as Yn,i as Zn}from"./index-CWU4-xd4.js";import{B as Jn,C as Qn,r as eo,u as Or,l as Fr,M as to,o as so,a as ao,c as io,g as pa,b as ro,P as no,d as oo,e as lo,f as co,h as $i,G as ho,E as uo,i as ps,j as fo,k as mo,m as go,S as ra,n as gt,p as po,q as xo,s as yo,t as vo,v as Dr,w as zr,x as $r,y as _o,z as bo,A as Ur,D as wo,F as Mo,H as Eo,I as So,J as Co,K as No,L as Ya,N as Po,O as Bs,Q as jo,R as ko,T as Ao,U as Io,V as Go,W as Oa,X as To,Y as Lo,Z as Ro,_ as Hr,$ as Oo,a0 as Fa,a1 as Fo,a2 as qr,a3 as rt,a4 as Br,a5 as Do,a6 as zt,a7 as $t,a8 as zo,a9 as Za,aa as Ja,ab as Qa,ac as Tt,ad as Wr,ae as st,af as ve,ag as $o,ah as Uo,ai as Ho,aj as qo,ak as Bo,al as qt,am as Wo,an as Vo,ao as Xo,ap as Ko,aq as Yo,ar as Ui,as as Zo,at as Vr,au as Xr,av as na,aw as j,ax as Jo,ay as Hi,az as Kr,aA as Pt,aB as Qo}from"./videoService-B-GTlqNn.js";import{C as xs}from"./chevron-right-BbZEi9KJ.js";import{H as el,G as tl}from"./house-DxVC7BWr.js";import{g as ei,a as sl}from"./legendasService-ZuLJoDUj.js";const al=[["path",{d:"M12 6.528V3a1 1 0 0 1 1-1h0",key:"11qiee"}],["path",{d:"M18.237 21A15 15 0 0 0 22 11a6 6 0 0 0-10-4.472A6 6 0 0 0 2 11a15.1 15.1 0 0 0 3.763 10 3 3 0 0 0 3.648.648 5.5 5.5 0 0 1 5.178 0A3 3 0 0 0 18.237 21",key:"110c12"}]],il=X("apple",al);const rl=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],xa=X("building",rl);const nl=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ol=X("calendar",nl);const ll=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],cl=X("chef-hat",ll);const hl=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ti=X("chevron-left",hl);const dl=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ul=X("clock",dl);const fl=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ml=X("copy",fl);const gl=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],pl=X("droplet",gl);const xl=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],yl=X("external-link",xl);const vl=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],_l=X("facebook",vl);const bl=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Yr=X("globe",bl);const wl=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Ml=X("link",wl);const El=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Sl=X("loader-circle",El);const Cl=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Nl=X("maximize-2",Cl);const Pl=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],si=X("message-circle",Pl);const jl=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],kl=X("minimize-2",jl);const Al=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Il=X("monitor",Al);const Gl=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Tl=X("navigation",Gl);const Ll=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],Rl=X("notebook-pen",Ll);const Ol=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Fl=X("rotate-cw",Ol);const Dl=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],zl=X("sparkles",Dl);const $l=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ul=X("star",$l);const Hl=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],ql=X("twitter",Hl);const Bl=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Wl=X("user-check",Bl);const Vl=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Xl=X("user-minus",Vl);const Kl=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],Yl=X("users-round",Kl);const Zl=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],Jl=X("utensils",Zl);const Ql=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],ec=X("wifi",Ql);const tc=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],sc=X("zoom-in",tc);const ac=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ic=X("zoom-out",ac),ge={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class rc extends Jn{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+Qn,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(ge.ELEMENT,this.handleElementChanged),this.addChangeListener(ge.MAP,this.handleMapChanged),this.addChangeListener(ge.OFFSET,this.handleOffsetChanged),this.addChangeListener(ge.POSITION,this.handlePositionChanged),this.addChangeListener(ge.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get(ge.ELEMENT)}getId(){return this.id}getMap(){return this.get(ge.MAP)||null}getOffset(){return this.get(ge.OFFSET)}getPosition(){return this.get(ge.POSITION)}getPositioning(){return this.get(ge.POSITIONING)}handleElementChanged(){eo(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(this.element?.remove(),Or(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=Fr(t,to.POSTRENDER,this.render,this),this.updatePixelPosition();const s=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?s.insertBefore(this.element,s.childNodes[0]||null):s.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(ge.ELEMENT,t)}setMap(t){this.set(ge.MAP,t)}setOffset(t){this.set(ge.OFFSET,t)}setPosition(t){this.set(ge.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const s=this.getMap();if(!s||!s.getTargetElement()||!this.get(ge.POSITION))return;const a=this.getRect(s.getTargetElement(),s.getSize()),i=this.getElement(),r=this.getRect(i,[so(i),ao(i)]);t=t||{};const o=t.margin===void 0?20:t.margin;if(!io(a,r)){const n=r[0]-a[0],c=a[2]-r[2],h=r[1]-a[1],f=a[3]-r[3],d=[0,0];if(n<0?d[0]=n-o:c<0&&(d[0]=Math.abs(c)+o),h<0?d[1]=h-o:f<0&&(d[1]=Math.abs(f)+o),d[0]!==0||d[1]!==0){const u=s.getView().getCenterInternal(),g=s.getPixelFromCoordinateInternal(u);if(!g)return;const m=[g[0]+d[0],g[1]+d[1]],y=t.animation||{};s.getView().animateInternal({center:s.getCoordinateFromPixelInternal(m),duration:y.duration,easing:y.easing})}}}getRect(t,s){const a=t.getBoundingClientRect(),i=a.left+window.pageXOffset,r=a.top+window.pageYOffset;return[i,r,i+s[0],r+s[1]]}setPositioning(t){this.set(ge.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),s=this.getPosition();if(!t||!t.isRendered()||!s){this.setVisible(!1);return}const a=t.getPixelFromCoordinate(s),i=t.getSize();this.updateRenderedPosition(a,i)}updateRenderedPosition(t,s){const a=this.element.style,i=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const o=`${t[0]+i[0]}px`,n=`${t[1]+i[1]}px`;let c="0%",h="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?c="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(c="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?h="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(h="-50%");const f=`translate(${c}, ${h}) translate(${o}, ${n})`;this.rendered.transform_!=f&&(this.rendered.transform_=f,a.transform=f)}getOptions(){return this.options}}function nc(e){const t=Object.keys(e.defs),s=t.length;let a,i;for(a=0;a<s;++a){const r=t[a];if(!pa(r)){const o=e.defs(r);let n=o.units;!n&&o.projName==="longlat"&&(n="degrees"),ro(new no({code:r,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:n}))}}for(a=0;a<s;++a){const r=t[a],o=pa(r);for(i=0;i<s;++i){const n=t[i],c=pa(n);if(!oo(r,n))if(e.defs[r]===e.defs[n])lo([o,c]);else{const h=e(r,n);co(o,c,$i(o,c,h.forward),$i(c,o,h.inverse))}}}}function oc(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),e("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}var pt=1,xt=2,Lt=3,lc=4,Da=5,qi=6378137,cc=6356752314e-3,Bi=.0066943799901413165,os=484813681109536e-20,N=Math.PI/2,hc=.16666666666666666,dc=.04722222222222222,uc=.022156084656084655,k=1e-10,he=.017453292519943295,Ue=57.29577951308232,W=Math.PI/4,us=Math.PI*2,ne=3.14159265359,Ae={};Ae.greenwich=0;Ae.lisbon=-9.131906111111;Ae.paris=2.337229166667;Ae.bogota=-74.080916666667;Ae.madrid=-3.687938888889;Ae.rome=12.452333333333;Ae.bern=7.439583333333;Ae.jakarta=106.807719444444;Ae.ferro=-17.666666666667;Ae.brussels=4.367975;Ae.stockholm=18.058277777778;Ae.athens=23.7163375;Ae.oslo=10.722916666667;const fc={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var Wi=/[\s_\-\/\(\)]/g;function nt(e,t){if(e[t])return e[t];for(var s=Object.keys(e),a=t.toLowerCase().replace(Wi,""),i=-1,r,o;++i<s.length;)if(r=s[i],o=r.toLowerCase().replace(Wi,""),o===a)return e[r]}function za(e){var t={},s=e.split("+").map(function(n){return n.trim()}).filter(function(n){return n}).reduce(function(n,c){var h=c.split("=");return h.push(!0),n[h[0].toLowerCase()]=h[1],n},{}),a,i,r,o={proj:"projName",datum:"datumCode",rf:function(n){t.rf=parseFloat(n)},lat_0:function(n){t.lat0=n*he},lat_1:function(n){t.lat1=n*he},lat_2:function(n){t.lat2=n*he},lat_ts:function(n){t.lat_ts=n*he},lon_0:function(n){t.long0=n*he},lon_1:function(n){t.long1=n*he},lon_2:function(n){t.long2=n*he},alpha:function(n){t.alpha=parseFloat(n)*he},gamma:function(n){t.rectified_grid_angle=parseFloat(n)*he},lonc:function(n){t.longc=n*he},x_0:function(n){t.x0=parseFloat(n)},y_0:function(n){t.y0=parseFloat(n)},k_0:function(n){t.k0=parseFloat(n)},k:function(n){t.k0=parseFloat(n)},a:function(n){t.a=parseFloat(n)},b:function(n){t.b=parseFloat(n)},r:function(n){t.a=t.b=parseFloat(n)},r_a:function(){t.R_A=!0},zone:function(n){t.zone=parseInt(n,10)},south:function(){t.utmSouth=!0},towgs84:function(n){t.datum_params=n.split(",").map(function(c){return parseFloat(c)})},to_meter:function(n){t.to_meter=parseFloat(n)},units:function(n){t.units=n;var c=nt(fc,n);c&&(t.to_meter=c.to_meter)},from_greenwich:function(n){t.from_greenwich=n*he},pm:function(n){var c=nt(Ae,n);t.from_greenwich=(c||parseFloat(n))*he},nadgrids:function(n){n==="@null"?t.datumCode="none":t.nadgrids=n},axis:function(n){var c="ewnsud";n.length===3&&c.indexOf(n.substr(0,1))!==-1&&c.indexOf(n.substr(1,1))!==-1&&c.indexOf(n.substr(2,1))!==-1&&(t.axis=n)},approx:function(){t.approx=!0},over:function(){t.over=!0}};for(a in s)i=s[a],a in o?(r=o[a],typeof r=="function"?r(i):t[r]=i):t[a]=i;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t.projStr=e,t}class Zr{static getId(t){const s=t.find(a=>Array.isArray(a)&&a[0]==="ID");return s&&s.length>=3?{authority:s[1],code:parseInt(s[2],10)}:null}static convertUnit(t,s="unit"){if(!t||t.length<3)return{type:s,name:"unknown",conversion_factor:null};const a=t[1],i=parseFloat(t[2])||null,r=t.find(n=>Array.isArray(n)&&n[0]==="ID"),o=r?{authority:r[1],code:parseInt(r[2],10)}:null;return{type:s,name:a,conversion_factor:i,id:o}}static convertAxis(t){const s=t[1]||"Unknown";let a;const i=s.match(/^\((.)\)$/);if(i){const h=i[1].toUpperCase();if(h==="E")a="east";else if(h==="N")a="north";else if(h==="U")a="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else a=t[2]?t[2].toLowerCase():"unknown";const r=t.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=r?parseInt(r[1],10):null,n=t.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),c=this.convertUnit(n);return{name:s,direction:a,unit:c,order:o}}static extractAxes(t){return t.filter(s=>Array.isArray(s)&&s[0]==="AXIS").map(s=>this.convertAxis(s)).sort((s,a)=>(s.order||0)-(a.order||0))}static convert(t,s={}){switch(t[0]){case"PROJCRS":s.type="ProjectedCRS",s.name=t[1],s.base_crs=t.find(u=>Array.isArray(u)&&u[0]==="BASEGEOGCRS")?this.convert(t.find(u=>Array.isArray(u)&&u[0]==="BASEGEOGCRS")):null,s.conversion=t.find(u=>Array.isArray(u)&&u[0]==="CONVERSION")?this.convert(t.find(u=>Array.isArray(u)&&u[0]==="CONVERSION")):null;const a=t.find(u=>Array.isArray(u)&&u[0]==="CS");a&&(s.coordinate_system={type:a[1],axis:this.extractAxes(t)});const i=t.find(u=>Array.isArray(u)&&u[0]==="LENGTHUNIT");if(i){const u=this.convertUnit(i);s.coordinate_system.unit=u}s.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":s.type="GeographicCRS",s.name=t[1];const r=t.find(u=>Array.isArray(u)&&(u[0]==="DATUM"||u[0]==="ENSEMBLE"));if(r){const u=this.convert(r);r[0]==="ENSEMBLE"?s.datum_ensemble=u:s.datum=u;const g=t.find(m=>Array.isArray(m)&&m[0]==="PRIMEM");g&&g[1]!=="Greenwich"&&(u.prime_meridian={name:g[1],longitude:parseFloat(g[2])})}s.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},s.id=this.getId(t);break;case"DATUM":s.type="GeodeticReferenceFrame",s.name=t[1],s.ellipsoid=t.find(u=>Array.isArray(u)&&u[0]==="ELLIPSOID")?this.convert(t.find(u=>Array.isArray(u)&&u[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":s.type="DatumEnsemble",s.name=t[1],s.members=t.filter(u=>Array.isArray(u)&&u[0]==="MEMBER").map(u=>({type:"DatumEnsembleMember",name:u[1],id:this.getId(u)}));const o=t.find(u=>Array.isArray(u)&&u[0]==="ENSEMBLEACCURACY");o&&(s.accuracy=parseFloat(o[1]));const n=t.find(u=>Array.isArray(u)&&u[0]==="ELLIPSOID");n&&(s.ellipsoid=this.convert(n)),s.id=this.getId(t);break;case"ELLIPSOID":s.type="Ellipsoid",s.name=t[1],s.semi_major_axis=parseFloat(t[2]),s.inverse_flattening=parseFloat(t[3]),t.find(u=>Array.isArray(u)&&u[0]==="LENGTHUNIT")&&this.convert(t.find(u=>Array.isArray(u)&&u[0]==="LENGTHUNIT"),s);break;case"CONVERSION":s.type="Conversion",s.name=t[1],s.method=t.find(u=>Array.isArray(u)&&u[0]==="METHOD")?this.convert(t.find(u=>Array.isArray(u)&&u[0]==="METHOD")):null,s.parameters=t.filter(u=>Array.isArray(u)&&u[0]==="PARAMETER").map(u=>this.convert(u));break;case"METHOD":s.type="Method",s.name=t[1],s.id=this.getId(t);break;case"PARAMETER":s.type="Parameter",s.name=t[1],s.value=parseFloat(t[2]),s.unit=this.convertUnit(t.find(u=>Array.isArray(u)&&(u[0]==="LENGTHUNIT"||u[0]==="ANGLEUNIT"||u[0]==="SCALEUNIT"))),s.id=this.getId(t);break;case"BOUNDCRS":s.type="BoundCRS";const c=t.find(u=>Array.isArray(u)&&u[0]==="SOURCECRS");if(c){const u=c.find(g=>Array.isArray(g));s.source_crs=u?this.convert(u):null}const h=t.find(u=>Array.isArray(u)&&u[0]==="TARGETCRS");if(h){const u=h.find(g=>Array.isArray(g));s.target_crs=u?this.convert(u):null}const f=t.find(u=>Array.isArray(u)&&u[0]==="ABRIDGEDTRANSFORMATION");f?s.transformation=this.convert(f):s.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(s.type="Transformation",s.name=t[1],s.method=t.find(u=>Array.isArray(u)&&u[0]==="METHOD")?this.convert(t.find(u=>Array.isArray(u)&&u[0]==="METHOD")):null,s.parameters=t.filter(u=>Array.isArray(u)&&(u[0]==="PARAMETER"||u[0]==="PARAMETERFILE")).map(u=>{if(u[0]==="PARAMETER")return this.convert(u);if(u[0]==="PARAMETERFILE")return{name:u[1],value:u[2],id:{authority:"EPSG",code:8656}}}),s.parameters.length===7){const u=s.parameters[6];u.name==="Scale difference"&&(u.value=Math.round((u.value-1)*1e12)/1e6)}s.id=this.getId(t);break;case"AXIS":s.coordinate_system||(s.coordinate_system={type:"unspecified",axis:[]}),s.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":const d=this.convertUnit(t,"LinearUnit");s.coordinate_system&&s.coordinate_system.axis&&s.coordinate_system.axis.forEach(u=>{u.unit||(u.unit=d)}),d.conversion_factor&&d.conversion_factor!==1&&s.semi_major_axis&&(s.semi_major_axis={value:s.semi_major_axis,unit:d});break;default:s.keyword=t[0];break}return s}}class mc extends Zr{static convert(t,s={}){return super.convert(t,s),s.coordinate_system&&s.coordinate_system.subtype==="Cartesian"&&delete s.coordinate_system,s.usage&&delete s.usage,s}}class gc extends Zr{static convert(t,s={}){super.convert(t,s);const a=t.find(r=>Array.isArray(r)&&r[0]==="CS");a&&(s.coordinate_system={subtype:a[1],axis:this.extractAxes(t)});const i=t.find(r=>Array.isArray(r)&&r[0]==="USAGE");if(i){const r=i.find(c=>Array.isArray(c)&&c[0]==="SCOPE"),o=i.find(c=>Array.isArray(c)&&c[0]==="AREA"),n=i.find(c=>Array.isArray(c)&&c[0]==="BBOX");s.usage={},r&&(s.usage.scope=r[1]),o&&(s.usage.area=o[1]),n&&(s.usage.bbox=n.slice(1))}return s}}function pc(e){return e.find(t=>Array.isArray(t)&&t[0]==="USAGE")?"2019":(e.find(t=>Array.isArray(t)&&t[0]==="CS")||e[0]==="BOUNDCRS"||e[0]==="PROJCRS"||e[0]==="GEOGCRS","2015")}function xc(e){return(pc(e)==="2019"?gc:mc).convert(e)}function yc(e){const t=e.toUpperCase();return t.includes("PROJCRS")||t.includes("GEOGCRS")||t.includes("BOUNDCRS")||t.includes("VERTCRS")||t.includes("LENGTHUNIT")||t.includes("ANGLEUNIT")||t.includes("SCALEUNIT")?"WKT2":(t.includes("PROJCS")||t.includes("GEOGCS")||t.includes("LOCAL_CS")||t.includes("VERT_CS")||t.includes("UNIT"),"WKT1")}var fs=1,Jr=2,Qr=3,Ws=4,en=5,ai=-1,vc=/\s/,_c=/[A-Za-z]/,bc=/[A-Za-z84_]/,oa=/[,\]]/,tn=/[\d\.E\-\+]/;function Ze(e){if(typeof e!="string")throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=fs}Ze.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==Ws)for(;vc.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case fs:return this.neutral(e);case Jr:return this.keyword(e);case Ws:return this.quoted(e);case en:return this.afterquote(e);case Qr:return this.number(e);case ai:return}};Ze.prototype.afterquote=function(e){if(e==='"'){this.word+='"',this.state=Ws;return}if(oa.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in afterquote yet, index '+this.place)};Ze.prototype.afterItem=function(e){if(e===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=fs;return}if(e==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=fs,this.currentObject=this.stack.pop(),this.currentObject||(this.state=ai);return}};Ze.prototype.number=function(e){if(tn.test(e)){this.word+=e;return}if(oa.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in number yet, index '+this.place)};Ze.prototype.quoted=function(e){if(e==='"'){this.state=en;return}this.word+=e};Ze.prototype.keyword=function(e){if(bc.test(e)){this.word+=e;return}if(e==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=fs;return}if(oa.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in keyword yet, index '+this.place)};Ze.prototype.neutral=function(e){if(_c.test(e)){this.word=e,this.state=Jr;return}if(e==='"'){this.word="",this.state=Ws;return}if(tn.test(e)){this.word=e,this.state=Qr;return}if(oa.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in neutral yet, index '+this.place)};Ze.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===ai)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function wc(e){var t=new Ze(e);return t.output()}function ya(e,t,s){Array.isArray(t)&&(s.unshift(t),t=null);var a=t?{}:e,i=s.reduce(function(r,o){return jt(o,r),r},a);t&&(e[t]=i)}function jt(e,t){if(!Array.isArray(e)){t[e]=!0;return}var s=e.shift();if(s==="PARAMETER"&&(s=e.shift()),e.length===1){if(Array.isArray(e[0])){t[s]={},jt(e[0],t[s]);return}t[s]=e[0];return}if(!e.length){t[s]=!0;return}if(s==="TOWGS84"){t[s]=e;return}if(s==="AXIS"){s in t||(t[s]=[]),t[s].push(e);return}Array.isArray(s)||(t[s]={});var a;switch(s){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[s]={name:e[0].toLowerCase(),convert:e[1]},e.length===3&&jt(e[2],t[s]);return;case"SPHEROID":case"ELLIPSOID":t[s]={name:e[0],a:e[1],rf:e[2]},e.length===4&&jt(e[3],t[s]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],ya(t,s,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],ya(t,s,e),t[s].type=s;return;default:for(a=-1;++a<e.length;)if(!Array.isArray(e[a]))return jt(e,t[s]);return ya(t,s,e)}}var Mc=.017453292519943295;function Fe(e){return e*Mc}function sn(e){const t=(e.projName||"").toLowerCase().replace(/_/g," ");!e.long0&&e.longc&&(t==="albers conic equal area"||t==="lambert azimuthal equal area")&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&(t==="stereographic south pole"||t==="polar stereographic (variant b)")?(e.lat0=Fe(e.lat1>0?90:-90),e.lat_ts=e.lat1,delete e.lat1):!e.lat_ts&&e.lat0&&(t==="polar stereographic"||t==="polar stereographic (variant a)")&&(e.lat_ts=e.lat0,e.lat0=Fe(e.lat0>0?90:-90),delete e.lat1)}function Vi(e){let t={units:null,to_meter:void 0};return typeof e=="string"?(t.units=e.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.units==="meter"&&(t.to_meter=1)):e&&e.name&&(t.units=e.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.to_meter=e.conversion_factor),t}function Xi(e){return typeof e=="object"?e.value*e.unit.conversion_factor:e}function Ki(e,t){e.ellipsoid.radius?(t.a=e.ellipsoid.radius,t.rf=0):(t.a=Xi(e.ellipsoid.semi_major_axis),e.ellipsoid.inverse_flattening!==void 0?t.rf=e.ellipsoid.inverse_flattening:e.ellipsoid.semi_major_axis!==void 0&&e.ellipsoid.semi_minor_axis!==void 0&&(t.rf=t.a/(t.a-Xi(e.ellipsoid.semi_minor_axis))))}function Vs(e,t={}){return!e||typeof e!="object"?e:e.type==="BoundCRS"?(Vs(e.source_crs,t),e.transformation&&(e.transformation.method&&e.transformation.method.name==="NTv2"?t.nadgrids=e.transformation.parameters[0].value:t.datum_params=e.transformation.parameters.map(s=>s.value)),t):(Object.keys(e).forEach(s=>{const a=e[s];if(a!==null)switch(s){case"name":if(t.srsCode)break;t.name=a,t.srsCode=a;break;case"type":a==="GeographicCRS"?t.projName="longlat":a==="ProjectedCRS"&&e.conversion&&e.conversion.method&&(t.projName=e.conversion.method.name);break;case"datum":case"datum_ensemble":a.ellipsoid&&(t.ellps=a.ellipsoid.name,Ki(a,t)),a.prime_meridian&&(t.from_greenwich=a.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":t.ellps=a.name,Ki(a,t);break;case"prime_meridian":t.long0=(a.longitude||0)*Math.PI/180;break;case"coordinate_system":if(a.axis){if(t.axis=a.axis.map(i=>{const r=i.direction;if(r==="east")return"e";if(r==="north")return"n";if(r==="west")return"w";if(r==="south")return"s";throw new Error(`Unknown axis direction: ${r}`)}).join("")+"u",a.unit){const{units:i,to_meter:r}=Vi(a.unit);t.units=i,t.to_meter=r}else if(a.axis[0]&&a.axis[0].unit){const{units:i,to_meter:r}=Vi(a.axis[0].unit);t.units=i,t.to_meter=r}}break;case"id":a.authority&&a.code&&(t.title=a.authority+":"+a.code);break;case"conversion":a.method&&a.method.name&&(t.projName=a.method.name),a.parameters&&a.parameters.forEach(i=>{const r=i.name.toLowerCase().replace(/\s+/g,"_"),o=i.value;i.unit&&i.unit.conversion_factor?t[r]=o*i.unit.conversion_factor:i.unit==="degree"?t[r]=o*Math.PI/180:t[r]=o});break;case"unit":a.name&&(t.units=a.name.toLowerCase(),t.units==="metre"&&(t.units="meter")),a.conversion_factor&&(t.to_meter=a.conversion_factor);break;case"base_crs":Vs(a,t),t.datumCode=a.id?a.id.authority+"_"+a.id.code:a.name;break}}),t.latitude_of_false_origin!==void 0&&(t.lat0=t.latitude_of_false_origin),t.longitude_of_false_origin!==void 0&&(t.long0=t.longitude_of_false_origin),t.latitude_of_standard_parallel!==void 0&&(t.lat0=t.latitude_of_standard_parallel,t.lat1=t.latitude_of_standard_parallel),t.latitude_of_1st_standard_parallel!==void 0&&(t.lat1=t.latitude_of_1st_standard_parallel),t.latitude_of_2nd_standard_parallel!==void 0&&(t.lat2=t.latitude_of_2nd_standard_parallel),t.latitude_of_projection_centre!==void 0&&(t.lat0=t.latitude_of_projection_centre),t.longitude_of_projection_centre!==void 0&&(t.longc=t.longitude_of_projection_centre),t.easting_at_false_origin!==void 0&&(t.x0=t.easting_at_false_origin),t.northing_at_false_origin!==void 0&&(t.y0=t.northing_at_false_origin),t.latitude_of_natural_origin!==void 0&&(t.lat0=t.latitude_of_natural_origin),t.longitude_of_natural_origin!==void 0&&(t.long0=t.longitude_of_natural_origin),t.longitude_of_origin!==void 0&&(t.long0=t.longitude_of_origin),t.false_easting!==void 0&&(t.x0=t.false_easting),t.easting_at_projection_centre&&(t.x0=t.easting_at_projection_centre),t.false_northing!==void 0&&(t.y0=t.false_northing),t.northing_at_projection_centre&&(t.y0=t.northing_at_projection_centre),t.standard_parallel_1!==void 0&&(t.lat1=t.standard_parallel_1),t.standard_parallel_2!==void 0&&(t.lat2=t.standard_parallel_2),t.scale_factor_at_natural_origin!==void 0&&(t.k0=t.scale_factor_at_natural_origin),t.scale_factor_at_projection_centre!==void 0&&(t.k0=t.scale_factor_at_projection_centre),t.scale_factor_on_pseudo_standard_parallel!==void 0&&(t.k0=t.scale_factor_on_pseudo_standard_parallel),t.azimuth!==void 0&&(t.alpha=t.azimuth),t.azimuth_at_projection_centre!==void 0&&(t.alpha=t.azimuth_at_projection_centre),t.angle_from_rectified_to_skew_grid&&(t.rectified_grid_angle=t.angle_from_rectified_to_skew_grid),sn(t),t)}var Ec=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Sc(e,t){var s=t[0],a=t[1];!(s in e)&&a in e&&(e[s]=e[a],t.length===3&&(e[s]=t[2](e[s])))}function an(e){for(var t=Object.keys(e),s=0,a=t.length;s<a;++s){var i=t[s];Ec.indexOf(i)!==-1&&Cc(e[i]),typeof e[i]=="object"&&an(e[i])}}function Cc(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if(e.type==="GEOGCS"?e.projName="longlat":e.type==="LOCAL_CS"?(e.projName="identity",e.local=!0):typeof e.PROJECTION=="object"?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var s="",a=0,i=e.AXIS.length;a<i;++a){var r=[e.AXIS[a][0].toLowerCase(),e.AXIS[a][1].toLowerCase()];r[0].indexOf("north")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="north"?s+="n":r[0].indexOf("south")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="south"?s+="s":r[0].indexOf("east")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="east"?s+="e":(r[0].indexOf("west")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="west")&&(s+="w")}s.length===2&&(s+="u"),s.length===3&&(e.axis=s)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.UNIT.convert&&(e.type==="GEOGCS"?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var o=e.GEOGCS;e.type==="GEOGCS"&&(o=e),o&&(o.DATUM?e.datumCode=o.DATUM.name.toLowerCase():e.datumCode=o.name.toLowerCase(),e.datumCode.slice(0,2)==="d_"&&(e.datumCode=e.datumCode.slice(2)),e.datumCode==="new_zealand_1949"&&(e.datumCode="nzgd49"),(e.datumCode==="wgs_1984"||e.datumCode==="world_geodetic_system_1984")&&(e.PROJECTION==="Mercator_Auxiliary_Sphere"&&(e.sphere=!0),e.datumCode="wgs84"),e.datumCode==="belge_1972"&&(e.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(e.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),e.ellps.toLowerCase().slice(0,13)==="international"&&(e.ellps="intl"),e.a=o.DATUM.SPHEROID.a,e.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(e.datum_params=o.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),e.datumCode==="ch1903+"&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),e.rectified_grid_angle&&(e.rectified_grid_angle=Fe(e.rectified_grid_angle));function n(f){var d=e.to_meter||1;return f*d}var c=function(f){return Sc(e,f)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Fe],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Fe],["x0","false_easting",n],["y0","false_northing",n],["long0","central_meridian",Fe],["lat0","latitude_of_origin",Fe],["lat0","standard_parallel_1",Fe],["lat1","standard_parallel_1",Fe],["lat2","standard_parallel_2",Fe],["azimuth","Azimuth"],["alpha","azimuth",Fe],["srsCode","name"]];h.forEach(c),sn(e)}function Xs(e){if(typeof e=="object")return Vs(e);const t=yc(e);var s=wc(e);if(t==="WKT2"){const r=xc(s);return Vs(r)}var a=s[0],i={};return jt(s,i),an(i),i[a]}function pe(e){var t=this;if(arguments.length===2){var s=arguments[1];typeof s=="string"?s.charAt(0)==="+"?pe[e]=za(arguments[1]):pe[e]=Xs(arguments[1]):typeof s=="object"&&!("projName"in s)?pe[e]=Xs(arguments[1]):pe[e]=s}else if(arguments.length===1){if(Array.isArray(e))return e.map(function(a){return Array.isArray(a)?pe.apply(t,a):pe(a)});if(typeof e=="string"){if(e in pe)return pe[e]}else"EPSG"in e?pe["EPSG:"+e.EPSG]=e:"ESRI"in e?pe["ESRI:"+e.ESRI]=e:"IAU2000"in e?pe["IAU2000:"+e.IAU2000]=e:console.log(e);return}}oc(pe);function Nc(e){return typeof e=="string"}function Pc(e){return e in pe}function jc(e){return e.indexOf("+")!==0&&e.indexOf("[")!==-1||typeof e=="object"&&!("srsCode"in e)}var kc=["3857","900913","3785","102113"];function Ac(e){var t=nt(e,"authority");if(t){var s=nt(t,"epsg");return s&&kc.indexOf(s)>-1}}function Ic(e){var t=nt(e,"extension");if(t)return nt(t,"proj4")}function Gc(e){return e[0]==="+"}function Tc(e){if(Nc(e)){if(Pc(e))return pe[e];if(jc(e)){var t=Xs(e);if(Ac(t))return pe["EPSG:3857"];var s=Ic(t);return s?za(s):t}if(Gc(e))return za(e)}else return"projName"in e?e:Xs(e)}function Yi(e,t){e=e||{};var s,a;if(!t)return e;for(a in t)s=t[a],s!==void 0&&(e[a]=s);return e}function He(e,t,s){var a=e*t;return s/Math.sqrt(1-a*a)}function ys(e){return e<0?-1:1}function A(e,t){return t||Math.abs(e)<=ne?e:e-ys(e)*us}function ze(e,t,s){var a=e*s,i=.5*e;return a=Math.pow((1-a)/(1+a),i),Math.tan(.5*(N-t))/a}function ms(e,t){for(var s=.5*e,a,i,r=N-2*Math.atan(t),o=0;o<=15;o++)if(a=e*Math.sin(r),i=N-2*Math.atan(t*Math.pow((1-a)/(1+a),s))-r,r+=i,Math.abs(i)<=1e-10)return r;return-9999}function Lc(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=He(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Rc(e){var t=e.x,s=e.y;if(s*Ue>90&&s*Ue<-90&&t*Ue>180&&t*Ue<-180)return null;var a,i;if(Math.abs(Math.abs(s)-N)<=k)return null;if(this.sphere)a=this.x0+this.a*this.k0*A(t-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(W+.5*s));else{var r=Math.sin(s),o=ze(this.e,s,r);a=this.x0+this.a*this.k0*A(t-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(o)}return e.x=a,e.y=i,e}function Oc(e){var t=e.x-this.x0,s=e.y-this.y0,a,i;if(this.sphere)i=N-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var r=Math.exp(-s/(this.a*this.k0));if(i=ms(this.e,r),i===-9999)return null}return a=A(this.long0+t/(this.a*this.k0),this.over),e.x=a,e.y=i,e}var Fc=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Dc={init:Lc,forward:Rc,inverse:Oc,names:Fc};function zc(){}function Zi(e){return e}var $c=["longlat","identity"];const Uc={init:zc,forward:Zi,inverse:Zi,names:$c};var Hc=[Dc,Uc],ft={},kt=[];function rn(e,t){var s=kt.length;return e.names?(kt[s]=e,e.names.forEach(function(a){ft[a.toLowerCase()]=s}),this):(console.log(t),!0)}function nn(e){return e.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function qc(e){if(!e)return!1;var t=e.toLowerCase();if(typeof ft[t]<"u"&&kt[ft[t]]||(t=nn(t),t in ft&&kt[ft[t]]))return kt[ft[t]]}function Bc(){Hc.forEach(rn)}const Wc={start:Bc,add:rn,get:qc};var on={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const Vc=on.WGS84;function Xc(e,t,s,a){var i=e*e,r=t*t,o=(i-r)/i,n=0;a?(e*=1-o*(hc+o*(dc+o*uc)),i=e*e,o=0):n=Math.sqrt(o);var c=(i-r)/r;return{es:o,e:n,ep2:c}}function Kc(e,t,s,a,i){if(!e){var r=nt(on,a);r||(r=Vc),e=r.a,t=r.b,s=r.rf}return s&&!t&&(t=(1-1/s)*e),(s===0||Math.abs(e-t)<k)&&(i=!0,t=e),{a:e,b:t,rf:s,sphere:i}}var zs={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Yc in zs){var va=zs[Yc];va.datumName&&(zs[va.datumName]=va)}function Zc(e,t,s,a,i,r,o){var n={};return e===void 0||e==="none"?n.datum_type=Da:n.datum_type=lc,t&&(n.datum_params=t.map(parseFloat),(n.datum_params[0]!==0||n.datum_params[1]!==0||n.datum_params[2]!==0)&&(n.datum_type=pt),n.datum_params.length>3&&(n.datum_params[3]!==0||n.datum_params[4]!==0||n.datum_params[5]!==0||n.datum_params[6]!==0)&&(n.datum_type=xt,n.datum_params[3]*=os,n.datum_params[4]*=os,n.datum_params[5]*=os,n.datum_params[6]=n.datum_params[6]/1e6+1)),o&&(n.datum_type=Lt,n.grids=o),n.a=s,n.b=a,n.es=i,n.ep2=r,n}var ii={};function Jc(e,t,s){return t instanceof ArrayBuffer?Qc(e,t,s):{ready:eh(e,t)}}function Qc(e,t,s){var a=!0;s!==void 0&&s.includeErrorFields===!1&&(a=!1);var i=new DataView(t),r=ah(i),o=ih(i,r),n=rh(i,o,r,a),c={header:o,subgrids:n};return ii[e]=c,c}async function eh(e,t){for(var s=[],a=await t.getImageCount(),i=a-1;i>=0;i--){var r=await t.getImage(i),o=await r.readRasters(),n=o,c=[r.getWidth(),r.getHeight()],h=r.getBoundingBox().map(Ji),f=[r.fileDirectory.ModelPixelScale[0],r.fileDirectory.ModelPixelScale[1]].map(Ji),d=h[0]+(c[0]-1)*f[0],u=h[3]-(c[1]-1)*f[1],g=n[0],m=n[1],y=[];for(let w=c[1]-1;w>=0;w--)for(let M=c[0]-1;M>=0;M--){var x=w*c[0]+M;y.push([-at(m[x]),at(g[x])])}s.push({del:f,lim:c,ll:[-d,u],cvs:y})}var _={header:{nSubgrids:a},subgrids:s};return ii[e]=_,_}function th(e){if(e===void 0)return null;var t=e.split(",");return t.map(sh)}function sh(e){if(e.length===0)return null;var t=e[0]==="@";return t&&(e=e.slice(1)),e==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:ii[e]||null,isNull:!1}}function Ji(e){return e*Math.PI/180}function at(e){return e/3600*Math.PI/180}function ah(e){var t=e.getInt32(8,!1);return t===11?!1:(t=e.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function ih(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:$a(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}function $a(e,t,s){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,s)))}function rh(e,t,s,a){for(var i=176,r=[],o=0;o<t.nSubgrids;o++){var n=oh(e,i,s),c=lh(e,i,n,s,a),h=Math.round(1+(n.upperLongitude-n.lowerLongitude)/n.longitudeInterval),f=Math.round(1+(n.upperLatitude-n.lowerLatitude)/n.latitudeInterval);r.push({ll:[at(n.lowerLongitude),at(n.lowerLatitude)],del:[at(n.longitudeInterval),at(n.latitudeInterval)],lim:[h,f],count:n.gridNodeCount,cvs:nh(c)});var d=16;a===!1&&(d=8),i+=176+n.gridNodeCount*d}return r}function nh(e){return e.map(function(t){return[at(t.longitudeShift),at(t.latitudeShift)]})}function oh(e,t,s){return{name:$a(e,t+8,t+16).trim(),parent:$a(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,s),upperLatitude:e.getFloat64(t+88,s),lowerLongitude:e.getFloat64(t+104,s),upperLongitude:e.getFloat64(t+120,s),latitudeInterval:e.getFloat64(t+136,s),longitudeInterval:e.getFloat64(t+152,s),gridNodeCount:e.getInt32(t+168,s)}}function lh(e,t,s,a,i){var r=t+176,o=16;i===!1&&(o=8);for(var n=[],c=0;c<s.gridNodeCount;c++){var h={latitudeShift:e.getFloat32(r+c*o,a),longitudeShift:e.getFloat32(r+c*o+4,a)};i!==!1&&(h.latitudeAccuracy=e.getFloat32(r+c*o+8,a),h.longitudeAccuracy=e.getFloat32(r+c*o+12,a)),n.push(h)}return n}function Le(e,t){if(!(this instanceof Le))return new Le(e);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,t=t||function(h){if(h)throw h};var s=Tc(e);if(typeof s!="object"){t("Could not parse to valid json: "+e);return}var a=Le.projections.get(s.projName);if(!a){t("Could not get projection name from: "+e);return}if(s.datumCode&&s.datumCode!=="none"){var i=nt(zs,s.datumCode);i&&(s.datum_params=s.datum_params||(i.towgs84?i.towgs84.split(","):null),s.ellps=i.ellipse,s.datumName=i.datumName?i.datumName:s.datumCode)}s.k0=s.k0||1,s.axis=s.axis||"enu",s.ellps=s.ellps||"wgs84",s.lat1=s.lat1||s.lat0;var r=Kc(s.a,s.b,s.rf,s.ellps,s.sphere),o=Xc(r.a,r.b,r.rf,s.R_A),n=th(s.nadgrids),c=s.datum||Zc(s.datumCode,s.datum_params,r.a,r.b,o.es,o.ep2,n);Yi(this,s),Yi(this,a),this.a=r.a,this.b=r.b,this.rf=r.rf,this.sphere=r.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=c,"init"in this&&typeof this.init=="function"&&this.init(),t(null,this)}Le.projections=Wc;Le.projections.start();function ch(e,t){return e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11?!1:e.datum_type===pt?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type===xt?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]:!0}function ln(e,t,s){var a=e.x,i=e.y,r=e.z?e.z:0,o,n,c,h;if(i<-N&&i>-1.001*N)i=-N;else if(i>N&&i<1.001*N)i=N;else{if(i<-N)return{x:-1/0,y:-1/0,z:e.z};if(i>N)return{x:1/0,y:1/0,z:e.z}}return a>Math.PI&&(a-=2*Math.PI),n=Math.sin(i),h=Math.cos(i),c=n*n,o=s/Math.sqrt(1-t*c),{x:(o+r)*h*Math.cos(a),y:(o+r)*h*Math.sin(a),z:(o*(1-t)+r)*n}}function cn(e,t,s,a){var i=1e-12,r=i*i,o=30,n,c,h,f,d,u,g,m,y,x,_,w,M,b=e.x,C=e.y,S=e.z?e.z:0,E,G,I;if(n=Math.sqrt(b*b+C*C),c=Math.sqrt(b*b+C*C+S*S),n/s<i){if(E=0,c/s<i)return G=N,I=-a,{x:e.x,y:e.y,z:e.z}}else E=Math.atan2(C,b);h=S/c,f=n/c,d=1/Math.sqrt(1-t*(2-t)*f*f),m=f*(1-t)*d,y=h*d,M=0;do M++,g=s/Math.sqrt(1-t*y*y),I=n*m+S*y-g*(1-t*y*y),u=t*g/(g+I),d=1/Math.sqrt(1-u*(2-u)*f*f),x=f*(1-u)*d,_=h*d,w=_*m-x*y,m=x,y=_;while(w*w>r&&M<o);return G=Math.atan(_/Math.abs(x)),{x:E,y:G,z:I}}function hh(e,t,s){if(t===pt)return{x:e.x+s[0],y:e.y+s[1],z:e.z+s[2]};if(t===xt){var a=s[0],i=s[1],r=s[2],o=s[3],n=s[4],c=s[5],h=s[6];return{x:h*(e.x-c*e.y+n*e.z)+a,y:h*(c*e.x+e.y-o*e.z)+i,z:h*(-n*e.x+o*e.y+e.z)+r}}}function dh(e,t,s){if(t===pt)return{x:e.x-s[0],y:e.y-s[1],z:e.z-s[2]};if(t===xt){var a=s[0],i=s[1],r=s[2],o=s[3],n=s[4],c=s[5],h=s[6],f=(e.x-a)/h,d=(e.y-i)/h,u=(e.z-r)/h;return{x:f+c*d-n*u,y:-c*f+d+o*u,z:n*f-o*d+u}}}function As(e){return e===pt||e===xt}function uh(e,t,s){if(ch(e,t)||e.datum_type===Da||t.datum_type===Da)return s;var a=e.a,i=e.es;if(e.datum_type===Lt){var r=Qi(e,!1,s);if(r!==0)return;a=qi,i=Bi}var o=t.a,n=t.b,c=t.es;if(t.datum_type===Lt&&(o=qi,n=cc,c=Bi),i===c&&a===o&&!As(e.datum_type)&&!As(t.datum_type))return s;if(s=ln(s,i,a),As(e.datum_type)&&(s=hh(s,e.datum_type,e.datum_params)),As(t.datum_type)&&(s=dh(s,t.datum_type,t.datum_params)),s=cn(s,c,o,n),t.datum_type===Lt){var h=Qi(t,!0,s);if(h!==0)return}return s}function Qi(e,t,s){if(e.grids===null||e.grids.length===0)return console.log("Grid shift grids not found"),-1;var a={x:-s.x,y:s.y},i={x:Number.NaN,y:Number.NaN},r=[];e:for(var o=0;o<e.grids.length;o++){var n=e.grids[o];if(r.push(n.name),n.isNull){i=a;break}if(n.grid===null){if(n.mandatory)return console.log("Unable to find mandatory grid '"+n.name+"'"),-1;continue}for(var c=n.grid.subgrids,h=0,f=c.length;h<f;h++){var d=c[h],u=(Math.abs(d.del[1])+Math.abs(d.del[0]))/1e4,g=d.ll[0]-u,m=d.ll[1]-u,y=d.ll[0]+(d.lim[0]-1)*d.del[0]+u,x=d.ll[1]+(d.lim[1]-1)*d.del[1]+u;if(!(m>a.y||g>a.x||x<a.y||y<a.x)&&(i=fh(a,t,d),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-a.x*Ue+" "+a.y*Ue+" tried: '"+r+"'"),-1):(s.x=-i.x,s.y=i.y,0)}function fh(e,t,s){var a={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return a;var i={x:e.x,y:e.y};i.x-=s.ll[0],i.y-=s.ll[1],i.x=A(i.x-Math.PI)+Math.PI;var r=er(i,s);if(t){if(isNaN(r.x))return a;r.x=i.x-r.x,r.y=i.y-r.y;var o=9,n=1e-12,c,h;do{if(h=er(r,s),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}c={x:i.x-(h.x+r.x),y:i.y-(h.y+r.y)},r.x+=c.x,r.y+=c.y}while(o--&&Math.abs(c.x)>n&&Math.abs(c.y)>n);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),a;a.x=A(r.x+s.ll[0]),a.y=r.y+s.ll[1]}else isNaN(r.x)||(a.x=e.x+r.x,a.y=e.y+r.y);return a}function er(e,t){var s={x:e.x/t.del[0],y:e.y/t.del[1]},a={x:Math.floor(s.x),y:Math.floor(s.y)},i={x:s.x-1*a.x,y:s.y-1*a.y},r={x:Number.NaN,y:Number.NaN},o;if(a.x<0||a.x>=t.lim[0]||a.y<0||a.y>=t.lim[1])return r;o=a.y*t.lim[0]+a.x;var n={x:t.cvs[o][0],y:t.cvs[o][1]};o++;var c={x:t.cvs[o][0],y:t.cvs[o][1]};o+=t.lim[0];var h={x:t.cvs[o][0],y:t.cvs[o][1]};o--;var f={x:t.cvs[o][0],y:t.cvs[o][1]},d=i.x*i.y,u=i.x*(1-i.y),g=(1-i.x)*(1-i.y),m=(1-i.x)*i.y;return r.x=g*n.x+u*c.x+m*f.x+d*h.x,r.y=g*n.y+u*c.y+m*f.y+d*h.y,r}function tr(e,t,s){var a=s.x,i=s.y,r=s.z||0,o,n,c,h={};for(c=0;c<3;c++)if(!(t&&c===2&&s.z===void 0))switch(c===0?(o=a,"ew".indexOf(e.axis[c])!==-1?n="x":n="y"):c===1?(o=i,"ns".indexOf(e.axis[c])!==-1?n="y":n="x"):(o=r,n="z"),e.axis[c]){case"e":h[n]=o;break;case"w":h[n]=-o;break;case"n":h[n]=o;break;case"s":h[n]=-o;break;case"u":s[n]!==void 0&&(h.z=o);break;case"d":s[n]!==void 0&&(h.z=-o);break;default:return null}return h}function hn(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}function mh(e){sr(e.x),sr(e.y)}function sr(e){if(typeof Number.isFinite=="function"){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if(typeof e!="number"||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function gh(e,t){return(e.datum.datum_type===pt||e.datum.datum_type===xt||e.datum.datum_type===Lt)&&t.datumCode!=="WGS84"||(t.datum.datum_type===pt||t.datum.datum_type===xt||t.datum.datum_type===Lt)&&e.datumCode!=="WGS84"}function Ks(e,t,s,a){var i;Array.isArray(s)?s=hn(s):s={x:s.x,y:s.y,z:s.z,m:s.m};var r=s.z!==void 0;if(mh(s),e.datum&&t.datum&&gh(e,t)&&(i=new Le("WGS84"),s=Ks(e,i,s,a),e=i),a&&e.axis!=="enu"&&(s=tr(e,!1,s)),e.projName==="longlat")s={x:s.x*he,y:s.y*he,z:s.z||0};else if(e.to_meter&&(s={x:s.x*e.to_meter,y:s.y*e.to_meter,z:s.z||0}),s=e.inverse(s),!s)return;if(e.from_greenwich&&(s.x+=e.from_greenwich),s=uh(e.datum,t.datum,s),!!s)return s=s,t.from_greenwich&&(s={x:s.x-t.from_greenwich,y:s.y,z:s.z||0}),t.projName==="longlat"?s={x:s.x*Ue,y:s.y*Ue,z:s.z||0}:(s=t.forward(s),t.to_meter&&(s={x:s.x/t.to_meter,y:s.y/t.to_meter,z:s.z||0})),a&&t.axis!=="enu"?tr(t,!0,s):(s&&!r&&delete s.z,s)}var ar=Le("WGS84");function _a(e,t,s,a){var i,r,o;return Array.isArray(s)?(i=Ks(e,t,s,a)||{x:NaN,y:NaN},s.length>2?typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(s.slice(3)):[i.x,i.y,s[2]].concat(s.slice(3)):[i.x,i.y].concat(s.slice(2)):[i.x,i.y]):(r=Ks(e,t,s,a),o=Object.keys(s),o.length===2||o.forEach(function(n){if(typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(n==="x"||n==="y"||n==="z")return}else if(n==="x"||n==="y")return;r[n]=s[n]}),r)}function Is(e){return e instanceof Le?e:typeof e=="object"&&"oProj"in e?e.oProj:Le(e)}function ph(e,t,s){var a,i,r=!1,o;return typeof t>"u"?(i=Is(e),a=ar,r=!0):(typeof t.x<"u"||Array.isArray(t))&&(s=t,i=Is(e),a=ar,r=!0),a||(a=Is(e)),i||(i=Is(t)),s?_a(a,i,s):(o={forward:function(n,c){return _a(a,i,n,c)},inverse:function(n,c){return _a(i,a,n,c)}},r&&(o.oProj=i),o)}var ir=6,dn="AJSAJS",un="AFAFAF",At=65,Pe=73,Ge=79,is=86,rs=90;const xh={forward:fn,inverse:yh,toPoint:mn};function fn(e,t){return t=t||5,bh(vh({lat:e[1],lon:e[0]}),t)}function yh(e){var t=ri(pn(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function mn(e){var t=ri(pn(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function ba(e){return e*(Math.PI/180)}function rr(e){return 180*(e/Math.PI)}function vh(e){var t=e.lat,s=e.lon,a=6378137,i=.00669438,r=.9996,o,n,c,h,f,d,u,g=ba(t),m=ba(s),y,x;x=Math.floor((s+180)/6)+1,s===180&&(x=60),t>=56&&t<64&&s>=3&&s<12&&(x=32),t>=72&&t<84&&(s>=0&&s<9?x=31:s>=9&&s<21?x=33:s>=21&&s<33?x=35:s>=33&&s<42&&(x=37)),o=(x-1)*6-180+3,y=ba(o),n=i/(1-i),c=a/Math.sqrt(1-i*Math.sin(g)*Math.sin(g)),h=Math.tan(g)*Math.tan(g),f=n*Math.cos(g)*Math.cos(g),d=Math.cos(g)*(m-y),u=a*((1-i/4-3*i*i/64-5*i*i*i/256)*g-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*g)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*g)-35*i*i*i/3072*Math.sin(6*g));var _=r*c*(d+(1-h+f)*d*d*d/6+(5-18*h+h*h+72*f-58*n)*d*d*d*d*d/120)+5e5,w=r*(u+c*Math.tan(g)*(d*d/2+(5-h+9*f+4*f*f)*d*d*d*d/24+(61-58*h+h*h+600*f-330*n)*d*d*d*d*d*d/720));return t<0&&(w+=1e7),{northing:Math.round(w),easting:Math.round(_),zoneNumber:x,zoneLetter:_h(t)}}function ri(e){var t=e.northing,s=e.easting,a=e.zoneLetter,i=e.zoneNumber;if(i<0||i>60)return null;var r=.9996,o=6378137,n=.00669438,c,h=(1-Math.sqrt(1-n))/(1+Math.sqrt(1-n)),f,d,u,g,m,y,x,_,w,M=s-5e5,b=t;a<"N"&&(b-=1e7),x=(i-1)*6-180+3,c=n/(1-n),y=b/r,_=y/(o*(1-n/4-3*n*n/64-5*n*n*n/256)),w=_+(3*h/2-27*h*h*h/32)*Math.sin(2*_)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*_)+151*h*h*h/96*Math.sin(6*_),f=o/Math.sqrt(1-n*Math.sin(w)*Math.sin(w)),d=Math.tan(w)*Math.tan(w),u=c*Math.cos(w)*Math.cos(w),g=o*(1-n)/Math.pow(1-n*Math.sin(w)*Math.sin(w),1.5),m=M/(f*r);var C=w-f*Math.tan(w)/g*(m*m/2-(5+3*d+10*u-4*u*u-9*c)*m*m*m*m/24+(61+90*d+298*u+45*d*d-252*c-3*u*u)*m*m*m*m*m*m/720);C=rr(C);var S=(m-(1+2*d+u)*m*m*m/6+(5-2*u+28*d-3*u*u+8*c+24*d*d)*m*m*m*m*m/120)/Math.cos(w);S=x+rr(S);var E;if(e.accuracy){var G=ri({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});E={top:G.lat,right:G.lon,bottom:C,left:S}}else E={lat:C,lon:S};return E}function _h(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function bh(e,t){var s="00000"+e.easting,a="00000"+e.northing;return e.zoneNumber+e.zoneLetter+wh(e.easting,e.northing,e.zoneNumber)+s.substr(s.length-5,t)+a.substr(a.length-5,t)}function wh(e,t,s){var a=gn(s),i=Math.floor(e/1e5),r=Math.floor(t/1e5)%20;return Mh(i,r,a)}function gn(e){var t=e%ir;return t===0&&(t=ir),t}function Mh(e,t,s){var a=s-1,i=dn.charCodeAt(a),r=un.charCodeAt(a),o=i+e-1,n=r+t,c=!1;o>rs&&(o=o-rs+At-1,c=!0),(o===Pe||i<Pe&&o>Pe||(o>Pe||i<Pe)&&c)&&o++,(o===Ge||i<Ge&&o>Ge||(o>Ge||i<Ge)&&c)&&(o++,o===Pe&&o++),o>rs&&(o=o-rs+At-1),n>is?(n=n-is+At-1,c=!0):c=!1,(n===Pe||r<Pe&&n>Pe||(n>Pe||r<Pe)&&c)&&n++,(n===Ge||r<Ge&&n>Ge||(n>Ge||r<Ge)&&c)&&(n++,n===Pe&&n++),n>is&&(n=n-is+At-1);var h=String.fromCharCode(o)+String.fromCharCode(n);return h}function pn(e){if(e&&e.length===0)throw"MGRSPoint coverting from nothing";for(var t=e.length,s=null,a="",i,r=0;!/[A-Z]/.test(i=e.charAt(r));){if(r>=2)throw"MGRSPoint bad conversion from: "+e;a+=i,r++}var o=parseInt(a,10);if(r===0||r+3>t)throw"MGRSPoint bad conversion from: "+e;var n=e.charAt(r++);if(n<="A"||n==="B"||n==="Y"||n>="Z"||n==="I"||n==="O")throw"MGRSPoint zone letter "+n+" not handled: "+e;s=e.substring(r,r+=2);for(var c=gn(o),h=Eh(s.charAt(0),c),f=Sh(s.charAt(1),c);f<Ch(n);)f+=2e6;var d=t-r;if(d%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+e;var u=d/2,g=0,m=0,y,x,_,w,M;return u>0&&(y=1e5/Math.pow(10,u),x=e.substring(r,r+u),g=parseFloat(x)*y,_=e.substring(r+u),m=parseFloat(_)*y),w=g+h,M=m+f,{easting:w,northing:M,zoneLetter:n,zoneNumber:o,accuracy:y}}function Eh(e,t){for(var s=dn.charCodeAt(t-1),a=1e5,i=!1;s!==e.charCodeAt(0);){if(s++,s===Pe&&s++,s===Ge&&s++,s>rs){if(i)throw"Bad character: "+e;s=At,i=!0}a+=1e5}return a}function Sh(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var s=un.charCodeAt(t-1),a=0,i=!1;s!==e.charCodeAt(0);){if(s++,s===Pe&&s++,s===Ge&&s++,s>is){if(i)throw"Bad character: "+e;s=At,i=!0}a+=1e5}return a}function Ch(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function Ut(e,t,s){if(!(this instanceof Ut))return new Ut(e,t,s);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if(typeof e=="object")this.x=e.x,this.y=e.y,this.z=e.z||0;else if(typeof e=="string"&&typeof t>"u"){var a=e.split(",");this.x=parseFloat(a[0]),this.y=parseFloat(a[1]),this.z=parseFloat(a[2])||0}else this.x=e,this.y=t,this.z=s||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ut.fromMGRS=function(e){return new Ut(mn(e))};Ut.prototype.toMGRS=function(e){return fn([this.x,this.y],e)};var Nh=1,Ph=.25,nr=.046875,or=.01953125,lr=.01068115234375,jh=.75,kh=.46875,Ah=.013020833333333334,Ih=.007120768229166667,Gh=.3645833333333333,Th=.005696614583333333,Lh=.3076171875;function ni(e){var t=[];t[0]=Nh-e*(Ph+e*(nr+e*(or+e*lr))),t[1]=e*(jh-e*(nr+e*(or+e*lr)));var s=e*e;return t[2]=s*(kh-e*(Ah+e*Ih)),s*=e,t[3]=s*(Gh-e*Th),t[4]=s*e*Lh,t}function Bt(e,t,s,a){return s*=t,t*=t,a[0]*e-s*(a[1]+t*(a[2]+t*(a[3]+t*a[4])))}var Rh=20;function oi(e,t,s){for(var a=1/(1-t),i=e,r=Rh;r;--r){var o=Math.sin(i),n=1-t*o*o;if(n=(Bt(i,o,Math.cos(i),s)-e)*(n*Math.sqrt(n))*a,i-=n,Math.abs(n)<k)return i}return i}function Oh(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=ni(this.es),this.ml0=Bt(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Fh(e){var t=e.x,s=e.y,a=A(t-this.long0,this.over),i,r,o,n=Math.sin(s),c=Math.cos(s);if(this.es){var f=c*a,d=Math.pow(f,2),u=this.ep2*Math.pow(c,2),g=Math.pow(u,2),m=Math.abs(c)>k?Math.tan(s):0,y=Math.pow(m,2),x=Math.pow(y,2);i=1-this.es*Math.pow(n,2),f=f/Math.sqrt(i);var _=Bt(s,n,c,this.en);r=this.a*(this.k0*f*(1+d/6*(1-y+u+d/20*(5-18*y+x+14*u-58*y*u+d/42*(61+179*x-x*y-479*y)))))+this.x0,o=this.a*(this.k0*(_-this.ml0+n*a*f/2*(1+d/12*(5-y+9*u+4*g+d/30*(61+x-58*y+270*u-330*y*u+d/56*(1385+543*x-x*y-3111*y))))))+this.y0}else{var h=c*Math.sin(a);if(Math.abs(Math.abs(h)-1)<k)return 93;if(r=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=c*Math.cos(a)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>k)return 93;o=0}else o=Math.acos(o);s<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return e.x=r,e.y=o,e}function Dh(e){var t,s,a,i,r=(e.x-this.x0)*(1/this.a),o=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+o/this.k0,s=oi(t,this.es,this.en),Math.abs(s)<N){var d=Math.sin(s),u=Math.cos(s),g=Math.abs(u)>k?Math.tan(s):0,m=this.ep2*Math.pow(u,2),y=Math.pow(m,2),x=Math.pow(g,2),_=Math.pow(x,2);t=1-this.es*Math.pow(d,2);var w=r*Math.sqrt(t)/this.k0,M=Math.pow(w,2);t=t*g,a=s-t*M/(1-this.es)*.5*(1-M/12*(5+3*x-9*m*x+m-4*y-M/30*(61+90*x-252*m*x+45*_+46*m-M/56*(1385+3633*x+4095*_+1574*_*x)))),i=A(this.long0+w*(1-M/6*(1+2*x+m-M/20*(5+28*x+24*_+8*m*x+6*m-M/42*(61+662*x+1320*_+720*_*x))))/u,this.over)}else a=N*ys(o),i=0;else{var n=Math.exp(r/this.k0),c=.5*(n-1/n),h=this.lat0+o/this.k0,f=Math.cos(h);t=Math.sqrt((1-Math.pow(f,2))/(1+Math.pow(c,2))),a=Math.asin(t),o<0&&(a=-a),c===0&&f===0?i=0:i=A(Math.atan2(c,f)+this.long0,this.over)}return e.x=i,e.y=a,e}var zh=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const $s={init:Oh,forward:Fh,inverse:Dh,names:zh};function xn(e){var t=Math.exp(e);return t=(t-1/t)/2,t}function ke(e,t){e=Math.abs(e),t=Math.abs(t);var s=Math.max(e,t),a=Math.min(e,t)/(s||1);return s*Math.sqrt(1+Math.pow(a,2))}function $h(e){var t=1+e,s=t-1;return s===0?e:e*Math.log(t)/s}function Uh(e){var t=Math.abs(e);return t=$h(t*(1+t/(ke(1,t)+1))),e<0?-t:t}function li(e,t){for(var s=2*Math.cos(2*t),a=e.length-1,i=e[a],r=0,o;--a>=0;)o=-r+s*i+e[a],r=i,i=o;return t+o*Math.sin(2*t)}function Hh(e,t){for(var s=2*Math.cos(t),a=e.length-1,i=e[a],r=0,o;--a>=0;)o=-r+s*i+e[a],r=i,i=o;return Math.sin(t)*o}function qh(e){var t=Math.exp(e);return t=(t+1/t)/2,t}function yn(e,t,s){for(var a=Math.sin(t),i=Math.cos(t),r=xn(s),o=qh(s),n=2*i*o,c=-2*a*r,h=e.length-1,f=e[h],d=0,u=0,g=0,m,y;--h>=0;)m=u,y=d,u=f,d=g,f=-m+n*u-c*d+e[h],g=-y+c*u+n*d;return n=a*o,c=i*r,[n*f-c*g,n*g+c*f]}function Bh(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&($s.init.apply(this),this.forward=$s.forward,this.inverse=$s.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),s=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),s=s*t,this.cgb[1]=s*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=s*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),s=s*t,this.cgb[2]=s*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=s*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),s=s*t,this.cgb[3]=s*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=s*(1237/630+t*(-12/5+t*(-24832/14175))),s=s*t,this.cgb[4]=s*(4174/315+t*(-144838/6237)),this.cbg[4]=s*(-734/315+t*(109598/31185)),s=s*t,this.cgb[5]=s*(601676/22275),this.cbg[5]=s*(444337/155925),s=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+s*(1/4+s*(1/64+s/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=s*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=s*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),s=s*t,this.utg[2]=s*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=s*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),s=s*t,this.utg[3]=s*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=s*(49561/161280+t*(-179/168+t*(6601661/7257600))),s=s*t,this.utg[4]=s*(-4583/161280+t*(108847/3991680)),this.gtu[4]=s*(34729/80640+t*(-3418889/1995840)),s=s*t,this.utg[5]=s*(-20648693/638668800),this.gtu[5]=s*(212378941/319334400);var a=li(this.cbg,this.lat0);this.Zb=-this.Qn*(a+Hh(this.gtu,2*a))}function Wh(e){var t=A(e.x-this.long0,this.over),s=e.y;s=li(this.cbg,s);var a=Math.sin(s),i=Math.cos(s),r=Math.sin(t),o=Math.cos(t);s=Math.atan2(a,o*i),t=Math.atan2(r*i,ke(a,i*o)),t=Uh(Math.tan(t));var n=yn(this.gtu,2*s,2*t);s=s+n[0],t=t+n[1];var c,h;return Math.abs(t)<=2.623395162778?(c=this.a*(this.Qn*t)+this.x0,h=this.a*(this.Qn*s+this.Zb)+this.y0):(c=1/0,h=1/0),e.x=c,e.y=h,e}function Vh(e){var t=(e.x-this.x0)*(1/this.a),s=(e.y-this.y0)*(1/this.a);s=(s-this.Zb)/this.Qn,t=t/this.Qn;var a,i;if(Math.abs(t)<=2.623395162778){var r=yn(this.utg,2*s,2*t);s=s+r[0],t=t+r[1],t=Math.atan(xn(t));var o=Math.sin(s),n=Math.cos(s),c=Math.sin(t),h=Math.cos(t);s=Math.atan2(o*h,ke(c,h*n)),t=Math.atan2(c,h*n),a=A(t+this.long0,this.over),i=li(this.cgb,s)}else a=1/0,i=1/0;return e.x=a,e.y=i,e}var Xh=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Us={init:Bh,forward:Wh,inverse:Vh,names:Xh};function Kh(e,t){if(e===void 0){if(e=Math.floor((A(t)+Math.PI)*30/Math.PI)+1,e<0)return 0;if(e>60)return 60}return e}var Yh="etmerc";function Zh(){var e=Kh(this.zone,this.long0);if(e===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*he,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Us.init.apply(this),this.forward=Us.forward,this.inverse=Us.inverse}var Jh=["Universal Transverse Mercator System","utm"];const Qh={init:Zh,names:Jh,dependsOn:Yh};function ci(e,t){return Math.pow((1-e)/(1+e),t)}var e0=20;function t0(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+W)/(Math.pow(Math.tan(.5*this.lat0+W),this.C)*ci(this.e*e,this.ratexp))}function s0(e){var t=e.x,s=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*s+W),this.C)*ci(this.e*Math.sin(s),this.ratexp))-N,e.x=this.C*t,e}function a0(e){for(var t=1e-14,s=e.x/this.C,a=e.y,i=Math.pow(Math.tan(.5*a+W)/this.K,1/this.C),r=e0;r>0&&(a=2*Math.atan(i*ci(this.e*Math.sin(e.y),-.5*this.e))-N,!(Math.abs(a-e.y)<t));--r)e.y=a;return r?(e.x=s,e.y=a,e):null}const hi={init:t0,forward:s0,inverse:a0};function i0(){hi.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function r0(e){var t,s,a,i;return e.x=A(e.x-this.long0,this.over),hi.forward.apply(this,[e]),t=Math.sin(e.y),s=Math.cos(e.y),a=Math.cos(e.x),i=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*s*a),e.x=i*s*Math.sin(e.x),e.y=i*(this.cosc0*t-this.sinc0*s*a),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function n0(e){var t,s,a,i,r;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,r=ke(e.x,e.y)){var o=2*Math.atan2(r,this.R2);t=Math.sin(o),s=Math.cos(o),i=Math.asin(s*this.sinc0+e.y*t*this.cosc0/r),a=Math.atan2(e.x*t,r*this.cosc0*s-e.y*this.sinc0*t)}else i=this.phic0,a=0;return e.x=a,e.y=i,hi.inverse.apply(this,[e]),e.x=A(e.x+this.long0,this.over),e}var o0=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const l0={init:i0,forward:r0,inverse:n0,names:o0};function di(e,t,s){return t*=s,Math.tan(.5*(N+e))*Math.pow((1-t)/(1+t),.5*s)}function c0(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=k&&(this.k0=.5*(1+ys(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=k&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=k&&Math.abs(Math.cos(this.lat_ts))>k&&(this.k0=.5*this.cons*He(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ze(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=He(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(di(this.lat0,this.sinlat0,this.e))-N,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function h0(e){var t=e.x,s=e.y,a=Math.sin(s),i=Math.cos(s),r,o,n,c,h,f,d=A(t-this.long0,this.over);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=k&&Math.abs(s+this.lat0)<=k?(e.x=NaN,e.y=NaN,e):this.sphere?(r=2*this.k0/(1+this.sinlat0*a+this.coslat0*i*Math.cos(d)),e.x=this.a*r*i*Math.sin(d)+this.x0,e.y=this.a*r*(this.coslat0*a-this.sinlat0*i*Math.cos(d))+this.y0,e):(o=2*Math.atan(di(s,a,this.e))-N,c=Math.cos(o),n=Math.sin(o),Math.abs(this.coslat0)<=k?(h=ze(this.e,s*this.con,this.con*a),f=2*this.a*this.k0*h/this.cons,e.x=this.x0+f*Math.sin(t-this.long0),e.y=this.y0-this.con*f*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<k?(r=2*this.a*this.k0/(1+c*Math.cos(d)),e.y=r*n):(r=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*c*Math.cos(d))),e.y=r*(this.cosX0*n-this.sinX0*c*Math.cos(d))+this.y0),e.x=r*c*Math.sin(d)+this.x0,e))}function d0(e){e.x-=this.x0,e.y-=this.y0;var t,s,a,i,r,o=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var n=2*Math.atan(o/(2*this.a*this.k0));return t=this.long0,s=this.lat0,o<=k?(e.x=t,e.y=s,e):(s=Math.asin(Math.cos(n)*this.sinlat0+e.y*Math.sin(n)*this.coslat0/o),Math.abs(this.coslat0)<k?this.lat0>0?t=A(this.long0+Math.atan2(e.x,-1*e.y),this.over):t=A(this.long0+Math.atan2(e.x,e.y),this.over):t=A(this.long0+Math.atan2(e.x*Math.sin(n),o*this.coslat0*Math.cos(n)-e.y*this.sinlat0*Math.sin(n)),this.over),e.x=t,e.y=s,e)}else if(Math.abs(this.coslat0)<=k){if(o<=k)return s=this.lat0,t=this.long0,e.x=t,e.y=s,e;e.x*=this.con,e.y*=this.con,a=o*this.cons/(2*this.a*this.k0),s=this.con*ms(this.e,a),t=this.con*A(this.con*this.long0+Math.atan2(e.x,-1*e.y),this.over)}else i=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,o<=k?r=this.X0:(r=Math.asin(Math.cos(i)*this.sinX0+e.y*Math.sin(i)*this.cosX0/o),t=A(this.long0+Math.atan2(e.x*Math.sin(i),o*this.cosX0*Math.cos(i)-e.y*this.sinX0*Math.sin(i)),this.over)),s=-1*ms(this.e,Math.tan(.5*(N+r)));return e.x=t,e.y=s,e}var u0=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const f0={init:c0,forward:h0,inverse:d0,names:u0,ssfn_:di};function m0(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),s=this.a,a=this.rf,i=1/a,r=2*i-Math.pow(i,2),o=this.e=Math.sqrt(r);this.R=this.k0*s*Math.sqrt(1-r)/(1-r*Math.pow(t,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var n=Math.log(Math.tan(Math.PI/4+this.b0/2)),c=Math.log(Math.tan(Math.PI/4+e/2)),h=Math.log((1+o*t)/(1-o*t));this.K=n-this.alpha*c+this.alpha*o/2*h}function g0(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),s=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),a=-this.alpha*(t+s)+this.K,i=2*(Math.atan(Math.exp(a))-Math.PI/4),r=this.alpha*(e.x-this.lambda0),o=Math.atan(Math.sin(r)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(r))),n=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(r));return e.y=this.R/2*Math.log((1+Math.sin(n))/(1-Math.sin(n)))+this.y0,e.x=this.R*o+this.x0,e}function p0(e){for(var t=e.x-this.x0,s=e.y-this.y0,a=t/this.R,i=2*(Math.atan(Math.exp(s/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(a)),o=Math.atan(Math.sin(a)/(Math.cos(this.b0)*Math.cos(a)-Math.sin(this.b0)*Math.tan(i))),n=this.lambda0+o/this.alpha,c=0,h=r,f=-1e3,d=0;Math.abs(h-f)>1e-7;){if(++d>20)return;c=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),f=h,h=2*Math.atan(Math.exp(c))-Math.PI/2}return e.x=n,e.y=h,e}var x0=["somerc"];const y0={init:m0,forward:g0,inverse:p0,names:x0};var Nt=1e-7;function v0(e){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],s=typeof e.projName=="object"?Object.keys(e.projName)[0]:e.projName;return"no_uoff"in e||"no_off"in e||t.indexOf(s)!==-1||t.indexOf(nn(s))!==-1}function _0(){var e,t,s,a,i,r,o,n,c,h,f=0,d,u=0,g=0,m=0,y=0,x=0,_=0;this.no_off=v0(this),this.no_rot="no_rot"in this;var w=!1;"alpha"in this&&(w=!0);var M=!1;if("rectified_grid_angle"in this&&(M=!0),w&&(_=this.alpha),M&&(f=this.rectified_grid_angle),w||M)u=this.longc;else if(g=this.long1,y=this.lat1,m=this.long2,x=this.lat2,Math.abs(y-x)<=Nt||(e=Math.abs(y))<=Nt||Math.abs(e-N)<=Nt||Math.abs(Math.abs(this.lat0)-N)<=Nt||Math.abs(Math.abs(x)-N)<=Nt)throw new Error;var b=1-this.es;t=Math.sqrt(b),Math.abs(this.lat0)>k?(n=Math.sin(this.lat0),s=Math.cos(this.lat0),e=1-this.es*n*n,this.B=s*s,this.B=Math.sqrt(1+this.es*this.B*this.B/b),this.A=this.B*this.k0*t/e,a=this.B*t/(s*Math.sqrt(e)),i=a*a-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=a,this.E*=Math.pow(ze(this.e,this.lat0,n),this.B)):(this.B=1/t,this.A=this.k0,this.E=a=i=1),w||M?(w?(d=Math.asin(Math.sin(_)/a),M||(f=_)):(d=f,_=Math.asin(a*Math.sin(d))),this.lam0=u-Math.asin(.5*(i-1/i)*Math.tan(d))/this.B):(r=Math.pow(ze(this.e,y,Math.sin(y)),this.B),o=Math.pow(ze(this.e,x,Math.sin(x)),this.B),i=this.E/r,c=(o-r)/(o+r),h=this.E*this.E,h=(h-o*r)/(h+o*r),e=g-m,e<-Math.PI?m-=us:e>Math.PI&&(m+=us),this.lam0=A(.5*(g+m)-Math.atan(h*Math.tan(.5*this.B*(g-m))/c)/this.B,this.over),d=Math.atan(2*Math.sin(this.B*A(g-this.lam0,this.over))/(i-1/i)),f=_=Math.asin(a*Math.sin(d))),this.singam=Math.sin(d),this.cosgam=Math.cos(d),this.sinrot=Math.sin(f),this.cosrot=Math.cos(f),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(a*a-1)/Math.cos(_))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*d,this.v_pole_n=this.ArB*Math.log(Math.tan(W-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(W+i))}function b0(e){var t={},s,a,i,r,o,n,c,h;if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-N)>k){if(o=this.E/Math.pow(ze(this.e,e.y,Math.sin(e.y)),this.B),n=1/o,s=.5*(o-n),a=.5*(o+n),r=Math.sin(this.B*e.x),i=(s*this.singam-r*this.cosgam)/a,Math.abs(Math.abs(i)-1)<k)throw new Error;h=.5*this.ArB*Math.log((1-i)/(1+i)),n=Math.cos(this.B*e.x),Math.abs(n)<Nt?c=this.A*e.x:c=this.ArB*Math.atan2(s*this.cosgam+r*this.singam,n)}else h=e.y>0?this.v_pole_n:this.v_pole_s,c=this.ArB*e.y;return this.no_rot?(t.x=c,t.y=h):(c-=this.u_0,t.x=h*this.cosrot+c*this.sinrot,t.y=c*this.cosrot-h*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function w0(e){var t,s,a,i,r,o,n,c={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(s=e.y,t=e.x):(s=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),a=Math.exp(-this.BrA*s),i=.5*(a-1/a),r=.5*(a+1/a),o=Math.sin(this.BrA*t),n=(o*this.cosgam+i*this.singam)/r,Math.abs(Math.abs(n)-1)<k)c.x=0,c.y=n<0?-N:N;else{if(c.y=this.E/Math.sqrt((1+n)/(1-n)),c.y=ms(this.e,Math.pow(c.y,1/this.B)),c.y===1/0)throw new Error;c.x=-this.rB*Math.atan2(i*this.cosgam-o*this.singam,Math.cos(this.BrA*t))}return c.x+=this.lam0,c}var M0=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const E0={init:_0,forward:b0,inverse:w0,names:M0};function S0(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<k)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),s=Math.cos(this.lat1),a=He(this.e,t,s),i=ze(this.e,this.lat1,t),r=Math.sin(this.lat2),o=Math.cos(this.lat2),n=He(this.e,r,o),c=ze(this.e,this.lat2,r),h=Math.abs(Math.abs(this.lat0)-N)<k?0:ze(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>k?this.ns=Math.log(a/n)/Math.log(i/c):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=a/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function C0(e){var t=e.x,s=e.y;Math.abs(2*Math.abs(s)-Math.PI)<=k&&(s=ys(s)*(N-2*k));var a=Math.abs(Math.abs(s)-N),i,r;if(a>k)i=ze(this.e,s,Math.sin(s)),r=this.a*this.f0*Math.pow(i,this.ns);else{if(a=s*this.ns,a<=0)return null;r=0}var o=this.ns*A(t-this.long0,this.over);return e.x=this.k0*(r*Math.sin(o))+this.x0,e.y=this.k0*(this.rh-r*Math.cos(o))+this.y0,e}function N0(e){var t,s,a,i,r,o=(e.x-this.x0)/this.k0,n=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(o*o+n*n),s=1):(t=-Math.sqrt(o*o+n*n),s=-1);var c=0;if(t!==0&&(c=Math.atan2(s*o,s*n)),t!==0||this.ns>0){if(s=1/this.ns,a=Math.pow(t/(this.a*this.f0),s),i=ms(this.e,a),i===-9999)return null}else i=-N;return r=A(c/this.ns+this.long0,this.over),e.x=r,e.y=i,e}var P0=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const j0={init:S0,forward:C0,inverse:N0,names:P0};function k0(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function A0(e){var t,s,a,i,r,o,n,c=e.x,h=e.y,f=A(c-this.long0,this.over);return t=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),s=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/t)-this.s45),a=-f*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(s)+Math.sin(this.ad)*Math.cos(s)*Math.cos(a)),r=Math.asin(Math.cos(s)*Math.sin(a)/Math.cos(i)),o=this.n*r,n=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),e.y=n*Math.cos(o)/1,e.x=n*Math.sin(o)/1,this.czech||(e.y*=-1,e.x*=-1),e}function I0(e){var t,s,a,i,r,o,n,c,h=e.x;e.x=e.y,e.y=h,this.czech||(e.y*=-1,e.x*=-1),o=Math.sqrt(e.x*e.x+e.y*e.y),r=Math.atan2(e.y,e.x),i=r/Math.sin(this.s0),a=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(i)),s=Math.asin(Math.cos(a)*Math.sin(i)/Math.cos(t)),e.x=this.long0-s/this.alfa,n=t,c=0;var f=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(n))/(1-this.e*Math.sin(n)),this.e/2))-this.s45),Math.abs(n-e.y)<1e-10&&(c=1),n=e.y,f+=1;while(c===0&&f<15);return f>=15?null:e}var G0=["Krovak","krovak"];const T0={init:k0,forward:A0,inverse:I0,names:G0};function be(e,t,s,a,i){return e*i-t*Math.sin(2*i)+s*Math.sin(4*i)-a*Math.sin(6*i)}function vs(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function _s(e){return .375*e*(1+.25*e*(1+.46875*e))}function bs(e){return .05859375*e*e*(1+.75*e)}function ws(e){return e*e*e*(35/3072)}function ui(e,t,s){var a=t*s;return e/Math.sqrt(1-a*a)}function lt(e){return Math.abs(e)<N?e:e-ys(e)*Math.PI}function Ys(e,t,s,a,i){var r,o;r=e/t;for(var n=0;n<15;n++)if(o=(e-(t*r-s*Math.sin(2*r)+a*Math.sin(4*r)-i*Math.sin(6*r)))/(t-2*s*Math.cos(2*r)+4*a*Math.cos(4*r)-6*i*Math.cos(6*r)),r+=o,Math.abs(o)<=1e-10)return r;return NaN}function L0(){this.sphere||(this.e0=vs(this.es),this.e1=_s(this.es),this.e2=bs(this.es),this.e3=ws(this.es),this.ml0=this.a*be(this.e0,this.e1,this.e2,this.e3,this.lat0))}function R0(e){var t,s,a=e.x,i=e.y;if(a=A(a-this.long0,this.over),this.sphere)t=this.a*Math.asin(Math.cos(i)*Math.sin(a)),s=this.a*(Math.atan2(Math.tan(i),Math.cos(a))-this.lat0);else{var r=Math.sin(i),o=Math.cos(i),n=ui(this.a,this.e,r),c=Math.tan(i)*Math.tan(i),h=a*Math.cos(i),f=h*h,d=this.es*o*o/(1-this.es),u=this.a*be(this.e0,this.e1,this.e2,this.e3,i);t=n*h*(1-f*c*(1/6-(8-c+8*d)*f/120)),s=u-this.ml0+n*r/o*f*(.5+(5-c+6*d)*f/24)}return e.x=t+this.x0,e.y=s+this.y0,e}function O0(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,s=e.y/this.a,a,i;if(this.sphere){var r=s+this.lat0;a=Math.asin(Math.sin(r)*Math.cos(t)),i=Math.atan2(Math.tan(t),Math.cos(r))}else{var o=this.ml0/this.a+s,n=Ys(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(n)-N)<=k)return e.x=this.long0,e.y=N,s<0&&(e.y*=-1),e;var c=ui(this.a,this.e,Math.sin(n)),h=c*c*c/this.a/this.a*(1-this.es),f=Math.pow(Math.tan(n),2),d=t*this.a/c,u=d*d;a=n-c*Math.tan(n)/h*d*d*(.5-(1+3*f)*d*d/24),i=d*(1-u*(f/3+(1+3*f)*f*u/15))/Math.cos(n)}return e.x=A(i+this.long0,this.over),e.y=lt(a),e}var F0=["Cassini","Cassini_Soldner","cass"];const D0={init:L0,forward:R0,inverse:O0,names:F0};function it(e,t){var s;return e>1e-7?(s=e*t,(1-e*e)*(t/(1-s*s)-.5/e*Math.log((1-s)/(1+s)))):2*t}var Ua=1,Ha=2,qa=3,Hs=4;function z0(){var e=Math.abs(this.lat0);if(Math.abs(e-N)<k?this.mode=this.lat0<0?Ua:Ha:Math.abs(e)<k?this.mode=qa:this.mode=Hs,this.es>0){var t;switch(this.qp=it(this.e,1),this.mmf=.5/(1-this.es),this.apa=K0(this.es),this.mode){case Ha:this.dd=1;break;case Ua:this.dd=1;break;case qa:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case Hs:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=it(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===Hs&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function $0(e){var t,s,a,i,r,o,n,c,h,f,d=e.x,u=e.y;if(d=A(d-this.long0,this.over),this.sphere){if(r=Math.sin(u),f=Math.cos(u),a=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(s=this.mode===this.EQUIT?1+f*a:1+this.sinph0*r+this.cosph0*f*a,s<=k)return null;s=Math.sqrt(2/s),t=s*f*Math.sin(d),s*=this.mode===this.EQUIT?r:this.cosph0*r-this.sinph0*f*a}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(a=-a),Math.abs(u+this.lat0)<k)return null;s=W-u*.5,s=2*(this.mode===this.S_POLE?Math.cos(s):Math.sin(s)),t=s*Math.sin(d),s*=a}}else{switch(n=0,c=0,h=0,a=Math.cos(d),i=Math.sin(d),r=Math.sin(u),o=it(this.e,r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(n=o/this.qp,c=Math.sqrt(1-n*n)),this.mode){case this.OBLIQ:h=1+this.sinb1*n+this.cosb1*c*a;break;case this.EQUIT:h=1+c*a;break;case this.N_POLE:h=N+u,o=this.qp-o;break;case this.S_POLE:h=u-N,o=this.qp+o;break}if(Math.abs(h)<k)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?s=this.ymf*h*(this.cosb1*n-this.sinb1*c*a):s=(h=Math.sqrt(2/(1+c*a)))*n*this.ymf,t=this.xmf*h*c*i;break;case this.N_POLE:case this.S_POLE:o>=0?(t=(h=Math.sqrt(o))*i,s=a*(this.mode===this.S_POLE?h:-h)):t=s=0;break}}return e.x=this.a*t+this.x0,e.y=this.a*s+this.y0,e}function U0(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,s=e.y/this.a,a,i,r,o,n,c,h;if(this.sphere){var f=0,d,u=0;if(d=Math.sqrt(t*t+s*s),i=d*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(u=Math.sin(i),f=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(d)<=k?0:Math.asin(s*u/d),t*=u,s=f*d;break;case this.OBLIQ:i=Math.abs(d)<=k?this.lat0:Math.asin(f*this.sinph0+s*u*this.cosph0/d),t*=u*this.cosph0,s=(f-Math.sin(i)*this.sinph0)*d;break;case this.N_POLE:s=-s,i=N-i;break;case this.S_POLE:i-=N;break}a=s===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,s)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,s*=this.dd,c=Math.sqrt(t*t+s*s),c<k)return e.x=this.long0,e.y=this.lat0,e;o=2*Math.asin(.5*c/this.rq),r=Math.cos(o),t*=o=Math.sin(o),this.mode===this.OBLIQ?(h=r*this.sinb1+s*o*this.cosb1/c,n=this.qp*h,s=c*this.cosb1*r-s*this.sinb1*o):(h=s*o/c,n=this.qp*h,s=c*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),n=t*t+s*s,!n)return e.x=this.long0,e.y=this.lat0,e;h=1-n/this.qp,this.mode===this.S_POLE&&(h=-h)}a=Math.atan2(t,s),i=Y0(Math.asin(h),this.apa)}return e.x=A(this.long0+a,this.over),e.y=i,e}var H0=.3333333333333333,q0=.17222222222222222,B0=.10257936507936508,W0=.06388888888888888,V0=.0664021164021164,X0=.016415012942191543;function K0(e){var t,s=[];return s[0]=e*H0,t=e*e,s[0]+=t*q0,s[1]=t*W0,t*=e,s[0]+=t*B0,s[1]+=t*V0,s[2]=t*X0,s}function Y0(e,t){var s=e+e;return e+t[0]*Math.sin(s)+t[1]*Math.sin(s+s)+t[2]*Math.sin(s+s+s)}var Z0=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const J0={init:z0,forward:$0,inverse:U0,names:Z0,S_POLE:Ua,N_POLE:Ha,EQUIT:qa,OBLIQ:Hs};function ot(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}function Q0(){Math.abs(this.lat1+this.lat2)<k||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=He(this.e3,this.sin_po,this.cos_po),this.qs1=it(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=He(this.e3,this.sin_po,this.cos_po),this.qs2=it(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=it(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>k?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function ed(e){var t=e.x,s=e.y;this.sin_phi=Math.sin(s),this.cos_phi=Math.cos(s);var a=it(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*a)/this.ns0,r=this.ns0*A(t-this.long0,this.over),o=i*Math.sin(r)+this.x0,n=this.rh-i*Math.cos(r)+this.y0;return e.x=o,e.y=n,e}function td(e){var t,s,a,i,r,o;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),a=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),a=-1),i=0,t!==0&&(i=Math.atan2(a*e.x,a*e.y)),a=t*this.ns0/this.a,this.sphere?o=Math.asin((this.c-a*a)/(2*this.ns0)):(s=(this.c-a*a)/this.ns0,o=this.phi1z(this.e3,s)),r=A(i/this.ns0+this.long0,this.over),e.x=r,e.y=o,e}function sd(e,t){var s,a,i,r,o,n=ot(.5*t);if(e<k)return n;for(var c=e*e,h=1;h<=25;h++)if(s=Math.sin(n),a=Math.cos(n),i=e*s,r=1-i*i,o=.5*r*r/a*(t/(1-c)-s/r+.5/e*Math.log((1-i)/(1+i))),n=n+o,Math.abs(o)<=1e-7)return n;return null}var ad=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const id={init:Q0,forward:ed,inverse:td,names:ad,phi1z:sd};function rd(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function nd(e){var t,s,a,i,r,o,n,c,h=e.x,f=e.y;return a=A(h-this.long0,this.over),t=Math.sin(f),s=Math.cos(f),i=Math.cos(a),o=this.sin_p14*t+this.cos_p14*s*i,r=1,o>0||Math.abs(o)<=k?(n=this.x0+this.a*r*s*Math.sin(a)/o,c=this.y0+this.a*r*(this.cos_p14*t-this.sin_p14*s*i)/o):(n=this.x0+this.infinity_dist*s*Math.sin(a),c=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*s*i)),e.x=n,e.y=c,e}function od(e){var t,s,a,i,r,o;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(i=Math.atan2(t,this.rc),s=Math.sin(i),a=Math.cos(i),o=ot(a*this.sin_p14+e.y*s*this.cos_p14/t),r=Math.atan2(e.x*s,t*this.cos_p14*a-e.y*this.sin_p14*s),r=A(this.long0+r,this.over)):(o=this.phic0,r=0),e.x=r,e.y=o,e}var ld=["gnom"];const cd={init:rd,forward:nd,inverse:od,names:ld};function hd(e,t){var s=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-s)<1e-6)return t<0?-1*N:N;for(var a=Math.asin(.5*t),i,r,o,n,c=0;c<30;c++)if(r=Math.sin(a),o=Math.cos(a),n=e*r,i=Math.pow(1-n*n,2)/(2*o)*(t/(1-e*e)-r/(1-n*n)+.5/e*Math.log((1-n)/(1+n))),a+=i,Math.abs(i)<=1e-10)return a;return NaN}function dd(){this.sphere||(this.k0=He(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function ud(e){var t=e.x,s=e.y,a,i,r=A(t-this.long0,this.over);if(this.sphere)a=this.x0+this.a*r*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var o=it(this.e,Math.sin(s));a=this.x0+this.a*this.k0*r,i=this.y0+this.a*o*.5/this.k0}return e.x=a,e.y=i,e}function fd(e){e.x-=this.x0,e.y-=this.y0;var t,s;return this.sphere?(t=A(this.long0+e.x/this.a/Math.cos(this.lat_ts),this.over),s=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(s=hd(this.e,2*e.y*this.k0/this.a),t=A(this.long0+e.x/(this.a*this.k0),this.over)),e.x=t,e.y=s,e}var md=["cea"];const gd={init:dd,forward:ud,inverse:fd,names:md};function pd(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function xd(e){var t=e.x,s=e.y,a=A(t-this.long0,this.over),i=lt(s-this.lat0);return e.x=this.x0+this.a*a*this.rc,e.y=this.y0+this.a*i,e}function yd(e){var t=e.x,s=e.y;return e.x=A(this.long0+(t-this.x0)/(this.a*this.rc),this.over),e.y=lt(this.lat0+(s-this.y0)/this.a),e}var vd=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const _d={init:pd,forward:xd,inverse:yd,names:vd};var cr=20;function bd(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=vs(this.es),this.e1=_s(this.es),this.e2=bs(this.es),this.e3=ws(this.es),this.ml0=this.a*be(this.e0,this.e1,this.e2,this.e3,this.lat0)}function wd(e){var t=e.x,s=e.y,a,i,r,o=A(t-this.long0,this.over);if(r=o*Math.sin(s),this.sphere)Math.abs(s)<=k?(a=this.a*o,i=-1*this.a*this.lat0):(a=this.a*Math.sin(r)/Math.tan(s),i=this.a*(lt(s-this.lat0)+(1-Math.cos(r))/Math.tan(s)));else if(Math.abs(s)<=k)a=this.a*o,i=-1*this.ml0;else{var n=ui(this.a,this.e,Math.sin(s))/Math.tan(s);a=n*Math.sin(r),i=this.a*be(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+n*(1-Math.cos(r))}return e.x=a+this.x0,e.y=i+this.y0,e}function Md(e){var t,s,a,i,r,o,n,c,h;if(a=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=k)t=A(a/this.a+this.long0,this.over),s=0;else{o=this.lat0+i/this.a,n=a*a/this.a/this.a+o*o,c=o;var f;for(r=cr;r;--r)if(f=Math.tan(c),h=-1*(o*(c*f+1)-c-.5*(c*c+n)*f)/((c-o)/f-1),c+=h,Math.abs(h)<=k){s=c;break}t=A(this.long0+Math.asin(a*Math.tan(c)/this.a)/Math.sin(s),this.over)}else if(Math.abs(i+this.ml0)<=k)s=0,t=A(this.long0+a/this.a,this.over);else{o=(this.ml0+i)/this.a,n=a*a/this.a/this.a+o*o,c=o;var d,u,g,m,y;for(r=cr;r;--r)if(y=this.e*Math.sin(c),d=Math.sqrt(1-y*y)*Math.tan(c),u=this.a*be(this.e0,this.e1,this.e2,this.e3,c),g=this.e0-2*this.e1*Math.cos(2*c)+4*this.e2*Math.cos(4*c)-6*this.e3*Math.cos(6*c),m=u/this.a,h=(o*(d*m+1)-m-.5*d*(m*m+n))/(this.es*Math.sin(2*c)*(m*m+n-2*o*m)/(4*d)+(o-m)*(d*g-2/Math.sin(2*c))-g),c-=h,Math.abs(h)<=k){s=c;break}d=Math.sqrt(1-this.es*Math.pow(Math.sin(s),2))*Math.tan(s),t=A(this.long0+Math.asin(a*d/this.a)/Math.sin(s),this.over)}return e.x=t,e.y=s,e}var Ed=["Polyconic","American_Polyconic","poly"];const Sd={init:bd,forward:wd,inverse:Md,names:Ed};function Cd(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Nd(e){var t,s=e.x,a=e.y,i=a-this.lat0,r=s-this.long0,o=i/os*1e-5,n=r,c=1,h=0;for(t=1;t<=10;t++)c=c*o,h=h+this.A[t]*c;var f=h,d=n,u=1,g=0,m,y,x=0,_=0;for(t=1;t<=6;t++)m=u*f-g*d,y=g*f+u*d,u=m,g=y,x=x+this.B_re[t]*u-this.B_im[t]*g,_=_+this.B_im[t]*u+this.B_re[t]*g;return e.x=_*this.a+this.x0,e.y=x*this.a+this.y0,e}function Pd(e){var t,s=e.x,a=e.y,i=s-this.x0,r=a-this.y0,o=r/this.a,n=i/this.a,c=1,h=0,f,d,u=0,g=0;for(t=1;t<=6;t++)f=c*o-h*n,d=h*o+c*n,c=f,h=d,u=u+this.C_re[t]*c-this.C_im[t]*h,g=g+this.C_im[t]*c+this.C_re[t]*h;for(var m=0;m<this.iterations;m++){var y=u,x=g,_,w,M=o,b=n;for(t=2;t<=6;t++)_=y*u-x*g,w=x*u+y*g,y=_,x=w,M=M+(t-1)*(this.B_re[t]*y-this.B_im[t]*x),b=b+(t-1)*(this.B_im[t]*y+this.B_re[t]*x);y=1,x=0;var C=this.B_re[1],S=this.B_im[1];for(t=2;t<=6;t++)_=y*u-x*g,w=x*u+y*g,y=_,x=w,C=C+t*(this.B_re[t]*y-this.B_im[t]*x),S=S+t*(this.B_im[t]*y+this.B_re[t]*x);var E=C*C+S*S;u=(M*C+b*S)/E,g=(b*C-M*S)/E}var G=u,I=g,H=1,F=0;for(t=1;t<=9;t++)H=H*G,F=F+this.D[t]*H;var T=this.lat0+F*os*1e5,D=this.long0+I;return e.x=D,e.y=T,e}var jd=["New_Zealand_Map_Grid","nzmg"];const kd={init:Cd,forward:Nd,inverse:Pd,names:jd};function Ad(){}function Id(e){var t=e.x,s=e.y,a=A(t-this.long0,this.over),i=this.x0+this.a*a,r=this.y0+this.a*Math.log(Math.tan(Math.PI/4+s/2.5))*1.25;return e.x=i,e.y=r,e}function Gd(e){e.x-=this.x0,e.y-=this.y0;var t=A(this.long0+e.x/this.a,this.over),s=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=s,e}var Td=["Miller_Cylindrical","mill"];const Ld={init:Ad,forward:Id,inverse:Gd,names:Td};var Rd=20;function Od(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ni(this.es)}function Fd(e){var t,s,a=e.x,i=e.y;if(a=A(a-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var r=this.n*Math.sin(i),o=Rd;o;--o){var n=(this.m*i+Math.sin(i)-r)/(this.m+Math.cos(i));if(i-=n,Math.abs(n)<k)break}t=this.a*this.C_x*a*(this.m+Math.cos(i)),s=this.a*this.C_y*i}else{var c=Math.sin(i),h=Math.cos(i);s=this.a*Bt(i,c,h,this.en),t=this.a*a*h/Math.sqrt(1-this.es*c*c)}return e.x=t,e.y=s,e}function Dd(e){var t,s,a,i;return e.x-=this.x0,a=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,a=a/(this.C_x*(this.m+Math.cos(t))),this.m?t=ot((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=ot(Math.sin(t)/this.n)),a=A(a+this.long0,this.over),t=lt(t)):(t=oi(e.y/this.a,this.es,this.en),i=Math.abs(t),i<N?(i=Math.sin(t),s=this.long0+e.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(t)),a=A(s,this.over)):i-k<N&&(a=this.long0)),e.x=a,e.y=t,e}var zd=["Sinusoidal","sinu"];const $d={init:Od,forward:Fd,inverse:Dd,names:zd};function Ud(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Hd(e){for(var t=e.x,s=e.y,a=A(t-this.long0,this.over),i=s,r=Math.PI*Math.sin(s);;){var o=-(i+Math.sin(i)-r)/(1+Math.cos(i));if(i+=o,Math.abs(o)<k)break}i/=2,Math.PI/2-Math.abs(s)<k&&(a=0);var n=.900316316158*this.a*a*Math.cos(i)+this.x0,c=1.4142135623731*this.a*Math.sin(i)+this.y0;return e.x=n,e.y=c,e}function qd(e){var t,s;e.x-=this.x0,e.y-=this.y0,s=e.y/(1.4142135623731*this.a),Math.abs(s)>.999999999999&&(s=.999999999999),t=Math.asin(s);var a=A(this.long0+e.x/(.900316316158*this.a*Math.cos(t)),this.over);a<-Math.PI&&(a=-Math.PI),a>Math.PI&&(a=Math.PI),s=(2*t+Math.sin(2*t))/Math.PI,Math.abs(s)>1&&(s=1);var i=Math.asin(s);return e.x=a,e.y=i,e}var Bd=["Mollweide","moll"];const Wd={init:Ud,forward:Hd,inverse:qd,names:Bd};function Vd(){Math.abs(this.lat1+this.lat2)<k||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=vs(this.es),this.e1=_s(this.es),this.e2=bs(this.es),this.e3=ws(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=He(this.e,this.sin_phi,this.cos_phi),this.ml1=be(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<k?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=He(this.e,this.sin_phi,this.cos_phi),this.ml2=be(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=be(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Xd(e){var t=e.x,s=e.y,a;if(this.sphere)a=this.a*(this.g-s);else{var i=be(this.e0,this.e1,this.e2,this.e3,s);a=this.a*(this.g-i)}var r=this.ns*A(t-this.long0,this.over),o=this.x0+a*Math.sin(r),n=this.y0+this.rh-a*Math.cos(r);return e.x=o,e.y=n,e}function Kd(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,s,a,i;this.ns>=0?(s=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(s=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var r=0;if(s!==0&&(r=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=A(this.long0+r/this.ns,this.over),a=lt(this.g-s/this.a),e.x=i,e.y=a,e;var o=this.g-s/this.a;return a=Ys(o,this.e0,this.e1,this.e2,this.e3),i=A(this.long0+r/this.ns,this.over),e.x=i,e.y=a,e}var Yd=["Equidistant_Conic","eqdc"];const Zd={init:Vd,forward:Xd,inverse:Kd,names:Yd};function Jd(){this.R=this.a}function Qd(e){var t=e.x,s=e.y,a=A(t-this.long0,this.over),i,r;Math.abs(s)<=k&&(i=this.x0+this.R*a,r=this.y0);var o=ot(2*Math.abs(s/Math.PI));(Math.abs(a)<=k||Math.abs(Math.abs(s)-N)<=k)&&(i=this.x0,s>=0?r=this.y0+Math.PI*this.R*Math.tan(.5*o):r=this.y0+Math.PI*this.R*-Math.tan(.5*o));var n=.5*Math.abs(Math.PI/a-a/Math.PI),c=n*n,h=Math.sin(o),f=Math.cos(o),d=f/(h+f-1),u=d*d,g=d*(2/h-1),m=g*g,y=Math.PI*this.R*(n*(d-m)+Math.sqrt(c*(d-m)*(d-m)-(m+c)*(u-m)))/(m+c);a<0&&(y=-y),i=this.x0+y;var x=c+d;return y=Math.PI*this.R*(g*x-n*Math.sqrt((m+c)*(c+1)-x*x))/(m+c),s>=0?r=this.y0+y:r=this.y0-y,e.x=i,e.y=r,e}function eu(e){var t,s,a,i,r,o,n,c,h,f,d,u,g;return e.x-=this.x0,e.y-=this.y0,d=Math.PI*this.R,a=e.x/d,i=e.y/d,r=a*a+i*i,o=-Math.abs(i)*(1+r),n=o-2*i*i+a*a,c=-2*o+1+2*i*i+r*r,g=i*i/c+(2*n*n*n/c/c/c-9*o*n/c/c)/27,h=(o-n*n/3/c)/c,f=2*Math.sqrt(-h/3),d=3*g/h/f,Math.abs(d)>1&&(d>=0?d=1:d=-1),u=Math.acos(d)/3,e.y>=0?s=(-f*Math.cos(u+Math.PI/3)-n/3/c)*Math.PI:s=-(-f*Math.cos(u+Math.PI/3)-n/3/c)*Math.PI,Math.abs(a)<k?t=this.long0:t=A(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(a*a-i*i)+r*r))/2/a,this.over),e.x=t,e.y=s,e}var tu=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const su={init:Jd,forward:Qd,inverse:eu,names:tu};function au(e,t,s,a,i,r){const o=a-t,n=Math.atan((1-r)*Math.tan(e)),c=Math.atan((1-r)*Math.tan(s)),h=Math.sin(n),f=Math.cos(n),d=Math.sin(c),u=Math.cos(c);let g=o,m,y=100,x,_,w,M,b,C,S,E,G,I,H,F,T,D;do{if(x=Math.sin(g),_=Math.cos(g),w=Math.sqrt(u*x*(u*x)+(f*d-h*u*_)*(f*d-h*u*_)),w===0)return{azi1:0,s12:0};M=h*d+f*u*_,b=Math.atan2(w,M),C=f*u*x/w,S=1-C*C,E=S!==0?M-2*h*d/S:0,G=r/16*S*(4+r*(4-3*S)),m=g,g=o+(1-G)*r*C*(b+G*w*(E+G*M*(-1+2*E*E)))}while(Math.abs(g-m)>1e-12&&--y>0);return y===0?{azi1:NaN,s12:NaN}:(I=S*(i*i-i*(1-r)*(i*(1-r)))/(i*(1-r)*(i*(1-r))),H=1+I/16384*(4096+I*(-768+I*(320-175*I))),F=I/1024*(256+I*(-128+I*(74-47*I))),T=F*w*(E+F/4*(M*(-1+2*E*E)-F/6*E*(-3+4*w*w)*(-3+4*E*E))),D=i*(1-r)*H*(b-T),{azi1:Math.atan2(u*x,f*d-h*u*_),s12:D})}function iu(e,t,s,a,i,r){const o=Math.atan((1-r)*Math.tan(e)),n=Math.sin(o),c=Math.cos(o),h=Math.sin(s),f=Math.cos(s),d=Math.atan2(n,c*f),u=c*h,g=1-u*u,m=g*(i*i-i*(1-r)*(i*(1-r)))/(i*(1-r)*(i*(1-r))),y=1+m/16384*(4096+m*(-768+m*(320-175*m))),x=m/1024*(256+m*(-128+m*(74-47*m)));let _=a/(i*(1-r)*y),w,M=100,b,C,S,E;do b=Math.cos(2*d+_),C=Math.sin(_),S=Math.cos(_),E=x*C*(b+x/4*(S*(-1+2*b*b)-x/6*b*(-3+4*C*C)*(-3+4*b*b))),w=_,_=a/(i*(1-r)*y)+E;while(Math.abs(_-w)>1e-12&&--M>0);if(M===0)return{lat2:NaN,lon2:NaN};const G=n*C-c*S*f,I=Math.atan2(n*S+c*C*f,(1-r)*Math.sqrt(u*u+G*G)),H=Math.atan2(C*h,c*S-n*C*f),F=r/16*g*(4+r*(4-3*g)),T=H-(1-F)*r*u*(_+F*C*(b+F*S*(-1+2*b*b))),D=t+T;return{lat2:I,lon2:D}}function ru(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function nu(e){var t=e.x,s=e.y,a=Math.sin(e.y),i=Math.cos(e.y),r=A(t-this.long0,this.over),o,n,c,h,f,d,u,g,m,y,x;return this.sphere?Math.abs(this.sin_p12-1)<=k?(e.x=this.x0+this.a*(N-s)*Math.sin(r),e.y=this.y0-this.a*(N-s)*Math.cos(r),e):Math.abs(this.sin_p12+1)<=k?(e.x=this.x0+this.a*(N+s)*Math.sin(r),e.y=this.y0+this.a*(N+s)*Math.cos(r),e):(m=this.sin_p12*a+this.cos_p12*i*Math.cos(r),u=Math.acos(m),g=u?u/Math.sin(u):1,e.x=this.x0+this.a*g*i*Math.sin(r),e.y=this.y0+this.a*g*(this.cos_p12*a-this.sin_p12*i*Math.cos(r)),e):(o=vs(this.es),n=_s(this.es),c=bs(this.es),h=ws(this.es),Math.abs(this.sin_p12-1)<=k?(f=this.a*be(o,n,c,h,N),d=this.a*be(o,n,c,h,s),e.x=this.x0+(f-d)*Math.sin(r),e.y=this.y0-(f-d)*Math.cos(r),e):Math.abs(this.sin_p12+1)<=k?(f=this.a*be(o,n,c,h,N),d=this.a*be(o,n,c,h,s),e.x=this.x0+(f+d)*Math.sin(r),e.y=this.y0+(f+d)*Math.cos(r),e):Math.abs(t)<k&&Math.abs(s-this.lat0)<k?(e.x=e.y=0,e):(y=au(this.lat0,this.long0,s,t,this.a,this.f),x=y.azi1,e.x=y.s12*Math.sin(x),e.y=y.s12*Math.cos(x),e))}function ou(e){e.x-=this.x0,e.y-=this.y0;var t,s,a,i,r,o,n,c,h,f,d,u,g,m,y,x;return this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*N*this.a?void 0:(s=t/this.a,a=Math.sin(s),i=Math.cos(s),r=this.long0,Math.abs(t)<=k?o=this.lat0:(o=ot(i*this.sin_p12+e.y*a*this.cos_p12/t),n=Math.abs(this.lat0)-N,Math.abs(n)<=k?this.lat0>=0?r=A(this.long0+Math.atan2(e.x,-e.y),this.over):r=A(this.long0-Math.atan2(-e.x,e.y),this.over):r=A(this.long0+Math.atan2(e.x*a,t*this.cos_p12*i-e.y*this.sin_p12*a),this.over)),e.x=r,e.y=o,e)):(c=vs(this.es),h=_s(this.es),f=bs(this.es),d=ws(this.es),Math.abs(this.sin_p12-1)<=k?(u=this.a*be(c,h,f,d,N),t=Math.sqrt(e.x*e.x+e.y*e.y),g=u-t,o=Ys(g/this.a,c,h,f,d),r=A(this.long0+Math.atan2(e.x,-1*e.y),this.over),e.x=r,e.y=o,e):Math.abs(this.sin_p12+1)<=k?(u=this.a*be(c,h,f,d,N),t=Math.sqrt(e.x*e.x+e.y*e.y),g=t-u,o=Ys(g/this.a,c,h,f,d),r=A(this.long0+Math.atan2(e.x,e.y),this.over),e.x=r,e.y=o,e):(m=Math.atan2(e.x,e.y),y=Math.sqrt(e.x*e.x+e.y*e.y),x=iu(this.lat0,this.long0,m,y,this.a,this.f),e.x=x.lon2,e.y=x.lat2,e))}var lu=["Azimuthal_Equidistant","aeqd"];const cu={init:ru,forward:nu,inverse:ou,names:lu};function hu(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function du(e){var t,s,a,i,r,o,n,c,h=e.x,f=e.y;return a=A(h-this.long0,this.over),t=Math.sin(f),s=Math.cos(f),i=Math.cos(a),o=this.sin_p14*t+this.cos_p14*s*i,r=1,(o>0||Math.abs(o)<=k)&&(n=this.a*r*s*Math.sin(a),c=this.y0+this.a*r*(this.cos_p14*t-this.sin_p14*s*i)),e.x=n,e.y=c,e}function uu(e){var t,s,a,i,r,o,n;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),s=ot(t/this.a),a=Math.sin(s),i=Math.cos(s),o=this.long0,Math.abs(t)<=k?(n=this.lat0,e.x=o,e.y=n,e):(n=ot(i*this.sin_p14+e.y*a*this.cos_p14/t),r=Math.abs(this.lat0)-N,Math.abs(r)<=k?(this.lat0>=0?o=A(this.long0+Math.atan2(e.x,-e.y),this.over):o=A(this.long0-Math.atan2(-e.x,e.y),this.over),e.x=o,e.y=n,e):(o=A(this.long0+Math.atan2(e.x*a,t*this.cos_p14*i-e.y*this.sin_p14*a),this.over),e.x=o,e.y=n,e))}var fu=["ortho"];const mu={init:hu,forward:du,inverse:uu,names:fu};var ie={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},V={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function gu(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=N-W/2?this.face=ie.TOP:this.lat0<=-(N-W/2)?this.face=ie.BOTTOM:Math.abs(this.long0)<=W?this.face=ie.FRONT:Math.abs(this.long0)<=N+W?this.face=this.long0>0?ie.RIGHT:ie.LEFT:this.face=ie.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function pu(e){var t={x:0,y:0},s,a,i,r,o,n,c={value:0};if(e.x-=this.long0,this.es!==0?s=Math.atan(this.one_minus_f_squared*Math.tan(e.y)):s=e.y,a=e.x,this.face===ie.TOP)r=N-s,a>=W&&a<=N+W?(c.value=V.AREA_0,i=a-N):a>N+W||a<=-(N+W)?(c.value=V.AREA_1,i=a>0?a-ne:a+ne):a>-(N+W)&&a<=-W?(c.value=V.AREA_2,i=a+N):(c.value=V.AREA_3,i=a);else if(this.face===ie.BOTTOM)r=N+s,a>=W&&a<=N+W?(c.value=V.AREA_0,i=-a+N):a<W&&a>=-W?(c.value=V.AREA_1,i=-a):a<-W&&a>=-(N+W)?(c.value=V.AREA_2,i=-a-N):(c.value=V.AREA_3,i=a>0?-a+ne:-a-ne);else{var h,f,d,u,g,m,y;this.face===ie.RIGHT?a=Rt(a,+N):this.face===ie.BACK?a=Rt(a,+ne):this.face===ie.LEFT&&(a=Rt(a,-N)),u=Math.sin(s),g=Math.cos(s),m=Math.sin(a),y=Math.cos(a),h=g*y,f=g*m,d=u,this.face===ie.FRONT?(r=Math.acos(h),i=Gs(r,d,f,c)):this.face===ie.RIGHT?(r=Math.acos(f),i=Gs(r,d,-h,c)):this.face===ie.BACK?(r=Math.acos(-h),i=Gs(r,d,-f,c)):this.face===ie.LEFT?(r=Math.acos(-f),i=Gs(r,d,h,c)):(r=i=0,c.value=V.AREA_0)}return n=Math.atan(12/ne*(i+Math.acos(Math.sin(i)*Math.cos(W))-N)),o=Math.sqrt((1-Math.cos(r))/(Math.cos(n)*Math.cos(n))/(1-Math.cos(Math.atan(1/Math.cos(i))))),c.value===V.AREA_1?n+=N:c.value===V.AREA_2?n+=ne:c.value===V.AREA_3&&(n+=1.5*ne),t.x=o*Math.cos(n),t.y=o*Math.sin(n),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,e.x=t.x,e.y=t.y,e}function xu(e){var t={lam:0,phi:0},s,a,i,r,o,n,c,h,f,d={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,a=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),s=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?d.value=V.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(d.value=V.AREA_1,s-=N):e.x<0&&-e.x>=Math.abs(e.y)?(d.value=V.AREA_2,s=s<0?s+ne:s-ne):(d.value=V.AREA_3,s+=N),f=ne/12*Math.tan(s),o=Math.sin(f)/(Math.cos(f)-1/Math.sqrt(2)),n=Math.atan(o),i=Math.cos(s),r=Math.tan(a),c=1-i*i*r*r*(1-Math.cos(Math.atan(1/Math.cos(n)))),c<-1?c=-1:c>1&&(c=1),this.face===ie.TOP)h=Math.acos(c),t.phi=N-h,d.value===V.AREA_0?t.lam=n+N:d.value===V.AREA_1?t.lam=n<0?n+ne:n-ne:d.value===V.AREA_2?t.lam=n-N:t.lam=n;else if(this.face===ie.BOTTOM)h=Math.acos(c),t.phi=h-N,d.value===V.AREA_0?t.lam=-n+N:d.value===V.AREA_1?t.lam=-n:d.value===V.AREA_2?t.lam=-n-N:t.lam=n<0?-n-ne:-n+ne;else{var u,g,m;u=c,f=u*u,f>=1?m=0:m=Math.sqrt(1-f)*Math.sin(n),f+=m*m,f>=1?g=0:g=Math.sqrt(1-f),d.value===V.AREA_1?(f=g,g=-m,m=f):d.value===V.AREA_2?(g=-g,m=-m):d.value===V.AREA_3&&(f=g,g=m,m=-f),this.face===ie.RIGHT?(f=u,u=-g,g=f):this.face===ie.BACK?(u=-u,g=-g):this.face===ie.LEFT&&(f=u,u=g,g=-f),t.phi=Math.acos(-m)-N,t.lam=Math.atan2(g,u),this.face===ie.RIGHT?t.lam=Rt(t.lam,-N):this.face===ie.BACK?t.lam=Rt(t.lam,-ne):this.face===ie.LEFT&&(t.lam=Rt(t.lam,+N))}if(this.es!==0){var y,x,_;y=t.phi<0?1:0,x=Math.tan(t.phi),_=this.b/Math.sqrt(x*x+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-_*_)/(this.one_minus_f*_)),y&&(t.phi=-t.phi)}return t.lam+=this.long0,e.x=t.lam,e.y=t.phi,e}function Gs(e,t,s,a){var i;return e<k?(a.value=V.AREA_0,i=0):(i=Math.atan2(t,s),Math.abs(i)<=W?a.value=V.AREA_0:i>W&&i<=N+W?(a.value=V.AREA_1,i-=N):i>N+W||i<=-(N+W)?(a.value=V.AREA_2,i=i>=0?i-ne:i+ne):(a.value=V.AREA_3,i+=N)),i}function Rt(e,t){var s=e+t;return s<-ne?s+=us:s>+ne&&(s-=us),s}var yu=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const vu={init:gu,forward:pu,inverse:xu,names:yu};var Ba=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],ns=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],vn=.8487,_n=1.3523,bn=Ue/5,_u=1/bn,It=18,Zs=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},bu=function(e,t){return e[1]+t*(2*e[2]+t*3*e[3])};function wu(e,t,s,a){for(var i=t;a;--a){var r=e(i);if(i-=r,Math.abs(r)<s)break}return i}function Mu(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Eu(e){var t=A(e.x-this.long0,this.over),s=Math.abs(e.y),a=Math.floor(s*bn);a<0?a=0:a>=It&&(a=It-1),s=Ue*(s-_u*a);var i={x:Zs(Ba[a],s)*t,y:Zs(ns[a],s)};return e.y<0&&(i.y=-i.y),i.x=i.x*this.a*vn+this.x0,i.y=i.y*this.a*_n+this.y0,i}function Su(e){var t={x:(e.x-this.x0)/(this.a*vn),y:Math.abs(e.y-this.y0)/(this.a*_n)};if(t.y>=1)t.x/=Ba[It][0],t.y=e.y<0?-N:N;else{var s=Math.floor(t.y*It);for(s<0?s=0:s>=It&&(s=It-1);;)if(ns[s][0]>t.y)--s;else if(ns[s+1][0]<=t.y)++s;else break;var a=ns[s],i=5*(t.y-a[0])/(ns[s+1][0]-a[0]);i=wu(function(r){return(Zs(a,r)-t.y)/bu(a,r)},i,k,100),t.x/=Zs(Ba[s],i),t.y=(5*s+i)*he,e.y<0&&(t.y=-t.y)}return t.x=A(t.x+this.long0,this.over),t}var Cu=["Robinson","robin"];const Nu={init:Mu,forward:Eu,inverse:Su,names:Cu};function Pu(){this.name="geocent"}function ju(e){var t=ln(e,this.es,this.a);return t}function ku(e){var t=cn(e,this.es,this.a,this.b);return t}var Au=["Geocentric","geocentric","geocent","Geocent"];const Iu={init:Pu,forward:ju,inverse:ku,names:Au};var xe={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Yt={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Gu(){if(Object.keys(Yt).forEach((function(s){if(typeof this[s]>"u")this[s]=Yt[s].def;else{if(Yt[s].num&&isNaN(this[s]))throw new Error("Invalid parameter value, must be numeric "+s+" = "+this[s]);Yt[s].num&&(this[s]=parseFloat(this[s]))}Yt[s].degrees&&(this[s]=this[s]*he)}).bind(this)),Math.abs(Math.abs(this.lat0)-N)<k?this.mode=this.lat0<0?xe.S_POLE:xe.N_POLE:Math.abs(this.lat0)<k?this.mode=xe.EQUIT:(this.mode=xe.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)}function Tu(e){e.x-=this.long0;var t=Math.sin(e.y),s=Math.cos(e.y),a=Math.cos(e.x),i,r;switch(this.mode){case xe.OBLIQ:r=this.sinph0*t+this.cosph0*s*a;break;case xe.EQUIT:r=s*a;break;case xe.S_POLE:r=-t;break;case xe.N_POLE:r=t;break}switch(r=this.pn1/(this.p-r),i=r*s*Math.sin(e.x),this.mode){case xe.OBLIQ:r*=this.cosph0*t-this.sinph0*s*a;break;case xe.EQUIT:r*=t;break;case xe.N_POLE:r*=-(s*a);break;case xe.S_POLE:r*=s*a;break}var o,n;return o=r*this.cg+i*this.sg,n=1/(o*this.sw*this.h1+this.cw),i=(i*this.cg-r*this.sg)*this.cw*n,r=o*n,e.x=i*this.a,e.y=r*this.a,e}function Lu(e){e.x/=this.a,e.y/=this.a;var t={x:e.x,y:e.y},s,a,i;i=1/(this.pn1-e.y*this.sw),s=this.pn1*e.x*i,a=this.pn1*e.y*this.cw*i,e.x=s*this.cg+a*this.sg,e.y=a*this.cg-s*this.sg;var r=ke(e.x,e.y);if(Math.abs(r)<k)t.x=0,t.y=e.y;else{var o,n;switch(n=1-r*r*this.pfact,n=(this.p-Math.sqrt(n))/(this.pn1/r+r/this.pn1),o=Math.sqrt(1-n*n),this.mode){case xe.OBLIQ:t.y=Math.asin(o*this.sinph0+e.y*n*this.cosph0/r),e.y=(o-this.sinph0*Math.sin(t.y))*r,e.x*=n*this.cosph0;break;case xe.EQUIT:t.y=Math.asin(e.y*n/r),e.y=o*r,e.x*=n;break;case xe.N_POLE:t.y=Math.asin(o),e.y=-e.y;break;case xe.S_POLE:t.y=-Math.asin(o);break}t.x=Math.atan2(e.x,e.y)}return e.x=t.x+this.long0,e.y=t.y,e}var Ru=["Tilted_Perspective","tpers"];const Ou={init:Gu,forward:Tu,inverse:Lu,names:Ru};function Fu(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Du(e){var t=e.x,s=e.y,a,i,r,o;if(t=t-this.long0,this.shape==="ellipse"){s=Math.atan(this.radius_p2*Math.tan(s));var n=this.radius_p/ke(this.radius_p*Math.cos(s),Math.sin(s));if(i=n*Math.cos(t)*Math.cos(s),r=n*Math.sin(t)*Math.cos(s),o=n*Math.sin(s),(this.radius_g-i)*i-r*r-o*o*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;a=this.radius_g-i,this.flip_axis?(e.x=this.radius_g_1*Math.atan(r/ke(o,a)),e.y=this.radius_g_1*Math.atan(o/a)):(e.x=this.radius_g_1*Math.atan(r/a),e.y=this.radius_g_1*Math.atan(o/ke(r,a)))}else this.shape==="sphere"&&(a=Math.cos(s),i=Math.cos(t)*a,r=Math.sin(t)*a,o=Math.sin(s),a=this.radius_g-i,this.flip_axis?(e.x=this.radius_g_1*Math.atan(r/ke(o,a)),e.y=this.radius_g_1*Math.atan(o/a)):(e.x=this.radius_g_1*Math.atan(r/a),e.y=this.radius_g_1*Math.atan(o/ke(r,a))));return e.x=e.x*this.a,e.y=e.y*this.a,e}function zu(e){var t=-1,s=0,a=0,i,r,o,n;if(e.x=e.x/this.a,e.y=e.y/this.a,this.shape==="ellipse"){this.flip_axis?(a=Math.tan(e.y/this.radius_g_1),s=Math.tan(e.x/this.radius_g_1)*ke(1,a)):(s=Math.tan(e.x/this.radius_g_1),a=Math.tan(e.y/this.radius_g_1)*ke(1,s));var c=a/this.radius_p;if(i=s*s+c*c+t*t,r=2*this.radius_g*t,o=r*r-4*i*this.C,o<0)return e.x=Number.NaN,e.y=Number.NaN,e;n=(-r-Math.sqrt(o))/(2*i),t=this.radius_g+n*t,s*=n,a*=n,e.x=Math.atan2(s,t),e.y=Math.atan(a*Math.cos(e.x)/t),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if(this.shape==="sphere"){if(this.flip_axis?(a=Math.tan(e.y/this.radius_g_1),s=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+a*a)):(s=Math.tan(e.x/this.radius_g_1),a=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+s*s)),i=s*s+a*a+t*t,r=2*this.radius_g*t,o=r*r-4*i*this.C,o<0)return e.x=Number.NaN,e.y=Number.NaN,e;n=(-r-Math.sqrt(o))/(2*i),t=this.radius_g+n*t,s*=n,a*=n,e.x=Math.atan2(s,t),e.y=Math.atan(a*Math.cos(e.x)/t)}return e.x=e.x+this.long0,e}var $u=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Uu={init:Fu,forward:Du,inverse:zu,names:$u};var ls=1.340264,cs=-.081106,hs=893e-6,ds=.003796,Js=Math.sqrt(3)/2;function Hu(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function qu(e){var t=A(e.x-this.long0,this.over),s=e.y,a=Math.asin(Js*Math.sin(s)),i=a*a,r=i*i*i;return e.x=t*Math.cos(a)/(Js*(ls+3*cs*i+r*(7*hs+9*ds*i))),e.y=a*(ls+cs*i+r*(hs+ds*i)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Bu(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var t=1e-9,s=12,a=e.y,i,r,o,n,c,h;for(h=0;h<s&&(i=a*a,r=i*i*i,o=a*(ls+cs*i+r*(hs+ds*i))-e.y,n=ls+3*cs*i+r*(7*hs+9*ds*i),a-=c=o/n,!(Math.abs(c)<t));++h);return i=a*a,r=i*i*i,e.x=Js*e.x*(ls+3*cs*i+r*(7*hs+9*ds*i))/Math.cos(a),e.y=Math.asin(Math.sin(a)/Js),e.x=A(e.x+this.long0,this.over),e}var Wu=["eqearth","Equal Earth","Equal_Earth"];const Vu={init:Hu,forward:qu,inverse:Bu,names:Wu};var gs=1e-10;function Xu(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<gs)throw new Error;this.es?(this.en=ni(this.es),this.m1=Bt(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Yu,this.forward=Ku):(Math.abs(this.phi1)+gs>=N?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Ju,this.forward=Zu)}function Ku(e){var t=A(e.x-(this.long0||0),this.over),s=e.y,a,i,r;return a=this.am1+this.m1-Bt(s,i=Math.sin(s),r=Math.cos(s),this.en),i=r*t/(a*Math.sqrt(1-this.es*i*i)),e.x=a*Math.sin(i),e.y=this.am1-a*Math.cos(i),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function Yu(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,s,a,i;if(s=ke(e.x,e.y=this.am1-e.y),i=oi(this.am1+this.m1-s,this.es,this.en),(t=Math.abs(i))<N)t=Math.sin(i),a=s*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(i);else if(Math.abs(t-N)<=gs)a=0;else throw new Error;return e.x=A(a+(this.long0||0),this.over),e.y=lt(i),e}function Zu(e){var t=A(e.x-(this.long0||0),this.over),s=e.y,a,i;return i=this.cphi1+this.phi1-s,Math.abs(i)>gs?(e.x=i*Math.sin(a=t*Math.cos(s)/i),e.y=this.cphi1-i*Math.cos(a)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function Ju(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,s,a=ke(e.x,e.y=this.cphi1-e.y);if(s=this.cphi1+this.phi1-a,Math.abs(s)>N)throw new Error;return Math.abs(Math.abs(s)-N)<=gs?t=0:t=a*Math.atan2(e.x,e.y)/Math.cos(s),e.x=A(t+(this.long0||0),this.over),e.y=lt(s),e}var Qu=["bonne","Bonne (Werner lat_1=90)"];const ef={init:Xu,names:Qu},hr={OBLIQUE:{forward:nf,inverse:lf},TRANSVERSE:{forward:of,inverse:cf}},Qs={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function tf(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const e=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),t=Le(e);if(!t)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);t.long0=0,this.obliqueProjection=t;let s;const a=Object.keys(Qs),i=n=>{if(typeof this[n]>"u")return;const c=parseFloat(this[n])*he;if(isNaN(c))throw new Error("Invalid value for "+n+": "+this[n]);return c};for(let n=0;n<a.length;n++){const c=a[n],h=Qs[c],f=Object.entries(h);if(f.some(([u])=>typeof this[u]<"u")){s=h;for(let u=0;u<f.length;u++){const[g,m]=f[u],y=i(g);if(typeof y>"u")throw new Error("Missing parameter: "+g+".");this[m]=y}break}}if(!s)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:r,phip:o}=rf(this,s);this.lamp=r,Math.abs(o)>k?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=hr.OBLIQUE):this.projectionType=hr.TRANSVERSE}function sf(e){return this.projectionType.forward(this,e)}function af(e){return this.projectionType.inverse(this,e)}function rf(e,t){let s,a;if(t===Qs.ROTATE){let i=e.oLongC,r=e.oLatC,o=e.oAlpha;if(Math.abs(Math.abs(r)-N)<=k)throw new Error("Invalid value for o_lat_c: "+e.o_lat_c+" should be < 90");a=i+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(r)),s=Math.asin(Math.cos(r)*Math.sin(o))}else if(t===Qs.NEW_POLE)a=e.oLongP,s=e.oLatP;else{let i=e.oLong1,r=e.oLat1,o=e.oLong2,n=e.oLat2,c=Math.abs(r);if(Math.abs(r)>N-k)throw new Error("Invalid value for o_lat_1: "+e.o_lat_1+" should be < 90");if(Math.abs(n)>N-k)throw new Error("Invalid value for o_lat_2: "+e.o_lat_2+" should be < 90");if(Math.abs(r-n)<k)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(c<k)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");a=Math.atan2(Math.cos(r)*Math.sin(n)*Math.cos(i)-Math.sin(r)*Math.cos(n)*Math.cos(o),Math.sin(r)*Math.cos(n)*Math.sin(o)-Math.cos(r)*Math.sin(n)*Math.sin(i)),s=Math.atan(-1*Math.cos(a-i)/Math.tan(r))}return{lamp:a,phip:s}}function nf(e,t){let{x:s,y:a}=t;s+=e.long0;const i=Math.cos(s),r=Math.sin(a),o=Math.cos(a);return t.x=A(Math.atan2(o*Math.sin(s),e.sphip*o*i+e.cphip*r)+e.lamp),t.y=Math.asin(e.sphip*r-e.cphip*o*i),e.obliqueProjection.forward(t)}function of(e,t){let{x:s,y:a}=t;s+=e.long0;const i=Math.cos(a),r=Math.cos(s);return t.x=A(Math.atan2(i*Math.sin(s),Math.sin(a))+e.lamp),t.y=Math.asin(-1*i*r),e.obliqueProjection.forward(t)}function lf(e,t){const s=e.obliqueProjection.inverse(t);let{x:a,y:i}=s;if(a<Number.MAX_VALUE){a-=e.lamp;const r=Math.cos(a),o=Math.sin(i),n=Math.cos(i);t.x=Math.atan2(n*Math.sin(a),e.sphip*n*r-e.cphip*o),t.y=Math.asin(e.sphip*o+e.cphip*n*r)}return t.x=A(t.x+e.long0),t}function cf(e,t){const s=e.obliqueProjection.inverse(t);let{x:a,y:i}=s;if(a<Number.MAX_VALUE){const r=Math.cos(i);a-=e.lamp,t.x=Math.atan2(r*Math.sin(a),-1*Math.sin(i)),t.y=Math.asin(r*Math.cos(a))}return t.x=A(t.x+e.long0),t}var hf=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const df={init:tf,forward:sf,inverse:af,names:hf};function uf(e){e.Proj.projections.add($s),e.Proj.projections.add(Us),e.Proj.projections.add(Qh),e.Proj.projections.add(l0),e.Proj.projections.add(f0),e.Proj.projections.add(y0),e.Proj.projections.add(E0),e.Proj.projections.add(j0),e.Proj.projections.add(T0),e.Proj.projections.add(D0),e.Proj.projections.add(J0),e.Proj.projections.add(id),e.Proj.projections.add(cd),e.Proj.projections.add(gd),e.Proj.projections.add(_d),e.Proj.projections.add(Sd),e.Proj.projections.add(kd),e.Proj.projections.add(Ld),e.Proj.projections.add($d),e.Proj.projections.add(Wd),e.Proj.projections.add(Zd),e.Proj.projections.add(su),e.Proj.projections.add(cu),e.Proj.projections.add(mu),e.Proj.projections.add(vu),e.Proj.projections.add(Nu),e.Proj.projections.add(Iu),e.Proj.projections.add(Ou),e.Proj.projections.add(Uu),e.Proj.projections.add(Vu),e.Proj.projections.add(ef),e.Proj.projections.add(df)}const fi=Object.assign(ph,{defaultDatum:"WGS84",Proj:Le,WGS84:new Le("WGS84"),Point:Ut,toPoint:hn,defs:pe,nadgrid:Jc,transform:Ks,mgrs:xh,version:"__VERSION__"});uf(fi);class ea extends ho{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Or),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let s=0,a=t.length;s<a;++s)this.changeEventsKeys_.push(Fr(t[s],uo.CHANGE,this.changed,this))}clone(){const t=new ea(wa(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,s,a,i){if(i<ps(this.getExtent(),t,s))return i;const r=this.geometries_;for(let o=0,n=r.length;o<n;++o)i=r[o].closestPointXY(t,s,a,i);return i}containsXY(t,s){const a=this.geometries_;for(let i=0,r=a.length;i<r;++i)if(a[i].containsXY(t,s))return!0;return!1}computeExtent(t){fo(t);const s=this.geometries_;for(let a=0,i=s.length;a<i;++a)mo(t,s[a].getExtent());return t}getGeometries(){return wa(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const s=this.geometries_;for(let a=0,i=s.length;a<i;++a)s[a].getType()===this.getType()?t=t.concat(s[a].getGeometriesArrayRecursive()):t.push(s[a]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const s=[],a=this.geometries_;let i=!1;for(let r=0,o=a.length;r<o;++r){const n=a[r],c=n.getSimplifiedGeometry(t);s.push(c),c!==n&&(i=!0)}return i?new ea(s):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const s=this.geometries_;for(let a=0,i=s.length;a<i;++a)if(s[a].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,s){const a=this.geometries_;for(let i=0,r=a.length;i<r;++i)a[i].rotate(t,s);this.changed()}scale(t,s,a){a||(a=go(this.getExtent()));const i=this.geometries_;for(let r=0,o=i.length;r<o;++r)i[r].scale(t,s,a);this.changed()}setGeometries(t){this.setGeometriesArray(wa(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const s=this.geometries_;for(let a=0,i=s.length;a<i;++a)s[a].applyTransform(t);this.changed()}translate(t,s){const a=this.geometries_;for(let i=0,r=a.length;i<r;++i)a[i].translate(t,s);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function wa(e){return e.map(t=>t.clone())}class Ht extends ra{constructor(t,s){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,s!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(s,t):this.setCoordinates(t,s)}appendCoordinate(t){gt(this.flatCoordinates,t),this.changed()}clone(){const t=new Ht(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,s,a,i){return i<ps(this.getExtent(),t,s)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(po(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,s,a,i))}forEachSegment(t){return yo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,s){return this.layout!="XYM"&&this.layout!="XYZM"?null:(s=s!==void 0?s:!1,vo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,s))}getCoordinates(){return Dr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,s){return zr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,s,this.stride)}getLength(){return $r(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const s=[];return s.length=_o(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,s,0),new Ht(s,"XY")}getType(){return"LineString"}intersectsExtent(t){return bo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,s){this.setLayout(s,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ur(this.flatCoordinates,0,t,this.stride),this.changed()}}class ta extends ra{constructor(t,s,a){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,s);else if(s!==void 0&&a)this.setFlatCoordinates(s,t),this.ends_=a;else{const i=t,r=[],o=[];for(let c=0,h=i.length;c<h;++c){const f=i[c];gt(r,f.getFlatCoordinates()),o.push(r.length)}const n=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(n,r),this.ends_=o}}appendLineString(t){gt(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new ta(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,s,a,i){return i<ps(this.getExtent(),t,s)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(wo(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Mo(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,s,a,i))}getCoordinateAtM(t,s,a){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(s=s!==void 0?s:!1,a=a!==void 0?a:!1,Eo(this.flatCoordinates,0,this.ends_,this.stride,t,s,a))}getCoordinates(){return So(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Ht(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,s=this.ends_,a=this.layout,i=[];let r=0;for(let o=0,n=s.length;o<n;++o){const c=s[o],h=new Ht(t.slice(r,c),a);i.push(h),r=c}return i}getLength(){const t=this.ends_;let s=0,a=0;for(let i=0,r=t.length;i<r;++i)a+=$r(this.flatCoordinates,s,t[i],this.stride),s=t[i];return a}getFlatMidpoints(){const t=[],s=this.flatCoordinates;let a=0;const i=this.ends_,r=this.stride;for(let o=0,n=i.length;o<n;++o){const c=i[o],h=zr(s,a,c,r,.5);gt(t,h),a=c}return t}getSimplifiedGeometryInternal(t){const s=[],a=[];return s.length=Co(this.flatCoordinates,0,this.ends_,this.stride,t,s,0,a),new ta(s,"XY",a)}getType(){return"MultiLineString"}intersectsExtent(t){return No(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,s){this.setLayout(s,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const a=Ya(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=a.length===0?0:a[a.length-1],this.changed()}}class la extends ra{constructor(t,s){super(),s&&!Array.isArray(t[0])?this.setFlatCoordinates(s,t):this.setCoordinates(t,s)}appendPoint(t){gt(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new la(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,s,a,i){if(i<ps(this.getExtent(),t,s))return i;const r=this.flatCoordinates,o=this.stride;for(let n=0,c=r.length;n<c;n+=o){const h=Po(t,s,r[n],r[n+1]);if(h<i){i=h;for(let f=0;f<o;++f)a[f]=r[n+f];a.length=o}}return i}getCoordinates(){return Dr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const s=this.flatCoordinates.length/this.stride;return t<0||s<=t?null:new Bs(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,s=this.layout,a=this.stride,i=[];for(let r=0,o=t.length;r<o;r+=a){const n=new Bs(t.slice(r,r+a),s);i.push(n)}return i}getType(){return"MultiPoint"}intersectsExtent(t){const s=this.flatCoordinates,a=this.stride;for(let i=0,r=s.length;i<r;i+=a){const o=s[i],n=s[i+1];if(jo(t,o,n))return!0}return!1}setCoordinates(t,s){this.setLayout(s,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ur(this.flatCoordinates,0,t,this.stride),this.changed()}}class sa extends ra{constructor(t,s,a){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!a&&!Array.isArray(t[0])){const i=t,r=[],o=[];for(let n=0,c=i.length;n<c;++n){const h=i[n],f=r.length,d=h.getEnds();for(let u=0,g=d.length;u<g;++u)d[u]+=f;gt(r,h.getFlatCoordinates()),o.push(d)}s=i.length===0?this.getLayout():i[0].getLayout(),t=r,a=o}s!==void 0&&a?(this.setFlatCoordinates(s,t),this.endss_=a):this.setCoordinates(t,s)}appendPolygon(t){let s;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),s=t.getEnds().slice(),this.endss_.push();else{const a=this.flatCoordinates.length;gt(this.flatCoordinates,t.getFlatCoordinates()),s=t.getEnds().slice();for(let i=0,r=s.length;i<r;++i)s[i]+=a}this.endss_.push(s),this.changed()}clone(){const t=this.endss_.length,s=new Array(t);for(let i=0;i<t;++i)s[i]=this.endss_[i].slice();const a=new sa(this.flatCoordinates.slice(),this.layout,s);return a.applyProperties(this),a}closestPointXY(t,s,a,i){return i<ps(this.getExtent(),t,s)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ko(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ao(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,s,a,i))}containsXY(t,s){return Io(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,s)}getArea(){return Go(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let s;return t!==void 0?(s=this.getOrientedFlatCoordinates().slice(),Oa(s,0,this.endss_,this.stride,t)):s=this.flatCoordinates,To(s,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Lo(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Ro(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new la(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Hr(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Oa(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const s=[],a=[];return s.length=Oo(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),s,0,a),new sa(s,"XY",a)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let s;if(t===0)s=0;else{const r=this.endss_[t-1];s=r[r.length-1]}const a=this.endss_[t].slice(),i=a[a.length-1];if(s!==0)for(let r=0,o=a.length;r<o;++r)a[r]-=s;return new Fa(this.flatCoordinates.slice(s,i),this.layout,a)}getPolygons(){const t=this.layout,s=this.flatCoordinates,a=this.endss_,i=[];let r=0;for(let o=0,n=a.length;o<n;++o){const c=a[o].slice(),h=c[c.length-1];if(r!==0)for(let d=0,u=c.length;d<u;++d)c[d]-=r;const f=new Fa(s.slice(r,h),t,c);i.push(f),r=h}return i}getType(){return"MultiPolygon"}intersectsExtent(t){return Fo(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,s){this.setLayout(s,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const a=qr(this.flatCoordinates,0,t,this.stride,this.endss_);if(a.length===0)this.flatCoordinates.length=0;else{const i=a[a.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const wn="/opin//map-marker.svg",Zt=(e,t=!1)=>{const s=e.get("markerData")||e.get("schoolData"),a=e.get("isNearbyPair");if(!s)return null;const i=new rt({image:new Br({src:wn,scale:a?1.2:1,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction"}),geometry:e.getGeometry()});if(t&&s.titulo){const r=new rt({text:new Do({text:s.titulo,font:"12px Arial",fill:new $t({color:"#1F2937"}),stroke:new zt({color:"#FFFFFF",width:2}),offsetY:-15,textAlign:"center"}),geometry:e.getGeometry()});return[i,r]}return i},ff=(e,t)=>{if(!t)return null;const s=e.getGeometry(),a=new rt({image:new zo({radius:12,fill:new $t({color:"transparent"}),stroke:new zt({color:"#ffffff",width:3,lineCap:"round",lineJoin:"round"})}),geometry:s}),i=new rt({image:new Br({src:wn,scale:1.1,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction"}),geometry:s});return Array.isArray(t)?[a,...t,i]:[a,t,i]},aa=()=>{const e=window.innerWidth;if(e>Ra.mobile)return!1;const t=e<=Ra.mobile,s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),a=window.orientation!==void 0;return t&&(s||a)?!0:t},mf=()=>"ontouchstart"in window||navigator.maxTouchPoints>0;class gf{constructor(t,s={}){this.map=t,this.options={enableHover:s.enableHover!==!1,enableClick:s.enableClick!==!1,enableDoubleClick:s.enableDoubleClick!==!1,enableTouch:s.enableTouch!==!1,hoverDelay:s.hoverDelay||200,clickDelay:s.clickDelay||300,...s},this.eventHandlers=new Map,this.hoveredFeature=null,this.clickedFeature=null,this.clickTimeout=null,this.hoverTimeout=null,this.tooltipElement=null,console.log("[OpenLayersInteractions] Interaes inicializadas"),this.initializeInteractions()}isMobile(){const t=aa(),s=mf();return console.log("[OpenLayersInteractions] Deteco de mobile:",{mobile:t,hasTouch:s,windowWidth:window.innerWidth,userAgent:navigator.userAgent}),t||s}initializeInteractions(){this.options.enableHover&&this.setupHoverInteraction(),this.options.enableClick&&this.setupClickInteraction(),this.options.enableDoubleClick&&this.setupDoubleClickInteraction(),this.options.enableTouch&&this.isMobile()&&this.setupTouchInteraction()}setupHoverInteraction(){this.map.on("pointermove",t=>{this.handlePointerMove(t)}),this.map.on("pointerleave",()=>{this.handlePointerLeave()})}setupClickInteraction(){this.map.on("click",t=>{this.handleClick(t)})}setupDoubleClickInteraction(){this.map.on("dblclick",t=>{this.handleDoubleClick(t)})}setupTouchInteraction(){console.log("[OpenLayersInteractions] Touch interaction configurada para mobile")}handlePointerMove(t){if(this.isMobile())return;const s=this.map.forEachFeatureAtPixel(t.pixel,a=>a);s&&!this.hoveredFeature&&console.log("[OpenLayersInteractions] Feature detectado:",{type:s.get("type"),schoolData:s.get("schoolData"),terraIndigenaInfo:s.get("terraIndigenaInfo")}),s!==this.hoveredFeature&&(this.hoveredFeature&&this.clearHover(),s&&this.applyHover(s,t))}handlePointerLeave(){this.clearHover()}handleClick(t){const s=this.map.forEachFeatureAtPixel(t.pixel,a=>a);if(s){if(this.isMobile()){this.handleMobileClick(s,t);return}if(this.clickedFeature===s){this.handleDoubleClick(t);return}this.clickedFeature=s,this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout(()=>{this.clickedFeature=null},this.options.clickDelay),this.executeClickHandler(s,t)}}handleDoubleClick(t){const s=this.map.forEachFeatureAtPixel(t.pixel,a=>a);s&&(this.clickTimeout&&(clearTimeout(this.clickTimeout),this.clickTimeout=null),this.clickedFeature=null,this.executeDoubleClickHandler(s,t))}handleTouchEnd(t){const s=this.map.forEachFeatureAtPixel(t.pixel,a=>a);s&&this.executeClickHandler(s,t)}handleMobileClick(t,s){if(this.clickedFeature===t){console.log("[OpenLayersInteractions] Segundo clique em mobile - abrindo painel"),this.forceHideTooltip(),this.executeClickHandler(t,s);return}console.log("[OpenLayersInteractions] Primeiro clique em mobile - mostrando tooltip"),this.clickedFeature=t,this.options.showTooltip&&this.showTooltip(t,s),this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout(()=>{console.log("[OpenLayersInteractions] Timeout mobile - escondendo tooltip e resetando"),this.forceHideTooltip()},3e3),this.executeHoverHandler(t,s)}applyHover(t,s){this.hoveredFeature=t,this.applyHoverStyle(t),this.options.showTooltip&&!this.isMobile()&&this.showTooltip(t,s),this.executeHoverHandler(t,s)}clearHover(){this.hoveredFeature&&(this.clearHoverStyle(this.hoveredFeature),this.isMobile()||this.hideTooltip(),this.executeHoverOutHandler(this.hoveredFeature),this.hoveredFeature=null)}applyHoverStyle(t){this.options.hoverStyleFunction&&this.options.hoverStyleFunction(t,!0)}clearHoverStyle(t){this.options.hoverStyleFunction&&this.options.hoverStyleFunction(t,!1)}showTooltip(t,s){this.tooltipElement&&this.hideTooltip();const a=this.getTooltipContent(t);if(console.log("[OpenLayersInteractions] Contedo do tooltip:",a),!a){console.log("[OpenLayersInteractions] Sem contedo para tooltip");return}this.tooltipElement=this.createTooltipElement(a,s),this.map.getTargetElement().appendChild(this.tooltipElement),console.log("[OpenLayersInteractions] Tooltip criado e adicionado ao DOM")}hideTooltip(){this.tooltipElement&&(this.tooltipElement.remove(),this.tooltipElement=null,console.log("[OpenLayersInteractions] Tooltip escondido"))}forceHideTooltip(){this.hideTooltip(),this.clickTimeout&&(clearTimeout(this.clickTimeout),this.clickTimeout=null),this.clickedFeature=null,console.log("[OpenLayersInteractions] Tooltip foradamente escondido e estado resetado")}createTooltipElement(t,s){const a=document.createElement("div");a.className="ol-tooltip";const i=t.includes("Terra Indgena");if(this.isMobile()){const n=`<span class="tooltip-clickable">${t}</span>`;a.innerHTML=n;const c=i?{backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(239, 68, 68, 0.15)"}:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(5, 150, 105, 0.15)"};Object.assign(a.style,{position:"absolute",padding:"6px 10px",borderRadius:"6px",fontSize:"13px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontWeight:"400",color:"#4B5563",pointerEvents:"auto",zIndex:"1000",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.04)",border:`1px solid ${c.borderColor}`,cursor:"default",transition:"all 0.2s ease",backdropFilter:"blur(8px)",...c});const h=a.querySelector(".tooltip-clickable");h&&(Object.assign(h.style,{cursor:"pointer",textDecoration:"underline",textDecorationColor:"#3B82F6",textDecorationThickness:"2px",transition:"all 0.2s ease",display:"inline-block",padding:"2px 4px",borderRadius:"4px",fontWeight:"800"}),h.addEventListener("click",()=>{console.log("[OpenLayersInteractions] Nome clicado no tooltip mobile");const f=this.map.forEachFeatureAtPixel(s.pixel,d=>d);f&&this.executeClickHandler(f,s)}),h.addEventListener("mouseenter",()=>{h.style.backgroundColor="rgba(59, 130, 246, 0.1)",h.style.textDecorationColor="#1D4ED8",h.style.transform="scale(1.05)"}),h.addEventListener("mouseleave",()=>{h.style.backgroundColor="transparent",h.style.textDecorationColor="#3B82F6",h.style.transform="scale(1)"}))}else{a.innerHTML=t;const n=i?{backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(239, 68, 68, 0.15)"}:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(5, 150, 105, 0.15)"};Object.assign(a.style,{position:"absolute",padding:"6px 10px",borderRadius:"6px",fontSize:"12px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontWeight:"400",color:"#4B5563",pointerEvents:"none",zIndex:"1000",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.04)",border:`1px solid ${n.borderColor}`,transition:"all 0.2s ease",backdropFilter:"blur(8px)",...n})}const r=s.coordinate,o=this.map.getPixelFromCoordinate(r);return a.style.left=o[0]+10+"px",a.style.top=o[1]-10+"px",a}getTooltipContent(t){if(console.log("[OpenLayersInteractions] Obtendo contedo do tooltip para feature:",{type:t.get("type"),schoolData:t.get("schoolData"),terraIndigenaInfo:t.get("terraIndigenaInfo")}),this.options.tooltipContentFunction){const i=this.options.tooltipContentFunction(t);return console.log("[OpenLayersInteractions] Contedo do tooltip (funo customizada):",i),i}const s=t.get("schoolData");if(s){const i=s.titulo||"Escola Indgena";return console.log("[OpenLayersInteractions] Ttulo extrado (padro):",i),console.log("[OpenLayersInteractions] Contedo do tooltip (padro escola - FORADO apenas ttulo):",i),i}const a=t.get("terraIndigenaInfo");if(a){const i=`Terra Indgena ${a.titulo||"Indgena"}`;return console.log("[OpenLayersInteractions] Contedo do tooltip (padro terra indgena):",i),i}return console.log("[OpenLayersInteractions] Nenhum contedo encontrado para tooltip"),null}executeClickHandler(t,s){const a=this.eventHandlers.get("click");a&&typeof a=="function"&&a(t,s)}executeDoubleClickHandler(t,s){const a=this.eventHandlers.get("doubleClick");a&&typeof a=="function"&&a(t,s)}executeHoverHandler(t,s){const a=this.eventHandlers.get("hover");a&&typeof a=="function"&&a(t,s)}executeHoverOutHandler(t){const s=this.eventHandlers.get("hoverOut");s&&typeof s=="function"&&s(t)}on(t,s){this.eventHandlers.set(t,s)}off(t){this.eventHandlers.delete(t)}clearHandlers(){this.eventHandlers.clear()}updateOptions(t){this.options={...this.options,...t},t.enableHover,t.enableClick}destroy(){this.clickTimeout&&clearTimeout(this.clickTimeout),this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.hideTooltip(),this.clearHover(),this.clearHandlers()}}function Mn(e,t={}){const s={enableHover:!0,enableClick:!0,enableDoubleClick:!0,enableTouch:!0,showTooltip:!0,hoverDelay:200,clickDelay:300};return new gf(e,{...s,...t})}function pf(e,t,s){console.log("[createMarkerInteractions] Criando interaes para marcadores...");const a=Mn(e,{showTooltip:!0,tooltipContentFunction:i=>{console.log("[createMarkerInteractions] Funo de contedo do tooltip chamada para:",i);const r=i.get("schoolData");if(r){const o=r.titulo||"Escola Indgena";return console.log("[createMarkerInteractions] Ttulo extrado:",o),console.log("[createMarkerInteractions] Contedo do tooltip gerado (FORADO apenas ttulo):",o),o}return console.log("[createMarkerInteractions] Sem dados de escola para tooltip"),null}});return t&&(console.log("[createMarkerInteractions] Configurando handler de clique personalizado"),a.on("click",t)),s&&a.on("hover",s),console.log("[createMarkerInteractions] Interaes criadas com sucesso"),a}function xf(e,t,s){const a=Mn(e,{showTooltip:!0,tooltipContentFunction:i=>{const r=i.get("terraIndigenaInfo");return r?`Terra Indgena ${r.titulo||"Indgena"}`:null}});return t&&a.on("click",t),s&&a.on("hover",s),a}function yf(e,t,s={}){if(!e||!t)return;const a=s.radiusPx??18,i=s.durationMs??900,r=document.createElement("div");r.className="ol-click-pulse",r.style.width=`${a*2}px`,r.style.height=`${a*2}px`,r.style.marginLeft=`${-a}px`,r.style.marginTop=`${-a}px`;const o=new rc({element:r,positioning:"center-center",stopEvent:!1});e.addOverlay(o),o.setPosition(t);const n=()=>{try{e.removeOverlay(o)}catch{}};r.addEventListener("animationend",n,{once:!0}),setTimeout(n,i+100)}function Ma(e,t,s={}){if(!e||!t)return;const a=s.durationMs??350,i=e.getView(),r={center:t,duration:a};typeof s.zoom=="number"&&(r.zoom=s.zoom),i.animate(r)}function vf(e,t,s={}){if(!e||!t)return;const a=s.durationMs??350,i=s.zoom,r=typeof s.fractionX=="number"?s.fractionX:.25,o=typeof s.fractionY=="number"?s.fractionY:.5,n=e.getSize();if(!n)return Ma(e,t,{durationMs:a,zoom:i});const[c,h]=n,f=Math.max(0,Math.min(1,r)),d=Math.max(0,Math.min(1,o)),u=f*c,g=d*h,m=e.getPixelFromCoordinate(t);if(!m)return Ma(e,t,{durationMs:a,zoom:i});const y=[m[0]-u+c/2,m[1]-g+h/2],x=e.getCoordinateFromPixel(y);if(!x)return Ma(e,t,{durationMs:a,zoom:i});const _=e.getView(),w={center:x,duration:a};typeof i=="number"&&(w.zoom=i),_.animate(w)}const _f=({dataPoints:e=[],onPainelOpen:t,showMarcadores:s=!0,showNomesEscolas:a=!1,map:i,className:r="h-full w-full"})=>{const o=p.useRef(null),n=p.useRef(null),[,c]=ee.useState(null),h=p.useCallback(()=>{i&&(o.current=new Za,n.current=new Ja({source:o.current,style:x=>Zt(x,a),zIndex:100}),i.addLayer(n.current),f())},[i,a]),f=p.useCallback(()=>{if(!i||!n.current)return;const x=pf(i,d,u);x.on("click",d),x.on("hover",u),x.on("hoverOut",g)},[i]),d=p.useCallback((x,_)=>{const w=x.get("schoolData");if(w&&t){const M=x.getGeometry()?.getCoordinates();if(i&&M){let b=.25;try{document.querySelector(".mj-panel")?.classList?.contains("mj-maximized")&&(b=.5)}catch{}vf(i,M,{durationMs:550,fractionX:b}),yf(i,M)}_e.debug("[OpenLayersMarkers] Marcador clicado:",w.titulo),t(w)}},[t,i]),u=p.useCallback((x,_)=>{c(x),n.current&&(n.current.setStyle(w=>w===x?ff(w,Zt(w,a)):Zt(w,a)),n.current.changed())},[a]),g=p.useCallback(()=>{c(null),n.current&&(n.current.setStyle(x=>Zt(x,a)),n.current.changed())},[a]),m=p.useCallback(()=>{if(!o.current||!e||(_e.debug("[OpenLayersMarkers] Atualizando marcadores...",e.length,"showMarcadores:",s),o.current.clear(),!s))return;const x=e.filter(_=>{if(!_.latitude||!_.longitude)return!1;const w=parseFloat(_.latitude),M=parseFloat(_.longitude);return!isNaN(w)&&!isNaN(M)&&w>=-90&&w<=90&&M>=-180&&M<=180});_e.debug("[OpenLayersMarkers] Pontos vlidos:",x.length),x.forEach((_,w)=>{if(_.latitude&&_.longitude){const M=new Qa({geometry:new Bs(Tt([_.longitude,_.latitude]))});M.set("markerData",_),M.set("schoolData",_),M.set("markerId",`marker_${w}`),M.set("type","marker"),o.current.addFeature(M)}}),_e.debug(`[OpenLayersMarkers] ${x.length} marcadores individuais adicionados`)},[e,s]),y=p.useCallback(()=>{n.current&&(n.current.setStyle(x=>Zt(x,a)),n.current.changed())},[a]);return p.useEffect(()=>(i&&h(),()=>{n.current&&i&&i.removeLayer(n.current)}),[i,h]),p.useEffect(()=>{m()},[m]),p.useEffect(()=>{y()},[y]),l.jsx("div",{className:r})};class bf{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Qa,this.supportedMediaTypes=null}getReadOptions(t,s){if(s){let a=s.dataProjection?st(s.dataProjection):this.readProjection(t);s.extent&&a&&a.getUnits()==="tile-pixels"&&(a=st(a),a.setWorldExtent(s.extent)),s={dataProjection:a,featureProjection:s.featureProjection}}return this.adaptOptions(s)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return ve()}readFeature(t,s){return ve()}readFeatures(t,s){return ve()}readGeometry(t,s){return ve()}readProjection(t){return ve()}writeFeature(t,s){return ve()}writeFeatures(t,s){return ve()}writeGeometry(t,s){return ve()}}function mi(e,t,s){const a=s?st(s.featureProjection):null,i=s?st(s.dataProjection):null;let r=e;if(a&&i&&!$o(a,i)){t&&(r=e.clone());const o=t?a:i,n=t?i:a;o.getUnits()==="tile-pixels"?r.transform(o,n):r.applyTransform(Uo(o,n))}if(t&&s&&s.decimals!==void 0){const o=Math.pow(10,s.decimals),n=function(c){for(let h=0,f=c.length;h<f;++h)c[h]=Math.round(c[h]*o)/o;return c};r===e&&(r=e.clone()),r.applyTransform(n)}return r}const wf={Point:Bs,LineString:Ht,Polygon:Fa,MultiPoint:la,MultiLineString:ta,MultiPolygon:sa};function Mf(e,t,s){return Array.isArray(t[0])?(Hr(e,0,t,s)||(e=e.slice(),Oa(e,0,t,s)),e):(Ho(e,0,t,s)||(e=e.slice(),qo(e,0,t,s)),e)}function En(e,t){const s=e.geometry;if(!s)return[];if(Array.isArray(s))return s.map(r=>En({...e,geometry:r})).flat();const a=s.type==="MultiPolygon"?"Polygon":s.type;if(a==="GeometryCollection"||a==="Circle")throw new Error("Unsupported geometry type: "+a);const i=s.layout.length;return mi(new Wr(a,a==="Polygon"?Mf(s.flatCoordinates,s.ends,i):s.flatCoordinates,s.ends?.flat(),i,e.properties||{},e.id).enableSimplifyTransformed(),!1,t)}function gi(e,t){if(!e)return null;if(Array.isArray(e)){const a=e.map(i=>gi(i,t));return new ea(a)}const s=wf[e.type];return mi(new s(e.flatCoordinates,e.layout||"XY",e.ends),!1,t)}class Ef extends bf{constructor(){super()}getType(){return"json"}readFeature(t,s){return this.readFeatureFromObject(Ts(t),this.getReadOptions(t,s))}readFeatures(t,s){return this.readFeaturesFromObject(Ts(t),this.getReadOptions(t,s))}readFeatureFromObject(t,s){return ve()}readFeaturesFromObject(t,s){return ve()}readGeometry(t,s){return this.readGeometryFromObject(Ts(t),this.getReadOptions(t,s))}readGeometryFromObject(t,s){return ve()}readProjection(t){return this.readProjectionFromObject(Ts(t))}readProjectionFromObject(t){return ve()}writeFeature(t,s){return JSON.stringify(this.writeFeatureObject(t,s))}writeFeatureObject(t,s){return ve()}writeFeatures(t,s){return JSON.stringify(this.writeFeaturesObject(t,s))}writeFeaturesObject(t,s){return ve()}writeGeometry(t,s){return JSON.stringify(this.writeGeometryObject(t,s))}writeGeometryObject(t,s){return ve()}}function Ts(e){if(typeof e=="string"){const t=JSON.parse(e);return t||null}return e!==null?e:null}class Sn extends Ef{constructor(t){t=t||{},super(),this.dataProjection=st(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=st(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,s){let a=null;t.type==="Feature"?a=t:a={type:"Feature",geometry:t,properties:null};const i=pi(a.geometry);if(this.featureClass===Wr)return En({geometry:i,id:a.id,properties:a.properties},s);const r=new Qa;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&a.geometry_name&&r.setGeometryName(a.geometry_name),r.setGeometry(gi(i,s)),"id"in a&&r.setId(a.id),a.properties&&r.setProperties(a.properties,!0),r}readFeaturesFromObject(t,s){const a=t;let i=null;if(a.type==="FeatureCollection"){const r=t;i=[];const o=r.features;for(let n=0,c=o.length;n<c;++n){const h=this.readFeatureFromObject(o[n],s);h&&i.push(h)}}else i=[this.readFeatureFromObject(t,s)];return i.flat()}readGeometryFromObject(t,s){return Sf(t,s)}readProjectionFromObject(t){const s=t.crs;let a;if(s)if(s.type=="name")a=st(s.properties.name);else if(s.type==="EPSG")a=st("EPSG:"+s.properties.code);else throw new Error("Unknown SRS type");else a=this.dataProjection;return a}writeFeatureObject(t,s){s=this.adaptOptions(s);const a={type:"Feature",geometry:null,properties:null},i=t.getId();if(i!==void 0&&(a.id=i),!t.hasProperties())return a;const r=t.getProperties(),o=t.getGeometry();return o&&(a.geometry=Wa(o,s),delete r[t.getGeometryName()]),Bo(r)||(a.properties=r),a}writeFeaturesObject(t,s){s=this.adaptOptions(s);const a=[];for(let i=0,r=t.length;i<r;++i)a.push(this.writeFeatureObject(t[i],s));return{type:"FeatureCollection",features:a}}writeGeometryObject(t,s){return Wa(t,this.adaptOptions(s))}}function pi(e,t){if(!e)return null;let s;switch(e.type){case"Point":{s=Nf(e);break}case"LineString":{s=Pf(e);break}case"Polygon":{s=If(e);break}case"MultiPoint":{s=kf(e);break}case"MultiLineString":{s=jf(e);break}case"MultiPolygon":{s=Af(e);break}case"GeometryCollection":{s=Cf(e);break}default:throw new Error("Unsupported GeoJSON type: "+e.type)}return s}function Sf(e,t){const s=pi(e);return gi(s,t)}function Cf(e,t){return e.geometries.map(function(a){return pi(a)})}function Nf(e){const t=e.coordinates;return{type:"Point",flatCoordinates:t,layout:qt(t.length)}}function Pf(e){const t=e.coordinates,s=t.flat();return{type:"LineString",flatCoordinates:s,ends:[s.length],layout:qt(t[0]?.length||2)}}function jf(e){const t=e.coordinates,s=t[0]?.[0]?.length||2,a=[],i=Ya(a,0,t,s);return{type:"MultiLineString",flatCoordinates:a,ends:i,layout:qt(s)}}function kf(e){const t=e.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:qt(t[0]?.length||2)}}function Af(e){const t=e.coordinates,s=[],a=t[0]?.[0]?.[0].length||2,i=qr(s,0,t,a);return{type:"MultiPolygon",flatCoordinates:s,ends:i,layout:qt(a)}}function If(e){const t=e.coordinates,s=[],a=t[0]?.[0]?.length,i=Ya(s,0,t,a);return{type:"Polygon",flatCoordinates:s,ends:i,layout:qt(a)}}function Wa(e,t){e=mi(e,!0,t);const s=e.getType();let a;switch(s){case"Point":{a=Ff(e);break}case"LineString":{a=Tf(e);break}case"Polygon":{a=Df(e,t);break}case"MultiPoint":{a=Rf(e);break}case"MultiLineString":{a=Lf(e);break}case"MultiPolygon":{a=Of(e,t);break}case"GeometryCollection":{a=Gf(e,t);break}case"Circle":{a={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+s)}return a}function Gf(e,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:e.getGeometriesArray().map(function(a){return Wa(a,t)})}}function Tf(e,t){return{type:"LineString",coordinates:e.getCoordinates()}}function Lf(e,t){return{type:"MultiLineString",coordinates:e.getCoordinates()}}function Rf(e,t){return{type:"MultiPoint",coordinates:e.getCoordinates()}}function Of(e,t){let s;return t&&(s=t.rightHanded),{type:"MultiPolygon",coordinates:e.getCoordinates(s)}}function Ff(e,t){return{type:"Point",coordinates:e.getCoordinates()}}function Df(e,t){let s;return t&&(s=t.rightHanded),{type:"Polygon",coordinates:e.getCoordinates(s)}}const Gt={terrasIndigenas:{regularizada:{fill:"rgba(220, 20, 60, 0.3)",stroke:"#B22222",hover:{fill:"rgba(220, 20, 60, 0.45)",stroke:"#FF0000"}},declarada:{fill:"rgba(139, 0, 0, 0.25)",stroke:"#B22222",hover:{fill:"rgba(139, 0, 0, 0.4)",stroke:"#FF0000"}}},estadoSP:{fill:"rgba(0, 0, 0, 0.3)",stroke:"#000000",hover:{fill:"rgba(0, 0, 0, 0.4)",stroke:"#333333"}}},ut=(e,t=!1)=>{if(!e||!e.properties)return new rt({fill:new $t({color:Gt.terrasIndigenas.regularizada.fill}),stroke:new zt({color:Gt.terrasIndigenas.regularizada.stroke,width:2})});const a=e.properties.fase_ti==="Regularizada"?Gt.terrasIndigenas.regularizada:Gt.terrasIndigenas.declarada,i=t?a.hover:a;return new rt({fill:new $t({color:i.fill}),stroke:new zt({color:i.stroke,width:t?3:2,lineDash:t?[]:[3,3]})})},zf=(e,t=!1)=>{const s=t?Gt.estadoSP.hover:Gt.estadoSP;return new rt({fill:new $t({color:s.fill}),stroke:new zt({color:s.stroke,width:t?2:1})})},$f=(e,t,s={})=>{const{fillColor:a="rgba(59, 130, 246, 0.3)",strokeColor:i="#1E40AF",strokeWidth:r=3,lineDash:o=[5,5]}=s,n=new rt({fill:new $t({color:a}),stroke:new zt({color:i,width:r,lineDash:o})});return Array.isArray(t)?[...t,n]:[t,n]},je={center:[-48.4129,-22.3794],zoom:7.63,maxZoom:18,minZoom:4,mobile:{center:[-48.5935,-21.9212],zoom:5.7},interaction:{clickDelay:300},ANIMATION_CONFIG:{duration:{zoom:800}}},Ot={dataProjection:"EPSG:4326",featureProjection:"EPSG:3857",sirgas2000:"EPSG:4674"},Ct={satellite:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:' <a href="https://www.esri.com/">Esri</a>',maxZoom:19,wrapX:!1,tilePixelRatio:1,tileSize:256}},Uf=p.forwardRef(({data:e,onPainelOpen:t,showTerrasIndigenas:s=!0,map:a,className:i="h-full w-full"},r)=>{const o=p.useRef(null),n=p.useRef(null),c=p.useRef(null),[,h]=ee.useState(null),[f,d]=ee.useState(null),u=p.useMemo(()=>aa(),[]),g=p.useCallback(()=>{if(!(!a||!e)){if(!e.features||!Array.isArray(e.features)||e.features.length===0){console.warn("[OpenLayersTerrasIndigenas] Dados invlidos ou vazios:",e);return}try{const C=new Sn({dataProjection:Ot.sirgas2000||Ot.dataProjection,featureProjection:Ot.featureProjection}).readFeatures(e);o.current=new Za({features:C}),n.current=new Ja({source:o.current,style:S=>ut(S,!1),zIndex:10}),C.forEach(S=>{const E=S.getProperties();S.set("terraIndigenaInfo",{titulo:E.terrai_nom,tipo:"terra_indigena",etnia:E.etnia_nome,municipio:E.municipio_,uf:E.uf_sigla,superficie:E.superficie,fase:E.fase_ti,modalidade:E.modalidade,reestudo:E.reestudo_t,cr:E.cr,faixa_fron:E.faixa_fron,undadm_nom:E.undadm_nom,undadm_sig:E.undadm_sig,dominio_un:E.dominio_un,data_atual:E.data_atual,terrai_cod:E.terrai_cod,undadm_cod:E.undadm_cod})}),a.addLayer(n.current),m(),console.log(`[OpenLayersTerrasIndigenas] Camada criada com ${C.length} features`)}catch(b){console.error("[OpenLayersTerrasIndigenas] Erro ao criar camada:",b)}}},[a,e]),m=p.useCallback(()=>{!a||!n.current||(c.current=xf(a,y,x),c.current.on("click",y),c.current.on("hover",x),c.current.on("hoverOut",_))},[a]),y=p.useCallback((b,C)=>{if(!b)return;const S=b.get("terraIndigenaInfo");if(S)if(u)t&&t(S);else if(f===b)t&&t(S),d(null);else{d(b);const E=b.getGeometry();if(E){const G=E.getExtent();a.getView().fit(G,{duration:je.ANIMATION_CONFIG.duration.zoom,padding:[50,50,50,50],maxZoom:15})}}},[u,t,f,a]),x=p.useCallback((b,C)=>{u||(h(b),n.current&&(n.current.setStyle(S=>S===b?ut(S,!0):ut(S,!1)),n.current.changed()))},[u]),_=p.useCallback(b=>{h(null),n.current&&(n.current.setStyle(C=>ut(C,!1)),n.current.changed())},[]),w=p.useCallback(b=>{n.current&&(n.current.setStyle(C=>{if(C===b){const S=ut(C,!1);return $f(C,S)}return ut(C,!1)}),n.current.changed())},[]),M=p.useCallback(b=>{n.current&&(n.current.setStyle(C=>ut(C,!1)),n.current.changed())},[]);return p.useEffect(()=>(a&&e&&s&&g(),()=>{c.current&&c.current.destroy(),n.current&&a&&a.removeLayer(n.current)}),[a,e,s,g]),p.useEffect(()=>{f?w(f):n.current&&M()},[f,w,M]),p.useEffect(()=>{if(f){const b=setTimeout(()=>{d(null)},je.interaction.clickDelay);return()=>clearTimeout(b)}},[f]),!s||!e?null:l.jsx("div",{className:i})}),Hf=p.forwardRef(({data:e,showEstadoSP:t=!0,map:s,className:a="h-full w-full"},i)=>{const r=p.useRef(null),o=p.useRef(null),n=p.useCallback(()=>{if(!(!s||!e)){if(!e.features||!Array.isArray(e.features)||e.features.length===0){console.warn("[OpenLayersEstadoSP] Dados invlidos ou vazios:",e);return}try{const h=new Sn({dataProjection:Ot.sirgas2000||Ot.dataProjection,featureProjection:Ot.featureProjection}).readFeatures(e);r.current=new Za({features:h}),o.current=new Ja({source:r.current,style:f=>zf(f,!1),zIndex:5,interactive:!1}),s.addLayer(o.current),console.log(`[OpenLayersEstadoSP] Camada criada com ${h.length} features`)}catch(c){console.error("[OpenLayersEstadoSP] Erro ao criar camada:",c)}}},[s,e]);return p.useEffect(()=>(s&&e&&t&&n(),()=>{o.current&&s&&s.removeLayer(o.current)}),[s,e,t,n]),!t||!e?null:l.jsx("div",{className:a})}),qf=({terrasIndigenasData:e,estadoSPData:t,showTerrasIndigenas:s=!0,showEstadoSP:a=!0,onPainelOpen:i,map:r,className:o="h-full w-full"})=>{const n=p.useRef(null),c=p.useRef(null),[h,f]=ee.useState({terrasIndigenas:{visible:s,loaded:!1,error:null},estadoSP:{visible:a,loaded:!1,error:null}}),d=p.useMemo(()=>({terrasIndigenas:e&&e.features&&e.features.length>0,estadoSP:t&&t.features&&t.features.length>0}),[e,t]),u=p.useCallback((_,w)=>{f(M=>({...M,[_]:{...M[_],...w}}))},[]),g=p.useCallback((_,w)=>{console.error(`[OpenLayersLayers] Erro na camada ${_}:`,w),u(_,{error:w.message})},[u]),m=p.useCallback(_=>{u(_,{loaded:!0,error:null})},[u]),y=p.useCallback(()=>{const _={total:0,visible:0,loaded:0,errors:0};return Object.values(h).forEach(w=>{_.total++,w.visible&&_.visible++,w.loaded&&_.loaded++,w.error&&_.errors++}),_},[h]),x=p.useCallback(()=>({terrasIndigenas:{...h.terrasIndigenas,hasData:d.terrasIndigenas,featureCount:d.terrasIndigenas?e.features.length:0},estadoSP:{...h.estadoSP,hasData:d.estadoSP,featureCount:d.estadoSP?t.features.length:0}}),[h,d,e,t]);return p.useEffect(()=>{const _=y(),w=x();console.log("[OpenLayersLayers] Status das camadas:",{stats:_,info:w,hasValidData:d})},[h,y,x,d]),p.useEffect(()=>{f(_=>({terrasIndigenas:{..._.terrasIndigenas,visible:s},estadoSP:{..._.estadoSP,visible:a}}))},[s,a]),!d.terrasIndigenas&&!d.estadoSP?l.jsx("div",{className:o,children:l.jsx("div",{className:"text-center text-gray-500 p-4",children:"Nenhuma camada GeoJSON disponvel"})}):l.jsxs("div",{className:o,children:[d.terrasIndigenas&&l.jsx(Uf,{ref:n,data:e,onPainelOpen:i,showTerrasIndigenas:s,map:r,onLoad:()=>m("terrasIndigenas"),onError:_=>g("terrasIndigenas",_)}),d.estadoSP&&l.jsx(Hf,{ref:c,data:t,showEstadoSP:a,map:r,onLoad:()=>m("estadoSP"),onError:_=>g("estadoSP",_)})]})},Bf=ee.forwardRef((e,t)=>l.jsx("div",{id:"map",className:"w-full h-full",ref:t,...e}));fi.defs("EPSG:4674","+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs");nc(fi);const Wf=({dataPoints:e=[],onPainelOpen:t,center:s=je.center,zoom:a=je.zoom,className:i="h-screen w-full",terrasIndigenasData:r=null,estadoSPData:o=null,showTerrasIndigenas:n=!0,showEstadoSP:c=!0,showMarcadores:h=!0,showNomesEscolas:f=!1,onMapReady:d=null})=>{const u=p.useRef(null),g=p.useRef(null),m=p.useRef(null),[,y]=p.useState({lng:s[0],lat:s[1],zoom:a}),x=p.useMemo(()=>aa(),[]),_=x?je.mobile.center:s,w=x?je.mobile.zoom:a,M=p.useCallback(()=>({satelliteLayer:new Wo({source:new Vo({url:Ct.satellite.url,attributions:Ct.satellite.attributions,maxZoom:Ct.satellite.maxZoom,wrapX:Ct.satellite.wrapX,tilePixelRatio:Ct.satellite.tilePixelRatio,tileSize:Ct.satellite.tileSize}),preload:1,useInterimTilesOnError:!1})}),[]),b=p.useCallback(()=>{if(g.current)return;const{satelliteLayer:S}=M();m.current=S,g.current=new Xo({target:u.current,layers:[m.current],view:new Yo({center:Tt(_),zoom:w,maxZoom:je.maxZoom,minZoom:je.minZoom,enableRotation:!1}),controls:Ko({zoom:!1})}),g.current.on("moveend",()=>{const E=g.current.getView(),G=Ui(E.getCenter()),I={lng:G[0].toFixed(4),lat:G[1].toFixed(4),zoom:E.getZoom().toFixed(2)};y(I)}),console.log("[OpenLayersMap] Mapa inicializado com sucesso"),typeof d=="function"&&d(g.current)},[_,w,M,d]),C=p.useCallback(()=>{if(!g.current)return;const S=aa(),E=S?je.mobile.center:s,G=S?je.mobile.zoom:a,I=g.current.getView(),H=Ui(I.getCenter()),F=I.getZoom();(H[0]!==E[0]||H[1]!==E[1]||F!==G)&&(I.setCenter(Tt(E)),I.setZoom(G))},[s,a]);return p.useEffect(()=>(b(),()=>{g.current&&(g.current.setTarget(void 0),typeof d=="function"&&d(null),g.current=null)}),[b,d]),p.useEffect(()=>{C()},[C]),l.jsx(Bf,{ref:u,children:g.current&&l.jsxs(l.Fragment,{children:[l.jsx(_f,{dataPoints:e,onPainelOpen:t,showMarcadores:h,showNomesEscolas:f,map:g.current}),l.jsx(qf,{terrasIndigenasData:r,estadoSPData:o,showTerrasIndigenas:n,showEstadoSP:c,onPainelOpen:t,map:g.current})]})})},Ea={},dr=e=>{const[t,s]=p.useState(null),[a,i]=p.useState(!1),[r,o]=p.useState(null);return p.useEffect(()=>{if(!e)return;(async()=>{if(Ea[e]){s(Ea[e]);return}i(!0);try{const c=`/opin//${e}.geojson`;_e.debug(`useGeoJSONCache: Carregando ${e} de:`,c);const h=await fetch(c);if(!h.ok)throw new Error(`Erro ao buscar GeoJSON (${h.status})`);const f=await h.json();_e.debug(`useGeoJSONCache: ${e} carregado com sucesso:`,{type:f.type,features:f.features?.length||0}),Ea[e]=f,s(f)}catch(c){_e.error(`useGeoJSONCache: Erro ao carregar ${e}:`,c),o(c)}finally{i(!1)}})()},[e]),{data:t,loading:a,error:r}},Vf=(e,t)=>p.useMemo(()=>e?{minimized:{path:"M5 15l7-7 7 7",ariaLabel:"Expandir menu"},expanded:{path:"M19 9l-7 7-7-7",ariaLabel:"Minimizar menu"}}:{minimized:{path:"M19 9l-7 7-7-7",ariaLabel:"Expandir menu"},expanded:{path:"M5 15l7-7 7 7",ariaLabel:"Minimizar menu"}},[e]),Xf=({isMobile:e,isMinimized:t,className:s="w-4 h-4"})=>{const a=Vf(e),i=t?a.minimized:a.expanded;return l.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-label":i.ariaLabel,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:i.path})})},Kf=({dataPoints:e,onPainelOpen:t,painelAberto:s=!1,className:a="h-screen w-full",isMainLoading:i=!1})=>{const{data:r,loading:o,error:n}=dr("terras_indigenas"),{data:c,loading:h,error:f}=dr("SP"),[d,u]=p.useState(!0),[g,m]=p.useState(!0),[y,x]=p.useState(!0),{isMobile:_}=Gr(),[w,M]=p.useState(!1),[b,C]=p.useState(!1),[S,E]=p.useState(""),G=p.useRef(null),I=p.useRef(null),{searchResults:H,isSearching:F,performSearch:T}=Bn(e),D=p.useCallback(()=>M(R=>!R),[]),[K,J]=p.useState(()=>{const R=typeof window<"u"?localStorage.getItem("opin:textScale"):null;return R?parseFloat(R):1}),[z,oe]=p.useState(null),de=p.useCallback(R=>{oe(R)},[]),Ie=p.useCallback(R=>{if(!z)return;const U=z.getView();if(!U)return;const B=U.getZoom();typeof B=="number"&&U.animate({zoom:B+R,duration:200})},[z]),Je=p.useCallback(R=>{if(t&&e&&e.length>0){const U=R.toLowerCase(),B=e.find(Ee=>Ee.titulo&&Ee.titulo.toLowerCase().includes(U));if(B&&(t(B),z&&B.Latitude&&B.Longitude)){const Ee=z.getView();Ee&&Ee.animate({center:Tt([B.Longitude,B.Latitude]),zoom:Math.max(Ee.getZoom()||15,15),duration:500})}}},[t,e,z]),Y=p.useCallback(R=>{if(t&&R.data){if(t(R.data),z&&R.coordinates){const U=z.getView();U&&U.animate({center:Tt([R.coordinates.lng,R.coordinates.lat]),zoom:Math.max(U.getZoom()||15,15),duration:500})}}else if(R.coordinates&&z){const U=z.getView();U&&U.animate({center:Tt([R.coordinates.lng,R.coordinates.lat]),zoom:Math.max(U.getZoom()||15,15),duration:500})}C(!1),E("")},[t,z]);p.useEffect(()=>{const R=U=>{G.current&&!G.current.contains(U.target)&&(C(!1),E(""))};if(b)return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[b]),p.useEffect(()=>{b&&I.current&&I.current.focus()},[b]),p.useEffect(()=>{if(S.length<2)return;const U=setTimeout(async()=>{try{await T(S)}catch(B){console.error("Erro na busca:",B)}},300);return()=>clearTimeout(U)},[S,T]);const Qe=R=>{R.preventDefault();const U=S.trim();U&&(Je(U),C(!1),E(""))},re=R=>{E(R.target.value)},qe=R=>{R.key==="Enter"?(R.preventDefault(),Qe(R)):R.key==="Escape"&&(C(!1),E(""))},Q=R=>{switch(R){case"school":return l.jsx(Dt,{className:"w-4 h-4"});case"land":return l.jsx(Ds,{className:"w-4 h-4"});case"teacher":return l.jsx(Tr,{className:"w-4 h-4"});case"history":return l.jsx(Xn,{className:"w-4 h-4"});default:return l.jsx(Dt,{className:"w-4 h-4"})}},Be=(R,U)=>{if(!U)return R;const B=new RegExp(`(${U})`,"gi");return R.split(B).map((Se,ct)=>B.test(Se)?l.jsx("span",{className:"bg-yellow-200 font-semibold",children:Se},ct):Se)};p.useEffect(()=>{const R=Math.min(1.3,Math.max(.9,K));if(R!==K){J(R);return}const U=16;document.documentElement.style.fontSize=`${U*R}px`;try{localStorage.setItem("opin:textScale",String(R))}catch{}},[K]),p.useEffect(()=>{_e.debug("MapSelector: Status das camadas GeoJSON:",{terrasIndigenas:{loading:o,error:n,hasData:!!r,features:r?.features?.length||0},estadoSP:{loading:h,error:f,hasData:!!c,features:c?.features?.length||0}})},[r,c,o,h,n,f]),p.useEffect(()=>{!s&&_&&x(!0)},[s,_]);const et=({onMinimize:R,isMobile:U,isMinimized:B})=>l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-green-900/80 to-green-800/80 text-white",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"})}),l.jsx("h3",{className:"text-sm font-semibold tracking-wide",children:"Camadas do Mapa"})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("button",{onClick:R,className:"text-white hover:bg-white/10 transition-all duration-200 p-1.5 rounded-md","aria-label":B?"Expandir":"Minimizar",type:"button",children:l.jsx(Xf,{isMobile:U,isMinimized:B,className:"w-4 h-4"})})})]}),q=({id:R,label:U,checked:B,onChange:Ee,disabled:Se=!1,loading:ct=!1,error:Vt=!1})=>l.jsxs("button",{type:"button",onClick:Ee,disabled:Se,className:`group w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 focus:outline-none focus:ring-0 ${B?"bg-white/10":"bg-white/5 hover:bg-white/10"} ${Se?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:`text-sm font-medium ${B?"text-white":"text-white/90"}`,children:U})}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[ct&&!i&&l.jsx("div",{className:"flex items-center gap-1 text-white/80",children:l.jsx("span",{className:"text-xs",children:"Carregando..."})}),Vt&&l.jsxs("div",{className:"flex items-center gap-1 text-red-300",children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{className:"text-xs",children:"Erro"})]})]})]}),l.jsx("div",{className:"flex-shrink-0 ml-2",role:"switch","aria-checked":B,"aria-label":U,children:l.jsx("div",{className:`relative inline-flex h-5 w-10 items-center rounded-full transition-colors duration-200 ${B?"bg-green-500/70":"bg-gray-300"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${B?"translate-x-5":"translate-x-1"}`})})})]}),tt=_?je.mobile.center:je.center,We=_?je.mobile.zoom:je.zoom;return l.jsxs("div",{className:a,style:{position:"relative"},children:[_?l.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20",children:l.jsxs("div",{className:"bg-green-900/30 backdrop-blur-md shadow-2xl rounded-t-2xl text-white",children:[l.jsx(et,{onMinimize:D,isMobile:!0,isMinimized:w}),!w&&l.jsxs("div",{className:"p-4 flex flex-col gap-3 max-h-80 overflow-y-auto",children:[l.jsx(q,{id:"estado-sp",label:"Estado de So Paulo",checked:g,onChange:()=>m(!g),loading:h,error:f}),l.jsx(q,{id:"marcadores",label:"Escolas Indgenas",checked:y,onChange:()=>x(!y)}),l.jsx(q,{id:"terras-indigenas",label:"Terras Indgenas",checked:d,onChange:()=>u(!d),loading:o,error:n})]})]})}):l.jsxs("div",{className:"fixed top-20 left-4 w-72 bg-green-900/30 backdrop-blur-md rounded-2xl shadow-2xl z-20 overflow-hidden text-white",children:[l.jsx(et,{onMinimize:D,isMobile:!1,isMinimized:w}),!w&&l.jsxs("div",{className:"p-4 flex flex-col gap-3 max-h-96 overflow-y-auto",children:[l.jsx(q,{id:"estado-sp",label:"Estado de So Paulo",checked:g,onChange:()=>m(!g),loading:h,error:f}),l.jsx(q,{id:"marcadores",label:"Escolas Indgenas",checked:y,onChange:()=>x(!y)}),l.jsx(q,{id:"terras-indigenas",label:"Terras Indgenas",checked:d,onChange:()=>u(!d),loading:o,error:n})]})]}),l.jsxs("div",{className:"fixed top-4 left-4 z-30 flex flex-col sm:flex-row items-start sm:items-center gap-3 pointer-events-auto",children:[l.jsxs(Wn,{to:"/",className:"rounded-full bg-green-900/90 hover:bg-green-800 p-3 shadow-lg flex items-center justify-center cursor-pointer transition-all duration-200 backdrop-blur-md","aria-label":"Sair do mapa e voltar para a pgina inicial",title:"Sair do mapa",children:[l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[l.jsx("path",{d:"M16 17L21 12L16 7",stroke:"#CDE8CF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M21 12H9",stroke:"#CDE8CF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9",stroke:"#CDE8CF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.jsx("span",{className:"sr-only",children:"Sair do mapa"})]}),l.jsxs("button",{type:"button",onClick:()=>J(R=>R>=1.3?1:Math.round((R+.15)*100)/100),className:"rounded-full bg-green-900/90 hover:bg-green-800 p-3 shadow-lg flex items-center justify-center cursor-pointer transition-all duration-200 backdrop-blur-md","aria-label":"Ajustar tamanho do texto",title:`Tamanho do texto: ${Math.round(K*100)}% (clique para alterar)`,children:[l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.6117 5.00684C6.86862 5.02589 7.11696 5.11134 7.3324 5.25488C7.57862 5.41908 7.77125 5.65263 7.88514 5.92578L11.9232 15.6162C12.1352 16.1258 11.8947 16.7115 11.3851 16.9238C10.8755 17.1362 10.2901 16.8942 10.0775 16.3848L9.08338 14H3.91736L2.92322 16.3857C2.71049 16.8948 2.12502 17.1359 1.6156 16.9238C1.10605 16.7114 0.865522 16.1258 1.07752 15.6162L5.11658 5.92578L5.16248 5.8252C5.27895 5.59518 5.45376 5.39859 5.66932 5.25488L5.76307 5.19727C5.98766 5.07035 6.24213 5.00195 6.50135 5.00195L6.6117 5.00684ZM4.75135 12H8.25037L6.50037 7.80176L4.75135 12Z",fill:"#CDE8CF"}),l.jsx("path",{d:"M18.0209 6.00098C18.0385 6.00133 18.0561 6.00165 18.0736 6.00293C18.0913 6.00421 18.1089 6.00562 18.1263 6.00781C18.1434 6.00996 18.1602 6.01358 18.1771 6.0166C18.1869 6.01835 18.1968 6.01946 18.2064 6.02148C18.234 6.02726 18.2614 6.03388 18.2885 6.04199C18.2921 6.04309 18.2956 6.04476 18.2992 6.0459C18.317 6.05145 18.3344 6.05789 18.3519 6.06445C18.368 6.07049 18.3841 6.07618 18.3998 6.08301C18.5114 6.13159 18.6161 6.20168 18.7074 6.29297L22.7074 10.293C23.0977 10.6835 23.0979 11.3166 22.7074 11.707C22.3169 12.0975 21.6839 12.0973 21.2933 11.707L19.0004 9.41406V16C19.0004 16.5522 18.5526 16.9999 18.0004 17C17.4481 17 17.0004 16.5523 17.0004 16V9.41406L14.7074 11.707C14.3169 12.0975 13.6839 12.0973 13.2933 11.707C12.9028 11.3165 12.9028 10.6835 13.2933 10.293L17.2933 6.29297C17.3386 6.2477 17.3876 6.20587 17.4408 6.16992C17.4934 6.13439 17.5488 6.10452 17.6058 6.08008C17.6512 6.06059 17.6989 6.04587 17.7474 6.0332C17.7614 6.02955 17.7753 6.0255 17.7894 6.02246C17.8033 6.01948 17.8173 6.01704 17.8314 6.01465C17.847 6.01199 17.8626 6.00973 17.8783 6.00781C17.8961 6.00565 17.914 6.00415 17.932 6.00293C17.948 6.00184 17.9639 6.00131 17.9799 6.00098C17.9866 6.00084 17.9936 6 18.0004 6C18.0072 6 18.0141 6.00084 18.0209 6.00098Z",fill:"#CDE8CF"})]}),l.jsx("div",{className:"hidden lg:block ml-2 text-green-100 text-sm",children:"Tamanho do texto"})]}),l.jsxs("div",{className:"flex flex-row items-center gap-2",children:[l.jsx("button",{type:"button",onClick:()=>Ie(.5),className:"rounded-full bg-green-900/90 hover:bg-green-800 p-3 shadow-lg flex items-center justify-center cursor-pointer transition-all duration-200 backdrop-blur-md","aria-label":"Aproximar mapa",title:"Aproximar mapa",children:l.jsx("span",{className:"text-green-100 text-lg font-semibold leading-none",children:"+"})}),l.jsx("button",{type:"button",onClick:()=>Ie(-.5),className:"rounded-full bg-green-900/90 hover:bg-green-800 p-3 shadow-lg flex items-center justify-center cursor-pointer transition-all duration-200 backdrop-blur-md","aria-label":"Afastar mapa",title:"Afastar mapa",children:l.jsx("span",{className:"text-green-100 text-lg font-semibold leading-none",children:""})})]}),l.jsxs("div",{ref:G,className:"relative",children:[l.jsx(Fi,{children:b?l.jsx(dt.div,{initial:{opacity:0,scale:.8,width:0},animate:{opacity:1,scale:1,width:"auto"},exit:{opacity:0,scale:.8,width:0},transition:{duration:.3,ease:"easeInOut",opacity:{duration:.2},scale:{duration:.3}},className:"flex items-center bg-white rounded-lg shadow-lg overflow-hidden",children:l.jsxs("form",{onSubmit:Qe,className:"flex items-center",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsx("input",{ref:I,type:"text",placeholder:"Buscar escolas, povos, lnguas...",value:S,onChange:re,onKeyDown:qe,className:`w-64 pl-10 pr-12 py-2 border-0 rounded-l-lg 
                               focus:outline-none focus:ring-2 focus:ring-green-500
                               text-sm text-black`})]}),l.jsx(dt.button,{type:"button",onClick:()=>{C(!1),E("")},className:"px-3 py-2 text-gray-400 hover:text-gray-600 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.95},children:l.jsx(Ft,{className:"w-4 h-4"})})]})}):l.jsx(dt.button,{initial:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:()=>C(!0),className:"rounded-full bg-green-900/90 hover:bg-green-800 p-3 shadow-lg flex items-center justify-center cursor-pointer transition-all duration-200 backdrop-blur-md","aria-label":"Buscar escolas",title:"Buscar escolas",children:l.jsx(Di,{className:"w-5 h-5 text-green-100"})})}),l.jsx(Fi,{children:b&&H.length>0&&l.jsx(dt.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.25,ease:"easeOut",delay:.1},className:"absolute top-full mt-2 left-0 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-50",children:l.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:F?l.jsx(dt.div,{initial:{opacity:0},animate:{opacity:1},className:"p-4 text-center text-gray-500",children:l.jsx("p",{className:"mt-2 text-xs",children:"Buscando..."})}):l.jsx(dt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"space-y-1",children:H.slice(0,8).map((R,U)=>l.jsxs(dt.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1+U*.05},onClick:()=>Y(R),className:`w-full p-2 text-left hover:bg-gray-50 rounded transition-colors
                                   flex items-center gap-2 group`,whileHover:{x:5},children:[l.jsx("div",{className:"text-gray-400 group-hover:text-green-600 transition-colors flex-shrink-0",children:Q(R.type)}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 text-sm truncate",children:Be(R.title,S)}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:R.subtitle})]}),R.coordinates&&l.jsx(Vn,{className:"w-4 h-4 text-gray-300 group-hover:text-green-600 transition-colors flex-shrink-0"})]},R.id))})})})})]})]}),l.jsx(Wf,{dataPoints:y?e:[],onPainelOpen:t,className:"h-full w-full",center:tt,zoom:We,terrasIndigenasData:r,estadoSPData:c,showTerrasIndigenas:d,showEstadoSP:g,showMarcadores:y,onMapReady:de})]})},Yf=ee.memo(Kf),Zf=e=>{const t=()=>{const i=Lr(e?.titulo||""),r=window.location.pathname;let o;return r.includes("/mapa")?o=r.split("?")[0]:r.includes("/opin")?o="/opin/mapa":o="/mapa",`${window.location.origin}${o}?panel=${i}`};return{gerarLinkCustomizado:t,copiarLink:async()=>{const i=t();try{await navigator.clipboard.writeText(i),alert("Link copiado!")}catch{const o=document.createElement("input");o.value=i,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),alert("Link copiado!")}},compartilhar:()=>{const i=t(),r=`Confira este painel: ${e.titulo}`;navigator.share?navigator.share({title:e.titulo,text:r,url:i}):window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(r)}&url=${encodeURIComponent(i)}`,"_blank")}}},Jf=(e,t)=>{const s=p.useRef(null),a=p.useRef(null);p.useEffect(()=>{if(e)return a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{const i=t();if(i!==s.current)try{window.history.replaceState({},"",i),s.current=i}catch(r){console.warn("Erro ao atualizar URL:",r)}},300),()=>{a.current&&clearTimeout(a.current)}},[e,t])},Qf=(e,t)=>{p.useEffect(()=>{const s=a=>{const i=a.target;i.classList&&i.classList.contains("openlayers-container")||i.closest('button[aria-label="Fechar painel"]')||i.closest('button[aria-label*="Fechar"]')||i.closest('[aria-label="Fechar painel"]')||!e.current||e.current.contains(a.target)||t(a)};return document.addEventListener("mousedown",s),document.addEventListener("touchstart",s),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}},[e,t])},em=e=>{const[t,s]=p.useState([]),[a,i]=p.useState(!0),[r,o]=p.useState(null);return p.useEffect(()=>{(async()=>{if(console.log(" Iniciando busca de documentos para escola:",e,"tipo:",typeof e),!e){console.log(" Nenhum ID de escola fornecido, retornando array vazio"),s([]),i(!1);return}try{i(!0),console.log(" Consultando tabela documentos_escola...");const{data:c,error:h}=await fe.auth.getSession();console.log(" Estado da autenticao:",{temSessao:!!c?.session,error:h});const{error:f}=await fe.from("documentos_escola").select("count").limit(1);console.log(" Verificao de permisses:",{podeAcessar:!f,error:f?{code:f.code,message:f.message,details:f.details,hint:f.hint}:null});const{data:d,error:u}=await fe.from("documentos_escola").select("*");u?console.error(" Erro ao buscar todos os documentos:",{code:u.code,message:u.message,details:u.details,hint:u.hint}):(console.log(" Todos os documentos na tabela:",d),d&&d.length>0?(console.log(" Exemplo de documento:",d[0]),console.log(" Tipos de escola_id encontrados:",d.map(y=>({id:y.id,escola_id:y.escola_id,tipo_escola_id:typeof y.escola_id,valor_escola_id:y.escola_id})))):console.log(" Tabela est vazia ou no temos permisso para ver os dados")),console.log(" Buscando documentos para escola_id:",e);const{data:g,error:m}=await fe.from("documentos_escola").select("*").eq("escola_id",e.toString()).order("created_at",{ascending:!1});if(m)throw console.error(" Erro na consulta Supabase:",{code:m.code,message:m.message,details:m.details,hint:m.hint}),m;if(console.log(" Documentos encontrados:",g?.length||0),g?.length===0){console.log(" Nenhum documento encontrado para a escola ID:",e),console.log(" Tentando buscar com diferentes formatos de escola_id...");const{data:y,error:x}=await fe.from("documentos_escola").select("*").eq("escola_id",Number(e)),{data:_,error:w}=await fe.from("documentos_escola").select("*").eq("escola_id",String(e));console.log("Resultados com escola_id como nmero:",{count:y?.length||0,error:x}),console.log("Resultados com escola_id como string:",{count:_?.length||0,error:w})}else console.log(" Dados dos documentos:",g);s(g||[])}catch(c){console.error(" Erro ao buscar documentos:",c),o(c.message)}finally{i(!1)}})()},[e]),{documentos:t,isLoading:a,error:r}};p.memo(({label:e,value:t,icon:s,type:a="text",className:i=""})=>{if(!t&&t!==0)return null;const r=()=>{switch(a){case"number":return l.jsx("div",{className:"text-center",children:l.jsx("div",{className:"text-3xl font-medium text-gray-900 mb-1",children:t.toLocaleString("pt-BR")})});case"boolean":return l.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${t?"bg-gray-100 text-gray-900":"bg-gray-100 text-gray-600"}`,children:t?"Sim":"No"});case"badge":return l.jsx("div",{className:"flex flex-wrap gap-1",children:Array.isArray(t)?t.map((o,n)=>l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-900 text-xs rounded-full",children:o},n)):l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-900 text-xs rounded-full",children:t})});case"link":return l.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 hover:text-gray-700 underline text-sm",children:t});default:return l.jsx("div",{className:"text-sm text-gray-700 leading-relaxed",children:t})}};return l.jsxs("div",{className:`rounded-lg p-4 transition-all duration-200 ${i}`,children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s&&l.jsx(s,{className:"w-5 h-5 text-gray-700"}),l.jsx("span",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:e})]}),r()]})});const tm=p.memo(({children:e,columns:t="auto-fit",gap:s=4,className:a=""})=>{const i={"auto-fit":"grid-cols-2 lg:grid-cols-3",2:"grid-cols-2",3:"grid-cols-2 lg:grid-cols-3",4:"grid-cols-2 lg:grid-cols-4"};return l.jsx("div",{className:`grid ${i[t]} gap-${s} ${a} [&>*]:bg-gray-50`,children:e})}),sm=p.memo(({data:e,className:t=""})=>!e||e.length===0?null:l.jsx("div",{className:`bg-gray-50 rounded-lg overflow-hidden ${t}`,children:l.jsx("table",{className:"w-full",children:l.jsx("tbody",{children:e.map((s,a)=>l.jsxs("tr",{className:a%2===0?"bg-white":"bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:s.label}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:s.value})]},a))})})})),am=p.memo(({stats:e,className:t=""})=>!e||e.length===0?null:l.jsx("div",{className:`grid grid-cols-2 sm:grid-cols-4 gap-4 ${t} [&>*]:border-b [&>*]:border-gray-200 [&>*]:pb-2 [&>*]:mb-2`,children:e.map((s,a)=>l.jsxs("div",{className:"text-center rounded-lg p-4",children:[l.jsx("div",{className:"flex justify-center mb-2",children:s.icon&&l.jsx(s.icon,{className:"w-6 h-6 text-gray-700"})}),l.jsx("div",{className:"text-3xl font-medium text-gray-900 mb-1",children:s.value}),l.jsx("div",{className:"text-xs text-gray-600 mt-1",children:s.label})]},a))})),Wt=p.memo(({title:e,icon:t,children:s,description:a,defaultCollapsed:i=!1,className:r="",layout:o="default",layoutProps:n={}})=>{const[c,h]=p.useState(i),f=()=>{if(!s)return null;switch(o){case"grid":return l.jsx(tm,{...n,children:s});case"table":return l.jsx(sm,{data:n.data,className:n.className});case"stats":return l.jsx(am,{stats:n.stats,className:n.className});default:return l.jsx("div",{className:"space-y-4",children:s})}},d=e&&e.trim()!=="";return l.jsxs("section",{className:`
        ${r}
      `,children:[d&&l.jsxs("button",{onClick:()=>h(!c),className:`
            w-full flex items-center justify-between 
            text-base sm:text-lg font-semibold
            mb-4 sm:mb-5 text-gray-900 hover:text-gray-700 
            transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 rounded-md p-1 -m-1
          `,"aria-expanded":!c,"aria-controls":`${e}-content`,id:`${e}-button`,children:[l.jsxs("div",{className:"flex items-center gap-2.5 sm:gap-3",children:[t&&l.jsx(t,{className:"w-5 h-5 text-gray-700 flex-shrink-0"}),l.jsx("span",{className:"tracking-tight leading-tight",children:e})]}),l.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform duration-200 flex-shrink-0 ${c?"":"rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(!d||!c)&&l.jsxs("div",{id:d?`${e}-content`:void 0,className:"overflow-visible",role:d?"region":void 0,"aria-labelledby":d?`${e}-button`:void 0,children:[a&&l.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:l.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",style:{lineHeight:"1.7"},children:a})}),f()]})]})}),Re=p.memo(({icon:e,label:t,value:s,type:a="text",className:i="",iconColor:r="green",showIconCircle:o=!0,description:n=null,layout:c="vertical",category:h=null})=>{if(s==null||typeof s=="string"&&s.trim()==="")return null;const f=()=>{switch(a){case"number":const M=s||0;return l.jsx("div",{className:"text-center w-full flex items-center justify-center h-full min-w-0",children:l.jsx("div",{className:"text-3xl font-semibold text-gray-900 truncate",style:{fontSize:"1.875rem",fontWeight:"600",color:"#111827",lineHeight:"1.2"},title:String(M),children:M.toLocaleString("pt-BR")})});case"boolean":return s?l.jsxs("span",{className:"flex items-center gap-1.5 text-gray-900 text-sm font-semibold",children:[l.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Sim"]}):l.jsxs("span",{className:"flex items-center gap-1.5 text-gray-600 text-sm font-semibold",children:[l.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:l.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),"No"]});default:if(ee.isValidElement(s))return s;const b=String(s||""),C=b.length>30;return l.jsx("div",{className:`text-sm text-gray-800 ${C?"text-left":"text-center"} w-full font-medium leading-relaxed break-words px-2`,style:{lineHeight:"1.6"},children:b})}},d={green:{bg:"#F3F4F6",icon:"#111827"},teal:{bg:"#F3F4F6",icon:"#111827"},blue:{bg:"#F3F4F6",icon:"#111827"}},u=d[r]||d.green;if(c==="horizontal")return l.jsxs("div",{className:`
          rounded-xl p-4 
          overflow-visible
          card-container
          relative
          ${i}
        `,style:{border:"none",outline:"none",backgroundColor:"#D1FAE5"},children:[e&&l.jsx("div",{className:"absolute -top-3 -left-3 z-10",style:{transform:"translate(0, 0)"},children:o?l.jsx("div",{className:"rounded-full p-2 flex items-center justify-center",style:{backgroundColor:u.bg,width:"40px",height:"40px"},children:l.jsx(e,{className:"w-5 h-5",style:{color:u.icon}})}):l.jsx("div",{className:"bg-white rounded-full p-2 border-2 border-gray-200",children:l.jsx(e,{className:"w-5 h-5 text-gray-700"})})}),l.jsx("div",{className:"flex items-center relative z-20",children:l.jsxs("div",{className:"flex-1 min-w-0 relative z-20",children:[h&&l.jsx("div",{className:"text-xs font-semibold text-teal-600 uppercase tracking-wide mb-1.5 break-words relative z-20",style:{lineHeight:"1.5"},children:h}),l.jsx("h5",{className:`font-medium leading-relaxed break-words relative z-20 ${h?"text-base text-gray-700":"text-sm text-gray-700"}`,style:{lineHeight:"1.6"},children:h?a==="number"?l.jsx("span",{className:"text-lg font-semibold text-gray-700",children:s||"0"}):a==="boolean"?f():ee.isValidElement(s)?s:l.jsx("span",{className:"break-words",children:String(s||t)}):a==="number"?l.jsx("span",{className:"text-lg font-semibold text-gray-700",children:s||"0"}):a==="boolean"?f():ee.isValidElement(s)?s:l.jsx("span",{className:"break-words",children:String(s||t)})})]})}),n&&l.jsx("div",{className:"text-xs text-gray-700 leading-relaxed mt-2 pt-2 border-t border-gray-200 whitespace-pre-line break-words relative z-20",style:{lineHeight:"1.6"},children:n})]});const m=i.includes("h-[")||i.includes("h-auto")||i.includes("min-h-[")?"":"min-h-[120px]",w=(a==="text"||!a||a==="default")&&(s&&typeof s=="string")&&String(s).trim().length>20;return l.jsxs("div",{className:`
        rounded-xl p-3 
        ${m} flex flex-col
        overflow-visible
        card-container
        relative
        ${i}
      `,style:{border:"none",outline:"none",backgroundColor:"#D1FAE5"},children:[e&&l.jsx("div",{className:"absolute -top-3 -left-3 z-10",style:{transform:"translate(0, 0)"},children:o?l.jsx("div",{className:"rounded-full p-2 flex items-center justify-center",style:{backgroundColor:u.bg,width:"40px",height:"40px"},children:l.jsx(e,{className:"w-5 h-5",style:{color:u.icon}})}):l.jsx("div",{className:"bg-white rounded-full p-2 border-2 border-gray-200",children:l.jsx(e,{className:"w-5 h-5 text-gray-700"})})}),l.jsxs("div",{className:"flex flex-col relative z-20",children:[l.jsx("div",{className:"flex items-center justify-center mb-1 flex-shrink-0 relative z-20",children:l.jsx("div",{className:"text-xs text-gray-700 font-semibold leading-tight text-center uppercase tracking-wide break-words relative z-20",style:{lineHeight:"1.3"},children:t})}),l.jsx("div",{className:`${w?"flex-grow flex items-start justify-center":"flex-1 flex items-center justify-center"} relative z-20`,children:f()}),n&&l.jsx("div",{className:"text-xs text-gray-700 leading-relaxed mt-1 pt-1 break-words relative z-20",style:{lineHeight:"1.5"},children:n})]})]})});Re.displayName="NativeLandCard";const im=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():"",rm=({escola:e})=>{if(!(e.logradouro||e.bairro||e.cep))return l.jsx("div",{className:"p-2.5 bg-gray-50 border border-gray-200 rounded-md",children:l.jsx("p",{className:"text-sm text-gray-900 leading-relaxed break-words",style:{lineHeight:"1.6"},children:im(e.endereco)})});const s=[{field:"logradouro",label:"Logradouro"},{field:"bairro",label:"Bairro"}];return l.jsxs("div",{className:"space-y-2",children:[s.map(({field:a,label:i})=>e[a]&&l.jsxs("div",{className:"flex items-start gap-2.5 p-2.5 bg-gray-50 border border-gray-200 rounded-md",children:[l.jsx(Dt,{className:"w-5 h-5 text-gray-700 mt-0.5 flex-shrink-0","aria-hidden":"true"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-xs font-semibold text-gray-800 mb-1",children:i}),l.jsx("div",{className:"text-sm text-gray-900 leading-relaxed break-words",style:{lineHeight:"1.6"},children:e[a]})]})]},a)),(e.cep||e.estado)&&l.jsxs("div",{className:"flex items-start gap-2.5 p-2.5 bg-gray-50 border border-gray-200 rounded-md",children:[l.jsx(Dt,{className:"w-5 h-5 text-gray-700 mt-0.5 flex-shrink-0","aria-hidden":"true"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-xs font-semibold text-gray-800 mb-1",children:"Localizao"}),l.jsx("div",{className:"text-sm text-gray-900 leading-relaxed break-words",style:{lineHeight:"1.6"},children:[e.municipio,e.estado,e.cep].filter(Boolean).join(", ")})]})]})]})},nm=({escola:e})=>{if(!(e.Latitude&&e.Longitude))return null;const s=()=>{window.open(`https://www.google.com/maps?q=${e.Latitude},${e.Longitude}`,"_blank")};return l.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 p-2.5 bg-green-600 hover:bg-green-700 active:bg-green-800 text-white rounded-md transition-colors text-sm font-semibold mt-3 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:[l.jsx(Tl,{className:"w-5 h-5","aria-hidden":"true"}),"Ver no Google Maps"]})},om=({links:e,expanded:t,onToggle:s})=>{const a=(e||"").split(",").map(i=>i.trim()).filter(Boolean);return a.length===0?null:l.jsxs("div",{className:"bg-gray-100 rounded-md",children:[l.jsxs("button",{onClick:()=>s("social"),className:"w-full flex justify-between items-center p-2.5 hover:bg-gray-100 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-1 rounded-md","aria-expanded":t.social,children:[l.jsxs("span",{className:"flex items-center gap-2 text-gray-800 font-semibold",children:[l.jsx(Yr,{className:"w-5 h-5 text-blue-600","aria-hidden":"true"}),"Redes sociais (",a.length,")"]}),l.jsx(xs,{className:`w-5 h-5 text-gray-500 transition-transform ${t.social?"rotate-90":""}`,"aria-hidden":"true"})]}),t.social&&l.jsx("div",{className:"px-3 pb-3 border-t border-gray-200 bg-white",children:l.jsx("div",{className:"mt-2 space-y-2",children:a.map((i,r)=>l.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md hover:bg-gray-100 group text-sm transition-colors",children:[l.jsx(Ml,{className:"w-5 h-5 text-blue-600 flex-shrink-0","aria-hidden":"true"}),l.jsx("span",{className:"truncate flex-1 text-gray-700 font-medium",children:i}),l.jsx(yl,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 flex-shrink-0","aria-hidden":"true"})]},r))})})]})},lm=p.memo(({escola:e})=>{const[t,s]=p.useState({});if(!e)return null;const a=h=>{s(f=>({...f,[h]:!f[h]}))},i=h=>h==null||typeof h=="string"&&h.trim()===""||typeof h=="number"&&isNaN(h)?!0:(typeof h=="number"||typeof h=="boolean"||ee.isValidElement(h),!1),r=h=>{if(!h||ee.isValidElement(h))return!1;if(typeof h=="string"){const f=h.trim();return f.length>30||f.includes(",")&&f.length>20}return!1},o=h=>h===0||h===1?"grid-cols-1":h===2?"grid-cols-2":"grid-cols-3 lg:grid-cols-3",c=[...[{icon:xa,label:"Municpio",value:e.municipio},{icon:ol,label:"Fundao",value:e.ano_criacao,type:"number"},{icon:Yr,label:"Redes sociais",value:e.usa_redes_sociais,type:"boolean"}].filter(h=>!i(h.value))];return e.diretoria_ensino&&!i(e.diretoria_ensino)&&c.push({icon:xa,label:"Diretoria de ensino",value:e.diretoria_ensino}),l.jsxs(l.Fragment,{children:[e.povos_indigenas&&l.jsx("div",{className:"mb-4",children:l.jsxs("div",{className:"text-lg sm:text-xl font-bold text-gray-900 leading-tight",children:["Povos Indgenas: ",l.jsx("span",{className:"font-semibold text-gray-900",children:e.povos_indigenas})]})}),l.jsxs(Wt,{children:[(()=>{const h=c.filter(d=>r(d.value)),f=c.filter(d=>!r(d.value));return l.jsxs(l.Fragment,{children:[h.length>0&&l.jsx("div",{className:"space-y-3 mb-3",children:h.map((d,u)=>l.jsx(Re,{...d,showIconCircle:!0},`long-${u}`))}),f.length>0&&l.jsx("div",{className:`grid ${o(f.length)} gap-3 ${h.length>0,"mb-3"} items-stretch overflow-visible`,children:f.map((d,u)=>l.jsx(Re,{...d,showIconCircle:!0},`normal-${u}`))})]})})(),l.jsxs("div",{className:"space-y-1.5",children:[e.endereco&&l.jsxs("div",{className:"bg-gray-100 rounded-md",children:[l.jsxs("button",{onClick:()=>a("endereco"),className:"w-full flex justify-between items-center p-2.5 hover:bg-gray-100 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-1 rounded-md","aria-expanded":t.endereco,children:[l.jsxs("span",{className:"flex items-center gap-2 text-gray-800 font-semibold",children:[l.jsx(xa,{className:"w-5 h-5 text-gray-700","aria-hidden":"true"}),"Endereo"]}),l.jsx(xs,{className:`w-5 h-5 text-gray-500 transition-transform ${t.endereco?"rotate-90":""}`,"aria-hidden":"true"})]}),t.endereco&&l.jsxs("div",{className:"px-3 pb-3 border-t border-gray-200 bg-white",children:[l.jsx(rm,{escola:e}),l.jsx(nm,{escola:e})]})]}),l.jsx(om,{links:e.links_redes_sociais,expanded:t,onToggle:a})]})]})]})}),cm=({htmlContent:e})=>{const t=e?e.replace(/Aborda\./g,"").trim():"";return l.jsx("div",{className:`historia-escola-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none
        prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify
        prose-img:rounded-xl prose-img:shadow-lg
        prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600
        prose-strong:text-green-800 prose-em:text-green-700
        prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg
        prose-ul:text-black prose-ol:text-black prose-li:text-black
        prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm`,dangerouslySetInnerHTML:{__html:t}})},hm=()=>l.jsx("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"bg-green-200 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:l.jsx("img",{src:"/opin//onca.svg",alt:"cone de ona",className:"w-18 h-18 sm:w-36 sm:h-36",style:{filter:"none",borderRadius:"0",boxShadow:"none",margin:"0",padding:"0",border:"none",outline:"none",transform:"translateY(17px)"},"aria-hidden":"true"})}),l.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-black m-0",children:"Histria da Escola"})]})}),dm=p.memo(({escola:e,refreshKey:t=0,isMaximized:s=!1})=>{if(!e?.historia_da_escola)return null;const a=e.historia_da_escola;return l.jsxs("div",{className:"mt-8 mb-12 flex flex-col items-center w-full",children:[l.jsxs("header",{className:"historia-escola-header mb-6 sm:mb-8 w-full max-w-4xl mx-auto",children:[l.jsx(hm,{}),l.jsx("div",{className:"h-1 w-20 sm:w-24 bg-green-300 rounded-full"})]}),l.jsx("article",{className:`
          prose prose-sm sm:prose-base md:prose-lg lg:prose-xl
          prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify
          prose-img:rounded-xl prose-img:shadow-lg
          prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600
          max-w-3xl mx-auto w-full
        `,style:{maxWidth:"65ch"},children:l.jsx(cm,{htmlContent:a})})]})}),mt=p.memo(({value:e})=>e==null?null:l.jsx("span",{className:`font-medium text-center w-full block ${e?"text-gray-900":"text-gray-500"}`,children:e?"Sim":"No"}));function um(e){return!e||typeof e!="string"?[]:e.split(`
`).flatMap(t=>t.includes("")?t.split("").map(s=>s.trim()).filter(Boolean):t.trim()?[t.trim()]:[]).filter(Boolean)}const fm=({items:e})=>!e||e.length===0?null:l.jsx("div",{className:"text-sm text-gray-800 text-left w-full font-medium leading-relaxed break-words px-2",children:l.jsx("ul",{className:"list-none pl-0 ml-0 space-y-1.5",children:e.map((t,s)=>l.jsxs("li",{className:"leading-relaxed m-0 p-0 pl-0 ml-0 flex items-start",style:{lineHeight:"1.7"},children:[l.jsx("span",{className:"mr-2 text-gray-900 select-none font-bold flex-shrink-0",style:{minWidth:"0.75em",display:"inline-block"},"aria-hidden":"true",children:""}),l.jsx("span",{className:"flex-1",children:t})]},s))})}),mm=e=>e==null||typeof e=="string"&&e.trim()===""||typeof e=="number"&&isNaN(e)?!0:(typeof e=="number"||typeof e=="boolean"||ee.isValidElement(e),!1),ur=e=>{if(!e||ee.isValidElement(e))return!1;if(typeof e=="string"){const t=e.trim();return t.length>30||t.includes(",")&&t.length>20}return!1},gm=e=>e===0||e===1?"grid-cols-1":e===2?"grid-cols-2":"grid-cols-3 lg:grid-cols-3",pm=p.memo(({escola:e})=>{if(!e)return null;const t=e.turnos_funcionamento||e.turnos_funcionamento||"",s=um(e.modalidade_ensino),a=[t&&{icon:ul,label:"Turnos de Funcionamento",value:t},{icon:Tr,label:"Nmero de Alunos",value:e.numero_alunos||"0",type:"number"},{icon:si,label:"Lnguas Faladas",value:e.linguas_faladas},{icon:Ds,label:"Material Pedaggico No Indgena",value:l.jsx(mt,{value:e.material_nao_indigena})},{icon:Ds,label:"Material Pedaggico Indgena",value:l.jsx(mt,{value:e.material_indigena})},{icon:Ds,label:"PPP com Comunidade",value:l.jsx(mt,{value:e.ppp_comunidade})}].filter(Boolean).filter(i=>!mm(i.value));return a.length===0&&s.length===0?null:l.jsx(l.Fragment,{children:l.jsxs(Wt,{children:[s.length>0&&l.jsx("div",{className:"mb-3",children:l.jsx(Re,{icon:zl,label:"Modalidade de Ensino",value:l.jsx(fm,{items:s}),showIconCircle:!0})}),a.length>0&&(()=>{const i=a.filter(o=>ur(o.value)),r=a.filter(o=>!ur(o.value));return l.jsxs(l.Fragment,{children:[i.length>0&&l.jsx("div",{className:`space-y-3 ${s.length>0,"mb-3"}`,children:i.map((o,n)=>l.jsx(Re,{icon:o.icon,label:o.label,value:o.value,type:o.type,showIconCircle:!0},`long-${n}`))}),r.length>0&&l.jsx("div",{className:`grid ${gm(r.length)} gap-3 ${i.length>0||s.length>0,""} items-stretch overflow-visible`,children:r.map((o,n)=>l.jsx(Re,{icon:o.icon,label:o.label,value:o.value,type:o.type,showIconCircle:!0},`normal-${n}`))})]})})()]})})}),fr=e=>e==null||typeof e=="string"&&e.trim()===""||typeof e=="number"&&isNaN(e)?!0:(typeof e=="number"||typeof e=="boolean"||ee.isValidElement(e),!1),mr=e=>{if(!e||ee.isValidElement(e))return!1;if(typeof e=="string"){const t=e.trim();return t.length>30||t.includes(",")&&t.length>20}return!1},xm=e=>e===0||e===1?"grid-cols-1":e===2?"grid-cols-2":"grid-cols-3 lg:grid-cols-3",ym=p.memo(({escola:e})=>{if(!e)return null;const t=[];e.espaco_escolar&&!fr(e.espaco_escolar)&&t.push({icon:el,label:"Espao Escolar e Estrutura",value:e.espaco_escolar});const s=[{icon:pl,label:"Acesso  gua",value:e.acesso_agua},{icon:Zo,label:"Coleta de Lixo",value:e.coleta_lixo},{icon:ec,label:"Acesso  Internet",value:l.jsx(mt,{value:e.acesso_internet})},{icon:Il,label:"Equipamentos Tecnolgicos",value:e.equipamentos},{icon:Dt,label:"Modo de Acesso  Escola",value:e.modo_acesso},{icon:Jl,label:"Cozinha",value:l.jsx(mt,{value:e.cozinha})},{icon:il,label:"Merenda Escolar",value:l.jsx(mt,{value:e.merenda_escolar})},{icon:cl,label:"Merenda Diferenciada",value:l.jsx(mt,{value:e.diferenciada})}].filter(o=>!fr(o.value)),a=[...t,...s];if(a.length===0)return null;const i=a.filter(o=>mr(o.value)),r=a.filter(o=>!mr(o.value));return l.jsxs(Wt,{children:[i.length>0&&l.jsx("div",{className:"space-y-3 mb-3",children:i.map((o,n)=>l.jsx(Re,{icon:o.icon,label:o.label,value:o.value,showIconCircle:!0},`long-${n}`))}),r.length>0&&l.jsx("div",{className:`grid ${xm(r.length)} gap-3 ${i.length>0,""} items-stretch overflow-visible`,children:r.map((o,n)=>l.jsx(Re,{icon:o.icon,label:o.label,value:o.value,showIconCircle:!0},`normal-${n}`))})]})}),vm=e=>{if(!e)return null;const[t,...s]=e.split("/"),a=s.join("/").trim();return{status:t.trim().toLowerCase()==="sim"?"Sim":t.trim(),descricao:a||null}},_m=e=>{if(!e)return null;const[t,...s]=e.split("/"),a=s.join("/").trim();return{status:t.trim().toLowerCase()==="sim"?"Sim":t.trim(),descricao:a||null}},Sa=e=>{const t=String(e).trim().toLowerCase();return t==="sim"?l.jsxs("div",{className:"flex items-center gap-1 text-gray-900",children:[l.jsx(Xr,{className:"w-5 h-5"}),"Sim"]}):t==="no"||t==="nao"?l.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[l.jsx(Ft,{className:"w-5 h-5"}),"No"]}):e},Jt=e=>e==null||typeof e=="string"&&e.trim()===""||typeof e=="number"&&isNaN(e)?!0:(typeof e=="number"||typeof e=="boolean"||ee.isValidElement(e),!1),gr=e=>{if(!e||ee.isValidElement(e))return!1;if(typeof e=="string"){const t=e.trim();return t.length>30||t.includes(",")&&t.length>20}return!1},bm=e=>e===0||e===1?"grid-cols-1":e===2?"grid-cols-2":"grid-cols-3 lg:grid-cols-3",wm=p.memo(({escola:e})=>{if(!e)return null;const t=vm(e.formacao_professores),s=_m(e.formacao_continuada),a=[!Jt(e.professores_indigenas)&&{icon:Wl,label:"Professores Indgenas",value:e.professores_indigenas,type:"number"},!Jt(e.professores_nao_indigenas)&&{icon:Xl,label:"Professores No Indgenas",value:e.professores_nao_indigenas,type:"number"},!Jt(e.professores_falam_lingua)&&{icon:si,label:"Professores que falam lngua indgena",value:Sa(e.professores_falam_lingua)}].filter(Boolean);return l.jsxs(Wt,{children:[(()=>{const i=a.filter(o=>gr(o.value)),r=a.filter(o=>!gr(o.value));return l.jsxs(l.Fragment,{children:[i.length>0&&l.jsx("div",{className:"space-y-3 mb-3",children:i.map((o,n)=>l.jsx(Re,{icon:o.icon,label:o.label,value:o.value,type:o.type,showIconCircle:!0},`long-${n}`))}),r.length>0&&l.jsx("div",{className:`grid ${bm(r.length)} gap-3 ${i.length>0,"mb-3"} items-stretch overflow-visible`,children:r.map((o,n)=>l.jsx(Re,{icon:o.icon,label:o.label,value:o.value,type:o.type,showIconCircle:!0},`normal-${n}`))})]})})(),(()=>{const i=[t?.status&&{icon:Ul,label:"Formao dos Professores",value:Sa(t.status),description:t.descricao,className:"h-auto min-h-[140px]"},!Jt(e.gestao)&&{icon:Vr,label:"Tem vice-diretor; COE?",value:e.gestao},!Jt(e.outros_funcionarios)&&{icon:Yl,label:"Outros Funcionrios",value:e.outros_funcionarios},s?.status&&{icon:Rl,label:"Visitas de Supervisores e Formao Continuada",value:Sa(s.status),description:s.descricao,className:"h-auto min-h-[140px]"}].filter(Boolean);return i.length===0?null:l.jsx("div",{className:"space-y-3 mt-3",children:i.map((r,o)=>l.jsx(Re,{icon:r.icon,label:r.label,value:r.value,description:r.description,showIconCircle:!0,className:r.className||""},`additional-${o}`))})})()]})}),Mm=p.memo(({escola:e})=>{if(!e)return null;const s=[{field:"parcerias_universidades",icon:tl,label:"Parcerias com universidades"}].filter(a=>e[a.field]&&e[a.field].trim());return s.length===0?null:l.jsx(Wt,{children:l.jsx("div",{className:"grid grid-cols-1 gap-3 items-stretch overflow-visible",children:s.map(a=>{const i=e[a.field],r=i?.trim().toLowerCase()==="no";return l.jsx("div",{className:"relative",children:l.jsx(Re,{icon:a.icon,label:a.label,value:r?"No":i,layout:"vertical",showIconCircle:!0,className:"h-auto"})},a.field)})})})}),xi=({images:e=[],currentImageIndex:t=0,isOpen:s=!1,onClose:a,onImageChange:i,showNavigation:r=!0,showControls:o=!0,showCounter:n=!0,showCaption:c=!0})=>{const[h,f]=p.useState(1),[d,u]=p.useState(0),[g,m]=p.useState(t);p.useEffect(()=>{f(1),u(0),m(t)},[t,s]);const y=e[g],x=p.useCallback(()=>{f(1),u(0),a()},[a]),_=()=>{f(1),u(0)},w=p.useCallback(()=>{if(g<e.length-1){const b=g+1;m(b),i&&i(b)}},[g,e.length,i]),M=p.useCallback(()=>{if(g>0){const b=g-1;m(b),i&&i(b)}},[g,i]);return p.useEffect(()=>{const b=C=>{C.key==="Escape"&&x()};if(s)return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[s,x]),p.useEffect(()=>{const b=C=>{if(s)switch(C.key){case"ArrowLeft":C.preventDefault(),M();break;case"ArrowRight":C.preventDefault(),w();break;case"r":case"R":C.preventDefault(),u(S=>(S+90)%360);break;case"+":case"=":C.preventDefault(),f(S=>Math.min(S+.25,3));break;case"-":C.preventDefault(),f(S=>Math.max(S-.25,.5));break;case"0":C.preventDefault(),_();break}};if(s)return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[s,g,e.length,w,M]),!s||!y?null:l.jsxs("div",{className:"image-zoom-modal",onClick:x,children:[l.jsx("button",{onClick:x,className:"image-zoom-close","aria-label":"Fechar",children:l.jsx(Ft,{size:24})}),o&&l.jsxs("div",{className:"image-zoom-controls",children:[l.jsx("button",{onClick:b=>{b.stopPropagation(),f(C=>Math.min(C+.25,3))},className:"image-zoom-control-button","aria-label":"Aumentar zoom",children:l.jsx(sc,{size:20})}),l.jsx("button",{onClick:b=>{b.stopPropagation(),f(C=>Math.max(C-.25,.5))},className:"image-zoom-control-button","aria-label":"Diminuir zoom",children:l.jsx(ic,{size:20})}),l.jsx("button",{onClick:b=>{b.stopPropagation(),u(C=>(C+90)%360)},className:"image-zoom-control-button","aria-label":"Rotacionar",children:l.jsx(Fl,{size:20})}),l.jsx("button",{onClick:b=>{b.stopPropagation(),_()},className:"image-zoom-control-button text-xs px-3","aria-label":"Resetar",children:"Reset"})]}),r&&e.length>1&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:b=>{b.stopPropagation(),M()},className:"image-zoom-navigation prev",disabled:g===0,"aria-label":"Imagem anterior",children:l.jsx(ti,{size:24})}),l.jsx("button",{onClick:b=>{b.stopPropagation(),w()},className:"image-zoom-navigation next",disabled:g===e.length-1,"aria-label":"Prxima imagem",children:l.jsx(xs,{size:24})})]}),n&&e.length>1&&l.jsxs("div",{className:"image-zoom-counter",children:[g+1," / ",e.length]}),l.jsxs("div",{className:"image-zoom-container",children:[l.jsx("div",{className:"image-zoom-image-wrapper",children:l.jsx("img",{src:y.url||y.publicURL||y.imagem_public_url,alt:y.descricao||y.descricao_imagem||"Imagem",className:"image-zoom-image",style:{transform:`scale(${h}) rotate(${d}deg)`,cursor:"grab"},onClick:b=>b.stopPropagation(),onMouseDown:b=>{b.preventDefault()}})}),c&&(y.descricao||y.descricao_imagem)&&l.jsxs("div",{className:"image-zoom-caption",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:y.descricao||y.descricao_imagem}),l.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[y.categoria&&l.jsx("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded text-gray-800",children:y.categoria}),y.autor&&l.jsxs("span",{children:["Fotgrafo: ",y.autor]}),y.dataFoto&&l.jsxs("span",{children:["Data: ",na(y.dataFoto)]})]}),y.descricaoDetalhada&&l.jsx("p",{className:"text-gray-600 leading-relaxed",children:y.descricaoDetalhada})]})]}),l.jsx("div",{className:"image-zoom-instructions",children:l.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[l.jsx("div",{children:"ESC: Fechar |  : Navegar | R: Rotacionar"}),l.jsx("div",{children:"+ -: Zoom | 0: Reset"})]})})]})};xi.propTypes={images:j.arrayOf(j.shape({url:j.string,publicURL:j.string,imagem_public_url:j.string,descricao:j.string,descricao_imagem:j.string,categoria:j.string,autor:j.string,dataFoto:j.string,descricaoDetalhada:j.string})).isRequired,currentImageIndex:j.number,isOpen:j.bool.isRequired,onClose:j.func.isRequired,onImageChange:j.func,showNavigation:j.bool,showControls:j.bool,showCounter:j.bool,showCaption:j.bool};const Ms=({src:e,alt:t,className:s="",isPreloaded:a=!1,placeholder:i=null,onLoad:r,onError:o,...n})=>{const[c,h]=p.useState(!1),[f,d]=p.useState(!1),[u,g]=p.useState(!1);p.useEffect(()=>{a&&(h(!0),g(!0))},[a]);const m=()=>{h(!0),d(!1),g(!0),r&&r()},y=()=>{d(!0),h(!1),o&&o()};return f?i||null:l.jsxs("div",{className:`relative overflow-hidden ${s}`,children:[!c&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:l.jsx("div",{className:"flex flex-col items-center space-y-2",children:l.jsx("div",{className:"text-xs text-gray-500",children:"Carregando..."})})}),l.jsx("img",{src:e,alt:t,className:`w-full h-full object-cover transition-all duration-500 ease-out ${u?"opacity-100 scale-100":"opacity-0 scale-105"}`,onLoad:m,onError:y,...n})]})};Ms.propTypes={src:j.string.isRequired,alt:j.string.isRequired,className:j.string,isPreloaded:j.bool,placeholder:j.node,onLoad:j.func,onError:j.func};const Es=(e,t=!0)=>{const[s,a]=p.useState(new Map),[i,r]=p.useState(!1),o=p.useRef(null),n=d=>new Promise((u,g)=>{const m=new Image;m.onload=()=>u(d),m.onerror=()=>g(new Error(`Failed to load image: ${d}`)),m.src=d}),c=async d=>{const u=d.map(m=>n(m).catch(y=>null));return(await Promise.all(u)).filter(Boolean)},h=async()=>{if(!(!e||!t)){r(!0);try{const{data:d}=await fe.storage.from("imagens-das-escolas").list(`${e}/`),{data:u}=await fe.storage.from("imagens-professores").list(`${e}/`),g=[];if(d&&d.length>0&&d.forEach(m=>{const{data:{publicUrl:y}}=fe.storage.from("imagens-das-escolas").getPublicUrl(`${e}/${m.name}`);g.push(y)}),u&&u.length>0&&u.forEach(m=>{const{data:{publicUrl:y}}=fe.storage.from("imagens-professores").getPublicUrl(`${e}/${m.name}`);g.push(y)}),_e.debug(` Preload: ${g.length} imagens encontradas`),g.length>0){const y=[];for(let _=0;_<g.length;_+=5)y.push(g.slice(_,_+5));for(let _=0;_<y.length;_++){const w=y[_];_e.debug(` Preload lote ${_+1}/${y.length}: ${w.length} imagens`),await c(w),_<y.length-1&&await new Promise(M=>setTimeout(M,200))}const x=new Map;g.forEach(_=>{x.set(_,!0)}),a(x),_e.debug(" Preload concludo:",g.length,"imagens")}}catch(d){_e.error(" Erro durante preload:",d)}finally{r(!1)}}};return p.useEffect(()=>{if(!(!e||!t))return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{h()},500),()=>{o.current&&clearTimeout(o.current)}},[e,t]),{isPreloading:i,preloadedImages:s,isImagePreloaded:d=>s.has(d),startPreload:h}},Cn=({escola_id:e,refreshKey:t=0,isMaximized:s=!1,hideInlineMedia:a=!1})=>{const[i,r]=p.useState([]),[o,n]=p.useState(!0),[c,h]=p.useState(null),[f,d]=p.useState(null),[u,g]=p.useState(0),{isImagePreloaded:m}=Es(e,!0),y=p.useCallback(()=>{d(null),g(0)},[]);return p.useEffect(()=>{t>0&&(console.log("ImagemHistoriadoProfessor: refreshKey mudou, forando recarga"),r([]),n(!0),h(null))},[t]),p.useEffect(()=>{e&&(n(!0),h(null),fe.storage.from("imagens-professores").list(`${e}/`).then(async({data:x,error:_})=>{if(_){h(_.message),n(!1);return}if(x&&x.length>0){console.log("Arquivos de professores encontrados:",x.length);const w=await Promise.all(x.map(async(M,b)=>{const{data:{publicUrl:C}}=fe.storage.from("imagens-professores").getPublicUrl(`${e}/${M.name}`);let S="professor";M.name.startsWith("professora_")?S="professora":M.name.startsWith("professor_")&&(S="professor");let E=null;try{const I=`${e}/${M.name}`;console.log("Buscando legenda para professor:",I),E=await ei(I,e,{categoria:"professor",tipo_foto:"professor"}),console.log("Legenda encontrada:",E)}catch(I){console.warn("Erro ao buscar legenda:",I)}const G=E?.legenda||null;return{id:b+1,publicURL:C,genero:S,nome:M.name,created_at:M.created_at||"",legenda:G,descricao:G,descricaoDetalhada:E?.descricao_detalhada,autor:E?.autor_foto,dataFoto:E?.data_foto,categoria:E?.categoria}}));r(w)}else r([]);n(!1)}).catch(x=>{h(`Erro inesperado: ${x.message}`),n(!1)}))},[e]),o?l.jsx("div",{className:"text-gray-500",children:"Carregando imagens do professor..."}):c?l.jsxs("div",{className:"text-red-600",children:["Erro ao carregar imagens: ",c]}):!i.length||a?null:l.jsxs("section",{className:"my-6",children:[l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:i.map((x,_)=>l.jsxs("figure",{className:"rounded-lg overflow-hidden bg-white shadow-sm flex flex-col cursor-pointer",onClick:()=>{x.publicURL&&(g(_),d(x))},children:[l.jsx("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:l.jsx(Ms,{src:x.publicURL,alt:x.legenda,className:"w-full h-full object-cover object-center",isPreloaded:m(x.publicURL),style:{maxHeight:"350px"}})}),x.legenda&&l.jsxs("figcaption",{className:"p-3 bg-white",children:[l.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:x.legenda}),l.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[x.categoria&&l.jsx("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:x.categoria}),x.autor&&l.jsxs("span",{children:["Por: ",x.autor]}),x.dataFoto&&l.jsx("span",{children:na(x.dataFoto)})]}),x.descricaoDetalhada&&l.jsx("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:x.descricaoDetalhada})]})]},x.id))}),l.jsx(xi,{images:i,currentImageIndex:u,isOpen:!!f,onClose:y,onImageChange:g,showNavigation:!0,showControls:!0,showCounter:!0,showCaption:!0})]})};Cn.propTypes={escola_id:j.oneOfType([j.string,j.number]).isRequired,refreshKey:j.number,hideInlineMedia:j.bool};const Em=ee.memo(Cn),Nn=({src:e,alt:t,name:s,size:a="medium",customSize:i,shape:r="circle",variant:o="default",loading:n=!1,error:c=!1,clickable:h=!1,className:f="",borderColor:d="border-green-200",backgroundColor:u="bg-gray-100",textColor:g="text-gray-600",badge:m,badgePosition:y="bottom-right",badgeColor:x="bg-green-500",badgeSize:_="small",onClick:w,onError:M,onLoad:b,fallbackIcon:C="user",showInitials:S=!0,maxInitials:E=2,lazy:G=!0,priority:I=!1,...H})=>{const[F,T]=p.useState(!1),[D,K]=p.useState(!!e),J=p.useMemo(()=>{if(i)return{container:"w-full h-full",text:"text-sm",icon:"w-6 h-6",badge:"w-3 h-3",customSize:i};const q={xs:{container:"w-6 h-6",text:"text-xs",icon:"w-3 h-3",badge:"w-2 h-2"},small:{container:"w-8 h-8",text:"text-xs",icon:"w-4 h-4",badge:"w-2 h-2"},medium:{container:"w-12 h-12 sm:w-16 sm:h-16",text:"text-sm sm:text-base",icon:"w-6 h-6 sm:w-8 sm:h-8",badge:"w-3 h-3"},large:{container:"w-16 h-16 sm:w-20 sm:h-20",text:"text-base sm:text-lg",icon:"w-8 h-8 sm:w-10 sm:h-10",badge:"w-4 h-4"},xlarge:{container:"w-20 h-20 sm:w-24 sm:h-24",text:"text-lg sm:text-xl",icon:"w-10 h-10 sm:w-12 sm:h-12",badge:"w-5 h-5"},xxlarge:{container:"w-24 h-24 sm:w-32 sm:h-32",text:"text-xl sm:text-2xl",icon:"w-12 h-12 sm:w-16 sm:h-16",badge:"w-6 h-6"}};return q[a]||q.medium},[a,i]),z=p.useMemo(()=>{const q={circle:"rounded-full",square:"rounded-lg",rounded:"rounded-xl",none:"rounded-none"};return q[r]||q.circle},[r]),oe=p.useMemo(()=>{const q={default:{border:"border-2",shadow:"shadow-md",hover:"hover:shadow-lg"},minimal:{border:"border",shadow:"shadow-sm",hover:"hover:shadow-md"},flat:{border:"border-2",shadow:"shadow-none",hover:"hover:shadow-sm"},elevated:{border:"border-2",shadow:"shadow-lg",hover:"hover:shadow-xl"}};return q[o]||q.default},[o]),de=p.useMemo(()=>{const q={"top-left":"top-0 left-0","top-right":"top-0 right-0","bottom-left":"bottom-0 left-0","bottom-right":"bottom-0 right-0",center:"top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},tt={small:"w-3 h-3",medium:"w-4 h-4",large:"w-5 h-5"};return{position:q[y]||q["bottom-right"],size:tt[_]||tt.small}},[y,_]),Ie=p.useMemo(()=>!s||!S?"":s.trim().split(" ").slice(0,E).map(We=>We.charAt(0).toUpperCase()).filter(We=>We.match(/[A-Z]/)).join(""),[s,S,E]),Je=p.useMemo(()=>{const q={user:Vr,alert:zi,loading:Sl};return q[C]||q.user},[C]),Y=()=>{K(!1),T(!1),b?.()},Qe=()=>{K(!1),T(!0),M?.()},re=q=>{(h||w)&&w?.(q)},qe=e&&!F&&!n,Q=!qe&&Ie&&!c,Be=!qe&&!Q&&!c,et=`
    ${J.container}
    ${z}
    ${oe.border}
    ${d}
    ${oe.shadow}
    ${h||w?"cursor-pointer":""}
    ${oe.hover}
    transition-all duration-200
    relative overflow-hidden
    flex items-center justify-center
    ${f}
  `.trim().replace(/\s+/g," ");return l.jsxs("div",{className:et,style:i?{width:i,height:i}:void 0,onClick:re,role:h||w?"button":void 0,tabIndex:h||w?0:void 0,...H,children:[n&&l.jsx("div",{className:`absolute inset-0 ${u} flex items-center justify-center`,children:l.jsx("span",{className:"text-xs text-green-600",children:"Carregando..."})}),qe&&l.jsx("img",{src:e,alt:t||`Avatar de ${s}`||"Avatar",className:`w-full h-full object-cover ${D?"opacity-0":"opacity-100"} transition-opacity duration-200`,onLoad:Y,onError:Qe,loading:G?"lazy":"eager",...I&&{fetchpriority:"high"}}),D&&qe&&l.jsx("div",{className:`absolute inset-0 ${u} flex items-center justify-center`,children:l.jsx("span",{className:"text-xs text-green-600",children:"Carregando..."})}),Q&&l.jsx("span",{className:`${J.text} font-semibold ${g}`,children:Ie}),Be&&l.jsx(Je,{className:`${J.icon} ${g}`}),c&&l.jsx("div",{className:`absolute inset-0 ${u} flex items-center justify-center`,children:l.jsx(zi,{className:`${J.icon} text-red-500`})}),m&&l.jsx("div",{className:`absolute ${de.position} ${de.size} ${x} rounded-full border-2 border-white`,children:typeof m=="string"?l.jsx("span",{className:"text-xs text-white font-bold flex items-center justify-center h-full",children:m}):m})]})};Nn.propTypes={src:j.string,alt:j.string,name:j.string,size:j.oneOf(["xs","small","medium","large","xlarge","xxlarge"]),customSize:j.string,shape:j.oneOf(["circle","square","rounded","none"]),variant:j.oneOf(["default","minimal","flat","elevated"]),loading:j.bool,error:j.bool,clickable:j.bool,className:j.string,borderColor:j.string,backgroundColor:j.string,textColor:j.string,badge:j.oneOfType([j.string,j.node]),badgePosition:j.oneOf(["top-left","top-right","bottom-left","bottom-right","center"]),badgeColor:j.string,badgeSize:j.oneOf(["small","medium","large"]),onClick:j.func,onError:j.func,onLoad:j.func,fallbackIcon:j.oneOf(["user","alert","loading"]),showInitials:j.bool,maxInitials:j.number,lazy:j.bool,priority:j.bool};const pr={default:{borderColor:"border-green-200",backgroundColor:"bg-green-50",textColor:"text-green-700",badgeColor:"bg-green-500",hoverBorderColor:"hover:border-green-300"},professor:{borderColor:"border-blue-200",backgroundColor:"bg-blue-50",textColor:"text-blue-700",badgeColor:"bg-blue-500",hoverBorderColor:"hover:border-blue-300"},escola:{borderColor:"border-orange-200",backgroundColor:"bg-orange-50",textColor:"text-orange-700",badgeColor:"bg-orange-500",hoverBorderColor:"hover:border-orange-300"},neutral:{borderColor:"border-gray-200",backgroundColor:"bg-gray-50",textColor:"text-gray-700",badgeColor:"bg-gray-500",hoverBorderColor:"hover:border-gray-300"},indigena:{borderColor:"border-amber-200",backgroundColor:"bg-amber-50",textColor:"text-amber-800",badgeColor:"bg-amber-600",hoverBorderColor:"hover:border-amber-300"},success:{borderColor:"border-emerald-200",backgroundColor:"bg-emerald-50",textColor:"text-emerald-700",badgeColor:"bg-emerald-500",hoverBorderColor:"hover:border-emerald-300"},warning:{borderColor:"border-yellow-200",backgroundColor:"bg-yellow-50",textColor:"text-yellow-800",badgeColor:"bg-yellow-500",hoverBorderColor:"hover:border-yellow-300"},error:{borderColor:"border-red-200",backgroundColor:"bg-red-50",textColor:"text-red-700",badgeColor:"bg-red-500",hoverBorderColor:"hover:border-red-300"}},Pn=({fotoUrl:e,nomeProfessor:t,tamanho:s="medium",className:a="",showFallback:i=!0,theme:r="professor",variant:o="default",shape:n="circle",clickable:c=!1,badge:h,badgePosition:f="bottom-right",onClick:d,onError:u,onLoad:g,size:m,customSize:y,escolaId:x})=>{const w=m||{small:"medium",medium:"large",large:"xlarge",xlarge:"xxlarge"}[s]||"large",{isImagePreloaded:M}=Es(x,!!x),b=pr[r]||pr.professor;return!e&&!i?null:l.jsx(Nn,{src:e,name:t,alt:t?`Foto de ${t}`:"Foto do professor",size:y?void 0:w,customSize:y,shape:n,variant:o,theme:r,clickable:c,badge:h,badgePosition:f,className:a,onClick:d,onError:u,onLoad:g,showInitials:!0,maxInitials:2,fallbackIcon:"user",lazy:!M(e),borderColor:b.borderColor,backgroundColor:b.backgroundColor,textColor:b.textColor,badgeColor:b.badgeColor})};Pn.propTypes={fotoUrl:j.string,nomeProfessor:j.string,tamanho:j.oneOf(["small","medium","large","xlarge"]),className:j.string,showFallback:j.bool,theme:j.oneOf(["default","professor","escola","neutral","indigena","success","warning","error"]),variant:j.oneOf(["default","minimal","flat","elevated"]),shape:j.oneOf(["circle","square","rounded","none"]),clickable:j.bool,badge:j.oneOfType([j.string,j.node]),badgePosition:j.oneOf(["top-left","top-right","bottom-left","bottom-right","center"]),onClick:j.func,onError:j.func,onLoad:j.func,size:j.oneOf(["xs","small","medium","large","xlarge","xxlarge"]),escolaId:j.oneOfType([j.string,j.number])};const Sm=p.memo(({escola:e,refreshKey:t=0,isMaximized:s=!1,shouldHideInlineMedia:a=!1})=>{const[i,r]=p.useState([]),[o,n]=p.useState(!0),[c,h]=p.useState(null),[f,d]=p.useState(0),[u,g]=p.useState(null),m=p.useCallback(()=>g(null),[]);p.useEffect(()=>{const M=b=>{b.key==="Escape"&&m()};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[m]),p.useEffect(()=>{if(!e?.id){n(!1);return}(async()=>{try{n(!0),h(null);const b=await Jo(e.id);r(b||[]),d(0)}catch(b){h(b.message)}finally{n(!1)}})()},[e?.id,t]);const y=p.useCallback(()=>{d(M=>M<i.length-1?M+1:0)},[i.length]),x=p.useCallback(()=>{d(M=>M>0?M-1:i.length-1)},[i.length]);if(p.useEffect(()=>{const M=b=>{i.length<=1||(b.key==="ArrowRight"?y():b.key==="ArrowLeft"&&x())};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[i.length,y,x]),o)return l.jsx("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-green-100/50",children:l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx("span",{className:"ml-2 text-gray-600",children:"Carregando histrias do professor..."})})});if(c)return l.jsx("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-red-100/50",children:l.jsx("div",{className:"text-center py-8",children:l.jsxs("p",{className:"text-red-600",children:["Erro ao carregar histrias do professor: ",c]})})});if(!i.length)return null;const _=i[f],w=i.length>1;return l.jsxs("div",{className:"mt-8 mb-12 flex flex-col items-center w-full",children:[l.jsxs("header",{className:"historia-professor-header mb-6 sm:mb-8 w-full max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"bg-green-200 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:l.jsx("img",{src:"/opin//passaro.svg",alt:"cone de pssaro",className:"w-12 h-12 sm:w-24 sm:h-24",style:{filter:"none",borderRadius:"0",boxShadow:"none",margin:"0",padding:"0",border:"none",outline:"none"},"aria-hidden":"true"})}),l.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-black m-0",children:"Depoimento dos Professores"})]}),w&&l.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:l.jsxs("span",{children:[f+1," de ",i.length]})})]}),l.jsx("div",{className:"h-1 w-20 sm:w-24 bg-green-300 rounded-full"})]}),l.jsxs("article",{className:`
          prose prose-sm sm:prose-base md:prose-lg lg:prose-xl
          prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify
          prose-img:rounded-xl prose-img:shadow-lg
          prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600
          max-w-3xl mx-auto w-full
        `,style:{maxWidth:"65ch"},children:[l.jsxs("section",{className:"text-base sm:text-lg leading-relaxed text-neutral-800",children:[_.nome_professor&&l.jsxs("div",{className:"flex flex-col items-center mb-6",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Pn,{fotoUrl:_.foto_rosto,nomeProfessor:_.nome_professor,customSize:"200px",className:"shadow-lg",escolaId:e.id})}),l.jsxs("div",{className:"w-full text-center",children:[l.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-green-800 mb-4 m-0",children:_.nome_professor}),l.jsx("div",{className:`historia-professor-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none
                  prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify
                  prose-img:rounded-xl prose-img:shadow-lg
                  prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600
                  prose-strong:text-green-800 prose-em:text-green-700
                  prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg
                  prose-ul:text-black prose-ol:text-black prose-li:text-black
                  prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm`,dangerouslySetInnerHTML:{__html:_.historia?_.historia.replace(/Aborda\./g,"").trim():""}})]})]}),!_.nome_professor&&l.jsx("div",{className:`historia-professor-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none
              prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify
              prose-img:rounded-xl prose-img:shadow-lg
              prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600
              prose-strong:text-green-800 prose-em:text-green-700
              prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg
              prose-ul:text-black prose-ol:text-black prose-li:text-black
              prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm`,dangerouslySetInnerHTML:{__html:_.historia?_.historia.replace(/Aborda\./g,"").trim():""}}),_.imagem_public_url&&l.jsx("figure",{className:"my-6",children:l.jsxs("div",{className:"relative",children:[l.jsx("img",{src:_.imagem_public_url,alt:_.descricao_imagem||"Imagem da histria do professor",className:"w-full max-w-2xl mx-auto rounded-xl shadow-lg cursor-pointer",onClick:()=>g(_),loading:"lazy"}),_.descricao_imagem&&l.jsx("figcaption",{className:"text-center text-sm text-gray-600 mt-2",children:_.descricao_imagem})]})})]}),w&&l.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200",children:[l.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Histria anterior",children:[l.jsx(ti,{className:"w-5 h-5"}),l.jsx("span",{className:"hidden sm:inline",children:"Anterior"})]}),l.jsx("div",{className:"flex gap-2",children:i.map((M,b)=>l.jsx("button",{onClick:()=>d(b),className:`w-3 h-3 rounded-full border-2 ${b===f?"bg-green-600 border-green-600":"bg-white border-gray-300"} transition-colors`,"aria-label":`Ir para histria ${b+1}`},b))}),l.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Prxima histria",children:[l.jsx("span",{className:"hidden sm:inline",children:"Prxima"}),l.jsx(xs,{className:"w-5 h-5"})]})]}),u&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:m,children:l.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center p-4",onClick:M=>M.stopPropagation(),children:[l.jsx("button",{className:"absolute top-4 right-4 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-80 z-10",onClick:m,"aria-label":"Fechar zoom",children:l.jsx(Ft,{className:"w-6 h-6"})}),l.jsx("img",{src:u.imagem_public_url,alt:u.descricao_imagem||"Imagem da histria do professor",className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl border-4 border-white"}),u.descricao_imagem&&l.jsx("figcaption",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 text-center text-sm text-white bg-black bg-opacity-50 rounded-lg px-3 py-1.5 max-w-2xl",children:u.descricao_imagem})]})}),l.jsx(Em,{escola_id:e.id,refreshKey:t,isMaximized:s,hideInlineMedia:a})]})]})}),jn=({escola_id:e,refreshKey:t=0,isMaximized:s=!1,hideInlineMedia:a=!1})=>{const[i,r]=p.useState([]),[o,n]=p.useState(!0),[c,h]=p.useState(null),[f,d]=p.useState(0),[u,g]=p.useState(""),m=p.useRef({}),[y,x]=p.useState(0),{isImagePreloaded:_}=Es(e,!0),w=p.useCallback(()=>{console.log("Limpando cache e recarregando imagens..."),m.current={},x(b=>b+1)},[]);p.useEffect(()=>{t>0&&(console.log("ImagensdasEscolas: refreshKey mudou, forando recarga"),w())},[t,w]),p.useEffect(()=>{t>0&&x(b=>b+1)},[t]);const M=p.useCallback(()=>{h(null),d(0),document.body.style.overflow="auto"},[]);return p.useEffect(()=>{const b=C=>{C.key==="Escape"&&M()};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[M]),p.useEffect(()=>{if(!e){n(!1);return}const b=`${e}_v${y}_rk${t}`;(async()=>{console.log("Buscando imagens para escola",e,"refreshKey:",t);try{const{data:S,error:E}=await fe.from("legendas_fotos").select("*").eq("escola_id",e).eq("tipo_foto","escola").eq("ativo",!0).order("ordem",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0}),G=new Map;S&&!E&&S.forEach(T=>{const D=T.imagem_url;G.set(D,T)});const{data:I,error:H}=await fe.storage.from("imagens-das-escolas").list(`${e}/`);if(H)throw H;if(!I||I.length===0){console.log("Nenhum arquivo encontrado para escola",e),r([]),n(!1);return}console.log("Arquivos encontrados:",I.length);const F=await Promise.all(I.map(async(T,D)=>{const K=`${e}/${T.name}`,{data:{publicUrl:J}}=fe.storage.from("imagens-das-escolas").getPublicUrl(K);let z=G.get(K);if(!z)try{console.log("Buscando legenda para:",K),z=await ei(K,e,{categoria:"escola",tipo_foto:"escola"}),console.log("Legenda encontrada:",z)}catch(oe){console.warn("Erro ao buscar legenda para",K,":",oe)}return{id:`${e}-${T.name}`,publicURL:J,filePath:K,descricao:z?.legenda||`Imagem ${D+1}`,descricaoDetalhada:z?.descricao_detalhada,autor:z?.autor_foto,dataFoto:z?.data_foto,categoria:z?.categoria,ordem:z?.ordem!==null&&z?.ordem!==void 0?z.ordem:1/0,urlError:null}}));F.sort((T,D)=>T.ordem!==D.ordem?T.ordem-D.ordem:0),console.log("Imagens processadas e ordenadas:",F.length),console.log("Ordem das imagens:",F.map(T=>({file:T.filePath.split("/").pop(),ordem:T.ordem}))),m.current[b]=F,r(F),F.length===0&&g("Nenhuma imagem encontrada para esta escola.")}catch(S){console.error("Erro ao processar imagens:",S),g("Erro ao carregar imagens da escola.")}finally{n(!1)}})()},[e,y,t]),o?l.jsx("div",{className:"text-gray-500 flex items-center gap-2",children:"Carregando imagens da escola..."}):u?l.jsxs("div",{className:"text-red-600 flex items-center gap-2",children:[l.jsx("span",{children:u}),l.jsx("button",{onClick:w,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:l.jsx(Hi,{className:"w-5 h-5"})})]}):i.length?a?null:l.jsxs("section",{className:"my-6",children:[l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:i.map(b=>l.jsxs("figure",{className:"rounded-lg overflow-hidden bg-white shadow-sm flex flex-col cursor-pointer",onClick:()=>{if(b.publicURL){const C=i.findIndex(S=>S.publicURL===b.publicURL);d(C),h(b)}},children:[l.jsx("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:l.jsx(Ms,{src:b.publicURL,alt:b.descricao,className:"w-full h-full object-cover object-center",isPreloaded:_(b.publicURL),style:{maxHeight:"350px"}})}),b.descricao&&l.jsxs("figcaption",{className:"p-3 bg-white",children:[l.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:b.descricao}),l.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[b.categoria&&l.jsx("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:b.categoria}),b.autor&&l.jsxs("span",{children:["Por: ",b.autor]}),b.dataFoto&&l.jsx("span",{children:na(b.dataFoto)})]}),b.descricaoDetalhada&&l.jsx("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:b.descricaoDetalhada})]})]},b.id))}),l.jsx(xi,{images:i,currentImageIndex:f,isOpen:!!c,onClose:M,onImageChange:d,showNavigation:!0,showControls:!0,showCounter:!0,showCaption:!0})]}):l.jsxs("div",{className:"text-yellow-700 flex items-center gap-2",children:[l.jsx("span",{children:"Nenhuma imagem encontrada para esta escola."}),l.jsx("button",{onClick:w,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:l.jsx(Hi,{className:"w-5 h-5"})})]})};jn.propTypes={escola_id:j.oneOfType([j.string,j.number]).isRequired,refreshKey:j.number,hideInlineMedia:j.bool};const Cm=ee.memo(jn),Nm=`
  .masonry-grid {
    column-count: 1;
    column-gap: 1.5rem;
    column-fill: balance;
  }
  
  .masonry-grid > * {
    display: block;
    break-inside: avoid;
    page-break-inside: avoid;
    margin-bottom: 1.5rem;
  }
  
  /* Mobile: 1 coluna */
  @media (max-width: 767px) {
    .masonry-grid {
      column-count: 1;
    }
  }
  
  /* Tablet e Desktop: 2 colunas */
  @media (min-width: 768px) {
    .masonry-grid {
      column-count: 2;
    }
  }
`,Pm=p.memo(({children:e,shouldUseGrid:t})=>{const s=t?"masonry-grid":"space-y-4";return l.jsxs(l.Fragment,{children:[l.jsx("style",{children:Nm}),l.jsx("div",{className:`${s} transition-all duration-300 ease-in-out`,children:e})]})}),jm=p.memo(({escola:e,shouldUseGrid:t=!1,refreshKey:s=0,sectionRefs:a,isMaximized:i=!1,shouldHideInlineMedia:r=!1})=>{console.log("EscolaInfo recebeu:",e);const{globalVisibility:o}=Kr();if(!e)return console.log("EscolaInfo: escola  null ou undefined"),null;const n=e.cards_visibilidade,c=[{Component:lm,props:{escola:e},id:"basicInfo"},{Component:pm,props:{escola:e},id:"modalidades"},{Component:ym,props:{escola:e},id:"infraestrutura"},{Component:wm,props:{escola:e},id:"gestaoProfessores"},{Component:Mm,props:{escola:e},id:"projetosParcerias"}].filter(({id:h})=>Pt(n,h,o));return l.jsxs("div",{className:"space-y-4",children:[c.length>0&&l.jsx("div",{ref:h=>a&&(a.dados=h),children:l.jsx(Pm,{shouldUseGrid:t,children:c.map(({Component:h,props:f},d)=>l.jsx(h,{...f},d))})}),Pt(n,"historiaEscola",o)&&l.jsx("div",{ref:h=>a&&(a.historia=h),children:l.jsx(dm,{escola:e,refreshKey:s,isMaximized:i})}),Pt(n,"imagensEscola",o)&&l.jsx(Cm,{escola_id:e.id,refreshKey:s,isMaximized:i,hideInlineMedia:r}),Pt(n,"historiaProfessor",o)&&l.jsx("div",{ref:h=>a&&(a.depoimentos=h),children:l.jsx(Sm,{escola:e,refreshKey:s,isMaximized:i,shouldHideInlineMedia:r})})]})}),km=({className:e="w-5 h-5",...t})=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",fill:"currentColor",className:e,...t,children:l.jsx("path",{d:"M200,80H184V64a32,32,0,0,0-56-21.13A32,32,0,0,0,72.21,60.42,32,32,0,0,0,24,88v40a104,104,0,0,0,208,0V112A32,32,0,0,0,200,80ZM152,48a16,16,0,0,1,16,16V80H136V64A16,16,0,0,1,152,48ZM88,64a16,16,0,0,1,32,0v40a16,16,0,0,1-32,0ZM40,88a16,16,0,0,1,32,0v16a16,16,0,0,1-32,0Zm176,40a88,88,0,0,1-175.92,3.75A31.93,31.93,0,0,0,80,125.13a31.93,31.93,0,0,0,44.58,3.35,32.21,32.21,0,0,0,11.8,11.44A47.88,47.88,0,0,0,120,176a8,8,0,0,0,16,0,32,32,0,0,1,32-32,8,8,0,0,0,0-16H152a16,16,0,0,1-16-16V96h64a16,16,0,0,1,16,16Z"})}),Ne=p.memo(({label:e,value:t,className:s="",isTextArea:a=!1})=>{if(!t&&t!==0)return null;const r=s.includes("flex flex-col")?"flex flex-col gap-1.5 text-sm py-1":"grid grid-cols-[auto,1fr] gap-x-3 gap-y-1 text-sm py-1";return l.jsxs("div",{className:`${r} ${s}`,children:[l.jsxs("span",{className:"font-semibold text-gray-800 leading-tight",children:[e,":"]}),a?l.jsx("div",{className:"text-gray-700",children:l.jsx("div",{className:"whitespace-pre-wrap break-words text-sm leading-relaxed",style:{lineHeight:"1.7"},children:t})}):l.jsx("span",{className:"text-gray-700 break-words leading-relaxed",style:{lineHeight:"1.6"},children:t})]})}),Am=e=>l.jsx(km,{className:"w-8 h-8",...e}),Im=p.memo(({terraIndigena:e})=>{if(!e)return console.log("TerraIndigenaInfo: terraIndigena  null ou undefined"),null;const t=()=>e.superficie?`Superfcie: ${parseFloat(e.superficie).toFixed(2)} ha`:null,s=()=>`${e.municipio||""}, ${e.uf||""}`.trim();return l.jsxs(Wt,{title:"Informaes da Terra Indgena",icon:Am,children:[l.jsx(Ne,{label:"Povos Indgenas",value:e.etnia}),l.jsx(Ne,{label:"Localizao",value:s()}),l.jsx(Ne,{label:"Superfcie",value:t()}),l.jsx(Ne,{label:"Fase",value:e.fase}),l.jsx(Ne,{label:"Modalidade",value:e.modalidade}),l.jsx(Ne,{label:"Reestudo",value:e.reestudo}),l.jsx(Ne,{label:"Coordenao Regional",value:e.cr}),l.jsx(Ne,{label:"Faixa de Fronteira",value:e.faixa_fron}),l.jsx(Ne,{label:"Unidade Administrativa",value:e.undadm_nom}),l.jsx(Ne,{label:"Sigla Unidade",value:e.undadm_sig}),l.jsx(Ne,{label:"Domnio",value:e.dominio_un}),l.jsx(Ne,{label:"Data de Atualizao",value:e.data_atual}),l.jsx(Ne,{label:"Cdigo Terra Indgena",value:e.terrai_cod}),l.jsx(Ne,{label:"Cdigo Unidade Administrativa",value:e.undadm_cod})]})});const{entries:kn,setPrototypeOf:xr,isFrozen:Gm,getPrototypeOf:Tm,getOwnPropertyDescriptor:Lm}=Object;let{freeze:we,seal:Oe,create:Va}=Object,{apply:Xa,construct:Ka}=typeof Reflect<"u"&&Reflect;we||(we=function(t){return t});Oe||(Oe=function(t){return t});Xa||(Xa=function(t,s){for(var a=arguments.length,i=new Array(a>2?a-2:0),r=2;r<a;r++)i[r-2]=arguments[r];return t.apply(s,i)});Ka||(Ka=function(t){for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return new t(...a)});const Ls=Me(Array.prototype.forEach),Rm=Me(Array.prototype.lastIndexOf),yr=Me(Array.prototype.pop),Qt=Me(Array.prototype.push),Om=Me(Array.prototype.splice),qs=Me(String.prototype.toLowerCase),Ca=Me(String.prototype.toString),Na=Me(String.prototype.match),es=Me(String.prototype.replace),Fm=Me(String.prototype.indexOf),Dm=Me(String.prototype.trim),De=Me(Object.prototype.hasOwnProperty),ye=Me(RegExp.prototype.test),ts=zm(TypeError);function Me(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return Xa(e,t,a)}}function zm(e){return function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];return Ka(e,s)}}function $(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qs;xr&&xr(e,null);let a=t.length;for(;a--;){let i=t[a];if(typeof i=="string"){const r=s(i);r!==i&&(Gm(t)||(t[a]=r),i=r)}e[i]=!0}return e}function $m(e){for(let t=0;t<e.length;t++)De(e,t)||(e[t]=null);return e}function Ye(e){const t=Va(null);for(const[s,a]of kn(e))De(e,s)&&(Array.isArray(a)?t[s]=$m(a):a&&typeof a=="object"&&a.constructor===Object?t[s]=Ye(a):t[s]=a);return t}function ss(e,t){for(;e!==null;){const a=Lm(e,t);if(a){if(a.get)return Me(a.get);if(typeof a.value=="function")return Me(a.value)}e=Tm(e)}function s(){return null}return s}const vr=we(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Pa=we(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ja=we(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Um=we(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ka=we(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Hm=we(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_r=we(["#text"]),br=we(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Aa=we(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),wr=we(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rs=we(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qm=Oe(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Bm=Oe(/<%[\w\W]*|[\w\W]*%>/gm),Wm=Oe(/\$\{[\w\W]*/gm),Vm=Oe(/^data-[\-\w.\u00B7-\uFFFF]+$/),Xm=Oe(/^aria-[\-\w]+$/),An=Oe(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Km=Oe(/^(?:\w+script|data):/i),Ym=Oe(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),In=Oe(/^html$/i),Zm=Oe(/^[a-z][.\w]*(-[.\w]+)+$/i);var Mr=Object.freeze({__proto__:null,ARIA_ATTR:Xm,ATTR_WHITESPACE:Ym,CUSTOM_ELEMENT:Zm,DATA_ATTR:Vm,DOCTYPE_NAME:In,ERB_EXPR:Bm,IS_ALLOWED_URI:An,IS_SCRIPT_OR_DATA:Km,MUSTACHE_EXPR:qm,TMPLIT_EXPR:Wm});const as={element:1,text:3,progressingInstruction:7,comment:8,document:9},Jm=function(){return typeof window>"u"?null:window},Qm=function(t,s){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";s&&s.hasAttribute(i)&&(a=s.getAttribute(i));const r="dompurify"+(a?"#"+a:"");try{return t.createPolicy(r,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}},Er=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Gn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jm();const t=O=>Gn(O);if(t.version="3.3.0",t.removed=[],!e||!e.document||e.document.nodeType!==as.document||!e.Element)return t.isSupported=!1,t;let{document:s}=e;const a=s,i=a.currentScript,{DocumentFragment:r,HTMLTemplateElement:o,Node:n,Element:c,NodeFilter:h,NamedNodeMap:f=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:u,trustedTypes:g}=e,m=c.prototype,y=ss(m,"cloneNode"),x=ss(m,"remove"),_=ss(m,"nextSibling"),w=ss(m,"childNodes"),M=ss(m,"parentNode");if(typeof o=="function"){const O=s.createElement("template");O.content&&O.content.ownerDocument&&(s=O.content.ownerDocument)}let b,C="";const{implementation:S,createNodeIterator:E,createDocumentFragment:G,getElementsByTagName:I}=s,{importNode:H}=a;let F=Er();t.isSupported=typeof kn=="function"&&typeof M=="function"&&S&&S.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:T,ERB_EXPR:D,TMPLIT_EXPR:K,DATA_ATTR:J,ARIA_ATTR:z,IS_SCRIPT_OR_DATA:oe,ATTR_WHITESPACE:de,CUSTOM_ELEMENT:Ie}=Mr;let{IS_ALLOWED_URI:Je}=Mr,Y=null;const Qe=$({},[...vr,...Pa,...ja,...ka,..._r]);let re=null;const qe=$({},[...br,...Aa,...wr,...Rs]);let Q=Object.seal(Va(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Be=null,et=null;const q=Object.seal(Va(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let tt=!0,We=!0,R=!1,U=!0,B=!1,Ee=!0,Se=!1,ct=!1,Vt=!1,_t=!1,Ss=!1,Cs=!1,_i=!0,bi=!1;const On="user-content-";let ca=!0,Xt=!1,bt={},wt=null;const wi=$({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Mi=null;const Ei=$({},["audio","video","img","source","image","track"]);let ha=null;const Si=$({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ns="http://www.w3.org/1998/Math/MathML",Ps="http://www.w3.org/2000/svg",Ve="http://www.w3.org/1999/xhtml";let Mt=Ve,da=!1,ua=null;const Fn=$({},[Ns,Ps,Ve],Ca);let js=$({},["mi","mo","mn","ms","mtext"]),ks=$({},["annotation-xml"]);const Dn=$({},["title","style","font","a","script"]);let Kt=null;const zn=["application/xhtml+xml","text/html"],$n="text/html";let ce=null,Et=null;const Un=s.createElement("form"),Ci=function(v){return v instanceof RegExp||v instanceof Function},fa=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Et&&Et===v)){if((!v||typeof v!="object")&&(v={}),v=Ye(v),Kt=zn.indexOf(v.PARSER_MEDIA_TYPE)===-1?$n:v.PARSER_MEDIA_TYPE,ce=Kt==="application/xhtml+xml"?Ca:qs,Y=De(v,"ALLOWED_TAGS")?$({},v.ALLOWED_TAGS,ce):Qe,re=De(v,"ALLOWED_ATTR")?$({},v.ALLOWED_ATTR,ce):qe,ua=De(v,"ALLOWED_NAMESPACES")?$({},v.ALLOWED_NAMESPACES,Ca):Fn,ha=De(v,"ADD_URI_SAFE_ATTR")?$(Ye(Si),v.ADD_URI_SAFE_ATTR,ce):Si,Mi=De(v,"ADD_DATA_URI_TAGS")?$(Ye(Ei),v.ADD_DATA_URI_TAGS,ce):Ei,wt=De(v,"FORBID_CONTENTS")?$({},v.FORBID_CONTENTS,ce):wi,Be=De(v,"FORBID_TAGS")?$({},v.FORBID_TAGS,ce):Ye({}),et=De(v,"FORBID_ATTR")?$({},v.FORBID_ATTR,ce):Ye({}),bt=De(v,"USE_PROFILES")?v.USE_PROFILES:!1,tt=v.ALLOW_ARIA_ATTR!==!1,We=v.ALLOW_DATA_ATTR!==!1,R=v.ALLOW_UNKNOWN_PROTOCOLS||!1,U=v.ALLOW_SELF_CLOSE_IN_ATTR!==!1,B=v.SAFE_FOR_TEMPLATES||!1,Ee=v.SAFE_FOR_XML!==!1,Se=v.WHOLE_DOCUMENT||!1,_t=v.RETURN_DOM||!1,Ss=v.RETURN_DOM_FRAGMENT||!1,Cs=v.RETURN_TRUSTED_TYPE||!1,Vt=v.FORCE_BODY||!1,_i=v.SANITIZE_DOM!==!1,bi=v.SANITIZE_NAMED_PROPS||!1,ca=v.KEEP_CONTENT!==!1,Xt=v.IN_PLACE||!1,Je=v.ALLOWED_URI_REGEXP||An,Mt=v.NAMESPACE||Ve,js=v.MATHML_TEXT_INTEGRATION_POINTS||js,ks=v.HTML_INTEGRATION_POINTS||ks,Q=v.CUSTOM_ELEMENT_HANDLING||{},v.CUSTOM_ELEMENT_HANDLING&&Ci(v.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Q.tagNameCheck=v.CUSTOM_ELEMENT_HANDLING.tagNameCheck),v.CUSTOM_ELEMENT_HANDLING&&Ci(v.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Q.attributeNameCheck=v.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),v.CUSTOM_ELEMENT_HANDLING&&typeof v.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Q.allowCustomizedBuiltInElements=v.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),B&&(We=!1),Ss&&(_t=!0),bt&&(Y=$({},_r),re=[],bt.html===!0&&($(Y,vr),$(re,br)),bt.svg===!0&&($(Y,Pa),$(re,Aa),$(re,Rs)),bt.svgFilters===!0&&($(Y,ja),$(re,Aa),$(re,Rs)),bt.mathMl===!0&&($(Y,ka),$(re,wr),$(re,Rs))),v.ADD_TAGS&&(typeof v.ADD_TAGS=="function"?q.tagCheck=v.ADD_TAGS:(Y===Qe&&(Y=Ye(Y)),$(Y,v.ADD_TAGS,ce))),v.ADD_ATTR&&(typeof v.ADD_ATTR=="function"?q.attributeCheck=v.ADD_ATTR:(re===qe&&(re=Ye(re)),$(re,v.ADD_ATTR,ce))),v.ADD_URI_SAFE_ATTR&&$(ha,v.ADD_URI_SAFE_ATTR,ce),v.FORBID_CONTENTS&&(wt===wi&&(wt=Ye(wt)),$(wt,v.FORBID_CONTENTS,ce)),ca&&(Y["#text"]=!0),Se&&$(Y,["html","head","body"]),Y.table&&($(Y,["tbody"]),delete Be.tbody),v.TRUSTED_TYPES_POLICY){if(typeof v.TRUSTED_TYPES_POLICY.createHTML!="function")throw ts('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof v.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ts('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=v.TRUSTED_TYPES_POLICY,C=b.createHTML("")}else b===void 0&&(b=Qm(g,i)),b!==null&&typeof C=="string"&&(C=b.createHTML(""));we&&we(v),Et=v}},Ni=$({},[...Pa,...ja,...Um]),Pi=$({},[...ka,...Hm]),Hn=function(v){let P=M(v);(!P||!P.tagName)&&(P={namespaceURI:Mt,tagName:"template"});const L=qs(v.tagName),se=qs(P.tagName);return ua[v.namespaceURI]?v.namespaceURI===Ps?P.namespaceURI===Ve?L==="svg":P.namespaceURI===Ns?L==="svg"&&(se==="annotation-xml"||js[se]):!!Ni[L]:v.namespaceURI===Ns?P.namespaceURI===Ve?L==="math":P.namespaceURI===Ps?L==="math"&&ks[se]:!!Pi[L]:v.namespaceURI===Ve?P.namespaceURI===Ps&&!ks[se]||P.namespaceURI===Ns&&!js[se]?!1:!Pi[L]&&(Dn[L]||!Ni[L]):!!(Kt==="application/xhtml+xml"&&ua[v.namespaceURI]):!1},$e=function(v){Qt(t.removed,{element:v});try{M(v).removeChild(v)}catch{x(v)}},ht=function(v,P){try{Qt(t.removed,{attribute:P.getAttributeNode(v),from:P})}catch{Qt(t.removed,{attribute:null,from:P})}if(P.removeAttribute(v),v==="is")if(_t||Ss)try{$e(P)}catch{}else try{P.setAttribute(v,"")}catch{}},ji=function(v){let P=null,L=null;if(Vt)v="<remove></remove>"+v;else{const le=Na(v,/^[\r\n\t ]+/);L=le&&le[0]}Kt==="application/xhtml+xml"&&Mt===Ve&&(v='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+v+"</body></html>");const se=b?b.createHTML(v):v;if(Mt===Ve)try{P=new u().parseFromString(se,Kt)}catch{}if(!P||!P.documentElement){P=S.createDocument(Mt,"template",null);try{P.documentElement.innerHTML=da?C:se}catch{}}const me=P.body||P.documentElement;return v&&L&&me.insertBefore(s.createTextNode(L),me.childNodes[0]||null),Mt===Ve?I.call(P,Se?"html":"body")[0]:Se?P.documentElement:me},ki=function(v){return E.call(v.ownerDocument||v,v,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},ma=function(v){return v instanceof d&&(typeof v.nodeName!="string"||typeof v.textContent!="string"||typeof v.removeChild!="function"||!(v.attributes instanceof f)||typeof v.removeAttribute!="function"||typeof v.setAttribute!="function"||typeof v.namespaceURI!="string"||typeof v.insertBefore!="function"||typeof v.hasChildNodes!="function")},Ai=function(v){return typeof n=="function"&&v instanceof n};function Xe(O,v,P){Ls(O,L=>{L.call(t,v,P,Et)})}const Ii=function(v){let P=null;if(Xe(F.beforeSanitizeElements,v,null),ma(v))return $e(v),!0;const L=ce(v.nodeName);if(Xe(F.uponSanitizeElement,v,{tagName:L,allowedTags:Y}),Ee&&v.hasChildNodes()&&!Ai(v.firstElementChild)&&ye(/<[/\w!]/g,v.innerHTML)&&ye(/<[/\w!]/g,v.textContent)||v.nodeType===as.progressingInstruction||Ee&&v.nodeType===as.comment&&ye(/<[/\w]/g,v.data))return $e(v),!0;if(!(q.tagCheck instanceof Function&&q.tagCheck(L))&&(!Y[L]||Be[L])){if(!Be[L]&&Ti(L)&&(Q.tagNameCheck instanceof RegExp&&ye(Q.tagNameCheck,L)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(L)))return!1;if(ca&&!wt[L]){const se=M(v)||v.parentNode,me=w(v)||v.childNodes;if(me&&se){const le=me.length;for(let Ce=le-1;Ce>=0;--Ce){const Ke=y(me[Ce],!0);Ke.__removalCount=(v.__removalCount||0)+1,se.insertBefore(Ke,_(v))}}}return $e(v),!0}return v instanceof c&&!Hn(v)||(L==="noscript"||L==="noembed"||L==="noframes")&&ye(/<\/no(script|embed|frames)/i,v.innerHTML)?($e(v),!0):(B&&v.nodeType===as.text&&(P=v.textContent,Ls([T,D,K],se=>{P=es(P,se," ")}),v.textContent!==P&&(Qt(t.removed,{element:v.cloneNode()}),v.textContent=P)),Xe(F.afterSanitizeElements,v,null),!1)},Gi=function(v,P,L){if(_i&&(P==="id"||P==="name")&&(L in s||L in Un))return!1;if(!(We&&!et[P]&&ye(J,P))){if(!(tt&&ye(z,P))){if(!(q.attributeCheck instanceof Function&&q.attributeCheck(P,v))){if(!re[P]||et[P]){if(!(Ti(v)&&(Q.tagNameCheck instanceof RegExp&&ye(Q.tagNameCheck,v)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(v))&&(Q.attributeNameCheck instanceof RegExp&&ye(Q.attributeNameCheck,P)||Q.attributeNameCheck instanceof Function&&Q.attributeNameCheck(P,v))||P==="is"&&Q.allowCustomizedBuiltInElements&&(Q.tagNameCheck instanceof RegExp&&ye(Q.tagNameCheck,L)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(L))))return!1}else if(!ha[P]){if(!ye(Je,es(L,de,""))){if(!((P==="src"||P==="xlink:href"||P==="href")&&v!=="script"&&Fm(L,"data:")===0&&Mi[v])){if(!(R&&!ye(oe,es(L,de,"")))){if(L)return!1}}}}}}}return!0},Ti=function(v){return v!=="annotation-xml"&&Na(v,Ie)},Li=function(v){Xe(F.beforeSanitizeAttributes,v,null);const{attributes:P}=v;if(!P||ma(v))return;const L={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re,forceKeepAttr:void 0};let se=P.length;for(;se--;){const me=P[se],{name:le,namespaceURI:Ce,value:Ke}=me,St=ce(le),ga=Ke;let ue=le==="value"?ga:Dm(ga);if(L.attrName=St,L.attrValue=ue,L.keepAttr=!0,L.forceKeepAttr=void 0,Xe(F.uponSanitizeAttribute,v,L),ue=L.attrValue,bi&&(St==="id"||St==="name")&&(ht(le,v),ue=On+ue),Ee&&ye(/((--!?|])>)|<\/(style|title|textarea)/i,ue)){ht(le,v);continue}if(St==="attributename"&&Na(ue,"href")){ht(le,v);continue}if(L.forceKeepAttr)continue;if(!L.keepAttr){ht(le,v);continue}if(!U&&ye(/\/>/i,ue)){ht(le,v);continue}B&&Ls([T,D,K],Oi=>{ue=es(ue,Oi," ")});const Ri=ce(v.nodeName);if(!Gi(Ri,St,ue)){ht(le,v);continue}if(b&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Ce)switch(g.getAttributeType(Ri,St)){case"TrustedHTML":{ue=b.createHTML(ue);break}case"TrustedScriptURL":{ue=b.createScriptURL(ue);break}}if(ue!==ga)try{Ce?v.setAttributeNS(Ce,le,ue):v.setAttribute(le,ue),ma(v)?$e(v):yr(t.removed)}catch{ht(le,v)}}Xe(F.afterSanitizeAttributes,v,null)},qn=function O(v){let P=null;const L=ki(v);for(Xe(F.beforeSanitizeShadowDOM,v,null);P=L.nextNode();)Xe(F.uponSanitizeShadowNode,P,null),Ii(P),Li(P),P.content instanceof r&&O(P.content);Xe(F.afterSanitizeShadowDOM,v,null)};return t.sanitize=function(O){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P=null,L=null,se=null,me=null;if(da=!O,da&&(O="<!-->"),typeof O!="string"&&!Ai(O))if(typeof O.toString=="function"){if(O=O.toString(),typeof O!="string")throw ts("dirty is not a string, aborting")}else throw ts("toString is not a function");if(!t.isSupported)return O;if(ct||fa(v),t.removed=[],typeof O=="string"&&(Xt=!1),Xt){if(O.nodeName){const Ke=ce(O.nodeName);if(!Y[Ke]||Be[Ke])throw ts("root node is forbidden and cannot be sanitized in-place")}}else if(O instanceof n)P=ji("<!---->"),L=P.ownerDocument.importNode(O,!0),L.nodeType===as.element&&L.nodeName==="BODY"||L.nodeName==="HTML"?P=L:P.appendChild(L);else{if(!_t&&!B&&!Se&&O.indexOf("<")===-1)return b&&Cs?b.createHTML(O):O;if(P=ji(O),!P)return _t?null:Cs?C:""}P&&Vt&&$e(P.firstChild);const le=ki(Xt?O:P);for(;se=le.nextNode();)Ii(se),Li(se),se.content instanceof r&&qn(se.content);if(Xt)return O;if(_t){if(Ss)for(me=G.call(P.ownerDocument);P.firstChild;)me.appendChild(P.firstChild);else me=P;return(re.shadowroot||re.shadowrootmode)&&(me=H.call(a,me,!0)),me}let Ce=Se?P.outerHTML:P.innerHTML;return Se&&Y["!doctype"]&&P.ownerDocument&&P.ownerDocument.doctype&&P.ownerDocument.doctype.name&&ye(In,P.ownerDocument.doctype.name)&&(Ce="<!DOCTYPE "+P.ownerDocument.doctype.name+`>
`+Ce),B&&Ls([T,D,K],Ke=>{Ce=es(Ce,Ke," ")}),b&&Cs?b.createHTML(Ce):Ce},t.setConfig=function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};fa(O),ct=!0},t.clearConfig=function(){Et=null,ct=!1},t.isValidAttribute=function(O,v,P){Et||fa({});const L=ce(O),se=ce(v);return Gi(L,se,P)},t.addHook=function(O,v){typeof v=="function"&&Qt(F[O],v)},t.removeHook=function(O,v){if(v!==void 0){const P=Rm(F[O],v);return P===-1?void 0:Om(F[O],P,1)[0]}return yr(F[O])},t.removeHooks=function(O){F[O]=[]},t.removeAllHooks=function(){F=Er()},t}var e1=Gn();const t1=({descricao:e,className:t=""})=>{const s=i=>{if(!i)return"";let r=i.replace(/\n\n+/g,"</p><p>");return r=r.replace(/\n/g,"<br>"),r.startsWith("<p>")||(r="<p>"+r),r.endsWith("</p>")||(r=r+"</p>"),r=r.replace(/>\s+</g,"><"),r},a=p.useMemo(()=>e?e1.sanitize(s(e),{ALLOWED_TAGS:["b","i","em","strong","a","p","br","ul","ol","li","div","span","img","h1","h2","h3","h4","h5","h6","center","blockquote","code","pre","hr","table","thead","tbody","tr","th","td"],ALLOWED_ATTR:["href","target","rel","class","style","src","alt","width","height","id","title","aria-label","aria-describedby"],ADD_TAGS:["center","blockquote"],ADD_ATTR:["target","className","title"],KEEP_CONTENT:!0,ALLOW_DATA_ATTR:!1}):"",[e]);return e?l.jsx("div",{className:`mb-6 ${t}`,children:l.jsx("div",{className:"prose prose-lg lg:prose-xl max-w-none px-1",style:{"--tw-prose-body":"#1f2937","--tw-prose-headings":"#111827","--tw-prose-links":"#059669","--tw-prose-bold":"#111827","--tw-prose-counters":"#1f2937","--tw-prose-bullets":"#4b5563","--tw-prose-hr":"#e5e7eb","--tw-prose-quotes":"#111827","--tw-prose-quote-borders":"#10b981","--tw-prose-captions":"#6b7280","--tw-prose-code":"#111827","--tw-prose-pre-code":"#e5e7eb","--tw-prose-pre-bg":"#1f2937","--tw-prose-th-borders":"#d1d5db","--tw-prose-td-borders":"#e5e7eb",lineHeight:"1.8",fontSize:"1.125rem",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',letterSpacing:"0.015em"},dangerouslySetInnerHTML:{__html:a},"aria-live":"polite"})}):null},s1=ee.memo(t1),a1=p.memo(({painelInfo:e})=>l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"prose prose-lg lg:prose-xl max-w-none",children:l.jsx("div",{className:"bg-green-100 rounded-lg p-6",children:l.jsx(s1,{descricao:e.descricao_detalhada})})}),e.audioUrl&&l.jsx("div",{className:"mt-6",children:l.jsxs("audio",{controls:!0,className:"w-full",children:[l.jsx("source",{src:e.audioUrl,type:"audio/mpeg"}),"Seu navegador no suporta o elemento de udio."]})})]})),i1=["EE","EEI"],Ia=e=>!e||typeof e!="string"?"":e.split(/\s+/).map(a=>i1.includes(a.toUpperCase())?a.toUpperCase():a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()).join(" ");var Ga={exports:{}};var Sr;function r1(){return Sr||(Sr=1,(function(e){(function(){var t={}.hasOwnProperty;function s(){for(var r="",o=0;o<arguments.length;o++){var n=arguments[o];n&&(r=i(r,a(n)))}return r}function a(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return s.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var o="";for(var n in r)t.call(r,n)&&r[n]&&(o=i(o,n));return o}function i(r,o){return o?r?r+" "+o:r+o:r}e.exports?(s.default=s,e.exports=s):window.classNames=s})()})(Ga)),Ga.exports}var n1=r1();const Tn=Rr(n1);var Os={exports:{}},Fs={exports:{}},Ta,Cr;function o1(){if(Cr)return Ta;Cr=1;var e=1e3,t=e*60,s=t*60,a=s*24,i=a*365.25;Ta=function(h,f){f=f||{};var d=typeof h;if(d==="string"&&h.length>0)return r(h);if(d==="number"&&isNaN(h)===!1)return f.long?n(h):o(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))};function r(h){if(h=String(h),!(h.length>100)){var f=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(f){var d=parseFloat(f[1]),u=(f[2]||"ms").toLowerCase();switch(u){case"years":case"year":case"yrs":case"yr":case"y":return d*i;case"days":case"day":case"d":return d*a;case"hours":case"hour":case"hrs":case"hr":case"h":return d*s;case"minutes":case"minute":case"mins":case"min":case"m":return d*t;case"seconds":case"second":case"secs":case"sec":case"s":return d*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function o(h){return h>=a?Math.round(h/a)+"d":h>=s?Math.round(h/s)+"h":h>=t?Math.round(h/t)+"m":h>=e?Math.round(h/e)+"s":h+"ms"}function n(h){return c(h,a,"day")||c(h,s,"hour")||c(h,t,"minute")||c(h,e,"second")||h+" ms"}function c(h,f,d){if(!(h<f))return h<f*1.5?Math.floor(h/f)+" "+d:Math.ceil(h/f)+" "+d+"s"}return Ta}var Nr;function l1(){return Nr||(Nr=1,(function(e,t){t=e.exports=i.debug=i.default=i,t.coerce=c,t.disable=o,t.enable=r,t.enabled=n,t.humanize=o1(),t.names=[],t.skips=[],t.formatters={};var s;function a(h){var f=0,d;for(d in h)f=(f<<5)-f+h.charCodeAt(d),f|=0;return t.colors[Math.abs(f)%t.colors.length]}function i(h){function f(){if(f.enabled){var d=f,u=+new Date,g=u-(s||u);d.diff=g,d.prev=s,d.curr=u,s=u;for(var m=new Array(arguments.length),y=0;y<m.length;y++)m[y]=arguments[y];m[0]=t.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");var x=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,function(w,M){if(w==="%%")return w;x++;var b=t.formatters[M];if(typeof b=="function"){var C=m[x];w=b.call(d,C),m.splice(x,1),x--}return w}),t.formatArgs.call(d,m);var _=f.log||t.log||console.log.bind(console);_.apply(d,m)}}return f.namespace=h,f.enabled=t.enabled(h),f.useColors=t.useColors(),f.color=a(h),typeof t.init=="function"&&t.init(f),f}function r(h){t.save(h),t.names=[],t.skips=[];for(var f=(typeof h=="string"?h:"").split(/[\s,]+/),d=f.length,u=0;u<d;u++)f[u]&&(h=f[u].replace(/\*/g,".*?"),h[0]==="-"?t.skips.push(new RegExp("^"+h.substr(1)+"$")):t.names.push(new RegExp("^"+h+"$")))}function o(){t.enable("")}function n(h){var f,d;for(f=0,d=t.skips.length;f<d;f++)if(t.skips[f].test(h))return!1;for(f=0,d=t.names.length;f<d;f++)if(t.names[f].test(h))return!0;return!1}function c(h){return h instanceof Error?h.stack||h.message:h}})(Fs,Fs.exports)),Fs.exports}var Pr;function c1(){return Pr||(Pr=1,(function(e,t){var s={};t=e.exports=l1(),t.log=r,t.formatArgs=i,t.save=o,t.load=n,t.useColors=a,t.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function a(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}t.formatters.j=function(h){try{return JSON.stringify(h)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}};function i(h){var f=this.useColors;if(h[0]=(f?"%c":"")+this.namespace+(f?" %c":" ")+h[0]+(f?"%c ":" ")+"+"+t.humanize(this.diff),!!f){var d="color: "+this.color;h.splice(1,0,d,"color: inherit");var u=0,g=0;h[0].replace(/%[a-zA-Z%]/g,function(m){m!=="%%"&&(u++,m==="%c"&&(g=u))}),h.splice(g,0,d)}}function r(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(h){try{h==null?t.storage.removeItem("debug"):t.storage.debug=h}catch{}}function n(){var h;try{h=t.storage.debug}catch{}return!h&&typeof process<"u"&&"env"in process&&(h=s.DEBUG),h}t.enable(n());function c(){try{return window.localStorage}catch{}}})(Os,Os.exports)),Os.exports}var La,jr;function h1(){if(jr)return La;jr=1;var e=c1()("jsonp");La=a;var t=0;function s(){}function a(i,r,o){typeof r=="function"&&(o=r,r={}),r||(r={});var n=r.prefix||"__jp",c=r.name||n+t++,h=r.param||"callback",f=r.timeout!=null?r.timeout:6e4,d=encodeURIComponent,u=document.getElementsByTagName("script")[0]||document.head,g,m;f&&(m=setTimeout(function(){y(),o&&o(new Error("Timeout"))},f));function y(){g.parentNode&&g.parentNode.removeChild(g),window[c]=s,m&&clearTimeout(m)}function x(){window[c]&&y()}return window[c]=function(_){e("jsonp got",_),y(),o&&o(null,_)},i+=(~i.indexOf("?")?"&":"?")+h+"="+d(c),i=i.replace("?&","?"),e('jsonp req "%s"',i),g=document.createElement("script"),g.src=i,u.parentNode.insertBefore(g,u),x}return La}var d1=h1();const yt=Rr(d1);var u1=Object.defineProperty,f1=Object.defineProperties,m1=Object.getOwnPropertyDescriptors,ia=Object.getOwnPropertySymbols,Ln=Object.prototype.hasOwnProperty,Rn=Object.prototype.propertyIsEnumerable,kr=(e,t,s)=>t in e?u1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Te=(e,t)=>{for(var s in t||(t={}))Ln.call(t,s)&&kr(e,s,t[s]);if(ia)for(var s of ia(t))Rn.call(t,s)&&kr(e,s,t[s]);return e},yi=(e,t)=>f1(e,m1(t)),vi=(e,t)=>{var s={};for(var a in e)Ln.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&ia)for(var a of ia(e))t.indexOf(a)<0&&Rn.call(e,a)&&(s[a]=e[a]);return s};class g1 extends Error{constructor(t){super(t),this.name="AssertionError"}}function te(e,t){if(!e)throw new g1(t)}function Z(e){const t=Object.entries(e).filter(([,s])=>s!=null).map(([s,a])=>`${encodeURIComponent(s)}=${encodeURIComponent(String(a))}`);return t.length>0?`?${t.join("&")}`:""}const p1=e=>!!e&&(typeof e=="object"||typeof e=="function")&&"then"in e&&typeof e.then=="function",x1=(e,t)=>({left:window.outerWidth/2+(window.screenX||window.screenLeft||0)-e/2,top:window.outerHeight/2+(window.screenY||window.screenTop||0)-t/2}),y1=(e,t)=>({top:(window.screen.height-t)/2,left:(window.screen.width-e)/2});function v1(e,t,s){var a=t,{height:i,width:r}=a,o=vi(a,["height","width"]);const n=Te({height:i,width:r,location:"no",toolbar:"no",status:"no",directories:"no",menubar:"no",scrollbars:"yes",resizable:"no",centerscreen:"yes",chrome:"yes"},o),c=window.open(e,"",Object.keys(n).map(h=>`${h}=${n[h]}`).join(", "));if(s){const h=window.setInterval(()=>{try{(c===null||c.closed)&&(window.clearInterval(h),s(c))}catch(f){console.error(f)}},1e3)}return c}function _1(e){var t=e,{beforeOnClick:s,children:a,className:i,disabled:r,disabledStyle:o={opacity:.6},forwardedRef:n,htmlTitle:c,networkLink:h,networkName:f,onClick:d,onShareWindowClose:u,openShareDialogOnClick:g=!0,opts:m,resetButtonStyle:y=!0,style:x,title:_,url:w,windowHeight:M=400,windowPosition:b="windowCenter",windowWidth:C=550}=t,S=vi(t,["beforeOnClick","children","className","disabled","disabledStyle","forwardedRef","htmlTitle","networkLink","networkName","onClick","onShareWindowClose","openShareDialogOnClick","opts","resetButtonStyle","style","title","url","windowHeight","windowPosition","windowWidth"]);const E=async H=>{const F=h(w,m);if(!r){if(H.preventDefault(),s){const T=s();p1(T)&&await T}if(g){const T=Te({height:M,width:C},b==="windowCenter"?x1(C,M):y1(C,M));v1(F,T,u)}d&&d(H,F)}},G=Tn("react-share__ShareButton",{"react-share__ShareButton--disabled":!!r,disabled:!!r},i),I=Te(Te(y?{backgroundColor:"transparent",border:"none",padding:0,font:"inherit",color:"inherit",cursor:"pointer"}:{},x),r&&o);return l.jsx("button",yi(Te({},S),{className:G,onClick:E,ref:n,style:I,title:c,children:a}))}function ae(e,t,s,a){const i=(r,o)=>{const n=s(r),c=Te({},r);return Object.keys(n).forEach(f=>{delete c[f]}),l.jsx(_1,yi(Te(Te({},a),c),{forwardedRef:o,networkName:e,networkLink:t,opts:n}))};return i.displayName=`ShareButton-${e}`,p.forwardRef(i)}function b1(e,{title:t,separator:s}){return te(e,"bluesky.url"),"https://bsky.app/intent/compose"+Z({text:t?t+s+e:e})}ae("bluesky",b1,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function w1(e,{subject:t,body:s,separator:a}){return"mailto:"+Z({subject:t,body:s?s+a+e:e})}ae("email",w1,e=>({subject:e.subject,body:e.body,separator:e.separator||" "}),{openShareDialogOnClick:!1,onClick:(e,t)=>{window.location.href=t}});function M1(e,{appId:t,redirectUri:s,to:a}){return"https://www.facebook.com/dialog/send"+Z({link:e,redirect_uri:s||e,app_id:t,to:a})}ae("facebookmessenger",M1,e=>({appId:e.appId,redirectUri:e.redirectUri,to:e.to}),{windowWidth:1e3,windowHeight:820});function E1(e,{hashtag:t}){return te(e,"facebook.url"),"https://www.facebook.com/sharer/sharer.php"+Z({u:e,hashtag:t})}const S1=ae("facebook",E1,e=>({hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});function C1(){const e=p.useRef(!1);return p.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),p.useCallback(()=>e.current,[])}function N1(e){var t=e,{children:s=u=>u,className:a,getCount:i,url:r}=t,o=vi(t,["children","className","getCount","url"]);const n=C1(),[c,h]=p.useState(void 0),[f,d]=p.useState(!1);return p.useEffect(()=>{d(!0),i(r,u=>{n()&&(h(u),d(!1))})},[r]),l.jsx("span",yi(Te({className:Tn("react-share__ShareCount",a)},o),{children:!f&&c!==void 0&&s(c)}))}function vt(e){const t=s=>l.jsx(N1,Te({getCount:e},s));return t.displayName=`ShareCount(${e.name})`,t}function P1(e,t){const s=`https://graph.facebook.com/?id=${e}&fields=og_object{engagement}`;yt(s,(a,i)=>{t(!a&&i&&i.og_object&&i.og_object.engagement?i.og_object.engagement.count:void 0)})}vt(P1);function j1(e,{title:t}){return te(e,"hatena.url"),`http://b.hatena.ne.jp/add?mode=confirm&url=${e}&title=${t}`}ae("hatena",j1,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function k1(e,t){yt("https://bookmark.hatenaapis.com/count/entry"+Z({url:e}),(a,i)=>{t(i??void 0)})}vt(k1);function A1(e,{title:t,description:s}){return te(e,"instapaper.url"),"http://www.instapaper.com/hello2"+Z({url:e,title:t,description:s})}ae("instapaper",A1,e=>({title:e.title,description:e.description}),{windowWidth:500,windowHeight:500,windowPosition:"windowCenter"});function I1(e,{title:t}){return te(e,"line.url"),"https://social-plugins.line.me/lineit/share"+Z({url:e,text:t})}ae("line",I1,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function G1(e,{title:t,summary:s,source:a}){return te(e,"linkedin.url"),"https://linkedin.com/shareArticle"+Z({url:e,mini:"true",title:t,summary:s,source:a})}ae("linkedin",G1,({title:e,summary:t,source:s})=>({title:e,summary:t,source:s}),{windowWidth:750,windowHeight:600});function T1(e,{title:t,description:s}){return te(e,"livejournal.url"),"https://www.livejournal.com/update.bml"+Z({subject:t,event:s})}ae("livejournal",T1,e=>({title:e.title,description:e.description}),{windowWidth:660,windowHeight:460});function L1(e,{title:t,description:s,imageUrl:a}){return te(e,"mailru.url"),"https://connect.mail.ru/share"+Z({url:e,title:t,description:s,image_url:a})}ae("mailru",L1,e=>({title:e.title,description:e.description,imageUrl:e.imageUrl}),{windowWidth:660,windowHeight:460});function R1(e,{title:t,description:s,image:a}){return te(e,"ok.url"),"https://connect.ok.ru/offer"+Z({url:e,title:t,description:s,imageUrl:a})}ae("ok",R1,e=>({title:e.title,description:e.description,image:e.image}),{windowWidth:588,windowHeight:480,windowPosition:"screenCenter"});function O1(e,t){window.OK||(window.OK={Share:{count:function(r,o){var n,c;(c=(n=window.OK.callbacks)[r])==null||c.call(n,o)}},callbacks:[]});const s="https://connect.ok.ru/dk",a=window.OK.callbacks.length;return window.ODKL={updateCount(i,r){var o,n;const c=i===""?0:parseInt(i.replace("react-share-",""),10);(n=(o=window.OK.callbacks)[c])==null||n.call(o,r===""?void 0:parseInt(r,10))}},window.OK.callbacks.push(t),yt(s+Z({"st.cmd":"extLike",uid:`react-share-${a}`,ref:e}))}vt(O1);function F1(e,{media:t,description:s,pinId:a}){return a?`https://pinterest.com/pin/${a}/repin/x/`:(te(e,"pinterest.url"),te(t,"pinterest.media"),"https://pinterest.com/pin/create/button/"+Z({url:e,media:t,description:s}))}ae("pinterest",F1,e=>({media:e.media,description:e.description,pinId:e.pinId}),{windowWidth:1e3,windowHeight:730});function D1(e,t){yt("https://api.pinterest.com/v1/urls/count.json"+Z({url:e}),(a,i)=>{t(i?i.count:void 0)})}vt(D1);function z1(e,{title:t}){return te(e,"pocket.url"),"https://getpocket.com/save"+Z({url:e,title:t})}ae("pocket",z1,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function $1(e,{title:t}){return te(e,"reddit.url"),"https://www.reddit.com/web/submit"+Z({url:e,title:t})}ae("reddit",$1,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function U1(e,{title:t}){return te(e,"gab.url"),"https://gab.com/compose"+Z({url:e,text:t})}ae("gab",U1,e=>({title:e.title}),{windowWidth:660,windowHeight:640,windowPosition:"windowCenter"});function H1(e,t){const s=`https://www.reddit.com/api/info.json?limit=1&url=${e}`;yt(s,{param:"jsonp"},(a,i)=>{t(!a&&i&&i.data&&i.data.children.length>0&&i.data.children[0].data.score?i.data.children[0].data.score:void 0)})}vt(H1);function q1(e,{title:t}){return te(e,"telegram.url"),"https://telegram.me/share/url"+Z({url:e,text:t})}ae("telegram",q1,e=>({title:e.title}),{windowWidth:550,windowHeight:400});function B1(e,{title:t}){return te(e,"threads.url"),"https://threads.net/intent/post"+Z({url:e,text:t})}ae("threads",B1,e=>({title:e.title}),{windowWidth:550,windowHeight:600});function W1(e,{title:t,caption:s,tags:a,posttype:i}){return te(e,"tumblr.url"),"https://www.tumblr.com/widgets/share/tool"+Z({canonicalUrl:e,title:t,caption:s,tags:a,posttype:i})}ae("tumblr",W1,e=>({title:e.title,tags:(e.tags||[]).join(","),caption:e.caption,posttype:e.posttype||"link"}),{windowWidth:660,windowHeight:460});function V1(e,t){return yt("https://api.tumblr.com/v2/share/stats"+Z({url:e}),(a,i)=>{t(!a&&i&&i.response?i.response.note_count:void 0)})}vt(V1);function X1(e,{title:t,via:s,hashtags:a=[],related:i=[]}){return te(e,"twitter.url"),te(Array.isArray(a),"twitter.hashtags is not an array"),te(Array.isArray(i),"twitter.related is not an array"),"https://twitter.com/intent/tweet"+Z({url:e,text:t,via:s,hashtags:a.length>0?a.join(","):void 0,related:i.length>0?i.join(","):void 0})}const K1=ae("twitter",X1,e=>({hashtags:e.hashtags,title:e.title,via:e.via,related:e.related}),{windowWidth:550,windowHeight:400});function Y1(e,{title:t,separator:s}){return te(e,"viber.url"),"viber://forward"+Z({text:t?t+s+e:e})}ae("viber",Y1,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460});function Z1(e,{title:t,image:s,noParse:a,noVkLinks:i}){return te(e,"vk.url"),"https://vk.com/share.php"+Z({url:e,title:t,image:s,noparse:a?1:0,no_vk_links:i?1:0})}ae("vk",Z1,e=>({title:e.title,image:e.image,noParse:e.noParse,noVkLinks:e.noVkLinks}),{windowWidth:660,windowHeight:460});function J1(e,t){window.VK||(window.VK={}),window.VK.Share={count:(i,r)=>{var o,n;return(n=(o=window.VK.callbacks)==null?void 0:o[i])==null?void 0:n.call(o,r)}},window.VK.callbacks=[];const s="https://vk.com/share.php",a=window.VK.callbacks.length;return window.VK.callbacks.push(t),yt(s+Z({act:"count",index:a,url:e}))}vt(J1);function Q1(e,{title:t,image:s}){return te(e,"weibo.url"),"http://service.weibo.com/share/share.php"+Z({url:e,title:t,pic:s})}ae("weibo",Q1,e=>({title:e.title,image:e.image}),{windowWidth:660,windowHeight:550,windowPosition:"screenCenter"});function eg(){return/(android|iphone|ipad|mobile)/i.test(navigator.userAgent)}function tg(e,{title:t,separator:s}){return te(e,"whatsapp.url"),"https://"+(eg()?"api":"web")+".whatsapp.com/send"+Z({text:t?t+s+e:e})}const sg=ae("whatsapp",tg,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:550,windowHeight:400});function ag(e,{quote:t,hashtag:s}){return te(e,"workplace.url"),"https://work.facebook.com/sharer.php"+Z({u:e,quote:t,hashtag:s})}ae("workplace",ag,e=>({quote:e.quote,hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});const Ar=({url:e,title:t,description:s=""})=>{const[a,i]=p.useState(!1),r=e||(typeof window<"u"?window.location.href:""),o=t||"OPIN - Observatrio Dos Professores Indgenas",n=async()=>{try{await navigator.clipboard.writeText(r),i(!0),setTimeout(()=>i(!1),2e3)}catch{const h=document.createElement("input");h.value=r,document.body.appendChild(h),h.select(),document.execCommand("copy"),document.body.removeChild(h),i(!0),setTimeout(()=>i(!1),2e3)}};return l.jsxs("span",{className:"shareBtns flex items-center",children:[l.jsx(S1,{url:r,quote:o,className:"shareIcon blackHover","aria-label":"Compartilhar no Facebook",children:l.jsx(_l,{className:"w-4 h-4"})}),l.jsx(K1,{url:r,title:o,className:"shareIcon blackHover","aria-label":"Compartilhar no Twitter",children:l.jsx(ql,{className:"w-4 h-4"})}),l.jsx(sg,{url:r,title:o,className:"shareIcon blackHover","aria-label":"Compartilhar no WhatsApp",children:l.jsx(si,{className:"w-4 h-4"})}),l.jsx("button",{onClick:n,className:"shareIcon blackHover","aria-label":a?"Link copiado":"Copiar link",title:a?"Link copiado!":"Copiar link",children:a?l.jsx(Xr,{className:"w-4 h-4"}):l.jsx(ml,{className:"w-4 h-4"})})]})},ig=e=>{if(!e)return"";const t=/^([Ee]\.?[Ee]\.?[Ii]\.?)\s*/i;if(e.match(t)){const i=e.replace(t,"").trim();return`E.E.I. ${Ia(i)}`}const a=e.toLowerCase();if(a.includes("escola estadual")&&a.includes("aldeia")){const i=e.split(" "),r=i.findIndex(o=>o.toLowerCase().includes("aldeia"));if(r!==-1&&r<i.length-1){const o=i.slice(r+1).join(" ");return`E.E.I. ${Ia(o)}`}}return Ia(e)},rg=({titulo:e,closePainel:t,toggleMaximize:s,isMaximized:a,imagemHeader:i,shareUrl:r,shareTitle:o})=>{const n=window.innerWidth<=Ra.mobile,c=n&&window.innerWidth>window.innerHeight,h=a&&(!n||c),f=h?"mj-header-half-right":"",d=h?{position:"absolute",top:0,right:0,width:"50%",background:"#ffffff",borderBottom:"1px solid rgba(5, 150, 105, 0.1)",zIndex:1e3}:{},u=c?"px-3 py-2":"px-3 sm:px-4 md:px-6 lg:px-8 py-2 sm:py-2 md:py-3",g=c?"flex flex-row items-center justify-between gap-2 pr-2":"flex flex-col sm:flex-row items-start sm:items-center justify-between pr-12",m=c?"flex-1 min-w-0":"space-y-1",y=c?"font-bold text-gray-900 leading-tight tracking-tight break-words text-[clamp(1.05rem,3.4vw,1.6rem)]":"font-bold text-gray-900 leading-tight tracking-tight break-words text-2xl sm:text-3xl md:text-4xl",x=c?"text-[11px] font-medium":"text-xs sm:text-sm font-medium",_="w-3 h-3",w=()=>c?l.jsxs("div",{className:"flex items-center gap-1 ml-2",style:{zIndex:1005},children:[r&&l.jsx("div",{className:"linkSocialContainer scale-90 origin-right",style:{zIndex:1005},children:l.jsx(Ar,{url:r,title:o||e})}),l.jsx("button",{onClick:M=>{M.stopPropagation(),t()},onMouseDown:M=>{M.stopPropagation()},className:"p-1.5 text-gray-700 hover:text-gray-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":"Fechar painel",style:{zIndex:1005},children:l.jsx(Ft,{size:18,"aria-hidden":"true",className:"stroke-2"})})]}):l.jsxs("div",{className:"absolute top-2 sm:top-4 right-2 sm:right-4 flex items-center gap-3",style:{zIndex:1005},children:[r&&l.jsx("div",{className:"linkSocialContainer",style:{zIndex:1005},children:l.jsx(Ar,{url:r,title:o||e})}),!n&&l.jsx("button",{onClick:s,className:"p-2 text-green-700 hover:text-green-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":a?"Restaurar painel":"Maximizar painel",title:a?"Restaurar":"Maximizar",style:{zIndex:1005},children:a?l.jsx(kl,{size:18,className:"stroke-2","aria-hidden":"true"}):l.jsx(Nl,{size:18,className:"stroke-2","aria-hidden":"true"})}),l.jsx("button",{onClick:M=>{M.stopPropagation(),t()},onMouseDown:M=>{M.stopPropagation()},className:"p-2 text-gray-700 hover:text-gray-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":"Fechar painel",style:{zIndex:1005},children:l.jsx(Ft,{size:20,"aria-hidden":"true",className:"stroke-2"})})]});return e?l.jsxs("header",{className:`relative border-b border-green-100 ${c?"min-h-[60px]":""}`,style:{zIndex:1e3,...d},children:[l.jsx("div",{className:`${u} ${f}`,style:{position:"relative",zIndex:1e3},children:l.jsxs("div",{className:g,children:[l.jsxs("div",{className:m,style:{position:"relative",zIndex:1015},children:[l.jsx("h2",{id:"painel-titulo",className:y,children:ig(e)}),l.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[l.jsx(Dt,{className:_,"aria-hidden":"true"}),l.jsx("span",{className:x,children:"Escola Estadual Indgena"})]})]}),c&&w()]})}),!c&&w()]}):null},ng=({imagemUrl:e,className:t="",isPreloaded:s=!1})=>{const[a,i]=p.useState(!1),r=()=>{i(!1)},o=()=>{i(!0)};return!e||a?null:l.jsxs("div",{className:`escola-header-image escola-header-shimmer relative overflow-hidden ${t}`,children:[l.jsx("div",{className:"absolute inset-0",children:l.jsx(Ms,{src:e,alt:"Imagem da escola",className:"w-full h-full object-cover transition-all duration-700 ease-out",style:{filter:"saturate(1.3)"},isPreloaded:s,onLoad:r,onError:o})}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/20 via-black/10 to-black/30"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),l.jsx("div",{className:"absolute inset-0 opacity-5",children:l.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.05)_0%,transparent_50%)]"})}),l.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-radial from-white/5 to-transparent rounded-full blur-xl"})]})},og=({escolaId:e,refreshKey:t=0,showTeacher:s=!0,showSchool:a=!0,scrollProgress:i,headerUrl:r,onCurrentItemChange:o})=>{const n=r?[{id:`header-${e||"temp"}`,url:r,titulo:"",descricao:"",autor:"",dataFoto:"",origem:"capa"}]:[],[c,h]=p.useState(n),[f,d]=p.useState(0),[u,g]=p.useState(!0),[m,y]=p.useState(""),{isImagePreloaded:x}=Es(e,!0),[_,w]=p.useState(0),[M,b]=p.useState(new Map),C=p.useCallback(async(T,D)=>{const{data:K,error:J}=await fe.storage.from(T).list(`${e}/`);if(J)throw J;if(!K||K.length===0)return[];const z=await Promise.all(K.map(async(oe,de)=>{const Ie=`${e}/${oe.name}`,{data:{publicUrl:Je}}=fe.storage.from(T).getPublicUrl(Ie);let Y=null;try{Y=await ei(Ie,e,{categoria:D,tipo_foto:D})}catch{}return{id:`${T}-${oe.name}`,url:Je,filePath:Ie,titulo:Y?.legenda||`Imagem ${de+1}`,descricao:Y?.descricao_detalhada||"",autor:Y?.autor_foto||"",dataFoto:Y?.data_foto||"",origem:D,ordem:Y?.ordem||1/0}}));return z.sort((oe,de)=>oe.ordem!==de.ordem?oe.ordem-de.ordem:0),z},[e]);p.useEffect(()=>{if(r){const T={id:`header-${e||"temp"}`,url:r,titulo:"",descricao:"",autor:"",dataFoto:"",origem:"capa"};h(D=>{if(D.some(z=>z.origem==="capa"&&z.url===r))return D;const J=D.filter(z=>z.origem!=="capa");return[T,...J]})}},[r,e]),p.useEffect(()=>{let T=!0;if(!e){g(!1);return}return g(!0),y(""),(async()=>{try{const D=[];a&&D.push(C("imagens-das-escolas","escola")),s&&D.push(C("imagens-professores","professor"));let J=(await Promise.all(D)).flat();if(r){const oe=J.some(Ie=>Ie.url===r),de={id:`header-${e}`,url:r,titulo:"",descricao:"",autor:"",dataFoto:"",origem:"capa"};J=oe?J:[de,...J]}if(!T)return;const z=J.sort((oe,de)=>oe.origem==="capa"?-1:de.origem==="capa"?1:oe.origem.localeCompare(de.origem));h(z),d(0)}catch{if(!T)return;y("Erro ao carregar imagens.")}finally{T&&g(!1)}})(),()=>{T=!1}},[e,t,C,a,s,r]);const S=c.length>0,E=p.useMemo(()=>!S||f<0||f>=c.length?null:c[f]||null,[c,f,S]),G=p.useMemo(()=>{if(!E||!E.url)return!1;const T=M.get(E.url);return T!==void 0&&T<1},[E,M]),I=p.useCallback(T=>{if(!E||!E.url)return;const D=T.target||T.currentTarget;if(D&&D.naturalWidth&&D.naturalHeight){const K=D.naturalWidth/D.naturalHeight;b(J=>new Map(J).set(E.url,K))}},[E]);p.useEffect(()=>{o&&E&&o(E)},[E,o]),p.useEffect(()=>{if(!S||typeof i!="number"||Date.now()<_)return;const T=Math.floor(i*Math.max(0,c.length-1));Number.isFinite(T)&&T!==f&&d(T)},[i,S,c.length,f,_]);const H=p.useCallback(()=>{S&&(d(T=>T>0?T-1:c.length-1),w(Date.now()+1200))},[S,c.length]),F=p.useCallback(()=>{S&&(d(T=>T<c.length-1?T+1:0),w(Date.now()+1200))},[S,c.length]);return m&&!S?l.jsx("div",{className:"text-red-600",children:m}):!u&&!S?l.jsx("div",{className:"text-gray-600",children:"Nenhuma imagem disponvel."}):l.jsx("div",{className:"h-full w-full relative",children:l.jsxs("div",{className:"absolute inset-0",children:[S&&c.length>1&&l.jsxs(l.Fragment,{children:[l.jsx("button",{type:"button",className:"absolute left-3 top-1/2 -translate-y-1/2 z-10 bg-white/80 hover:bg-white text-gray-700 rounded-full p-2 shadow",onClick:H,"aria-label":"Imagem anterior",children:l.jsx(ti,{className:"w-5 h-5"})}),l.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 z-10 bg-white/80 hover:bg-white text-gray-700 rounded-full p-2 shadow",onClick:F,"aria-label":"Prxima imagem",children:l.jsx(xs,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"w-full h-full bg-black/5 overflow-y-auto overflow-x-hidden flex items-start justify-center",children:[E&&l.jsx(l.Fragment,{children:E.origem==="capa"?l.jsx("img",{src:E.url,alt:E.titulo||"Imagem",className:G?"w-full object-contain":"w-full h-full object-cover",style:{maxHeight:G?"none":"100%",minHeight:G?"100%":"auto",maxWidth:"100%",display:"block",objectPosition:G?"top center":"center center",filter:"saturate(1.3)"},loading:"eager",fetchpriority:"high",decoding:"async",onLoad:I}):l.jsx(Ms,{src:E.url,alt:E.titulo||"Imagem",className:G?"w-full object-contain":"w-full h-full object-cover",isPreloaded:x(E.url),priority:"high",style:{maxHeight:G?"none":"100%",minHeight:G?"100%":"auto",maxWidth:"100%",objectPosition:G?"top center":"center center"},onLoad:T=>{if(!E||!E.url)return;const D=T?.target||document.querySelector(`img[src="${E.url}"]`);if(D&&D.naturalWidth&&D.naturalHeight){const K=D.naturalWidth/D.naturalHeight;b(J=>new Map(J).set(E.url,K))}}})}),u&&S&&l.jsx("div",{className:"absolute top-4 right-4 z-20 bg-white/90 px-3 py-1.5 rounded-full text-xs text-gray-600 shadow",children:"Carregando mais imagens..."})]}),E&&l.jsx("div",{className:"absolute bottom-3 left-3 right-3 z-10 flex",children:l.jsxs("div",{className:"text-white px-3 py-2",style:{backgroundColor:"rgba(0,0,0,0.88)",borderRadius:"8px",maxWidth:"80%"},children:[E.titulo&&l.jsx("h4",{className:"text-sm font-semibold m-0",children:E.titulo}),l.jsxs("div",{className:"text-[11px] mt-0.5 space-x-2",children:[E.origem&&l.jsx("span",{className:"capitalize",children:E.origem}),E.autor&&l.jsxs("span",{children:["Por: ",E.autor]}),E.dataFoto&&l.jsx("span",{children:na(E.dataFoto)})]}),E.descricao&&l.jsx("p",{className:"text-xs mt-1 m-0",children:E.descricao})]})})]})})},lg=ee.memo(og),cg=e=>{const[t,s]=p.useState(!1),{isMobile:a}=Gr();return p.useEffect(()=>(e&&typeof e=="object"?(s(!0),document.body.style.overflow="hidden"):(s(!1),document.body.style.overflow=""),()=>{document.body.style.overflow=""}),[e]),{isVisible:t,isMobile:a}},hg=(e,t)=>{const[s,a]=p.useState(window.innerWidth),[i,r]=p.useState(window.innerHeight),o={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};return p.useEffect(()=>{const c=()=>{a(window.innerWidth),r(window.innerHeight)};return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]),p.useMemo(()=>{const c=e&&s>i,h="100vh",f="100vh",d=s>=o.md,u=d&&t;let g;return e?g="100%":g=t?"100%":s>=o.lg?"49%":"75%",{height:h,maxHeight:f,width:g,isDesktop:d,isMobileLandscape:c,shouldUseGrid:u,breakpoints:o,zIndex:1e3}},[e,t,s,i])},dg=({painelInfo:e,closePainel:t,children:s,isMaximized:a,onToggleMaximize:i,contentRef:r,rightNav:o,refreshKey:n,shareUrl:c,shareTitle:h})=>{const[f,d]=p.useState(0),{isVisible:u,isMobile:g}=cg(e),m=hg(g,a),y=m.isMobileLandscape,x=g&&!y,_=!x,w=_&&(a||y),{isImagePreloaded:M}=Es(e?.id,!0);if(p.useEffect(()=>{if(e?.imagem_header&&u){const G=new Image;G.src=e.imagem_header;const I=document.createElement("link");return I.rel="preload",I.as="image",I.href=e.imagem_header,"fetchPriority"in I&&(I.fetchPriority="high"),document.head.appendChild(I),()=>{I.parentNode===document.head&&document.head.removeChild(I)}}},[e?.imagem_header,u]),!e)return null;const b=`
    fixed
    ${x?"inset-x-0 top-0 w-full h-full":"top-0 bottom-0 right-0 w-full sm:w-3/4 lg:w-[49%] h-auto"}
    rounded-t-xl shadow-xl z-[9999] transform transition-all duration-500 ease-in-out
    bg-white border-t-4 border-white mj-panel
  `,C=u?"translate-y-0 opacity-100":"translate-y-full opacity-0",E=typeof s=="function"?s({isMobile:g,isMobilePortrait:x,isMobileLandscape:y,shouldUseDesktopLayout:_,useSplitLayout:w}):s;return l.jsxs("div",{role:"dialog","aria-labelledby":"painel-titulo","aria-describedby":"painel-descricao","aria-modal":"true",className:`${b} ${C}${x?" painel-informacoes-mobile":""}${w?" mj-maximized":""}${w&&y?" mj-mobile-landscape":""}`,style:{height:m.height,maxHeight:m.maxHeight,width:x?"100%":m.width,top:0,display:"flex",flexDirection:"column",position:"fixed",...x&&{borderRadius:m.isMobileLandscape?"0":"1rem 1rem 0 0",boxShadow:m.isMobileLandscape?"0 0 0 0":"0 -4px 6px -1px rgba(0, 0, 0, 0.1), 0 -2px 4px -1px rgba(0, 0, 0, 0.06)"}},children:[l.jsx(rg,{titulo:e.titulo,closePainel:t,toggleMaximize:i,isMaximized:a,imagemHeader:e.imagem_header,shareUrl:c,shareTitle:h}),o&&l.jsx("div",{className:"hidden sm:flex flex-col gap-1 absolute right-0 top-1/2 -translate-y-1/2 z-[10000]",children:o}),w?l.jsxs("div",{className:"flex-1 mj-split",children:[l.jsx("aside",{className:"mj-split-left",children:l.jsx(lg,{escolaId:e.id,refreshKey:n||0,scrollProgress:f,headerUrl:e.imagem_header})}),l.jsx("div",{ref:r,className:"mj-split-right overflow-y-auto mj-panel-content",onScroll:G=>{const I=G.currentTarget,H=I.scrollHeight-I.clientHeight,F=H>0?I.scrollTop/H:0;d(Math.min(1,Math.max(0,F)))},children:l.jsx("div",{className:`${x?"p-3 sm:p-4":"p-6"} space-y-4 sm:space-y-5`,children:l.jsx("div",{className:"prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none mj-prose",children:E})})})]}):l.jsxs("div",{ref:r,className:"flex-1 overflow-y-auto mj-panel-content",children:[e.imagem_header&&l.jsx(ng,{imagemUrl:e.imagem_header,className:"h-56 sm:h-64 md:h-72 lg:h-80 xl:h-96 w-full",isPreloaded:M(e.imagem_header)}),l.jsx("div",{className:`${x?"p-3 sm:p-4":"p-6"} space-y-4 sm:space-y-5 -mt-2`,children:l.jsx("div",{className:"prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none mj-prose",children:E})})]})]})},ug=ee.memo(dg),fg=e=>{if(!e||typeof e!="string")return null;const t=e.match(/\/d\/([a-zA-Z0-9-_]+)/);return t?`https://docs.google.com/gview?url=https://drive.google.com/uc?id=${t[1]}&embedded=true`:null},mg=({viewMode:e,setViewMode:t})=>l.jsxs("div",{className:"flex items-center gap-2",role:"tablist","aria-label":"Modos de visualizao dos documentos",children:[l.jsxs("button",{type:"button",role:"tab","aria-selected":e==="list","aria-label":"Visualizar em lista",onClick:()=>t("list"),className:`p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ${e==="list"?"bg-green-100 text-green-800 font-semibold":"text-gray-600 hover:bg-gray-100"}`,tabIndex:0,children:[l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),l.jsx("span",{className:"hidden sm:inline",children:"Lista"})]}),l.jsxs("button",{type:"button",role:"tab","aria-selected":e==="grid","aria-label":"Visualizar em grade",onClick:()=>t("grid"),className:`p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ${e==="grid"?"bg-green-100 text-green-800 font-semibold":"text-gray-600 hover:bg-gray-100"}`,tabIndex:0,children:[l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),l.jsx("span",{className:"hidden sm:inline",children:"Grade"})]})]}),gg=({documentos:e,title:t="Documentos"})=>{const[s,a]=p.useState(null),[i,r]=p.useState("list"),o=p.useRef(null),[n,c]=p.useState(!1),[h,f]=p.useState(!1);if(p.useEffect(()=>{s&&(c(!1),f(!1))},[s]),p.useEffect(()=>{!s&&e?.length>0&&a(e[0])},[e,s]),p.useEffect(()=>{const m=o.current;if(!m||!s)return;const y=()=>{c(!1)},x=()=>{c(!0),f(!0)};return m.addEventListener("load",y),m.addEventListener("error",x),()=>{m.removeEventListener("load",y),m.removeEventListener("error",x)}},[s]),!e||e.length===0)return null;const d=()=>l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:e.map(m=>l.jsx("div",{className:`
              flex flex-col justify-between h-full max-w-xs mx-auto
              rounded-2xl cursor-pointer
              shadow-sm
              ${s?.id===m.id?"bg-green-100 scale-[1.03]":"bg-white"}
            `,onClick:()=>{a(m)},tabIndex:0,"aria-label":`Selecionar documento: ${m.titulo}`,children:l.jsxs("div",{className:"p-5 flex-1 flex flex-col justify-between",children:[l.jsx("h4",{className:"font-semibold text-green-800 mb-2 line-clamp-2 text-lg",children:m.titulo}),m.autoria&&l.jsxs("p",{className:"text-sm text-gray-600 mb-2 line-clamp-1",children:["Por: ",m.autoria]}),m.tipo&&l.jsx("span",{className:"inline-block px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full",children:m.tipo})]})},m.id))}),u=()=>l.jsx("div",{className:"space-y-2",children:e.map(m=>l.jsxs("button",{onClick:()=>{a(m)},className:`w-full text-left p-3 rounded-lg ${s?.id===m.id?"bg-green-100":""}`,children:[l.jsx("h4",{className:"font-medium text-green-800",children:m.titulo}),m.autoria&&l.jsxs("p",{className:"text-sm text-gray-600",children:["Por: ",m.autoria]}),m.tipo&&l.jsx("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full",children:m.tipo})]},m.id))}),g=()=>{if(!s)return null;const m=s.link_pdf.includes("drive.google.com/file/d/");return l.jsx("div",{className:"rounded-lg overflow-hidden shadow-lg bg-white",children:m?l.jsxs(l.Fragment,{children:[h?l.jsx("iframe",{ref:o,src:fg(s.link_pdf),width:"100%",height:"500px",allow:"autoplay",loading:"lazy",title:`${s.titulo} (Google Docs Viewer)`,sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",className:"bg-white"}):l.jsx("iframe",{ref:o,src:s.link_pdf.replace("/view?usp=sharing","/preview"),width:"100%",height:"500px",allow:"autoplay",loading:"lazy",title:s.titulo,sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",className:"bg-white"}),n&&l.jsxs("div",{className:"p-6 text-center text-gray-600 bg-green-100",children:[l.jsx("p",{className:"mb-3 text-lg",children:"No foi possvel carregar o documento diretamente."}),l.jsxs("a",{href:s.link_pdf,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Abrir em nova aba"]})]})]}):l.jsx("div",{className:"flex justify-center p-6",children:l.jsxs("a",{href:s.link_pdf,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Ver documento PDF"]})})})};return l.jsxs("div",{className:"mt-8 max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h3",{className:"text-xl font-semibold text-green-800",children:[t,":"]}),e.length>1&&l.jsx(mg,{viewMode:i,setViewMode:r})]}),e.length>1&&l.jsx("div",{className:"mb-6",children:i==="grid"?d():u()}),g()]})},pg=ee.memo(gg),xg=e=>{if(!e||typeof e!="string")return null;const t=e.split("?")[0],s=[/youtube\.com\/embed\/([^/?&]+)/,/youtube\.com\/watch\?v=([^&]+)/,/youtu\.be\/([^?&]+)/,/youtube\.com\/v\/([^?&]+)/];for(const a of s){const i=t.match(a);if(i&&i[1])return i[1]}return null},yg=({videoUrl:e,title:t="Vdeo",escolaId:s})=>{const[a,i]=p.useState(null),[,r]=p.useState(!1);if(p.useEffect(()=>{(async()=>{if(!(!e||!s))try{r(!0);const c=await sl(e,s);i(c)}catch(c){console.warn("Erro ao buscar ttulo personalizado:",c)}finally{r(!1)}})()},[e,s]),!e)return null;const o=xg(e);return o?l.jsxs("div",{className:"mt-8 max-w-4xl mx-auto",children:[l.jsxs("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[a?.titulo||t,":"]}),a&&l.jsxs("div",{className:"mb-4 p-4 bg-green-100 rounded-lg",children:[a.descricao&&l.jsx("p",{className:"text-gray-700 mb-2",children:a.descricao}),l.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.categoria&&l.jsx("span",{className:"capitalize bg-green-200 text-green-800 px-2 py-1 rounded",children:a.categoria}),a.plataforma&&l.jsx("span",{className:"capitalize",children:a.plataforma}),a.duracao&&l.jsxs("span",{children:["Durao: ",a.duracao]})]})]}),l.jsx("div",{className:"rounded-lg overflow-hidden shadow-lg bg-white",children:l.jsx("div",{className:"relative pb-[56.25%] h-0",children:l.jsx("iframe",{className:"absolute top-0 left-0 w-full h-full",src:`https://www.youtube.com/embed/${o}`,title:a?.titulo||t,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy",referrerPolicy:"origin"})})})]}):l.jsxs("div",{className:"mt-8 max-w-4xl mx-auto",children:[l.jsxs("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[a?.titulo||t,":"]}),l.jsxs("div",{className:"p-6 text-center text-gray-600 bg-gray-50 rounded-lg",children:[l.jsx("p",{className:"mb-3 text-lg",children:"Link do vdeo invlido ou no suportado."}),l.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[l.jsxs("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Tentar abrir no YouTube"]})]})]})},Ir=ee.memo(yg),vg=({painelInfo:e,closePainel:t,escola_id:s,refreshKey:a=0})=>{const i=p.useRef(null),r=p.useRef(null),o=p.useRef({}),n=p.useRef(!1);p.useEffect(()=>{e&&new URLSearchParams(window.location.search).get("panel")&&(n.current=!0)},[e]);const[c,h]=p.useState(()=>{if(new URLSearchParams(window.location.search).get("panel"))return!0;try{const E=localStorage.getItem("opin:painelIsMaximized");if(E==="true")return!0;if(E==="false")return!1}catch{}return!0}),{gerarLinkCustomizado:f}=Zf(e),{documentos:d}=em(e?.id),[u,g]=p.useState(!1),[m,y]=p.useState([]),x=()=>{h(S=>{const E=!S;try{localStorage.setItem("opin:painelIsMaximized",String(E))}catch{}return E})};p.useEffect(()=>{if(e)if(new URLSearchParams(window.location.search).get("panel")){h(!0);try{localStorage.setItem("opin:painelIsMaximized","true")}catch{}}else try{const G=localStorage.getItem("opin:painelIsMaximized");G==="true"?h(!0):G==="false"&&h(!1)}catch{}},[e]),Jf(e,f),Qf(i,()=>{r.current&&(r.current.scrollTop=0),t()}),p.useEffect(()=>{console.log("PainelInformacoes: refreshKey mudou para",a)},[a]),p.useEffect(()=>{let S=!0;async function E(){try{g(!1),y([]);const G=e?.id;if(!G)return;const I=await Qo(G);if(!S)return;Array.isArray(I)&&I.length>0&&(g(!0),y(I))}catch{if(!S)return;g(!1),y([])}}return E(),()=>{S=!1}},[e?.id,a]);const{globalVisibility:_}=Kr();if(!e)return null;const w=e.tipo==="terra_indigena",M=e.titulo==="Sobre o site",b=(S={})=>{const{useSplitLayout:E=!1}=S,G=e?.cards_visibilidade;return M?l.jsx(a1,{painelInfo:e}):w?l.jsx(Im,{terraIndigena:e}):l.jsxs("div",{className:"relative",children:[l.jsx(jm,{escola:e,shouldUseGrid:!0,refreshKey:a,sectionRefs:o.current,isMaximized:c,shouldHideInlineMedia:E}),Pt(G,"documentos",_)&&d&&d.length>0&&l.jsx(pg,{documentos:d,title:"Produes e materiais da escola"}),Pt(G,"videos",_)&&(e.link_para_videos||u)&&l.jsx("div",{ref:I=>o.current.videos=I,children:e.link_para_videos?l.jsx(Ir,{videoUrl:e.link_para_videos,title:l.jsx("span",{style:{fontSize:"0.75em"},children:`Produes realizadas na ${e.titulo}`}),escolaId:e.id}):m.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-semibold text-green-800 mb-4",style:{fontSize:"0.75em"},children:`Produes realizadas na ${e.titulo}`}),m.map((I,H)=>l.jsx("div",{className:H>0?"mt-8":"",children:l.jsx(Ir,{videoUrl:I.video_url,title:I.titulo||l.jsx("span",{style:{fontSize:"0.75em"},children:`Produes audiovisuais realizadas na ${e.titulo}`}),escolaId:e.id})},I.id||H))]})})]})},C=e?f():"";return l.jsx("div",{ref:i,children:l.jsx(ug,{painelInfo:e,closePainel:t,isMaximized:c,onToggleMaximize:x,contentRef:r,refreshKey:a,rightNav:null,shareUrl:C,shareTitle:e?.titulo,children:S=>b(S)})})},_g=ee.memo(vg),Cg=({dataPoints:e,onPainelOpen:t,isLoading:s=!1})=>{_e.debug("DataPoints recebidos no MapaEscolasIndigenas:",e?{quantidade:e.length,exemplo:e[0]?{titulo:e[0].titulo,latitude:e[0].Latitude,longitude:e[0].Longitude,tipo:e[0].tipo}:"Nenhum ponto"}:"Nenhum dataPoint");const{refreshKey:a}=Kn(),i=Yn(),r=Zn(),o=p.useMemo(()=>new URLSearchParams(i.search||"").get("panel"),[i.search]),n=p.useMemo(()=>i.state?.schoolData?i.state.schoolData:o&&o!==""&&e&&e.length>0&&e.find(_=>Lr(_.titulo)===o)||null,[o,e,i.state]),[c,h]=p.useState(null),[f,d]=p.useState(!1),u=p.useMemo(()=>e?e.filter(x=>x.pontuacao>=0):[],[e]),g=p.useCallback(x=>{x&&h(x)},[]),m=p.useCallback(()=>{},[]);p.useEffect(()=>{if(n&&!f&&o){_e.debug("MapaEscolasIndigenas: Abrindo painel automaticamente da URL para:",n.titulo),h(n),d(!0);try{localStorage.setItem("opin:painelIsMaximized","true")}catch(x){console.warn("Erro ao salvar estado de maximizao:",x)}}!o&&f&&d(!1)},[n,f,o]),p.useEffect(()=>{if(i.state?.schoolData){const x=i.state.schoolData;(!c||c.id!==x.id)&&(_e.debug("MapaEscolasIndigenas: Abrindo painel a partir do navigation state:",x.titulo),h(x))}},[i.state?.schoolData,c]),p.useEffect(()=>{t&&typeof t=="function"&&t(g,m)},[g,t,m]);const y=p.useCallback(()=>{h(null),d(!1);const x=new URLSearchParams(i.search);x.has("panel")&&x.delete("panel");const _=x.toString(),w=`${i.pathname}${_?`?${_}`:""}${i.hash||""}`;let M=i.state||null;if(M&&typeof M=="object"&&"schoolData"in M){const{schoolData:b,...C}=M;M=Object.keys(C).length>0?C:null}r(w,{replace:!0,state:M})},[i.hash,i.pathname,i.search,i.state,r]);return l.jsxs("div",{className:"relative h-screen w-full overflow-hidden",children:[l.jsx(Yf,{dataPoints:u,onPainelOpen:g,painelAberto:!!c,className:"h-full w-full",isMainLoading:s}),c&&l.jsx(_g,{painelInfo:c,closePainel:y,refreshKey:a})]})};export{Cg as default};
