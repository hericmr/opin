"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[248],{26092:(e,o,a)=>{a.r(o),a.d(o,{default:()=>ya});var t=a(65043),s=a(1642),r=a(75351),n=a(56528),l=a(99468),i=a(62463),c=a(41060),d=a(9333),m=a(89826),u=(a(43976),a(35366)),g=a(20495),h=a(63104),x=a(43241),p=a(45921),f=a(85263),b=a(73361),v=a(61247),w=a(47790);const j="".concat("/opin","/map-marker.svg"),y=function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=e.get("markerData")||e.get("schoolData"),t=e.get("isNearbyPair");if(!a)return null;const s=new p.Ay({image:new f.A({src:j,scale:t?1.2:1,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction"}),geometry:e.getGeometry()});if(o&&a.titulo){return[s,new p.Ay({text:new b.A({text:a.titulo,font:"12px Arial",fill:new v.A({color:"#1F2937"}),stroke:new w.A({color:"#FFFFFF",width:2}),offsetY:-15,textAlign:"center"}),geometry:e.getGeometry()})]}return s};var N=a(89379);const k=()=>{const e=window.innerWidth<=768,o="ontouchstart"in window||navigator.maxTouchPoints>0,a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t=void 0!==window.orientation,s=[e,o,a,t].filter(Boolean).length;return console.log("[mobileUtils] Crit\xe9rios de mobile:",{isMobileWidth:e,hasTouch:o,isMobileUserAgent:a,isMobileOrientation:t,mobileCriteria:s,userAgent:navigator.userAgent}),s>=2};class C{constructor(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.map=e,this.options=(0,N.A)({enableHover:!1!==o.enableHover,enableClick:!1!==o.enableClick,enableDoubleClick:!1!==o.enableDoubleClick,enableTouch:!1!==o.enableTouch,hoverDelay:o.hoverDelay||200,clickDelay:o.clickDelay||300},o),this.eventHandlers=new Map,this.hoveredFeature=null,this.clickedFeature=null,this.clickTimeout=null,this.hoverTimeout=null,this.tooltipElement=null,console.log("[OpenLayersInteractions] Intera\xe7\xf5es inicializadas"),this.initializeInteractions()}isMobile(){const e=k(),o="ontouchstart"in window||navigator.maxTouchPoints>0;return console.log("[OpenLayersInteractions] Detec\xe7\xe3o de mobile:",{mobile:e,hasTouch:o,windowWidth:window.innerWidth,userAgent:navigator.userAgent}),e||o}initializeInteractions(){this.options.enableHover&&this.setupHoverInteraction(),this.options.enableClick&&this.setupClickInteraction(),this.options.enableDoubleClick&&this.setupDoubleClickInteraction(),this.options.enableTouch&&this.isMobile()&&this.setupTouchInteraction()}setupHoverInteraction(){this.map.on("pointermove",(e=>{this.handlePointerMove(e)})),this.map.on("pointerleave",(()=>{this.handlePointerLeave()}))}setupClickInteraction(){this.map.on("click",(e=>{this.handleClick(e)}))}setupDoubleClickInteraction(){this.map.on("dblclick",(e=>{this.handleDoubleClick(e)}))}setupTouchInteraction(){console.log("[OpenLayersInteractions] Touch interaction configurada para mobile")}handlePointerMove(e){if(this.isMobile())return;const o=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));o&&!this.hoveredFeature&&console.log("[OpenLayersInteractions] Feature detectado:",{type:o.get("type"),schoolData:o.get("schoolData"),terraIndigenaInfo:o.get("terraIndigenaInfo")}),o!==this.hoveredFeature&&(this.hoveredFeature&&this.clearHover(),o&&this.applyHover(o,e))}handlePointerLeave(){this.clearHover()}handleClick(e){const o=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));o&&(this.isMobile()?this.handleMobileClick(o,e):this.clickedFeature!==o?(this.clickedFeature=o,this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout((()=>{this.clickedFeature=null}),this.options.clickDelay),this.executeClickHandler(o,e)):this.handleDoubleClick(e))}handleDoubleClick(e){const o=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));o&&(this.clickTimeout&&(clearTimeout(this.clickTimeout),this.clickTimeout=null),this.clickedFeature=null,this.executeDoubleClickHandler(o,e))}handleTouchEnd(e){const o=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));o&&this.executeClickHandler(o,e)}handleMobileClick(e,o){if(this.clickedFeature===e)return console.log("[OpenLayersInteractions] Segundo clique em mobile - abrindo painel"),this.forceHideTooltip(),void this.executeClickHandler(e,o);console.log("[OpenLayersInteractions] Primeiro clique em mobile - mostrando tooltip"),this.clickedFeature=e,this.options.showTooltip&&this.showTooltip(e,o),this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout((()=>{console.log("[OpenLayersInteractions] Timeout mobile - escondendo tooltip e resetando"),this.forceHideTooltip()}),3e3),this.executeHoverHandler(e,o)}applyHover(e,o){this.hoveredFeature=e,this.applyHoverStyle(e),this.options.showTooltip&&!this.isMobile()&&this.showTooltip(e,o),this.executeHoverHandler(e,o)}clearHover(){this.hoveredFeature&&(this.clearHoverStyle(this.hoveredFeature),this.isMobile()||this.hideTooltip(),this.executeHoverOutHandler(this.hoveredFeature),this.hoveredFeature=null)}applyHoverStyle(e){this.options.hoverStyleFunction&&this.options.hoverStyleFunction(e,!0)}clearHoverStyle(e){this.options.hoverStyleFunction&&this.options.hoverStyleFunction(e,!1)}showTooltip(e,o){this.tooltipElement&&this.hideTooltip();const a=this.getTooltipContent(e);console.log("[OpenLayersInteractions] Conte\xfado do tooltip:",a),a?(this.tooltipElement=this.createTooltipElement(a,o),this.map.getTargetElement().appendChild(this.tooltipElement),console.log("[OpenLayersInteractions] Tooltip criado e adicionado ao DOM")):console.log("[OpenLayersInteractions] Sem conte\xfado para tooltip")}hideTooltip(){this.tooltipElement&&(this.tooltipElement.remove(),this.tooltipElement=null,console.log("[OpenLayersInteractions] Tooltip escondido"))}forceHideTooltip(){this.hideTooltip(),this.clickTimeout&&(clearTimeout(this.clickTimeout),this.clickTimeout=null),this.clickedFeature=null,console.log("[OpenLayersInteractions] Tooltip for\xe7adamente escondido e estado resetado")}createTooltipElement(e,o){const a=document.createElement("div");a.className="ol-tooltip";const t=e.includes("Terra Ind\xedgena");if(this.isMobile()){const s='<span class="tooltip-clickable">'.concat(e,"</span>");a.innerHTML=s;const r=t?{backgroundColor:"#fef2f2",borderColor:"rgba(239, 68, 68, 0.3)"}:{backgroundColor:"#bbf7d0",borderColor:"rgba(34, 197, 94, 0.3)"};Object.assign(a.style,(0,N.A)({position:"absolute",padding:"8px 12px",borderRadius:"8px",fontSize:"14px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontWeight:"700",color:"#000000",pointerEvents:"auto",zIndex:"1000",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",border:"2px solid ".concat(r.borderColor),cursor:"default"},r));const n=a.querySelector(".tooltip-clickable");n&&(Object.assign(n.style,{cursor:"pointer",textDecoration:"underline",textDecorationColor:"#3B82F6",textDecorationThickness:"2px",transition:"all 0.2s ease",display:"inline-block",padding:"2px 4px",borderRadius:"4px",fontWeight:"800"}),n.addEventListener("click",(()=>{console.log("[OpenLayersInteractions] Nome clicado no tooltip mobile");const e=this.map.forEachFeatureAtPixel(o.pixel,(e=>e));e&&this.executeClickHandler(e,o)})),n.addEventListener("mouseenter",(()=>{n.style.backgroundColor="rgba(59, 130, 246, 0.1)",n.style.textDecorationColor="#1D4ED8",n.style.transform="scale(1.05)"})),n.addEventListener("mouseleave",(()=>{n.style.backgroundColor="transparent",n.style.textDecorationColor="#3B82F6",n.style.transform="scale(1)"})))}else{a.innerHTML=e;const o=t?{backgroundColor:"#fef2f2"}:{backgroundColor:"#bbf7d0"};Object.assign(a.style,(0,N.A)({position:"absolute",padding:"6px 10px",borderRadius:"6px",fontSize:"12px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontWeight:"700",color:"#000000",pointerEvents:"none",zIndex:"1000",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},o))}const s=o.coordinate,r=this.map.getPixelFromCoordinate(s);return a.style.left=r[0]+10+"px",a.style.top=r[1]-10+"px",a}getTooltipContent(e){if(console.log("[OpenLayersInteractions] Obtendo conte\xfado do tooltip para feature:",{type:e.get("type"),schoolData:e.get("schoolData"),terraIndigenaInfo:e.get("terraIndigenaInfo")}),this.options.tooltipContentFunction){const o=this.options.tooltipContentFunction(e);return console.log("[OpenLayersInteractions] Conte\xfado do tooltip (fun\xe7\xe3o customizada):",o),o}const o=e.get("schoolData");if(o){const e=o.titulo||"Escola Ind\xedgena";return console.log("[OpenLayersInteractions] T\xedtulo extra\xeddo (padr\xe3o):",e),console.log("[OpenLayersInteractions] Conte\xfado do tooltip (padr\xe3o escola - FOR\xc7ADO apenas t\xedtulo):",e),e}const a=e.get("terraIndigenaInfo");if(a){const e="Terra Ind\xedgena ".concat(a.titulo||"Ind\xedgena");return console.log("[OpenLayersInteractions] Conte\xfado do tooltip (padr\xe3o terra ind\xedgena):",e),e}return console.log("[OpenLayersInteractions] Nenhum conte\xfado encontrado para tooltip"),null}executeClickHandler(e,o){const a=this.eventHandlers.get("click");a&&"function"===typeof a&&a(e,o)}executeDoubleClickHandler(e,o){const a=this.eventHandlers.get("doubleClick");a&&"function"===typeof a&&a(e,o)}executeHoverHandler(e,o){const a=this.eventHandlers.get("hover");a&&"function"===typeof a&&a(e,o)}executeHoverOutHandler(e){const o=this.eventHandlers.get("hoverOut");o&&"function"===typeof o&&o(e)}on(e,o){this.eventHandlers.set(e,o)}off(e){this.eventHandlers.delete(e)}clearHandlers(){this.eventHandlers.clear()}updateOptions(e){this.options=(0,N.A)((0,N.A)({},this.options),e),e.enableHover,e.enableClick}destroy(){this.clickTimeout&&clearTimeout(this.clickTimeout),this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.hideTooltip(),this.clearHover(),this.clearHandlers()}}function A(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new C(e,(0,N.A)((0,N.A)({},{enableHover:!0,enableClick:!0,enableDoubleClick:!0,enableTouch:!0,showTooltip:!0,hoverDelay:200,clickDelay:300}),o))}const _=0,E=1,I=2,S=3,L=S,z={debug:function(){if(L<=_){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];console.log("[DEBUG]",...o)}},info:function(){if(L<=E){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];console.info("[INFO]",...o)}},warn:function(){if(L<=I){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];console.warn("[WARN]",...o)}},error:function(){if(L<=S){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];console.error("[ERROR]",...o)}},group:e=>{L<=_&&console.group(e)},groupEnd:()=>{L<=_&&console.groupEnd()}};var P=a(70579);const M=e=>{let{dataPoints:o=[],onPainelOpen:a,showMarcadores:s=!0,showNomesEscolas:r=!1,map:n,className:l="h-full w-full"}=e;const c=(0,t.useRef)(null),d=(0,t.useRef)(null),[,m]=t.useState(null),b=(0,t.useCallback)((()=>{n&&(z.debug("[OpenLayersMarkers] Inicializando marcadores individuais..."),c.current=new g.A,d.current=new u.A({source:c.current,style:e=>y(e,r),zIndex:100}),n.addLayer(d.current),v())}),[n,r]),v=(0,t.useCallback)((()=>{if(!n||!d.current)return;z.debug("[OpenLayersMarkers] Configurando intera\xe7\xf5es com tooltips...");const e=function(e,o,a){console.log("[createMarkerInteractions] Criando intera\xe7\xf5es para marcadores...");const t=A(e,{showTooltip:!0,tooltipContentFunction:e=>{console.log("[createMarkerInteractions] Fun\xe7\xe3o de conte\xfado do tooltip chamada para:",e);const o=e.get("schoolData");if(o){const e=o.titulo||"Escola Ind\xedgena";return console.log("[createMarkerInteractions] T\xedtulo extra\xeddo:",e),console.log("[createMarkerInteractions] Conte\xfado do tooltip gerado (FOR\xc7ADO apenas t\xedtulo):",e),e}return console.log("[createMarkerInteractions] Sem dados de escola para tooltip"),null}});return o&&(console.log("[createMarkerInteractions] Configurando handler de clique personalizado"),t.on("click",o)),a&&t.on("hover",a),console.log("[createMarkerInteractions] Intera\xe7\xf5es criadas com sucesso"),t}(n,w,N);e.on("click",w),e.on("hover",N),e.on("hoverOut",k),z.debug("[OpenLayersMarkers] Intera\xe7\xf5es configuradas e integradas com o mapa")}),[n]),w=(0,t.useCallback)(((e,o)=>{const t=e.get("schoolData");t&&a&&(z.debug("[OpenLayersMarkers] Marcador clicado:",t.titulo),a(t))}),[a]),N=(0,t.useCallback)(((e,o)=>{m(e),d.current&&(d.current.setStyle((o=>o===e?((e,o)=>{if(!o)return null;const a=new p.Ay({image:new f.A({src:j,scale:1.3,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction"}),geometry:e.getGeometry()});return Array.isArray(o)?[...o,a]:[o,a]})(o,y(o,r)):y(o,r))),d.current.changed())}),[r]),k=(0,t.useCallback)((()=>{m(null),d.current&&(d.current.setStyle((e=>y(e,r))),d.current.changed())}),[r]),C=(0,t.useCallback)((()=>{if(!c.current||!o)return;if(z.debug("[OpenLayersMarkers] Atualizando marcadores...",o.length,"showMarcadores:",s),c.current.clear(),!s)return void z.debug("[OpenLayersMarkers] Marcadores desabilitados, removendo todos");const e=o.filter((e=>{if(!e.latitude||!e.longitude)return!1;const o=parseFloat(e.latitude),a=parseFloat(e.longitude);return!isNaN(o)&&!isNaN(a)&&o>=-90&&o<=90&&a>=-180&&a<=180}));z.debug("[OpenLayersMarkers] Pontos v\xe1lidos:",e.length),e.forEach(((e,o)=>{if(e.latitude&&e.longitude){const a=new h.A({geometry:new x.A((0,i.Rb)([e.longitude,e.latitude]))});a.set("markerData",e),a.set("schoolData",e),a.set("markerId","marker_".concat(o)),a.set("type","marker"),c.current.addFeature(a)}})),z.debug("[OpenLayersMarkers] ".concat(e.length," marcadores individuais adicionados"))}),[o,s]),_=(0,t.useCallback)((()=>{d.current&&(d.current.setStyle((e=>y(e,r))),d.current.changed())}),[r]);return(0,t.useEffect)((()=>(n&&b(),()=>{d.current&&n&&n.removeLayer(d.current)})),[n,b]),(0,t.useEffect)((()=>{C()}),[C]),(0,t.useEffect)((()=>{_()}),[_]),(0,P.jsx)("div",{className:l})};var T=a(3908);const D={terrasIndigenas:{regularizada:{fill:"rgba(220, 20, 60, 0.3)",stroke:"#B22222",hover:{fill:"rgba(220, 20, 60, 0.45)",stroke:"#FF0000"}},declarada:{fill:"rgba(139, 0, 0, 0.25)",stroke:"#B22222",hover:{fill:"rgba(139, 0, 0, 0.4)",stroke:"#FF0000"}}},estadoSP:{fill:"rgba(0, 0, 0, 0.3)",stroke:"#000000",hover:{fill:"rgba(0, 0, 0, 0.4)",stroke:"#333333"}}},F=function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||!e.properties)return new p.Ay({fill:new v.A({color:D.terrasIndigenas.regularizada.fill}),stroke:new w.A({color:D.terrasIndigenas.regularizada.stroke,width:2})});const a="Regularizada"===e.properties.fase_ti?D.terrasIndigenas.regularizada:D.terrasIndigenas.declarada,t=o?a.hover:a;return new p.Ay({fill:new v.A({color:t.fill}),stroke:new w.A({color:t.stroke,width:o?3:2,lineDash:o?[]:[3,3]})})};const O={center:[-48.4129,-22.3794],zoom:7.63,maxZoom:18,minZoom:4,mobile:{center:[-48.5935,-21.9212],zoom:5.7},clusterDistance:15,clusterMinDistance:3,clusterAnimationDuration:300,proximityThreshold:5e-5,disableClusteringAtZoom:12,tooltipOffset:10,tooltipDelay:200,interaction:{enableHover:!0,enableClick:!0,enableDoubleClick:!0,enableTouch:!0,clickDelay:300,hoverDelay:200},performance:{enableLazyLoading:!0,maxFeaturesPerTile:1e3,enableFeatureCulling:!0,enableTileCaching:!0},ANIMATION_CONFIG:{duration:{marker:300,cluster:500,zoom:800,pan:600},easing:{marker:"ease-out",cluster:"ease-in-out",zoom:"ease-out",pan:"ease-out"}}},R={small:"#60A5FA",medium:"#3B82F6",large:"#2563EB",xlarge:"#1E40AF"},H={min:11,max:20,size:52},q={min:21,max:50,size:56},U={min:51,max:100,size:64},B="EPSG:4326",W="EPSG:3857",G="EPSG:4674",V={url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:'\xa9 <a href="https://www.esri.com/">Esri</a>',maxZoom:19,wrapX:!1,tilePixelRatio:1,tileSize:256},Z=(R.small,H.size,R.medium,q.size,R.large,U.size,R.xlarge,(0,t.forwardRef)(((e,o)=>{let{data:a,onPainelOpen:s,showTerrasIndigenas:r=!0,map:n,className:l="h-full w-full"}=e;const i=(0,t.useRef)(null),c=(0,t.useRef)(null),d=(0,t.useRef)(null),[,m]=t.useState(null),[h,x]=t.useState(null),f=(0,t.useMemo)((()=>k()),[]),b=(0,t.useCallback)((()=>{if(n&&a)if(a.features&&Array.isArray(a.features)&&0!==a.features.length)try{const e=new T.A({dataProjection:G||B,featureProjection:W}).readFeatures(a);i.current=new g.A({features:e}),c.current=new u.A({source:i.current,style:e=>F(e,!1),zIndex:10}),e.forEach((e=>{const o=e.getProperties();e.set("terraIndigenaInfo",{titulo:o.terrai_nom,tipo:"terra_indigena",etnia:o.etnia_nome,municipio:o.municipio_,uf:o.uf_sigla,superficie:o.superficie,fase:o.fase_ti,modalidade:o.modalidade,reestudo:o.reestudo_t,cr:o.cr,faixa_fron:o.faixa_fron,undadm_nom:o.undadm_nom,undadm_sig:o.undadm_sig,dominio_un:o.dominio_un,data_atual:o.data_atual,terrai_cod:o.terrai_cod,undadm_cod:o.undadm_cod})})),n.addLayer(c.current),j(),console.log("[OpenLayersTerrasIndigenas] Camada criada com ".concat(e.length," features"))}catch(e){console.error("[OpenLayersTerrasIndigenas] Erro ao criar camada:",e)}else console.warn("[OpenLayersTerrasIndigenas] Dados inv\xe1lidos ou vazios:",a)}),[n,a]),j=(0,t.useCallback)((()=>{n&&c.current&&(d.current=function(e,o,a){const t=A(e,{showTooltip:!0,tooltipContentFunction:e=>{const o=e.get("terraIndigenaInfo");return o?"Terra Ind\xedgena ".concat(o.titulo||"Ind\xedgena"):null}});return o&&t.on("click",o),a&&t.on("hover",a),t}(n,y,N),d.current.on("click",y),d.current.on("hover",N),d.current.on("hoverOut",C))}),[n]),y=(0,t.useCallback)(((e,o)=>{if(!e)return;const a=e.get("terraIndigenaInfo");if(a)if(f)s&&s(a);else if(h===e)s&&s(a),x(null);else{x(e);const o=e.getGeometry();if(o){const e=o.getExtent();n.getView().fit(e,{duration:O.ANIMATION_CONFIG.duration.zoom,padding:[50,50,50,50],maxZoom:15})}}}),[f,s,h,n]),N=(0,t.useCallback)(((e,o)=>{f||(m(e),c.current&&(c.current.setStyle((o=>F(o,o===e))),c.current.changed()))}),[f]),C=(0,t.useCallback)((e=>{m(null),c.current&&(c.current.setStyle((e=>F(e,!1))),c.current.changed())}),[]),_=(0,t.useCallback)((e=>{c.current&&(c.current.setStyle((o=>{if(o===e){return function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{fillColor:t="rgba(59, 130, 246, 0.3)",strokeColor:s="#1E40AF",strokeWidth:r=3,lineDash:n=[5,5]}=a,l=new p.Ay({fill:new v.A({color:t}),stroke:new w.A({color:s,width:r,lineDash:n})});return Array.isArray(o)?[...o,l]:[o,l]}(o,F(o,!1))}return F(o,!1)})),c.current.changed())}),[]),E=(0,t.useCallback)((e=>{c.current&&(c.current.setStyle((e=>F(e,!1))),c.current.changed())}),[]);return(0,t.useEffect)((()=>(n&&a&&r&&b(),()=>{d.current&&d.current.destroy(),c.current&&n&&n.removeLayer(c.current)})),[n,a,r,b]),(0,t.useEffect)((()=>{h?_(h):c.current&&E()}),[h,_,E]),(0,t.useEffect)((()=>{if(h){const e=setTimeout((()=>{x(null)}),O.interaction.clickDelay);return()=>clearTimeout(e)}}),[h]),r&&a?(0,P.jsx)("div",{className:l}):null}))),K=(0,t.forwardRef)(((e,o)=>{let{data:a,showEstadoSP:s=!0,map:r,className:n="h-full w-full"}=e;const l=(0,t.useRef)(null),i=(0,t.useRef)(null),c=(0,t.useCallback)((()=>{if(r&&a)if(a.features&&Array.isArray(a.features)&&0!==a.features.length)try{const e=new T.A({dataProjection:G||B,featureProjection:W}).readFeatures(a);l.current=new g.A({features:e}),i.current=new u.A({source:l.current,style:e=>function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=o?D.estadoSP.hover:D.estadoSP;return new p.Ay({fill:new v.A({color:a.fill}),stroke:new w.A({color:a.stroke,width:o?2:1})})}(e,!1),zIndex:5,interactive:!1}),r.addLayer(i.current),console.log("[OpenLayersEstadoSP] Camada criada com ".concat(e.length," features"))}catch(e){console.error("[OpenLayersEstadoSP] Erro ao criar camada:",e)}else console.warn("[OpenLayersEstadoSP] Dados inv\xe1lidos ou vazios:",a)}),[r,a]);return(0,t.useEffect)((()=>(r&&a&&s&&c(),()=>{i.current&&r&&r.removeLayer(i.current)})),[r,a,s,c]),s&&a?(0,P.jsx)("div",{className:n}):null})),J=e=>{let{terrasIndigenasData:o,estadoSPData:a,showTerrasIndigenas:s=!0,showEstadoSP:r=!0,onPainelOpen:n,map:l,className:i="h-full w-full"}=e;const c=(0,t.useRef)(null),d=(0,t.useRef)(null),[m,u]=t.useState({terrasIndigenas:{visible:s,loaded:!1,error:null},estadoSP:{visible:r,loaded:!1,error:null}}),g=(0,t.useMemo)((()=>({terrasIndigenas:o&&o.features&&o.features.length>0,estadoSP:a&&a.features&&a.features.length>0})),[o,a]),h=(0,t.useCallback)(((e,o)=>{u((a=>(0,N.A)((0,N.A)({},a),{},{[e]:(0,N.A)((0,N.A)({},a[e]),o)})))}),[]),x=(0,t.useCallback)(((e,o)=>{console.error("[OpenLayersLayers] Erro na camada ".concat(e,":"),o),h(e,{error:o.message})}),[h]),p=(0,t.useCallback)((e=>{h(e,{loaded:!0,error:null})}),[h]),f=(0,t.useCallback)((()=>{const e={total:0,visible:0,loaded:0,errors:0};return Object.values(m).forEach((o=>{e.total++,o.visible&&e.visible++,o.loaded&&e.loaded++,o.error&&e.errors++})),e}),[m]),b=(0,t.useCallback)((()=>({terrasIndigenas:(0,N.A)((0,N.A)({},m.terrasIndigenas),{},{hasData:g.terrasIndigenas,featureCount:g.terrasIndigenas?o.features.length:0}),estadoSP:(0,N.A)((0,N.A)({},m.estadoSP),{},{hasData:g.estadoSP,featureCount:g.estadoSP?a.features.length:0})})),[m,g,o,a]);return(0,t.useEffect)((()=>{const e=f(),o=b();console.log("[OpenLayersLayers] Status das camadas:",{stats:e,info:o,hasValidData:g})}),[m,f,b,g]),(0,t.useEffect)((()=>{u((e=>({terrasIndigenas:(0,N.A)((0,N.A)({},e.terrasIndigenas),{},{visible:s}),estadoSP:(0,N.A)((0,N.A)({},e.estadoSP),{},{visible:r})})))}),[s,r]),g.terrasIndigenas||g.estadoSP?(0,P.jsxs)("div",{className:i,children:[g.terrasIndigenas&&(0,P.jsx)(Z,{ref:c,data:o,onPainelOpen:n,showTerrasIndigenas:s,map:l,onLoad:()=>p("terrasIndigenas"),onError:e=>x("terrasIndigenas",e)}),g.estadoSP&&(0,P.jsx)(K,{ref:d,data:a,showEstadoSP:r,map:l,onLoad:()=>p("estadoSP"),onError:e=>x("estadoSP",e)})]}):(0,P.jsx)("div",{className:i,children:(0,P.jsx)("div",{className:"text-center text-gray-500 p-4",children:"Nenhuma camada GeoJSON dispon\xedvel"})})},Y=()=>{const[e,o]=(0,t.useState)({width:"undefined"!==typeof window?window.innerWidth:1024,height:"undefined"!==typeof window?window.innerHeight:768}),[a,s]=(0,t.useState)(!1),[r,n]=(0,t.useState)(!1),[l,i]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const e=()=>{const e=window.innerWidth,a=window.innerHeight;o({width:e,height:a}),s(e<=767),n(e>=768&&e<=1023),i(e>=1024)};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]);return{screenSize:e,isMobile:a,isTablet:r,isDesktop:l,zoomConfig:a?{bottom:120,buttonSize:44,spacing:8,left:.25}:r?{bottom:40,buttonSize:40,spacing:6,left:.5}:{bottom:60,buttonSize:36,spacing:6,left:.5},accessibility:{prefersReducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,prefersHighContrast:window.matchMedia("(prefers-contrast: high)").matches,isLandscape:e.width>e.height}}},X=e=>{let{mapRef:o}=e;const{zoomConfig:a,accessibility:s,isMobile:r,isTablet:n}=Y(),l=(0,t.useRef)(null);return(0,t.useEffect)((()=>{if(!l.current||null===o||void 0===o||!o.current)return;const e=o.current.getControls().getArray().find((e=>e.getClassName&&e.getClassName().includes("ol-zoom")));if(e){const o=e.element;o.style.bottom="".concat(a.bottom,"px"),o.style.left="".concat(a.left,"em");o.querySelectorAll(".ol-zoom-in, .ol-zoom-out").forEach((e=>{e.style.minHeight="".concat(a.buttonSize,"px"),e.style.minWidth="".concat(a.buttonSize,"px"),e.style.marginBottom="".concat(a.spacing,"px"),s.prefersReducedMotion&&(e.style.transition="none"),s.prefersHighContrast&&(e.style.backgroundColor="white",e.style.border="2px solid black",e.style.color="black")}))}}),[a,s,o]),(0,t.useEffect)((()=>{if(!l.current)return;const e=l.current;e.classList.remove("mobile-optimized","tablet-optimized","desktop-optimized"),r?e.classList.add("mobile-optimized"):n?e.classList.add("tablet-optimized"):e.classList.add("desktop-optimized")}),[r,n]),(0,P.jsx)("div",{ref:l,className:"responsive-zoom-controls","data-device":r?"mobile":n?"tablet":"desktop","data-accessibility":JSON.stringify(s)})},$=t.forwardRef(((e,o)=>(0,P.jsx)("div",(0,N.A)({id:"map",className:"w-full h-full",ref:o},e))));m.A.defs("EPSG:4674","+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs"),(0,d.kz)(m.A);const Q=e=>{let{dataPoints:o=[],onPainelOpen:a,center:d=O.center,zoom:m=O.zoom,className:u="h-screen w-full",terrasIndigenasData:g=null,estadoSPData:h=null,showTerrasIndigenas:x=!0,showEstadoSP:p=!0,showMarcadores:f=!0,showNomesEscolas:b=!1}=e;const v=(0,t.useRef)(null),w=(0,t.useRef)(null),j=(0,t.useRef)(null),[,y]=(0,t.useState)({lng:d[0],lat:d[1],zoom:m}),N=(0,t.useMemo)((()=>k()),[]),C=N?O.mobile.center:d,A=N?O.mobile.zoom:m,_=(0,t.useCallback)((()=>({satelliteLayer:new n.A({source:new l.A({url:V.url,attributions:V.attributions,maxZoom:V.maxZoom,wrapX:V.wrapX,tilePixelRatio:V.tilePixelRatio,tileSize:V.tileSize}),preload:1,useInterimTilesOnError:!1})})),[]),E=(0,t.useCallback)((()=>{if(w.current)return;const{satelliteLayer:e}=_();j.current=e,w.current=new s.A({target:v.current,layers:[j.current],view:new r.Ay({center:(0,i.Rb)(C),zoom:A,maxZoom:O.maxZoom,minZoom:O.minZoom,enableRotation:!1}),controls:(0,c.N)()}),w.current.on("moveend",(()=>{const e=w.current.getView(),o=(0,i.WP)(e.getCenter()),a={lng:o[0].toFixed(4),lat:o[1].toFixed(4),zoom:e.getZoom().toFixed(2)};y(a)})),console.log("[OpenLayersMap] Mapa inicializado com sucesso")}),[C,A,_]),I=(0,t.useCallback)((()=>{if(!w.current)return;const e=k(),o=e?O.mobile.center:d,a=e?O.mobile.zoom:m,t=w.current.getView(),s=(0,i.WP)(t.getCenter()),r=t.getZoom();s[0]===o[0]&&s[1]===o[1]&&r===a||(t.setCenter((0,i.Rb)(o)),t.setZoom(a))}),[d,m]);return(0,t.useEffect)((()=>(E(),()=>{w.current&&(w.current.setTarget(void 0),w.current=null)})),[E]),(0,t.useEffect)((()=>{I()}),[I]),(0,P.jsx)($,{ref:v,children:w.current&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(M,{dataPoints:o,onPainelOpen:a,showMarcadores:f,showNomesEscolas:b,map:w.current}),(0,P.jsx)(J,{terrasIndigenasData:g,estadoSPData:h,showTerrasIndigenas:x,showEstadoSP:p,onPainelOpen:a,map:w.current}),(0,P.jsx)(X,{mapRef:w})]})})},ee={},oe=e=>{const[o,a]=(0,t.useState)(null),[s,r]=(0,t.useState)(!1),[n,l]=(0,t.useState)(null);return(0,t.useEffect)((()=>{if(!e)return;(async()=>{if(ee[e])return z.debug("useGeoJSONCache: Dados de ".concat(e," encontrados no cache")),void a(ee[e]);r(!0);try{var o;const t="".concat("/opin","/").concat(e,".geojson");z.debug("useGeoJSONCache: Carregando ".concat(e," de:"),t);const s=await fetch(t);if(!s.ok)throw new Error("Erro ao buscar GeoJSON (".concat(s.status,")"));const r=await s.json();z.debug("useGeoJSONCache: ".concat(e," carregado com sucesso:"),{type:r.type,features:(null===(o=r.features)||void 0===o?void 0:o.length)||0}),ee[e]=r,a(r)}catch(t){z.error("useGeoJSONCache: Erro ao carregar ".concat(e,":"),t),l(t)}finally{r(!1)}})()}),[e]),{data:o,loading:s,error:n}},ae=(e,o)=>(0,t.useMemo)((()=>e?{minimized:{path:"M5 15l7-7 7 7",ariaLabel:"Expandir menu"},expanded:{path:"M19 9l-7 7-7-7",ariaLabel:"Minimizar menu"}}:{minimized:{path:"M19 9l-7 7-7-7",ariaLabel:"Expandir menu"},expanded:{path:"M5 15l7-7 7 7",ariaLabel:"Minimizar menu"}}),[e]),te=e=>{let{isMobile:o,isMinimized:a,className:t="w-4 h-4"}=e;const s=ae(o),r=a?s.minimized:s.expanded;return(0,P.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-label":r.ariaLabel,children:(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:r.path})})};var se=a(29134);const re=e=>{let{dataPoints:o,onPainelOpen:a,painelAberto:s=!1,className:r="h-screen w-full",isMainLoading:n=!1}=e;const{data:l,loading:i,error:c}=oe("terras_indigenas"),{data:d,loading:m,error:u}=oe("SP"),[g,h]=(0,t.useState)(!0),[x,p]=(0,t.useState)(!0),[f,b]=(0,t.useState)(!0),{isMobile:v}=(0,se.d)(),[w,j]=(0,t.useState)(!1),y=(0,t.useCallback)((()=>j((e=>!e))),[]);(0,t.useEffect)((()=>{var e,o;z.debug("MapSelector: Status das camadas GeoJSON:",{terrasIndigenas:{loading:i,error:c,hasData:!!l,features:(null===l||void 0===l||null===(e=l.features)||void 0===e?void 0:e.length)||0},estadoSP:{loading:m,error:u,hasData:!!d,features:(null===d||void 0===d||null===(o=d.features)||void 0===o?void 0:o.length)||0}})}),[l,d,i,m,c,u]),(0,t.useEffect)((()=>{!s&&v&&(z.debug("MapSelector: Painel fechado em mobile, reativando marcadores"),b(!0))}),[s,v]);const N=e=>{let{onMinimize:o,isMobile:a,isMinimized:t}=e;return(0,P.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-green-700 to-green-800 text-white",children:[(0,P.jsxs)("div",{className:"flex items-center gap-2",children:[(0,P.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"})}),(0,P.jsx)("h3",{className:"text-sm font-semibold tracking-wide",children:"Camadas do Mapa"})]}),(0,P.jsx)("button",{onClick:o,className:"text-green-100 hover:text-white hover:bg-green-600 transition-all duration-200 p-1.5 rounded-md","aria-label":t?"Expandir":"Minimizar",type:"button",children:(0,P.jsx)(te,{isMobile:a,isMinimized:t,className:"w-4 h-4"})})]})},k=e=>{let{id:o,label:a,checked:t,onChange:s,disabled:r=!1,loading:l=!1,error:i=!1,total:c,color:d,subItems:m=null}=e;return(0,P.jsxs)("button",{type:"button",onClick:s,disabled:r,className:"group w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 ".concat(t?"bg-green-50 shadow-sm":"bg-white hover:bg-green-50/50"," ").concat(r?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:[(0,P.jsx)("div",{className:"flex-shrink-0",children:m?(0,P.jsx)("div",{className:"flex flex-col gap-1.5",children:m.map(((e,o)=>(0,P.jsxs)("div",{className:"flex items-center gap-2",children:[(0,P.jsx)("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:e.color}}),(0,P.jsx)("span",{className:"text-xs font-medium text-gray-700",children:e.label})]},o)))}):(0,P.jsx)("div",{className:"w-4 h-4 rounded-full shadow-sm ".concat(t?"ring-2 ring-green-200":""),style:{backgroundColor:d}})}),(0,P.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,P.jsxs)("div",{className:"flex items-center gap-2",children:[(0,P.jsx)("span",{className:"text-sm font-medium ".concat(t?"text-green-900":"text-gray-800"),children:a}),void 0!==c&&(0,P.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(t?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"),children:c})]}),(0,P.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[l&&!n&&(0,P.jsx)("div",{className:"flex items-center gap-1 text-blue-600",children:(0,P.jsx)("span",{className:"text-xs",children:"Carregando..."})}),i&&(0,P.jsxs)("div",{className:"flex items-center gap-1 text-red-600",children:[(0,P.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,P.jsx)("span",{className:"text-xs",children:"Erro"})]})]})]}),(0,P.jsx)("div",{className:"flex-shrink-0",children:(0,P.jsx)("div",{className:"w-3 h-3 rounded-full transition-colors duration-200 ".concat(t?"bg-green-600":"bg-gray-300")})})]})},C=v?O.mobile.center:O.center,A=v?O.mobile.zoom:O.zoom;return z.debug("MapSelector - Configura\xe7\xe3o do mapa:",{isMobile:v,zoom:A,center:C}),(0,P.jsxs)("div",{className:r,style:{position:"relative"},children:[v?(0,P.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-20",children:(0,P.jsxs)("div",{className:"bg-white shadow-2xl rounded-t-2xl",children:[(0,P.jsx)(N,{onMinimize:y,isMobile:!0,isMinimized:w}),!w&&(0,P.jsxs)("div",{className:"p-4 flex flex-col gap-3 max-h-80 overflow-y-auto",children:[(0,P.jsx)(k,{id:"estado-sp",label:"Estado de S\xe3o Paulo",checked:x,onChange:()=>p(!x),loading:m,error:u,color:"#10B981"}),(0,P.jsx)(k,{id:"marcadores",label:"Escolas Ind\xedgenas",checked:f,onChange:()=>b(!f),color:"#3B82F6"}),(0,P.jsx)(k,{id:"terras-indigenas",label:"Terras Ind\xedgenas",checked:g,onChange:()=>h(!g),loading:i,error:c,subItems:[{label:"Regularizadas",color:"#DC143C"},{label:"Declaradas",color:"#8B0000"}]})]})]})}):(0,P.jsxs)("div",{className:"fixed top-24 right-4 w-72 bg-white rounded-2xl shadow-2xl z-20 overflow-hidden",children:[(0,P.jsx)(N,{onMinimize:y,isMobile:!1,isMinimized:w}),!w&&(0,P.jsxs)("div",{className:"p-4 flex flex-col gap-3 max-h-96 overflow-y-auto",children:[(0,P.jsx)(k,{id:"estado-sp",label:"Estado de S\xe3o Paulo",checked:x,onChange:()=>p(!x),loading:m,error:u,color:"#10B981"}),(0,P.jsx)(k,{id:"marcadores",label:"Escolas Ind\xedgenas",checked:f,onChange:()=>b(!f),total:null===o||void 0===o?void 0:o.length,color:"#3B82F6"}),(0,P.jsx)(k,{id:"terras-indigenas",label:"Terras Ind\xedgenas",checked:g,onChange:()=>h(!g),loading:i,error:c,subItems:[{label:"Regularizadas",color:"#DC143C"},{label:"Declaradas",color:"#8B0000"}]})]})]}),(0,P.jsx)(Q,{dataPoints:f?o:[],onPainelOpen:a,className:"h-full w-full",center:C,zoom:A,terrasIndigenasData:l,estadoSPData:d,showTerrasIndigenas:g,showEstadoSP:x,showMarcadores:f})]})},ne=t.memo(re);var le=a(16799);var ie=a(92880);const ce=e=>{const[o,a]=(0,t.useState)([]),[s,r]=(0,t.useState)(!0),[n,l]=(0,t.useState)(null);return(0,t.useEffect)((()=>{(async()=>{if(console.log("\ud83d\udd04 Iniciando busca de documentos para escola:",e,"tipo:",typeof e),!e)return console.log("\u26a0\ufe0f Nenhum ID de escola fornecido, retornando array vazio"),a([]),void r(!1);try{r(!0),console.log("\ud83d\udce1 Consultando tabela documentos_escola...");const{data:o,error:t}=await ie.N.auth.getSession();console.log("\ud83d\udd10 Estado da autentica\xe7\xe3o:",{temSessao:!(null===o||void 0===o||!o.session),error:t});const{error:s}=await ie.N.from("documentos_escola").select("count").limit(1);console.log("\ud83d\udd11 Verifica\xe7\xe3o de permiss\xf5es:",{podeAcessar:!s,error:s?{code:s.code,message:s.message,details:s.details,hint:s.hint}:null});const{data:n,error:l}=await ie.N.from("documentos_escola").select("*");l?console.error("\u274c Erro ao buscar todos os documentos:",{code:l.code,message:l.message,details:l.details,hint:l.hint}):(console.log("\ud83d\udcca Todos os documentos na tabela:",n),n&&n.length>0?(console.log("\ud83d\udcca Exemplo de documento:",n[0]),console.log("\ud83d\udcca Tipos de escola_id encontrados:",n.map((e=>({id:e.id,escola_id:e.escola_id,tipo_escola_id:typeof e.escola_id,valor_escola_id:e.escola_id}))))):console.log("\u26a0\ufe0f Tabela est\xe1 vazia ou n\xe3o temos permiss\xe3o para ver os dados")),console.log("\ud83d\udd0d Buscando documentos para escola_id:",e);const{data:i,error:c}=await ie.N.from("documentos_escola").select("*").eq("escola_id",e.toString()).order("created_at",{ascending:!1});if(c)throw console.error("\u274c Erro na consulta Supabase:",{code:c.code,message:c.message,details:c.details,hint:c.hint}),c;if(console.log("\u2705 Documentos encontrados:",(null===i||void 0===i?void 0:i.length)||0),0===(null===i||void 0===i?void 0:i.length)){console.log("\u2139\ufe0f Nenhum documento encontrado para a escola ID:",e),console.log("\u2139\ufe0f Tentando buscar com diferentes formatos de escola_id...");const{data:o,error:a}=await ie.N.from("documentos_escola").select("*").eq("escola_id",Number(e)),{data:t,error:s}=await ie.N.from("documentos_escola").select("*").eq("escola_id",String(e));console.log("Resultados com escola_id como n\xfamero:",{count:(null===o||void 0===o?void 0:o.length)||0,error:a}),console.log("Resultados com escola_id como string:",{count:(null===t||void 0===t?void 0:t.length)||0,error:s})}else console.log("\ud83d\udcc4 Dados dos documentos:",i);a(i||[])}catch(o){console.error("\u274c Erro ao buscar documentos:",o),l(o.message)}finally{r(!1)}})()}),[e]),{documentos:o,isLoading:s,error:n}};var de=a(193),me=a(7669),ue=a(21209),ge=a(74387),he=a(79816),xe=a(50225),pe=a(99769),fe=a(56863),be=a(86093),ve=a(94183);const we=(0,t.memo)((e=>{let{children:o,columns:a="auto-fit",gap:t=4,className:s=""}=e;return(0,P.jsx)("div",{className:"grid ".concat({"auto-fit":"grid-cols-2 lg:grid-cols-3",2:"grid-cols-2",3:"grid-cols-2 lg:grid-cols-3",4:"grid-cols-2 lg:grid-cols-4"}[a]," gap-").concat(t," ").concat(s," [&>*]:bg-green-100"),children:o})})),je=(0,t.memo)((e=>{let{data:o,className:a=""}=e;return o&&0!==o.length?(0,P.jsx)("div",{className:"bg-green-100 rounded-lg overflow-hidden ".concat(a),children:(0,P.jsx)("table",{className:"w-full",children:(0,P.jsx)("tbody",{children:o.map(((e,o)=>(0,P.jsxs)("tr",{className:o%2===0?"bg-white":"bg-green-50",children:[(0,P.jsx)("td",{className:"px-4 py-3 text-sm font-medium text-gray-700 border-r border-green-200",children:e.label}),(0,P.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.value})]},o)))})})}):null})),ye=(0,t.memo)((e=>{let{stats:o,className:a=""}=e;return o&&0!==o.length?(0,P.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 ".concat(a," [&>*]:border-b [&>*]:border-gray-200 [&>*]:pb-2 [&>*]:mb-2"),children:o.map(((e,o)=>(0,P.jsxs)("div",{className:"text-center rounded-lg p-4",children:[(0,P.jsx)("div",{className:"flex justify-center mb-2",children:e.icon&&(0,P.jsx)(e.icon,{className:"w-6 h-6 text-gray-700"})}),(0,P.jsx)("div",{className:"text-3xl font-medium text-green-800 mb-1",children:e.value}),(0,P.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:e.label})]},o)))}):null})),Ne=(0,t.memo)((e=>{let{title:o,icon:a,children:s,description:r,defaultCollapsed:n=!1,className:l="",layout:i="default",layoutProps:c={}}=e;const[d,m]=(0,t.useState)(n);return(0,P.jsxs)("section",{className:"\n        bg-white rounded-2xl p-5 \n        shadow-sm transition-all duration-200\n        ".concat(l,"\n      "),children:[(0,P.jsx)("button",{onClick:()=>m(!d),className:" w-full flex items-center justify-between  text-base font-semibold mb-4 text-gray-900 hover:text-gray-800  transition-colors focus:outline-none ","aria-expanded":!d,"aria-controls":"".concat(o,"-content"),children:(0,P.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,P.jsx)(a,{className:"w-5 h-5 text-gray-700"}),(0,P.jsx)("span",{className:"tracking-wide",children:o})]})}),!d&&(0,P.jsxs)("div",{id:"".concat(o,"-content"),className:"space-y-4",role:"region","aria-labelledby":"".concat(o,"-button"),children:[r&&(0,P.jsx)("div",{className:"bg-green-100 rounded-lg p-4",children:(0,P.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed",children:r})}),(()=>{if(!s)return null;switch(i){case"grid":return(0,P.jsx)(we,(0,N.A)((0,N.A)({},c),{},{children:s}));case"table":return(0,P.jsx)(je,{data:c.data,className:c.className});case"stats":return(0,P.jsx)(ye,{stats:c.stats,className:c.className});default:return(0,P.jsx)("div",{className:"space-y-4",children:s})}})()]})]})})),ke=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():"",Ce=e=>{let{icon:o,label:a,value:t,type:s="text"}=e;return(0,P.jsxs)("div",{className:"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col",children:[(0,P.jsxs)("div",{className:"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]",children:[(0,P.jsx)(o,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0"}),(0,P.jsx)("span",{className:"text-xs text-gray-600 font-medium leading-tight",children:a})]}),(0,P.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(()=>{switch(s){case"boolean":return t?(0,P.jsxs)("span",{className:"flex items-center gap-1 text-green-600 text-sm",children:[(0,P.jsx)(de.A,{className:"w-4 h-4 flex-shrink-0"}),"Sim"]}):(0,P.jsxs)("span",{className:"flex items-center gap-1 text-red-500 text-sm",children:[(0,P.jsx)(me.A,{className:"w-4 h-4 flex-shrink-0"}),"N\xe3o"]});case"number":return(0,P.jsx)("div",{className:"text-center w-full flex items-center justify-center h-full",children:(0,P.jsx)("div",{className:"text-3xl font-medium text-green-800",style:{fontSize:"1.875rem",fontWeight:"500",color:"#166534"},children:t||"0"})});default:return(0,P.jsx)("span",{className:"text-sm text-gray-800 break-words text-center w-full",children:t})}})()})]})},Ae=e=>{let{escola:o}=e;if(!(o.logradouro||o.numero||o.bairro||o.cep))return(0,P.jsx)("div",{className:"mt-2 p-2 bg-green-100 rounded-md",children:(0,P.jsx)("p",{className:"text-xs text-gray-700 leading-snug",children:ke(o.endereco)})});return(0,P.jsxs)("div",{className:"mt-2 space-y-1",children:[[{field:"logradouro",label:"Logradouro"},{field:"numero",label:"N\xfamero"},{field:"complemento",label:"Complemento"},{field:"bairro",label:"Bairro"}].map((e=>{let{field:a,label:t}=e;return o[a]&&(0,P.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 rounded-md",children:[(0,P.jsx)(ue.A,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),(0,P.jsxs)("div",{className:"flex-1",children:[(0,P.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-0.5",children:t}),(0,P.jsx)("div",{className:"text-xs text-gray-800 leading-snug",children:o[a]})]})]},a)})),(o.cep||o.estado)&&(0,P.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 rounded-md",children:[(0,P.jsx)(ue.A,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),(0,P.jsxs)("div",{className:"flex-1",children:[(0,P.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-0.5",children:"Localiza\xe7\xe3o"}),(0,P.jsx)("div",{className:"text-xs text-gray-800 leading-snug",children:[o.municipio,o.estado,o.cep].filter(Boolean).join(", ")})]})]})]})},_e=e=>{let{escola:o}=e;if(!(o.Latitude&&o.Longitude))return null;return(0,P.jsxs)("button",{onClick:()=>{window.open("https://www.google.com/maps?q=".concat(o.Latitude,",").concat(o.Longitude),"_blank")},className:"mt-2 w-full flex items-center justify-center gap-2 p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors text-xs font-medium",children:[(0,P.jsx)(ge.A,{className:"w-5 h-5"}),"Ver no Google Maps"]})},Ee=e=>{let{links:o,expanded:a,onToggle:t}=e;const s=(o||"").split(",").map((e=>e.trim())).filter(Boolean);return 0===s.length?null:(0,P.jsxs)("div",{className:"bg-green-100 rounded-md",children:[(0,P.jsxs)("button",{onClick:()=>t("social"),className:"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs","aria-expanded":a.social,children:[(0,P.jsxs)("span",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,P.jsx)(he.A,{className:"w-5 h-5 text-blue-600"}),"Redes sociais (",s.length,")"]}),(0,P.jsx)(xe.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(a.social?"rotate-90":"")})]}),a.social&&(0,P.jsx)("div",{className:"px-2 pb-2 border-t border-green-200 bg-white",children:(0,P.jsx)("div",{className:"mt-1 space-y-1",children:s.map(((e,o)=>(0,P.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 p-1.5 bg-green-100 rounded-md hover:bg-green-200 group text-xs",children:[(0,P.jsx)(pe.A,{className:"w-5 h-5 text-blue-600"}),(0,P.jsx)("span",{className:"truncate flex-1 text-gray-700",children:e}),(0,P.jsx)(fe.A,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600"})]},o)))})})]})},Ie=(0,t.memo)((e=>{let{escola:o}=e;const[a,s]=(0,t.useState)({});if(!o)return null;const r=e=>{s((o=>(0,N.A)((0,N.A)({},o),{},{[e]:!o[e]})))},n=[{icon:be.A,label:"Munic\xedpio",value:ke(o.municipio)},{icon:ve.A,label:"Funda\xe7\xe3o",value:o.ano_criacao,type:"number"},{icon:he.A,label:"Redes sociais",value:o.usa_redes_sociais,type:"boolean"}].filter((e=>e.value));return(0,P.jsxs)(P.Fragment,{children:[o.povos_indigenas&&(0,P.jsx)("div",{className:"mb-4",children:(0,P.jsxs)("div",{className:"text-lg sm:text-xl font-bold text-green-800",children:["Povos Ind\xedgenas: ",(0,P.jsx)("span",{className:"font-semibold text-black",children:o.povos_indigenas})]})}),(0,P.jsxs)(Ne,{title:"Localiza\xe7\xe3o",icon:ue.A,children:[(0,P.jsxs)("div",{className:"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 mb-4 items-stretch",children:[n.map(((e,o)=>(0,P.jsx)(Ce,(0,N.A)({},e),o))),o.diretoria_ensino&&(0,P.jsx)(Ce,{icon:be.A,label:"Diretoria de ensino",value:o.diretoria_ensino})]}),(0,P.jsxs)("div",{className:"space-y-1.5",children:[o.endereco&&(0,P.jsxs)("div",{className:"bg-green-100 rounded-md",children:[(0,P.jsxs)("button",{onClick:()=>r("endereco"),className:"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs","aria-expanded":a.endereco,children:[(0,P.jsxs)("span",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,P.jsx)(be.A,{className:"w-5 h-5"}),"Endere\xe7o"]}),(0,P.jsx)(xe.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(a.endereco?"rotate-90":"")})]}),a.endereco&&(0,P.jsxs)("div",{className:"px-2 pb-2 border-t border-green-200 bg-white",children:[(0,P.jsx)(Ae,{escola:o}),(0,P.jsx)(_e,{escola:o})]})]}),(0,P.jsx)(Ee,{links:o.links_redes_sociais,expanded:a,onToggle:r})]})]})]})})),Se=e=>{let{htmlContent:o}=e;return(0,P.jsx)("div",{className:"historia-escola-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify prose-img:rounded-xl prose-img:shadow-lg prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600 prose-strong:text-green-800 prose-em:text-green-700 prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg prose-ul:text-black prose-ol:text-black prose-li:text-black prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm",dangerouslySetInnerHTML:{__html:o}})},Le=()=>(0,P.jsxs)("header",{className:"mb-6 sm:mb-8 max-w-4xl mx-auto w-full",children:[(0,P.jsxs)("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[(0,P.jsx)("span",{className:"bg-green-200 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:(0,P.jsx)("img",{src:"".concat("/opin","/onca.svg"),alt:"\xcdcone de on\xe7a",className:"w-18 h-18 sm:w-36 sm:h-36",style:{filter:"none",borderRadius:"0",boxShadow:"none",margin:"0",padding:"0",border:"none",outline:"none",transform:"translateY(17px)"},"aria-hidden":"true"})}),(0,P.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-black m-0",children:"Hist\xf3ria da Escola"})]}),(0,P.jsx)("div",{className:"h-1 w-20 sm:w-24 bg-green-200 rounded-full"})]}),ze=(0,t.memo)((e=>{let{escola:o,refreshKey:a=0}=e;if(null===o||void 0===o||!o.historia_da_escola)return null;const t=o.historia_da_escola;return(0,P.jsxs)("div",{className:"mt-8 mb-12 flex flex-col items-center",children:[(0,P.jsx)(Le,{}),(0,P.jsx)("article",{className:" px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg prose prose-sm sm:prose-base md:prose-lg lg:prose-xl prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify prose-img:rounded-xl prose-img:shadow-lg prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600 max-w-4xl mx-auto w-full ",children:(0,P.jsx)(Se,{htmlContent:t})})]})}));var Pe=a(56735),Me=a(12065),Te=a(43531),De=a(80197),Fe=a(98242);const Oe=(0,t.memo)((e=>{let{value:o}=e;return void 0===o||null===o?null:(0,P.jsx)("span",{className:"font-medium text-center w-full block ".concat(o?"text-green-600":"text-neutral-400"),children:o?"Sim":"N\xe3o"})}));const Re=e=>{let{items:o,maxVisible:a=3}=e;return o&&0!==o.length?(0,P.jsx)("div",{className:"-mt-1",children:(0,P.jsx)("ul",{className:"list-none text-gray-800 text-xs pl-0 ml-0",children:o.map(((e,o)=>(0,P.jsxs)("li",{className:"leading-tight m-0 p-0 pl-0 ml-0 flex items-start",children:[(0,P.jsx)("span",{className:"mr-1 text-green-700 select-none",style:{minWidth:"1em",display:"inline-block"},children:"\u2022"}),(0,P.jsx)("span",{children:e})]},o)))})}):null},He=e=>{let{icon:o,label:a,value:t,type:s="text"}=e;return(0,P.jsxs)("div",{className:"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col",children:[(0,P.jsxs)("div",{className:"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]",children:[(0,P.jsx)(o,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0"}),(0,P.jsx)("span",{className:"text-xs text-gray-600 font-medium leading-tight",children:a})]}),(0,P.jsx)("div",{className:"flex-1 flex items-center justify-center",children:"number"===s?(0,P.jsx)("div",{className:"text-center w-full flex items-center justify-center h-full",children:(0,P.jsx)("div",{className:"text-3xl font-medium text-green-800",style:{fontSize:"1.875rem",fontWeight:"500",color:"#166534"},children:t||"0"})}):(0,P.jsx)("div",{className:"text-sm text-gray-800 font-medium break-words text-center w-full",children:t})})]})},qe=(0,t.memo)((e=>{let{escola:o}=e;if(!o)return null;const a=o.turnos_funcionamento||o.turnos_funcionamento||"",t=(s=o.modalidade_ensino)&&"string"===typeof s?s.split("\u2013").map((e=>e.trim())).filter(Boolean):[];var s;const r=[a&&{icon:Pe.A,label:"Turnos de Funcionamento",value:a},{icon:Me.A,label:"N\xfamero de Alunos",value:o.numero_alunos||"0",type:"number"},{icon:Te.A,label:"L\xednguas Faladas",value:o.linguas_faladas}].filter(Boolean),n=[{icon:De.A,label:"Material Pedag\xf3gico N\xe3o Ind\xedgena",value:(0,P.jsx)(Oe,{value:o.material_nao_indigena})},{icon:De.A,label:"Material Pedag\xf3gico Ind\xedgena",value:(0,P.jsx)(Oe,{value:o.material_indigena})},{icon:De.A,label:"PPP Pr\xf3prio",value:(0,P.jsx)(Oe,{value:o.ppp_proprio})},{icon:De.A,label:"PPP com Comunidade",value:(0,P.jsx)(Oe,{value:o.ppp_comunidade})}];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(Ne,{children:[(0,P.jsxs)("div",{className:"mb-4 bg-green-50 rounded-lg p-4",children:[(0,P.jsxs)("div",{className:"flex items-start gap-3 mb-2",children:[(0,P.jsx)(Fe.A,{className:"w-5 h-5 text-gray-700 mt-0.5 flex-shrink-0"}),(0,P.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Modalidade de Ensino"})]}),(0,P.jsx)("div",{className:"ml-8",children:(0,P.jsx)(Re,{items:t,maxVisible:3})})]}),(0,P.jsx)("div",{className:"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 mt-1 items-stretch",children:r.map(((e,o)=>(0,P.jsx)(He,{icon:e.icon,label:e.label,value:e.value,type:e.type},o)))})]}),(0,P.jsxs)(Ne,{title:"Materiais Pedag\xf3gicos",icon:De.A,description:"Diferenciados e n\xe3o diferenciados, produzidos dentro e fora da comunidade.",children:[(0,P.jsx)("div",{className:"mb-3",children:(0,P.jsx)(He,{icon:n[0].icon,label:n[0].label,value:n[0].value})}),n.length>1&&(0,P.jsx)("div",{className:"space-y-3",children:(()=>{const e=n.slice(1),o=[];for(let a=0;a<e.length;a+=3)o.push(e.slice(a,a+3));return o.map(((e,o)=>(0,P.jsx)("div",{className:"grid gap-0.5 sm:gap-1 items-stretch ".concat(3===e.length?"grid-cols-3":2===e.length?"grid-cols-2":"grid-cols-1"),children:e.map(((e,a)=>(0,P.jsx)(He,{icon:e.icon,label:e.label,value:e.value},"".concat(o,"-").concat(a))))},o)))})()})]})]})}));var Ue=a(52499),Be=a(31184),We=a(26920),Ge=a(1799),Ve=a(64758),Ze=a(98493),Ke=a(141),Je=a(31441);const Ye=e=>{let{icon:o,label:a,value:t}=e;return(0,P.jsxs)("div",{className:"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col",children:[(0,P.jsxs)("div",{className:"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]",children:[(0,P.jsx)(o,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0"}),(0,P.jsx)("span",{className:"text-xs text-gray-600 font-medium leading-tight",children:a})]}),(0,P.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,P.jsx)("div",{className:"text-sm text-gray-800 font-medium break-words text-center w-full",children:t})})]})},Xe=(0,t.memo)((e=>{let{escola:o}=e;if(!o)return null;const a=[{icon:Ue.A,label:"Acesso \xe0 \xc1gua",value:o.acesso_agua},{icon:Be.A,label:"Coleta de Lixo",value:o.coleta_lixo},{icon:We.A,label:"Acesso \xe0 Internet",value:(0,P.jsx)(Oe,{value:o.acesso_internet})},{icon:Ge.A,label:"Equipamentos Tecnol\xf3gicos",value:o.equipamentos},{icon:ue.A,label:"Modo de Acesso \xe0 Escola",value:o.modo_acesso},{icon:Ve.A,label:"Cozinha",value:(0,P.jsx)(Oe,{value:o.cozinha})},{icon:Ze.A,label:"Merenda Escolar",value:(0,P.jsx)(Oe,{value:o.merenda_escolar})},{icon:Ke.A,label:"Merenda Diferenciada",value:(0,P.jsx)(Oe,{value:o.diferenciada})}];return(0,P.jsxs)(Ne,{title:"Infraestrutura",icon:Je.A,children:[o.espaco_escolar&&(0,P.jsx)("div",{className:"p-2 text-sm text-gray-800 border-b border-gray-200 whitespace-pre-wrap",children:o.espaco_escolar}),(0,P.jsx)("div",{className:"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 mt-3 items-stretch",children:a.map(((e,o)=>(0,P.jsx)(Ye,{icon:e.icon,label:e.label,value:e.value},o)))})]})}));var $e=a(21172),Qe=a(12427),eo=a(86635),oo=a(29449),ao=a(74562),to=a(63626);const so=e=>{let{icon:o,label:a,value:t,description:s,type:r="text"}=e;return(0,P.jsxs)("div",{className:"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col",children:[(0,P.jsxs)("div",{className:"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]",children:[(0,P.jsx)(o,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0"}),(0,P.jsx)("span",{className:"text-xs text-gray-600 font-medium leading-tight",children:a})]}),(0,P.jsx)("div",{className:"flex-1 flex items-center justify-center",children:"number"===r?(0,P.jsx)("div",{className:"text-center w-full flex items-center justify-center h-full",children:(0,P.jsx)("div",{className:"text-3xl font-medium text-green-800",style:{fontSize:"1.875rem",fontWeight:"500",color:"#166534"},children:t||"0"})}):(0,P.jsx)("div",{className:"text-sm text-gray-800 font-medium mb-2 break-words text-center w-full",children:t})}),s&&(0,P.jsx)("div",{className:"text-xs text-gray-600 whitespace-pre-line leading-relaxed break-words mt-2",children:s})]})},ro=e=>{const o=String(e).trim().toLowerCase();return"sim"===o?(0,P.jsxs)("div",{className:"flex items-center gap-1 text-green-700",children:[(0,P.jsx)(de.A,{className:"w-5 h-5"}),"Sim"]}):"n\xe3o"===o||"nao"===o?(0,P.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,P.jsx)(me.A,{className:"w-5 h-5"}),"N\xe3o"]}):e},no=(0,t.memo)((e=>{let{escola:o}=e;if(!o)return null;const a=(e=>{if(!e)return null;const[o,...a]=e.split("/"),t=a.join("/").trim();return{status:"sim"===o.trim().toLowerCase()?"Sim":o.trim(),descricao:t||null}})(o.formacao_professores),t=(e=>{if(!e)return null;const[o,...a]=e.split("/"),t=a.join("/").trim();return{status:"sim"===o.trim().toLowerCase()?"Sim":o.trim(),descricao:t||null}})(o.formacao_continuada);return(0,P.jsxs)(Ne,{title:"Gestores",icon:$e.A,children:[(0,P.jsxs)("div",{className:"space-y-4 mt-1",children:[(0,P.jsxs)("div",{className:"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 items-stretch",children:[(0,P.jsx)(so,{icon:Qe.A,label:"Professores Ind\xedgenas",value:o.professores_indigenas,type:"number"}),(0,P.jsx)(so,{icon:eo.A,label:"Professores N\xe3o Ind\xedgenas",value:o.professores_nao_indigenas,type:"number"}),(0,P.jsx)(so,{icon:Te.A,label:"Professores que falam l\xedngua ind\xedgena",value:ro(o.professores_falam_lingua)})]}),(null===a||void 0===a?void 0:a.status)&&(0,P.jsx)(so,{icon:oo.A,label:"Forma\xe7\xe3o dos Professores",value:ro(a.status),description:a.descricao})]}),(0,P.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,P.jsx)(so,{icon:ao.A,label:"Gest\xe3o/Nome",value:o.gestao}),(0,P.jsx)(so,{icon:$e.A,label:"Outros Funcion\xe1rios",value:o.outros_funcionarios}),(null===t||void 0===t?void 0:t.status)&&(0,P.jsx)(so,{icon:to.A,label:"Visitas de Supervisores e Forma\xe7\xe3o Continuada",value:ro(t.status),description:t.descricao})]})]})}));var lo=a(46192),io=a(24621),co=a(21204);const mo=e=>{let{icon:o,label:a,value:t}=e;const s="n\xe3o"===(null===t||void 0===t?void 0:t.trim().toLowerCase());return(0,P.jsx)("div",{className:"bg-green-50 hover:bg-green-100 rounded-lg p-5 transition-all duration-200 hover:shadow-sm min-h-[120px] flex flex-col",children:(0,P.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[(0,P.jsx)(o,{className:"w-5 h-5 text-gray-700 mt-0.5 flex-shrink-0"}),(0,P.jsxs)("div",{className:"flex-1 min-w-0 flex flex-col space-y-4",children:[(0,P.jsx)("div",{className:"text-sm font-medium text-gray-700 flex-shrink-0",children:a}),(0,P.jsx)("div",{className:"flex-1 flex items-start",children:s?(0,P.jsxs)("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[(0,P.jsx)(me.A,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),"N\xe3o"]}):(0,P.jsx)("div",{className:"text-sm text-gray-800 leading-relaxed break-words",children:t})})]})]})})},uo=(0,t.memo)((e=>{let{escola:o}=e;if(!o)return null;const a=[{field:"projetos_andamento",icon:De.A,label:"Projetos em andamento"},{field:"parcerias_universidades",icon:lo.A,label:"Parcerias com universidades"},{field:"acoes_ongs",icon:Me.A,label:"A\xe7\xf5es com ONGs ou coletivos"},{field:"desejos_comunidade",icon:io.A,label:"Desejos da comunidade para a escola"},{field:"parcerias_municipio",icon:co.A,label:"Parcerias com o munic\xedpio"}].filter((e=>o[e.field]&&o[e.field].trim()));return 0===a.length?null:(0,P.jsx)(Ne,{title:"Projetos e Parcerias",icon:co.A,children:(0,P.jsx)("div",{className:"grid grid-cols-1 gap-6 items-stretch",children:a.map((e=>(0,P.jsx)(mo,{icon:e.icon,label:e.label,value:o[e.field]},e.field)))})})}));var go=a(38438),ho=a(82006),xo=a(40237),po=a(57908),fo=a(49147),bo=a(35757);const vo=e=>{let{images:o=[],currentImageIndex:a=0,isOpen:s=!1,onClose:r,onImageChange:n,showNavigation:l=!0,showControls:i=!0,showCounter:c=!0,showCaption:d=!0}=e;const[m,u]=(0,t.useState)(1),[g,h]=(0,t.useState)(0),[x,p]=(0,t.useState)(a);(0,t.useEffect)((()=>{u(1),h(0),p(a)}),[a,s]);const f=o[x],b=(0,t.useCallback)((()=>{u(1),h(0),r()}),[r]),v=()=>{u(1),h(0)},w=(0,t.useCallback)((()=>{if(x<o.length-1){const e=x+1;p(e),n&&n(e)}}),[x,o.length,n]),j=(0,t.useCallback)((()=>{if(x>0){const e=x-1;p(e),n&&n(e)}}),[x,n]);return(0,t.useEffect)((()=>{const e=e=>{"Escape"===e.key&&b()};if(s)return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[s,b]),(0,t.useEffect)((()=>{const e=e=>{if(s)switch(e.key){case"ArrowLeft":e.preventDefault(),j();break;case"ArrowRight":e.preventDefault(),w();break;case"r":case"R":e.preventDefault(),h((e=>(e+90)%360));break;case"+":case"=":e.preventDefault(),u((e=>Math.min(e+.25,3)));break;case"-":e.preventDefault(),u((e=>Math.max(e-.25,.5)));break;case"0":e.preventDefault(),v()}};if(s)return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[s,x,o.length,w,j]),s&&f?(0,P.jsxs)("div",{className:"image-zoom-modal",onClick:b,children:[(0,P.jsx)("button",{onClick:b,className:"image-zoom-close","aria-label":"Fechar",children:(0,P.jsx)(me.A,{size:24})}),i&&(0,P.jsxs)("div",{className:"image-zoom-controls",children:[(0,P.jsx)("button",{onClick:e=>{e.stopPropagation(),u((e=>Math.min(e+.25,3)))},className:"image-zoom-control-button","aria-label":"Aumentar zoom",children:(0,P.jsx)(po.A,{size:20})}),(0,P.jsx)("button",{onClick:e=>{e.stopPropagation(),u((e=>Math.max(e-.25,.5)))},className:"image-zoom-control-button","aria-label":"Diminuir zoom",children:(0,P.jsx)(fo.A,{size:20})}),(0,P.jsx)("button",{onClick:e=>{e.stopPropagation(),h((e=>(e+90)%360))},className:"image-zoom-control-button","aria-label":"Rotacionar",children:(0,P.jsx)(bo.A,{size:20})}),(0,P.jsx)("button",{onClick:e=>{e.stopPropagation(),v()},className:"image-zoom-control-button text-xs px-3","aria-label":"Resetar",children:"Reset"})]}),l&&o.length>1&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("button",{onClick:e=>{e.stopPropagation(),j()},className:"image-zoom-navigation prev",disabled:0===x,"aria-label":"Imagem anterior",children:(0,P.jsx)(go.A,{size:24})}),(0,P.jsx)("button",{onClick:e=>{e.stopPropagation(),w()},className:"image-zoom-navigation next",disabled:x===o.length-1,"aria-label":"Pr\xf3xima imagem",children:(0,P.jsx)(xe.A,{size:24})})]}),c&&o.length>1&&(0,P.jsxs)("div",{className:"image-zoom-counter",children:[x+1," / ",o.length]}),(0,P.jsxs)("div",{className:"image-zoom-container",children:[(0,P.jsx)("div",{className:"image-zoom-image-wrapper",children:(0,P.jsx)("img",{src:f.url||f.publicURL||f.imagem_public_url,alt:f.descricao||f.descricao_imagem||"Imagem",className:"image-zoom-image",style:{transform:"scale(".concat(m,") rotate(").concat(g,"deg)"),cursor:"grab"},onClick:e=>e.stopPropagation(),onMouseDown:e=>{e.preventDefault()}})}),d&&(f.descricao||f.descricao_imagem)&&(0,P.jsxs)("div",{className:"image-zoom-caption",children:[(0,P.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:f.descricao||f.descricao_imagem}),(0,P.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[f.categoria&&(0,P.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded text-gray-800",children:f.categoria}),f.autor&&(0,P.jsxs)("span",{children:["Fot\xf3grafo: ",f.autor]}),f.dataFoto&&(0,P.jsxs)("span",{children:["Data: ",new Date(f.dataFoto).toLocaleDateString("pt-BR")]})]}),f.descricaoDetalhada&&(0,P.jsx)("p",{className:"text-gray-600 leading-relaxed",children:f.descricaoDetalhada})]})]}),(0,P.jsx)("div",{className:"image-zoom-instructions",children:(0,P.jsxs)("div",{className:"text-xs text-gray-400 space-y-1",children:[(0,P.jsx)("div",{children:"ESC: Fechar | \u2190 \u2192: Navegar | R: Rotacionar"}),(0,P.jsx)("div",{children:"+ -: Zoom | 0: Reset"})]})})]}):null};var wo=a(53986);const jo=["src","alt","className","isPreloaded","placeholder","onLoad","onError"],yo=e=>{let{src:o,alt:a,className:s="",isPreloaded:r=!1,placeholder:n=null,onLoad:l,onError:i}=e,c=(0,wo.A)(e,jo);const[d,m]=(0,t.useState)(!1),[u,g]=(0,t.useState)(!1),[h,x]=(0,t.useState)(!1);(0,t.useEffect)((()=>{r&&(m(!0),x(!0))}),[r]);return u?n||null:(0,P.jsxs)("div",{className:"relative overflow-hidden ".concat(s),children:[!d&&(0,P.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:(0,P.jsx)("div",{className:"flex flex-col items-center space-y-2",children:(0,P.jsx)("div",{className:"text-xs text-gray-500",children:"Carregando..."})})}),(0,P.jsx)("img",(0,N.A)({src:o,alt:a,className:"w-full h-full object-cover transition-all duration-500 ease-out ".concat(h?"opacity-100 scale-100":"opacity-0 scale-105"),onLoad:()=>{m(!0),g(!1),x(!0),l&&l()},onError:()=>{g(!0),m(!1),i&&i()}},c))]})},No=function(e){let o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const[a,s]=(0,t.useState)(new Map),[r,n]=(0,t.useState)(!1),l=(0,t.useRef)(null),i=async e=>{const o=e.map((e=>(e=>new Promise(((o,a)=>{const t=new Image;t.onload=()=>o(e),t.onerror=()=>a(new Error("Failed to load image: ".concat(e))),t.src=e})))(e).catch((o=>(console.warn("Erro ao preload da imagem:",e,o),null)))));return(await Promise.all(o)).filter(Boolean)},c=async()=>{if(e&&o){n(!0),console.log("\ud83d\uddbc\ufe0f Iniciando preload de imagens para escola:",e);try{const{data:o}=await ie.N.storage.from("imagens-das-escolas").list("".concat(e,"/")),{data:a}=await ie.N.storage.from("imagens-professores").list("".concat(e,"/")),t=[];if(o&&o.length>0&&o.forEach((o=>{const{data:{publicUrl:a}}=ie.N.storage.from("imagens-das-escolas").getPublicUrl("".concat(e,"/").concat(o.name));t.push(a)})),a&&a.length>0&&a.forEach((o=>{const{data:{publicUrl:a}}=ie.N.storage.from("imagens-professores").getPublicUrl("".concat(e,"/").concat(o.name));t.push(a)})),console.log("\ud83d\uddbc\ufe0f Preload: ".concat(t.length," imagens encontradas")),t.length>0){const e=5,o=[];for(let s=0;s<t.length;s+=e)o.push(t.slice(s,s+e));for(let t=0;t<o.length;t++){const e=o[t];console.log("\ud83d\uddbc\ufe0f Preload lote ".concat(t+1,"/").concat(o.length,": ").concat(e.length," imagens")),await i(e),t<o.length-1&&await new Promise((e=>setTimeout(e,200)))}const a=new Map;t.forEach((e=>{a.set(e,!0)})),s(a),console.log("\u2705 Preload conclu\xeddo:",t.length,"imagens")}}catch(a){console.error("\u274c Erro durante preload:",a)}finally{n(!1)}}};(0,t.useEffect)((()=>{if(e&&o)return l.current&&clearTimeout(l.current),l.current=setTimeout((()=>{c()}),500),()=>{l.current&&clearTimeout(l.current)}}),[e,o]);return{isPreloading:r,preloadedImages:a,isImagePreloaded:e=>a.has(e),startPreload:c}},ko=e=>{let{escola_id:o,refreshKey:a=0}=e;const[s,r]=(0,t.useState)([]),[n,l]=(0,t.useState)(!0),[i,c]=(0,t.useState)(null),[d,m]=(0,t.useState)(null),[u,g]=(0,t.useState)(0),{isImagePreloaded:h}=No(o,!0),x=(0,t.useCallback)((()=>{m(null),g(0)}),[]);return(0,t.useEffect)((()=>{a>0&&(console.log("ImagemHistoriadoProfessor: refreshKey mudou, for\xe7ando recarga"),r([]),l(!0),c(null))}),[a]),(0,t.useEffect)((()=>{o&&(l(!0),c(null),ie.N.storage.from("imagens-professores").list("".concat(o,"/")).then((async e=>{let{data:a,error:t}=e;if(t)return c(t.message),void l(!1);if(a&&a.length>0){console.log("Arquivos de professores encontrados:",a.length);const e=await Promise.all(a.map((async(e,a)=>{var s,r,n,l,i;const{data:{publicUrl:c}}=ie.N.storage.from("imagens-professores").getPublicUrl("".concat(o,"/").concat(e.name));let d="professor";e.name.startsWith("professora_")?d="professora":e.name.startsWith("professor_")&&(d="professor");let m=null;try{const a="".concat(o,"/").concat(e.name);console.log("Buscando legenda para professor:",a),m=await(0,xo.t$)(a,o,{categoria:"professor",tipo_foto:"professor"}),console.log("Legenda encontrada:",m)}catch(t){console.warn("Erro ao buscar legenda:",t)}return{id:a+1,publicURL:c,genero:d,nome:e.name,created_at:e.created_at||"",legenda:(null===(s=m)||void 0===s?void 0:s.legenda)||"Imagem do ".concat(d),descricaoDetalhada:null===(r=m)||void 0===r?void 0:r.descricao_detalhada,autor:null===(n=m)||void 0===n?void 0:n.autor_foto,dataFoto:null===(l=m)||void 0===l?void 0:l.data_foto,categoria:null===(i=m)||void 0===i?void 0:i.categoria}})));r(e)}else r([]);l(!1)})).catch((e=>{c("Erro inesperado: ".concat(e.message)),l(!1)})))}),[o]),n?(0,P.jsx)("div",{className:"text-gray-500",children:"Carregando imagens do professor..."}):i?(0,P.jsxs)("div",{className:"text-red-600",children:["Erro ao carregar imagens: ",i]}):s.length?(0,P.jsxs)("section",{className:"my-6",children:[(0,P.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:s.map(((e,o)=>(0,P.jsxs)("figure",{className:"rounded-lg overflow-hidden bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md",onClick:()=>{e.publicURL&&(g(o),m(e))},children:[(0,P.jsx)("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:(0,P.jsx)(yo,{src:e.publicURL,alt:e.legenda,className:"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105",isPreloaded:h(e.publicURL),style:{maxHeight:"350px"}})}),e.legenda&&(0,P.jsxs)("figcaption",{className:"p-3 bg-white",children:[(0,P.jsx)("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:e.legenda}),(0,P.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.categoria&&(0,P.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:e.categoria}),e.autor&&(0,P.jsxs)("span",{children:["Por: ",e.autor]}),e.dataFoto&&(0,P.jsx)("span",{children:new Date(e.dataFoto).toLocaleDateString("pt-BR")})]}),e.descricaoDetalhada&&(0,P.jsx)("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:e.descricaoDetalhada})]})]},e.id)))}),(0,P.jsx)(vo,{images:s,currentImageIndex:u,isOpen:!!d,onClose:x,onImageChange:g,showNavigation:!0,showControls:!0,showCounter:!0,showCaption:!0})]}):null},Co=t.memo(ko);var Ao=a(56478),_o=a(84583);const Eo=["src","alt","name","size","customSize","shape","variant","loading","error","clickable","className","borderColor","backgroundColor","textColor","badge","badgePosition","badgeColor","badgeSize","onClick","onError","onLoad","fallbackIcon","showInitials","maxInitials","lazy","priority"],Io=e=>{let{src:o,alt:a,name:s,size:r="medium",customSize:n,shape:l="circle",variant:i="default",loading:c=!1,error:d=!1,clickable:m=!1,className:u="",borderColor:g="border-green-200",backgroundColor:h="bg-gray-100",textColor:x="text-gray-600",badge:p,badgePosition:f="bottom-right",badgeColor:b="bg-green-500",badgeSize:v="small",onClick:w,onError:j,onLoad:y,fallbackIcon:k="user",showInitials:C=!0,maxInitials:A=2,lazy:_=!0,priority:E=!1}=e,I=(0,wo.A)(e,Eo);const[S,L]=(0,t.useState)(!1),[z,M]=(0,t.useState)(!!o),T=(0,t.useMemo)((()=>{if(n)return{container:"w-full h-full",text:"text-sm",icon:"w-6 h-6",badge:"w-3 h-3",customSize:n};const e={xs:{container:"w-6 h-6",text:"text-xs",icon:"w-3 h-3",badge:"w-2 h-2"},small:{container:"w-8 h-8",text:"text-xs",icon:"w-4 h-4",badge:"w-2 h-2"},medium:{container:"w-12 h-12 sm:w-16 sm:h-16",text:"text-sm sm:text-base",icon:"w-6 h-6 sm:w-8 sm:h-8",badge:"w-3 h-3"},large:{container:"w-16 h-16 sm:w-20 sm:h-20",text:"text-base sm:text-lg",icon:"w-8 h-8 sm:w-10 sm:h-10",badge:"w-4 h-4"},xlarge:{container:"w-20 h-20 sm:w-24 sm:h-24",text:"text-lg sm:text-xl",icon:"w-10 h-10 sm:w-12 sm:h-12",badge:"w-5 h-5"},xxlarge:{container:"w-24 h-24 sm:w-32 sm:h-32",text:"text-xl sm:text-2xl",icon:"w-12 h-12 sm:w-16 sm:h-16",badge:"w-6 h-6"}};return e[r]||e.medium}),[r,n]),D=(0,t.useMemo)((()=>{const e={circle:"rounded-full",square:"rounded-lg",rounded:"rounded-xl",none:"rounded-none"};return e[l]||e.circle}),[l]),F=(0,t.useMemo)((()=>{const e={default:{border:"border-2",shadow:"shadow-md",hover:"hover:shadow-lg"},minimal:{border:"border",shadow:"shadow-sm",hover:"hover:shadow-md"},flat:{border:"border-2",shadow:"shadow-none",hover:"hover:shadow-sm"},elevated:{border:"border-2",shadow:"shadow-lg",hover:"hover:shadow-xl"}};return e[i]||e.default}),[i]),O=(0,t.useMemo)((()=>{const e={"top-left":"top-0 left-0","top-right":"top-0 right-0","bottom-left":"bottom-0 left-0","bottom-right":"bottom-0 right-0",center:"top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},o={small:"w-3 h-3",medium:"w-4 h-4",large:"w-5 h-5"};return{position:e[f]||e["bottom-right"],size:o[v]||o.small}}),[f,v]),R=(0,t.useMemo)((()=>{if(!s||!C)return"";return s.trim().split(" ").slice(0,A).map((e=>e.charAt(0).toUpperCase())).filter((e=>e.match(/[A-Z]/))).join("")}),[s,C,A]),H=(0,t.useMemo)((()=>{const e={user:ao.A,alert:Ao.A,loading:_o.A};return e[k]||e.user}),[k]),q=o&&!S&&!c,U=!q&&R&&!d,B=!q&&!U&&!d,W="\n    ".concat(T.container,"\n    ").concat(D,"\n    ").concat(F.border,"\n    ").concat(g,"\n    ").concat(F.shadow,"\n    ").concat(m||w?"cursor-pointer":"","\n    ").concat(F.hover,"\n    transition-all duration-200\n    relative overflow-hidden\n    flex items-center justify-center\n    ").concat(u,"\n  ").trim().replace(/\s+/g," ");return(0,P.jsxs)("div",(0,N.A)((0,N.A)({className:W,style:n?{width:n,height:n}:void 0,onClick:e=>{(m||w)&&(null===w||void 0===w||w(e))},role:m||w?"button":void 0,tabIndex:m||w?0:void 0},I),{},{children:[c&&(0,P.jsx)("div",{className:"absolute inset-0 ".concat(h," flex items-center justify-center"),children:(0,P.jsx)("span",{className:"text-xs text-green-600",children:"Carregando..."})}),q&&(0,P.jsx)("img",(0,N.A)({src:o,alt:a||"Avatar de ".concat(s)||0,className:"w-full h-full object-cover ".concat(z?"opacity-0":"opacity-100"," transition-opacity duration-200"),onLoad:()=>{M(!1),L(!1),null===y||void 0===y||y()},onError:()=>{M(!1),L(!0),null===j||void 0===j||j()},loading:_?"lazy":"eager"},E&&{fetchPriority:"high"})),z&&q&&(0,P.jsx)("div",{className:"absolute inset-0 ".concat(h," flex items-center justify-center"),children:(0,P.jsx)("span",{className:"text-xs text-green-600",children:"Carregando..."})}),U&&(0,P.jsx)("span",{className:"".concat(T.text," font-semibold ").concat(x),children:R}),B&&(0,P.jsx)(H,{className:"".concat(T.icon," ").concat(x)}),d&&(0,P.jsx)("div",{className:"absolute inset-0 ".concat(h," flex items-center justify-center"),children:(0,P.jsx)(Ao.A,{className:"".concat(T.icon," text-red-500")})}),p&&(0,P.jsx)("div",{className:"absolute ".concat(O.position," ").concat(O.size," ").concat(b," rounded-full border-2 border-white"),children:"string"===typeof p?(0,P.jsx)("span",{className:"text-xs text-white font-bold flex items-center justify-center h-full",children:p}):p})]}))},So={default:{borderColor:"border-green-200",backgroundColor:"bg-green-50",textColor:"text-green-700",badgeColor:"bg-green-500",hoverBorderColor:"hover:border-green-300"},professor:{borderColor:"border-blue-200",backgroundColor:"bg-blue-50",textColor:"text-blue-700",badgeColor:"bg-blue-500",hoverBorderColor:"hover:border-blue-300"},escola:{borderColor:"border-orange-200",backgroundColor:"bg-orange-50",textColor:"text-orange-700",badgeColor:"bg-orange-500",hoverBorderColor:"hover:border-orange-300"},neutral:{borderColor:"border-gray-200",backgroundColor:"bg-gray-50",textColor:"text-gray-700",badgeColor:"bg-gray-500",hoverBorderColor:"hover:border-gray-300"},indigena:{borderColor:"border-amber-200",backgroundColor:"bg-amber-50",textColor:"text-amber-800",badgeColor:"bg-amber-600",hoverBorderColor:"hover:border-amber-300"},success:{borderColor:"border-emerald-200",backgroundColor:"bg-emerald-50",textColor:"text-emerald-700",badgeColor:"bg-emerald-500",hoverBorderColor:"hover:border-emerald-300"},warning:{borderColor:"border-yellow-200",backgroundColor:"bg-yellow-50",textColor:"text-yellow-800",badgeColor:"bg-yellow-500",hoverBorderColor:"hover:border-yellow-300"},error:{borderColor:"border-red-200",backgroundColor:"bg-red-50",textColor:"text-red-700",badgeColor:"bg-red-500",hoverBorderColor:"hover:border-red-300"}},Lo=e=>{let{fotoUrl:o,nomeProfessor:a,tamanho:t="medium",className:s="",showFallback:r=!0,theme:n="professor",variant:l="default",shape:i="circle",clickable:c=!1,badge:d,badgePosition:m="bottom-right",onClick:u,onError:g,onLoad:h,size:x,customSize:p,escolaId:f}=e;const b=x||{small:"medium",medium:"large",large:"xlarge",xlarge:"xxlarge"}[t]||"large",{isImagePreloaded:v}=No(f,!!f),w=So[n]||So.professor;return o||r?(0,P.jsx)(Io,{src:o,name:a,alt:a?"Foto de ".concat(a):"Foto do professor",size:p?void 0:b,customSize:p,shape:i,variant:l,theme:n,clickable:c,badge:d,badgePosition:m,className:s,onClick:u,onError:g,onLoad:h,showInitials:!0,maxInitials:2,fallbackIcon:"user",lazy:!v(o),borderColor:w.borderColor,backgroundColor:w.backgroundColor,textColor:w.textColor,badgeColor:w.badgeColor}):null},zo=(0,t.memo)((e=>{let{escola:o,refreshKey:a=0}=e;const[s,r]=(0,t.useState)([]),[n,l]=(0,t.useState)(!0),[i,c]=(0,t.useState)(null),[d,m]=(0,t.useState)(0),[u,g]=(0,t.useState)(null),h=(0,t.useCallback)((()=>g(null)),[]);(0,t.useEffect)((()=>{const e=e=>{"Escape"===e.key&&h()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[h]),(0,t.useEffect)((()=>{if(null===o||void 0===o||!o.id)return void l(!1);(async()=>{try{l(!0),c(null);const e=await(0,ho.Y8)(o.id);r(e||[]),m(0)}catch(e){c(e.message)}finally{l(!1)}})()}),[null===o||void 0===o?void 0:o.id,a]);const x=(0,t.useCallback)((()=>{m((e=>e<s.length-1?e+1:0))}),[s.length]),p=(0,t.useCallback)((()=>{m((e=>e>0?e-1:s.length-1))}),[s.length]);if((0,t.useEffect)((()=>{const e=e=>{s.length<=1||("ArrowRight"===e.key?x():"ArrowLeft"===e.key&&p())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[s.length,x,p]),n)return(0,P.jsx)("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-green-100/50",children:(0,P.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,P.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando hist\xf3rias do professor..."})})});if(i)return(0,P.jsx)("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-red-100/50",children:(0,P.jsx)("div",{className:"text-center py-8",children:(0,P.jsxs)("p",{className:"text-red-600",children:["Erro ao carregar hist\xf3rias do professor: ",i]})})});if(!s.length)return null;const f=s[d],b=s.length>1;return(0,P.jsxs)("div",{className:"mt-8 mb-12 flex flex-col items-center",children:[(0,P.jsxs)("header",{className:"mb-6 sm:mb-8 max-w-4xl mx-auto w-full",children:[(0,P.jsxs)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[(0,P.jsxs)("div",{className:"flex items-center gap-3",children:[(0,P.jsx)("span",{className:"bg-green-200 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:(0,P.jsx)("img",{src:"".concat("/opin","/passaro.svg"),alt:"\xcdcone de p\xe1ssaro",className:"w-12 h-12 sm:w-24 sm:h-24",style:{filter:"none",borderRadius:"0",boxShadow:"none",margin:"0",padding:"0",border:"none",outline:"none"},"aria-hidden":"true"})}),(0,P.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-black m-0",children:"Depoimento dos Professores"})]}),b&&(0,P.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:(0,P.jsxs)("span",{children:[d+1," de ",s.length]})})]}),(0,P.jsx)("div",{className:"h-1 w-20 sm:w-24 bg-green-300 rounded-full"})]}),(0,P.jsxs)("article",{className:" px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg prose prose-sm sm:prose-base md:prose-lg lg:prose-xl prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify prose-img:rounded-xl prose-img:shadow-lg prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600 max-w-4xl mx-auto w-full ",children:[(0,P.jsxs)("section",{className:"text-base sm:text-lg leading-relaxed text-neutral-800",children:[f.nome_professor&&(0,P.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[(0,P.jsx)("div",{className:"flex-shrink-0",children:(0,P.jsx)(Lo,{fotoUrl:f.foto_rosto,nomeProfessor:f.nome_professor,customSize:"200px",className:"shadow-lg",escolaId:o.id})}),(0,P.jsxs)("div",{className:"w-full text-center",children:[(0,P.jsx)("h3",{className:"text-xl sm:text-2xl font-bold text-green-800 mb-4 m-0",children:f.nome_professor}),(0,P.jsx)("div",{className:"historia-professor-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify prose-img:rounded-xl prose-img:shadow-lg prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600 prose-strong:text-green-800 prose-em:text-green-700 prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg prose-ul:text-black prose-ol:text-black prose-li:text-black prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm",dangerouslySetInnerHTML:{__html:f.historia}})]})]}),!f.nome_professor&&(0,P.jsx)("div",{className:"historia-professor-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify prose-img:rounded-xl prose-img:shadow-lg prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600 prose-strong:text-green-800 prose-em:text-green-700 prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg prose-ul:text-black prose-ol:text-black prose-li:text-black prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm",dangerouslySetInnerHTML:{__html:f.historia}}),f.imagem_public_url&&(0,P.jsx)("figure",{className:"my-6",children:(0,P.jsxs)("div",{className:"relative",children:[(0,P.jsx)("img",{src:f.imagem_public_url,alt:f.descricao_imagem||"Imagem da hist\xf3ria do professor",className:"w-full max-w-2xl mx-auto rounded-xl shadow-lg cursor-pointer transition-transform duration-200 hover:scale-105",onClick:()=>g(f),loading:"lazy"}),f.descricao_imagem&&(0,P.jsx)("figcaption",{className:"text-center text-sm text-gray-600 mt-2",children:f.descricao_imagem})]})})]}),b&&(0,P.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200",children:[(0,P.jsxs)("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Hist\xf3ria anterior",children:[(0,P.jsx)(go.A,{className:"w-5 h-5"}),(0,P.jsx)("span",{className:"hidden sm:inline",children:"Anterior"})]}),(0,P.jsx)("div",{className:"flex gap-2",children:s.map(((e,o)=>(0,P.jsx)("button",{onClick:()=>m(o),className:"w-3 h-3 rounded-full border-2 ".concat(o===d?"bg-green-600 border-green-600":"bg-white border-gray-300"," transition-colors"),"aria-label":"Ir para hist\xf3ria ".concat(o+1)},o)))}),(0,P.jsxs)("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Pr\xf3xima hist\xf3ria",children:[(0,P.jsx)("span",{className:"hidden sm:inline",children:"Pr\xf3xima"}),(0,P.jsx)(xe.A,{className:"w-5 h-5"})]})]}),u&&(0,P.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:h,children:(0,P.jsxs)("div",{className:"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center p-4",onClick:e=>e.stopPropagation(),children:[(0,P.jsx)("button",{className:"absolute top-4 right-4 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-80 z-10",onClick:h,"aria-label":"Fechar zoom",children:(0,P.jsx)(me.A,{className:"w-6 h-6"})}),(0,P.jsx)("img",{src:u.imagem_public_url,alt:u.descricao_imagem||"Imagem da hist\xf3ria do professor",className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl border-4 border-white"}),u.descricao_imagem&&(0,P.jsx)("figcaption",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 text-center text-sm text-white bg-black bg-opacity-50 rounded-lg px-3 py-1.5 max-w-2xl",children:u.descricao_imagem})]})}),(0,P.jsx)(Co,{escola_id:o.id,refreshKey:a})]})]})}));var Po=a(35349);const Mo=e=>{let{escola_id:o,refreshKey:a=0}=e;const[s,r]=(0,t.useState)([]),[n,l]=(0,t.useState)(!0),[i,c]=(0,t.useState)(null),[d,m]=(0,t.useState)(0),[u,g]=(0,t.useState)(""),h=(0,t.useRef)({}),[x,p]=(0,t.useState)(0),{isImagePreloaded:f}=No(o,!0),b=(0,t.useCallback)((()=>{console.log("Limpando cache e recarregando imagens..."),h.current={},p((e=>e+1))}),[]);(0,t.useEffect)((()=>{a>0&&(console.log("ImagensdasEscolas: refreshKey mudou, for\xe7ando recarga"),b())}),[a,b]);const v=(0,t.useCallback)((()=>{c(null),m(0),document.body.style.overflow="auto"}),[]);return(0,t.useEffect)((()=>{const e=e=>{"Escape"===e.key&&v()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[v]),(0,t.useEffect)((()=>{if(!o)return void l(!1);const e="".concat(o,"_v").concat(x);if(h.current[e])return console.log("Usando cache para escola",o),r(h.current[e]),void l(!1);(async()=>{console.log("Buscando imagens para escola",o);try{const{data:a,error:t}=await ie.N.storage.from("imagens-das-escolas").list("".concat(o,"/"));if(t)throw t;if(!a||0===a.length)return console.log("Nenhum arquivo encontrado para escola",o),r([]),void l(!1);console.log("Arquivos encontrados:",a.length);const s=await Promise.all(a.map((async(e,a)=>{var s,r,n,l,i;const c="".concat(o,"/").concat(e.name),{data:{publicUrl:d}}=ie.N.storage.from("imagens-das-escolas").getPublicUrl(c);let m=null;try{console.log("Buscando legenda para:",c),m=await(0,xo.t$)(c,o,{categoria:"escola",tipo_foto:"escola"}),console.log("Legenda encontrada:",m)}catch(t){console.warn("Erro ao buscar legenda para",c,":",t)}return{id:"".concat(o,"-").concat(e.name),publicURL:d,descricao:(null===(s=m)||void 0===s?void 0:s.legenda)||"Imagem ".concat(a+1),descricaoDetalhada:null===(r=m)||void 0===r?void 0:r.descricao_detalhada,autor:null===(n=m)||void 0===n?void 0:n.autor_foto,dataFoto:null===(l=m)||void 0===l?void 0:l.data_foto,categoria:null===(i=m)||void 0===i?void 0:i.categoria,urlError:null}})));console.log("Imagens processadas:",s.length),h.current[e]=s,r(s),0===s.length&&g("Nenhuma imagem encontrada para esta escola.")}catch(u){console.error("Erro ao processar imagens:",u),g("Erro ao carregar imagens da escola.")}finally{l(!1)}})()}),[o,x]),n?(0,P.jsx)("div",{className:"text-gray-500 flex items-center gap-2",children:"Carregando imagens da escola..."}):u?(0,P.jsxs)("div",{className:"text-red-600 flex items-center gap-2",children:[(0,P.jsx)("span",{children:u}),(0,P.jsx)("button",{onClick:b,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:(0,P.jsx)(Po.A,{className:"w-5 h-5"})})]}):s.length?(0,P.jsxs)("section",{className:"my-6",children:[(0,P.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:s.map((e=>(0,P.jsxs)("figure",{className:"rounded-lg overflow-hidden bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md",onClick:()=>{if(e.publicURL){const o=s.findIndex((o=>o.publicURL===e.publicURL));m(o),c(e)}},children:[(0,P.jsx)("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:(0,P.jsx)(yo,{src:e.publicURL,alt:e.descricao,className:"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105",isPreloaded:f(e.publicURL),style:{maxHeight:"350px"}})}),e.descricao&&(0,P.jsxs)("figcaption",{className:"p-3 bg-white",children:[(0,P.jsx)("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:e.descricao}),(0,P.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.categoria&&(0,P.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:e.categoria}),e.autor&&(0,P.jsxs)("span",{children:["Por: ",e.autor]}),e.dataFoto&&(0,P.jsx)("span",{children:new Date(e.dataFoto).toLocaleDateString("pt-BR")})]}),e.descricaoDetalhada&&(0,P.jsx)("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:e.descricaoDetalhada})]})]},e.id)))}),(0,P.jsx)(vo,{images:s,currentImageIndex:d,isOpen:!!i,onClose:v,onImageChange:m,showNavigation:!0,showControls:!0,showCounter:!0,showCaption:!0})]}):(0,P.jsxs)("div",{className:"text-yellow-700 flex items-center gap-2",children:[(0,P.jsx)("span",{children:"Nenhuma imagem encontrada para esta escola."}),(0,P.jsx)("button",{onClick:b,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:(0,P.jsx)(Po.A,{className:"w-5 h-5"})})]})},To=t.memo(Mo),Do=(0,t.memo)((e=>{let{children:o,shouldUseGrid:a}=e;const t=a?"masonry-grid":"space-y-4";return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("style",{children:"\n  .masonry-grid {\n    column-count: 1;\n    column-gap: 1.5rem;\n    column-fill: balance;\n  }\n  \n  .masonry-grid > * {\n    display: block;\n    break-inside: avoid;\n    page-break-inside: avoid;\n    margin-bottom: 1.5rem;\n  }\n  \n  /* Mobile: 1 coluna */\n  @media (max-width: 767px) {\n    .masonry-grid {\n      column-count: 1;\n    }\n  }\n  \n  /* Tablet e Desktop: 2 colunas */\n  @media (min-width: 768px) {\n    .masonry-grid {\n      column-count: 2;\n    }\n  }\n"}),(0,P.jsx)("div",{className:"".concat(t," transition-all duration-300 ease-in-out"),children:o})]})})),Fo=(0,t.memo)((e=>{let{escola:o,shouldUseGrid:a=!1,refreshKey:t=0}=e;if(console.log("EscolaInfo recebeu:",o),!o)return console.log("EscolaInfo: escola \xe9 null ou undefined"),null;const s=[{Component:Ie,props:{escola:o}},{Component:qe,props:{escola:o}},{Component:Xe,props:{escola:o}},{Component:no,props:{escola:o}},{Component:uo,props:{escola:o}}];return(0,P.jsxs)("div",{className:"space-y-8",children:[(0,P.jsx)(Do,{shouldUseGrid:a,children:s.map(((e,o)=>{let{Component:a,props:t}=e;return(0,P.jsx)(a,(0,N.A)({},t),o)}))}),(0,P.jsx)(ze,{escola:o,refreshKey:t}),(0,P.jsx)(To,{escola_id:o.id,refreshKey:t}),(0,P.jsx)(zo,{escola:o,refreshKey:t})]})})),Oo=["className"],Ro=e=>{let{className:o="w-5 h-5"}=e,a=(0,wo.A)(e,Oo);return(0,P.jsx)("svg",(0,N.A)((0,N.A)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",fill:"currentColor",className:o},a),{},{children:(0,P.jsx)("path",{d:"M200,80H184V64a32,32,0,0,0-56-21.13A32,32,0,0,0,72.21,60.42,32,32,0,0,0,24,88v40a104,104,0,0,0,208,0V112A32,32,0,0,0,200,80ZM152,48a16,16,0,0,1,16,16V80H136V64A16,16,0,0,1,152,48ZM88,64a16,16,0,0,1,32,0v40a16,16,0,0,1-32,0ZM40,88a16,16,0,0,1,32,0v16a16,16,0,0,1-32,0Zm176,40a88,88,0,0,1-175.92,3.75A31.93,31.93,0,0,0,80,125.13a31.93,31.93,0,0,0,44.58,3.35,32.21,32.21,0,0,0,11.8,11.44A47.88,47.88,0,0,0,120,176a8,8,0,0,0,16,0,32,32,0,0,1,32-32,8,8,0,0,0,0-16H152a16,16,0,0,1-16-16V96h64a16,16,0,0,1,16,16Z"})}))},Ho=(0,t.memo)((e=>{let{label:o,value:a,className:t="",isTextArea:s=!1}=e;if(!a)return null;const r=t.includes("flex flex-col")?"flex flex-col gap-1 text-sm py-0.5":"grid grid-cols-[auto,1fr] gap-x-2 text-sm py-0.5";return(0,P.jsxs)("div",{className:"".concat(r," ").concat(t),children:[(0,P.jsxs)("span",{className:"font-medium text-neutral-800",children:[o,":"]}),s?(0,P.jsx)("div",{className:"text-neutral-600",children:(0,P.jsx)("div",{className:"whitespace-pre-wrap break-words text-sm leading-relaxed",children:a})}):(0,P.jsx)("span",{className:"text-neutral-600 break-words",children:a})]})})),qo=e=>(0,P.jsx)(Ro,(0,N.A)({className:"w-8 h-8"},e)),Uo=(0,t.memo)((e=>{let{terraIndigena:o}=e;if(!o)return console.log("TerraIndigenaInfo: terraIndigena \xe9 null ou undefined"),null;return(0,P.jsxs)(Ne,{title:"Informa\xe7\xf5es da Terra Ind\xedgena",icon:qo,children:[(0,P.jsx)(Ho,{label:"Povos Ind\xedgenas",value:o.etnia}),(0,P.jsx)(Ho,{label:"Localiza\xe7\xe3o",value:"".concat(o.municipio||"",", ").concat(o.uf||"").trim()}),(0,P.jsx)(Ho,{label:"Superf\xedcie",value:o.superficie?"Superf\xedcie: ".concat(parseFloat(o.superficie).toFixed(2)," ha"):null}),(0,P.jsx)(Ho,{label:"Fase",value:o.fase}),(0,P.jsx)(Ho,{label:"Modalidade",value:o.modalidade}),(0,P.jsx)(Ho,{label:"Reestudo",value:o.reestudo}),(0,P.jsx)(Ho,{label:"Coordena\xe7\xe3o Regional",value:o.cr}),(0,P.jsx)(Ho,{label:"Faixa de Fronteira",value:o.faixa_fron}),(0,P.jsx)(Ho,{label:"Unidade Administrativa",value:o.undadm_nom}),(0,P.jsx)(Ho,{label:"Sigla Unidade",value:o.undadm_sig}),(0,P.jsx)(Ho,{label:"Dom\xednio",value:o.dominio_un}),(0,P.jsx)(Ho,{label:"Data de Atualiza\xe7\xe3o",value:o.data_atual}),(0,P.jsx)(Ho,{label:"C\xf3digo Terra Ind\xedgena",value:o.terrai_cod}),(0,P.jsx)(Ho,{label:"C\xf3digo Unidade Administrativa",value:o.undadm_cod})]})}));var Bo=a(519),Wo=a(39501),Go=a(65410),Vo=a(52291);const Zo=e=>{let{children:o,text:a,position:s="top"}=e;const[r,n]=(0,t.useState)(!1);return(0,P.jsxs)("div",{className:"relative inline-block",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onFocus:()=>n(!0),onBlur:()=>n(!1),children:[o,r&&(0,P.jsxs)("div",{className:"\n          absolute z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-xl whitespace-nowrap\n          ".concat({top:"bottom-full left-1/2 transform -translate-x-1/2 mb-3",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-3"}[s],"\n          animate-in fade-in-0 zoom-in-95 duration-200\n        "),children:[a,(0,P.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},Ko=e=>{let{onClick:o,url:a,title:s,description:r=""}=e;const[n,l]=(0,t.useState)(!1),i=["Conhe\xe7a a escola ind\xedgena: ".concat(s),"Descubra esta escola ind\xedgena: ".concat(s),"Escola ind\xedgena incr\xedvel: ".concat(s),"Educa\xe7\xe3o ind\xedgena em destaque: ".concat(s),"Conhe\xe7a esta escola: ".concat(s),"Escola ind\xedgena que inspira: ".concat(s),"Educa\xe7\xe3o que transforma: ".concat(s),"Escola ind\xedgena de refer\xeancia: ".concat(s)],c=i[Math.floor(Math.random()*i.length)],d=a||window.location.href,m=[{name:"WhatsApp",icon:(0,P.jsx)(Te.A,{className:"w-5 h-5"}),color:"bg-green-500 hover:bg-green-600",component:Bo.Kz,props:{url:d,title:c}},{name:"Facebook",icon:(0,P.jsx)(Wo.A,{className:"w-5 h-5"}),color:"bg-blue-600 hover:bg-blue-700",component:Bo.uI,props:{url:d,quote:c}},{name:"Twitter",icon:(0,P.jsx)(Go.A,{className:"w-5 h-5"}),color:"bg-sky-500 hover:bg-sky-600",component:Bo.r6,props:{url:d,title:c}},{name:"LinkedIn",icon:(0,P.jsx)(Vo.A,{className:"w-5 h-5"}),color:"bg-blue-700 hover:bg-blue-800",component:Bo.wk,props:{url:d,title:s,summary:r}}];return(0,P.jsx)("div",{className:"px-4 py-4 border-t border-green-200 bg-gradient-to-b from-white to-green-50",children:(0,P.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,P.jsx)("div",{className:"text-center mb-3",children:(0,P.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Compartilhe esta escola"})}),(0,P.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,P.jsx)(Zo,{text:n?"Link copiado!":"Copiar link",children:(0,P.jsxs)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(a),l(!0),setTimeout((()=>l(!1)),3e3)}catch(e){const o=document.createElement("input");o.value=a,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),l(!0),setTimeout((()=>l(!1)),3e3)}},className:"\n                flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg transition-all duration-200\n                focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1\n                ".concat(n?"bg-green-100 text-green-800":"bg-green-500 hover:bg-green-600 text-white","\n              "),"aria-label":"Copiar link",children:[n?(0,P.jsx)(de.A,{className:"w-4 h-4"}):(0,P.jsx)(pe.A,{className:"w-4 h-4"}),(0,P.jsx)("span",{className:"text-xs font-medium",children:n?"Copiado":"Link"})]})}),m.map(((e,o)=>{const a=e.component;return(0,P.jsx)(Zo,{text:"Compartilhar no ".concat(e.name),children:(0,P.jsx)(a,(0,N.A)((0,N.A)({},e.props),{},{className:"transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1","aria-label":"Compartilhar no ".concat(e.name),children:(0,P.jsxs)("div",{className:"\n                    flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg text-white\n                    ".concat(e.color,"\n                  "),children:[e.icon,(0,P.jsx)("span",{className:"text-xs font-medium",children:e.name})]})}))},o)}))]})]})})},Jo=t.memo(Ko);var Yo=a(41360);const Xo=(0,t.memo)((e=>{let{copiarLink:o,compartilhar:a,painelInfo:s}=e;const r=(0,t.useMemo)((()=>(0,Yo.aH)(s)),[s]),n=(0,t.useMemo)((()=>(0,Yo.Ec)(s)),[s]),l=(0,t.useMemo)((()=>(0,Yo.M)(s)),[s]);return(0,P.jsx)(Jo,{onClick:a,url:r,title:l,description:n})}));var $o=a(87977);const Qo=e=>{let{descricao:o,className:a=""}=e;const s=(0,t.useMemo)((()=>o?$o.A.sanitize((e=>{if(!e)return"";let o=e.replace(/\n\n+/g,"</p><p>");return o=o.replace(/\n/g,"<br>"),o.startsWith("<p>")||(o="<p>"+o),o.endsWith("</p>")||(o+="</p>"),o=o.replace(/>\s+</g,"><"),o})(o),{ALLOWED_TAGS:["b","i","em","strong","a","p","br","ul","ol","li","div","span","img","h1","h2","h3","h4","h5","h6","center","blockquote","code","pre","hr","table","thead","tbody","tr","th","td"],ALLOWED_ATTR:["href","target","rel","class","style","src","alt","width","height","id","title","aria-label","aria-describedby"],ADD_TAGS:["center","blockquote"],ADD_ATTR:["target","className","title"],KEEP_CONTENT:!0,ALLOW_DATA_ATTR:!1}):""),[o]);return o?(0,P.jsx)("div",{className:"mb-6 ".concat(a),children:(0,P.jsx)("div",{className:"prose prose-lg lg:prose-xl max-w-none px-1",style:{"--tw-prose-body":"#1f2937","--tw-prose-headings":"#111827","--tw-prose-links":"#059669","--tw-prose-bold":"#111827","--tw-prose-counters":"#1f2937","--tw-prose-bullets":"#4b5563","--tw-prose-hr":"#e5e7eb","--tw-prose-quotes":"#111827","--tw-prose-quote-borders":"#10b981","--tw-prose-captions":"#6b7280","--tw-prose-code":"#111827","--tw-prose-pre-code":"#e5e7eb","--tw-prose-pre-bg":"#1f2937","--tw-prose-th-borders":"#d1d5db","--tw-prose-td-borders":"#e5e7eb",lineHeight:"1.8",fontSize:"1.125rem",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',letterSpacing:"0.015em"},dangerouslySetInnerHTML:{__html:s},"aria-live":"polite"})}):null},ea=t.memo(Qo),oa=(0,t.memo)((e=>{let{painelInfo:o}=e;return(0,P.jsxs)("div",{className:"space-y-6",children:[(0,P.jsx)("div",{className:"prose prose-lg lg:prose-xl max-w-none",children:(0,P.jsx)("div",{className:"bg-green-100 rounded-lg p-6",children:(0,P.jsx)(ea,{descricao:o.descricao_detalhada})})}),o.audioUrl&&(0,P.jsx)("div",{className:"mt-6",children:(0,P.jsxs)("audio",{controls:!0,className:"w-full",children:[(0,P.jsx)("source",{src:o.audioUrl,type:"audio/mpeg"}),"Seu navegador n\xe3o suporta o elemento de \xe1udio."]})})]})}));var aa=a(2922),ta=a(64224);const sa=["EE","EEI"],ra=e=>{if(!e||"string"!==typeof e)return"";return e.split(/\s+/).map((e=>sa.includes(e.toUpperCase())?e.toUpperCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(" ")},na=e=>{if(!e)return"";const o=e.toLowerCase();if(o.includes("escola estadual")&&o.includes("aldeia")){const o=e.split(" "),a=o.findIndex((e=>e.toLowerCase().includes("aldeia")));if(-1!==a&&a<o.length-1){const e=o.slice(a+1).join(" ");return"E.E.I ".concat(ra(e))}}return ra(e)},la=e=>{let{titulo:o,closePainel:a,toggleMaximize:t,isMaximized:s,imagemHeader:r}=e;const n=window.innerWidth<=768,l=n&&window.innerWidth>window.innerHeight,i=l&&window.innerWidth<=850;return(0,P.jsxs)("header",{className:"relative border-b border-green-100 ".concat(l?"min-h-[60px]":""),children:[(0,P.jsx)("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8 py-2 sm:py-2 md:py-3",children:(0,P.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between pr-12",children:(0,P.jsxs)("div",{className:"space-y-1",children:[(0,P.jsx)("h2",{id:"painel-titulo",className:"font-bold text-gray-900 leading-tight tracking-tight break-words ".concat(i?"text-lg":l?"text-xl sm:text-2xl":"text-2xl sm:text-3xl md:text-4xl"),style:i?{fontSize:"clamp(1.125rem, 4.5vw, 1.5rem)"}:{},children:na(o)}),(0,P.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600",children:[(0,P.jsx)(ue.A,{className:"w-3 h-3"})," ",(0,P.jsxs)("span",{className:"text-xs sm:text-sm font-medium",children:[" ","Escola Estadual Ind\xedgena"]})]})]})})}),(0,P.jsxs)("div",{className:"absolute top-2 sm:top-4 right-2 sm:right-4 flex items-center gap-2",children:[!n&&(0,P.jsx)("button",{onClick:t,className:"p-2 text-green-700 hover:text-green-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":s?"Restaurar painel":"Maximizar painel",title:s?"Restaurar":"Maximizar",children:s?(0,P.jsx)(aa.A,{size:18,className:"stroke-2","aria-hidden":"true"}):(0,P.jsx)(ta.A,{size:18,className:"stroke-2","aria-hidden":"true"})}),(0,P.jsx)("button",{onClick:a,className:"text-gray-700 hover:text-gray-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ".concat(l?"p-1.5":"p-2"),"aria-label":"Fechar painel",children:(0,P.jsx)(me.A,{size:l?18:20,"aria-hidden":"true",className:"stroke-2"})})]})]})},ia=e=>{let{imagemUrl:o,className:a="",isPreloaded:s=!1}=e;const[r,n]=(0,t.useState)(!1);return!o||r?null:(0,P.jsxs)("div",{className:"escola-header-image escola-header-shimmer relative overflow-hidden ".concat(a),children:[(0,P.jsx)("div",{className:"absolute inset-0",children:(0,P.jsx)(yo,{src:o,alt:"Imagem da escola",className:"w-full h-full object-cover transition-all duration-700 ease-out",isPreloaded:s,onLoad:()=>{n(!1)},onError:()=>{n(!0)}})}),(0,P.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-black/20 via-black/10 to-black/30"}),(0,P.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),(0,P.jsx)("div",{className:"absolute inset-0 opacity-5",children:(0,P.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.05)_0%,transparent_50%)]"})}),(0,P.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-radial from-white/5 to-transparent rounded-full blur-xl"})]})},ca=e=>{const[o,a]=(0,t.useState)(!1),{isMobile:s}=(0,se.d)();return(0,t.useEffect)((()=>(z.debug("usePainelVisibility - painelInfo mudou:",e),e&&"object"===typeof e?(z.debug("usePainelVisibility: Definindo visibilidade como true"),a(!0),document.body.style.overflow="hidden"):(z.debug("usePainelVisibility: Definindo visibilidade como false"),a(!1),document.body.style.overflow=""),()=>{document.body.style.overflow=""})),[e]),{isVisible:o,isMobile:s}},da=e=>{let{painelInfo:o,closePainel:a,children:s,isMaximized:r,onToggleMaximize:n}=e;const{isVisible:l,isMobile:i}=ca(o),c=((e,o)=>{const[a,s]=(0,t.useState)(window.innerWidth),[r,n]=(0,t.useState)(window.innerHeight),l={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};(0,t.useEffect)((()=>{const e=()=>{s(window.innerWidth),n(window.innerHeight)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const i=(0,t.useMemo)((()=>{const t=e&&a>r,s="calc(100vh - ".concat(t?48:e?56:72,"px)"),n=a>=l.md;let i;return i=e||o?"100%":a>=l.lg?"49%":"75%",{height:s,maxHeight:e?"96vh":"92vh",width:i,isDesktop:n,isMobileLandscape:t,shouldUseGrid:n&&o,breakpoints:l,zIndex:1e3}}),[e,o,a,r]);return i})(i,r),{isImagePreloaded:d}=No(null===o||void 0===o?void 0:o.id,!0);if(!o)return null;const m=i&&window.innerWidth>window.innerHeight?48:i?56:72,u="\n    fixed\n    ".concat(i?"inset-x-0 top-0 w-full h-full":"top-30 bottom-0 right-0 w-full sm:w-3/4 lg:w-[49%] h-auto","\n    rounded-t-xl shadow-xl z-[9999] transform transition-all duration-500 ease-in-out\n    bg-white border-t-4 border-white mj-panel\n  "),g=l?"translate-y-0 opacity-100":"translate-y-full opacity-0";return(0,P.jsxs)("div",{role:"dialog","aria-labelledby":"painel-titulo","aria-describedby":"painel-descricao","aria-modal":"true",className:"".concat(u," ").concat(g).concat(i?" painel-informacoes-mobile":""),style:(0,N.A)({height:c.height,maxHeight:c.maxHeight,width:i?"100%":c.width,top:i?"".concat(m,"px"):72,display:"flex",flexDirection:"column"},i&&{borderRadius:c.isMobileLandscape?"0":"1rem 1rem 0 0",boxShadow:c.isMobileLandscape?"0 0 0 0":"0 -4px 6px -1px rgba(0, 0, 0, 0.1), 0 -2px 4px -1px rgba(0, 0, 0, 0.06)"}),children:[(0,P.jsx)(la,{titulo:o.titulo,closePainel:a,toggleMaximize:n,isMaximized:r,imagemHeader:o.imagem_header}),(0,P.jsxs)("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-green-600/40 scrollbar-track-green-50/20 mj-panel-content",children:[o.imagem_header&&(0,P.jsx)(ia,{imagemUrl:o.imagem_header,className:"h-56 sm:h-64 md:h-72 lg:h-80 xl:h-96 w-full",isPreloaded:d(o.imagem_header)}),(0,P.jsx)("div",{className:"".concat(i?"p-3 sm:p-4":"p-6"," space-y-4 sm:space-y-5 -mt-2"),children:(0,P.jsx)("div",{className:"prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none mj-prose",children:s})})]})]})},ma=t.memo(da),ua=e=>{if(!e||"string"!==typeof e)return null;const o=e.match(/\/d\/([a-zA-Z0-9-_]+)/);if(!o)return null;const a=o[1];return"https://docs.google.com/gview?url=https://drive.google.com/uc?id=".concat(a,"&embedded=true")},ga=e=>{let{viewMode:o,setViewMode:a}=e;return(0,P.jsxs)("div",{className:"flex items-center gap-2",role:"tablist","aria-label":"Modos de visualiza\xe7\xe3o dos documentos",children:[(0,P.jsxs)("button",{type:"button",role:"tab","aria-selected":"list"===o,"aria-label":"Visualizar em lista",onClick:()=>a("list"),className:"p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ".concat("list"===o?"bg-green-100 text-green-800 font-semibold":"text-gray-600 hover:bg-gray-100"),tabIndex:0,children:[(0,P.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),(0,P.jsx)("span",{className:"hidden sm:inline",children:"Lista"})]}),(0,P.jsxs)("button",{type:"button",role:"tab","aria-selected":"grid"===o,"aria-label":"Visualizar em grade",onClick:()=>a("grid"),className:"p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ".concat("grid"===o?"bg-green-100 text-green-800 font-semibold":"text-gray-600 hover:bg-gray-100"),tabIndex:0,children:[(0,P.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),(0,P.jsx)("span",{className:"hidden sm:inline",children:"Grade"})]})]})},ha=e=>{let{documentos:o,title:a="Documentos"}=e;const[s,r]=(0,t.useState)(null),[n,l]=(0,t.useState)("list"),i=(0,t.useRef)(null),[c,d]=(0,t.useState)(!1),[m,u]=(0,t.useState)(!1);if((0,t.useEffect)((()=>{s&&(d(!1),u(!1))}),[s]),(0,t.useEffect)((()=>{!s&&(null===o||void 0===o?void 0:o.length)>0&&r(o[0])}),[o,s]),(0,t.useEffect)((()=>{const e=i.current;if(!e||!s)return;const o=()=>{d(!1)},a=()=>{d(!0),u(!0)};return e.addEventListener("load",o),e.addEventListener("error",a),()=>{e.removeEventListener("load",o),e.removeEventListener("error",a)}}),[s]),!o||0===o.length)return null;return(0,P.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,P.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,P.jsxs)("h3",{className:"text-xl font-semibold text-green-800",children:[a,":"]}),o.length>1&&(0,P.jsx)(ga,{viewMode:n,setViewMode:l})]}),o.length>1&&(0,P.jsx)("div",{className:"mb-6",children:"grid"===n?(0,P.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:o.map((e=>(0,P.jsx)("div",{className:"\n              flex flex-col justify-between h-full max-w-xs mx-auto\n              rounded-2xl transition-all duration-200 cursor-pointer\n              shadow-sm hover:shadow-lg\n              ".concat((null===s||void 0===s?void 0:s.id)===e.id?"bg-green-100 scale-[1.03]":"bg-white hover:bg-green-50","\n            "),onClick:()=>{r(e)},tabIndex:0,"aria-label":"Selecionar documento: ".concat(e.titulo),children:(0,P.jsxs)("div",{className:"p-5 flex-1 flex flex-col justify-between",children:[(0,P.jsx)("h4",{className:"font-semibold text-green-800 mb-2 line-clamp-2 text-lg",children:e.titulo}),e.autoria&&(0,P.jsxs)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-1",children:["Por: ",e.autoria]}),e.tipo&&(0,P.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full",children:e.tipo})]})},e.id)))}):(0,P.jsx)("div",{className:"space-y-2",children:o.map((e=>(0,P.jsxs)("button",{onClick:()=>{r(e)},className:"w-full text-left p-3 rounded-lg transition-colors duration-200 ".concat((null===s||void 0===s?void 0:s.id)===e.id?"bg-green-100":"hover:bg-green-50"),children:[(0,P.jsx)("h4",{className:"font-medium text-green-800",children:e.titulo}),e.autoria&&(0,P.jsxs)("p",{className:"text-sm text-gray-600",children:["Por: ",e.autoria]}),e.tipo&&(0,P.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full",children:e.tipo})]},e.id)))})}),(()=>{if(!s)return null;const e=s.link_pdf.includes("drive.google.com/file/d/");return(0,P.jsx)("div",{className:"rounded-lg overflow-hidden shadow-lg bg-white",children:e?(0,P.jsxs)(P.Fragment,{children:[m?(0,P.jsx)("iframe",{ref:i,src:ua(s.link_pdf),width:"100%",height:"500px",allow:"autoplay",loading:"lazy",title:"".concat(s.titulo," (Google Docs Viewer)"),sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",className:"bg-white"}):(0,P.jsx)("iframe",{ref:i,src:s.link_pdf.replace("/view?usp=sharing","/preview"),width:"100%",height:"500px",allow:"autoplay",loading:"lazy",title:s.titulo,sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",className:"bg-white"}),c&&(0,P.jsxs)("div",{className:"p-6 text-center text-gray-600 bg-green-100",children:[(0,P.jsx)("p",{className:"mb-3 text-lg",children:"N\xe3o foi poss\xedvel carregar o documento diretamente."}),(0,P.jsxs)("a",{href:s.link_pdf,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[(0,P.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Abrir em nova aba"]})]})]}):(0,P.jsx)("div",{className:"flex justify-center p-6",children:(0,P.jsxs)("a",{href:s.link_pdf,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[(0,P.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Ver documento PDF"]})})})})()]})},xa=t.memo(ha),pa=e=>{let{videoUrl:o,title:a="V\xeddeo",escolaId:s}=e;const[r,n]=(0,t.useState)(null),[,l]=(0,t.useState)(!1);if((0,t.useEffect)((()=>{(async()=>{if(o&&s)try{l(!0);const e=await(0,xo.jW)(o,s);n(e)}catch(e){console.warn("Erro ao buscar t\xedtulo personalizado:",e)}finally{l(!1)}})()}),[o,s]),!o)return null;const i=(e=>{if(!e||"string"!==typeof e)return null;const o=e.split("?")[0],a=[/youtube\.com\/embed\/([^/?&]+)/,/youtube\.com\/watch\?v=([^&]+)/,/youtu\.be\/([^?&]+)/,/youtube\.com\/v\/([^?&]+)/];for(const t of a){const e=o.match(t);if(e&&e[1])return e[1]}return null})(o);return i?(0,P.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,P.jsxs)("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[(null===r||void 0===r?void 0:r.titulo)||a,":"]}),r&&(0,P.jsxs)("div",{className:"mb-4 p-4 bg-green-100 rounded-lg",children:[r.descricao&&(0,P.jsx)("p",{className:"text-gray-700 mb-2",children:r.descricao}),(0,P.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[r.categoria&&(0,P.jsx)("span",{className:"capitalize bg-green-200 text-green-800 px-2 py-1 rounded",children:r.categoria}),r.plataforma&&(0,P.jsx)("span",{className:"capitalize",children:r.plataforma}),r.duracao&&(0,P.jsxs)("span",{children:["Dura\xe7\xe3o: ",r.duracao]})]})]}),(0,P.jsx)("div",{className:"rounded-lg overflow-hidden shadow-lg bg-white",children:(0,P.jsx)("div",{className:"relative pb-[56.25%] h-0",children:(0,P.jsx)("iframe",{className:"absolute top-0 left-0 w-full h-full",src:"https://www.youtube.com/embed/".concat(i),title:(null===r||void 0===r?void 0:r.titulo)||a,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy",referrerPolicy:"origin"})})})]}):(0,P.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,P.jsxs)("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[(null===r||void 0===r?void 0:r.titulo)||a,":"]}),(0,P.jsxs)("div",{className:"p-6 text-center text-gray-600 bg-gray-50 rounded-lg",children:[(0,P.jsx)("p",{className:"mb-3 text-lg",children:"Link do v\xeddeo inv\xe1lido ou n\xe3o suportado."}),(0,P.jsxs)("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[(0,P.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,P.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Tentar abrir no YouTube"]})]})]})},fa=t.memo(pa),ba=e=>{let{painelInfo:o,closePainel:a,escola_id:s,refreshKey:r=0}=e;const n=(0,t.useRef)(null),[l,i]=(0,t.useState)(!1),{gerarLinkCustomizado:c,copiarLink:d,compartilhar:m}=(e=>{const o=()=>window.location.origin+window.location.pathname+"?panel="+(0,le.N)(e.titulo);return{gerarLinkCustomizado:o,copiarLink:async()=>{const e=o();try{await navigator.clipboard.writeText(e),alert("Link copiado!")}catch(a){const o=document.createElement("input");o.value=e,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),alert("Link copiado!")}},compartilhar:()=>{const a=o(),t="Confira este painel: ".concat(e.titulo);navigator.share?navigator.share({title:e.titulo,text:t,url:a}):window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(t),"&url=").concat(encodeURIComponent(a)),"_blank")}}})(o),{documentos:u}=ce(null===o||void 0===o?void 0:o.id);var g,h;if(((e,o)=>{const a=(0,t.useRef)(null),s=(0,t.useRef)(null);(0,t.useEffect)((()=>{if(e)return s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{const e=o();if(e!==a.current)try{window.history.replaceState({},"",e),a.current=e}catch(t){console.warn("Erro ao atualizar URL:",t)}}),300),()=>{s.current&&clearTimeout(s.current)}}),[e,o])})(o,c),g=n,h=a,(0,t.useEffect)((()=>{const e=e=>{const o=e.target;o.classList&&o.classList.contains("openlayers-container")||g.current&&!g.current.contains(e.target)&&h(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[g,h]),(0,t.useEffect)((()=>{console.log("PainelInformacoes: refreshKey mudou para",r)}),[r]),!o)return null;const x="terra_indigena"===o.tipo,p="Sobre o site"===o.titulo;return(0,P.jsx)("div",{ref:n,children:(0,P.jsxs)(ma,{painelInfo:o,closePainel:a,isMaximized:l,onToggleMaximize:()=>i((e=>!e)),children:[p?(0,P.jsx)(oa,{painelInfo:o}):x?(0,P.jsx)(Uo,{terraIndigena:o}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Fo,{escola:o,shouldUseGrid:!0,refreshKey:r}),u&&u.length>0&&(0,P.jsx)(xa,{documentos:u,title:"Produ\xe7\xf5es e materiais da escola"}),o.link_para_videos&&(0,P.jsx)(fa,{videoUrl:o.link_para_videos,title:(0,P.jsx)("span",{style:{fontSize:"0.75em"},children:"Produ\xe7\xf5es audiovisuais realizadas na ".concat(o.titulo)}),escolaId:o.id})]}),(0,P.jsx)(Xo,{copiarLink:d,compartilhar:m,painelInfo:o})]})})},va=t.memo(ba);var wa=a(43303);const ja=e=>{let{dataPoints:o,onPainelOpen:a,isLoading:s=!1}=e;z.debug("DataPoints recebidos no MapaEscolasIndigenas:",o?{quantidade:o.length,exemplo:o[0]?{titulo:o[0].titulo,latitude:o[0].Latitude,longitude:o[0].Longitude,tipo:o[0].tipo}:"Nenhum ponto"}:"Nenhum dataPoint");const{refreshKey:r}=(0,wa.b)(),n=(0,t.useMemo)((()=>new URLSearchParams(window.location.search)),[]).get("panel"),l=(0,t.useMemo)((()=>{if(n&&""!==n&&o&&o.length>0){return o.find((e=>(0,le.N)(e.titulo)===n))||null}return null}),[n,o]),[i,c]=(0,t.useState)(l),[d,m]=(0,t.useState)(!!l),u=(0,t.useMemo)((()=>o?o.filter((e=>e.pontuacao>=0)):[]),[o]),g=(0,t.useCallback)((e=>{e&&c(e)}),[]),h=(0,t.useCallback)((()=>{z.debug("For\xe7ando refresh do painel de informa\xe7\xf5es")}),[]);(0,t.useEffect)((()=>{!l||i||d||(z.debug("MapaEscolasIndigenas: Abrindo painel automaticamente para:",l.titulo),c(l),m(!0))}),[l,i,d]),(0,t.useEffect)((()=>{z.debug("MapaEscolasIndigenas: onPainelOpen dispon\xedvel:",!!a),z.debug("MapaEscolasIndigenas: abrirPainel dispon\xedvel:",!!g),a&&"function"===typeof a&&(z.debug("MapaEscolasIndigenas: Expondo fun\xe7\xe3o abrirPainel e refreshPainel"),a(g,h))}),[g,a,h]);const x=(0,t.useCallback)((()=>{c(null)}),[]);return(0,P.jsxs)("div",{className:"relative h-screen w-full overflow-hidden",children:[(0,P.jsx)(ne,{dataPoints:u,onPainelOpen:g,painelAberto:!!i,className:"h-full w-full",isMainLoading:s}),i&&(0,P.jsx)(va,{painelInfo:i,closePainel:x,refreshKey:r})]})},ya=t.memo(ja)},40237:(e,o,a)=>{a.d(o,{eP:()=>l,iy:()=>s,jW:()=>c,qP:()=>r,t$:()=>n,w_:()=>i});var t=a(92880);const s=async()=>{try{const{error:e}=await t.N.from("legendas_fotos").select("count").limit(1);return e?(console.warn("Tabela legendas_fotos n\xe3o encontrada ou sem permiss\xe3o:",e.message),!1):(console.log("Tabela legendas_fotos acess\xedvel"),!0)}catch(e){return console.warn("Erro ao testar tabela legendas_fotos:",e.message),!1}},r=async function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let s=t.N.from("legendas_fotos").select("*").eq("imagem_url",e).eq("escola_id",o);!1!==a.ativo&&(s=s.eq("ativo",!0)),a.categoria&&(s=s.eq("categoria",a.categoria)),a.tipo_foto&&(s=s.eq("tipo_foto",a.tipo_foto));const{data:r,error:n}=await s.order("created_at",{ascending:!1});return n?(console.warn("Erro ao buscar legenda:",n.message),null):r&&r.length>0?r[0]:null}catch(s){return console.warn("Erro ao buscar legenda:",s.message),null}},n=async function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(console.log("\ud83d\udd0d Buscando legenda flex\xedvel para: ".concat(e," (escola: ").concat(o,")")),a.categoria||a.tipo_foto){console.log("  \ud83d\udccb Tentativa 1: Busca com prefer\xeancias espec\xedficas");const t=await r(e,o,a);if(t)return console.log("  \u2705 Encontrada com prefer\xeancias espec\xedficas"),t}console.log("  \ud83d\udccb Tentativa 2: Busca apenas por URL e escola");const{data:s,error:n}=await t.N.from("legendas_fotos").select("*").eq("imagem_url",e).eq("escola_id",o).eq("ativo",!0).order("created_at",{ascending:!1});if(n)console.warn("  \u274c Erro na busca por URL e escola:",n.message);else if(s&&s.length>0)return console.log("  \u2705 Encontrada por URL e escola"),s[0];console.log("  \ud83d\udccb Tentativa 3: Busca incluindo legendas inativas");const{data:l,error:i}=await t.N.from("legendas_fotos").select("*").eq("imagem_url",e).eq("escola_id",o).order("created_at",{ascending:!1});if(i)console.warn("  \u274c Erro na busca incluindo inativas:",i.message);else if(l&&l.length>0)return console.log("  \u2705 Encontrada incluindo legendas inativas"),l[0];const c=e.split("/").pop();console.log("  \ud83d\udccb Tentativa 4: Busca por nome do arquivo: ".concat(c));const{data:d,error:m}=await t.N.from("legendas_fotos").select("*").ilike("imagem_url","%".concat(c)).eq("escola_id",o).eq("ativo",!0).order("created_at",{ascending:!1});if(m)console.warn("  \u274c Erro na busca por nome do arquivo:",m.message);else if(d&&d.length>0)return console.log("  \u2705 Encontrada por nome do arquivo"),d[0];return console.log("  \u274c Nenhuma legenda encontrada com todas as estrat\xe9gias"),null}catch(s){return console.warn("Erro ao buscar legenda flex\xedvel:",s.message),null}},l=async e=>{try{const{data:o,error:a}=await t.N.from("legendas_fotos").insert([e]).select().single();if(a)throw a;return o}catch(o){throw console.error("Erro ao adicionar legenda:",o),o}},i=async(e,o)=>{try{const{data:a,error:s}=await t.N.from("legendas_fotos").update(o).eq("id",e).select().single();if(s)throw s;return a}catch(a){throw console.error("Erro ao atualizar legenda:",a),a}},c=async(e,o)=>{try{const{data:a,error:s}=await t.N.from("legendas_fotos").select("*").eq("imagem_url",e).eq("escola_id",o).eq("categoria","video").single();if(s){if("PGRST116"===s.code)return null;throw s}return a}catch(a){return console.warn("Erro ao buscar t\xedtulo do v\xeddeo:",a.message),null}}},82006:(e,o,a)=>{a.d(o,{Y8:()=>n,e0:()=>i,g2:()=>c,lz:()=>l});var t=a(89379),s=a(92880);const r={BUCKET_NAME:"historia-professor-imagens",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_HISTORIA:1,MIN_DIMENSIONS:{width:200,height:200}},n=async e=>{try{const{data:o,error:a}=await s.N.from("historias_professor").select("*").eq("escola_id",e).eq("ativo",!0).order("ordem",{ascending:!0}).order("created_at",{ascending:!0});if(a)throw a;if(!o||0===o.length)return[];return o.map((e=>{if(e.imagem_url)try{const{data:{publicUrl:o}}=s.N.storage.from(r.BUCKET_NAME).getPublicUrl(e.imagem_url);return(0,t.A)((0,t.A)({},e),{},{imagem_public_url:o})}catch(o){return(0,t.A)((0,t.A)({},e),{},{imagem_public_url:null,urlError:o.message})}return e}))}catch(o){throw console.error("Erro ao buscar hist\xf3rias do professor:",o),o}},l=async e=>{try{const{data:o,error:a}=await s.N.from("historias_professor").insert([{escola_id:e.escola_id,nome_professor:e.nome_professor||null,historia:e.historia,ordem:e.ordem||1,ativo:!1!==e.ativo,foto_rosto:e.foto_rosto||null}]).select().single();if(a)throw a;return o}catch(o){throw console.error("Erro ao criar hist\xf3ria do professor:",o),o}},i=async(e,o)=>{try{const{data:a,error:t}=await s.N.from("historias_professor").update({nome_professor:o.nome_professor,historia:o.historia,ordem:o.ordem,ativo:o.ativo,foto_rosto:o.foto_rosto||null,updated_at:(new Date).toISOString()}).eq("id",e).select().single();if(t)throw t;return a}catch(a){throw console.error("Erro ao atualizar hist\xf3ria do professor:",a),a}},c=async e=>{try{const{error:o}=await s.N.from("historias_professor").delete().eq("id",e);if(o)throw o}catch(o){throw console.error("Erro ao deletar hist\xf3ria do professor:",o),o}}}}]);
//# sourceMappingURL=248.27c3da8f.chunk.js.map