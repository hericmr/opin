/*! For license information please see 901.4f7edd0b.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[901],{193:(e,a,s)=>{s.d(a,{A:()=>r});const r=(0,s(1114).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},1184:(e,a,s)=>{s.d(a,{A:()=>r});const r=(0,s(1114).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},4562:(e,a,s)=>{s.d(a,{A:()=>r});const r=(0,s(1114).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9901:(e,a,s)=>{s.r(a),s.d(a,{default:()=>F});var r=s(9379),o=s(5043),t=s(2880),l=s(1114);const n=(0,l.A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),i=(0,l.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var d=s(193);const c=(0,l.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var g=s(7669),m=s(1184);const u=(0,l.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),x={BUCKET_NAME:"imagens-das-escolas",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:10,MIN_DIMENSIONS:{width:200,height:200}},p={BUCKET_NAME:"imagens-professores",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:5,MIN_DIMENSIONS:{width:200,height:200}},b=(e,a)=>{if(!a.ALLOWED_TYPES.includes(e.type))return{isValid:!1,error:"Tipo de arquivo n\xe3o suportado. Use apenas: ".concat(a.ALLOWED_TYPES.map((e=>e.split("/")[1].toUpperCase())).join(", "))};if(e.size>a.MAX_FILE_SIZE)return{isValid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(a.MAX_FILE_SIZE/1048576,"MB")};const s=e.name.split(".").pop().toLowerCase(),r=a.ALLOWED_TYPES.map((e=>e.split("/")[1]));return r.includes(s)?{isValid:!0}:{isValid:!1,error:"Extens\xe3o n\xe3o permitida. Use apenas: ".concat(r.join(", "))}},h=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const r=b(e,x);if(!r.isValid)throw new Error(r.error);const o=((e,a)=>{const s=Date.now(),r=Math.random().toString(36).substring(2,8),o=e.name.split(".").pop().toLowerCase();return"".concat(a,"_").concat(s,"_").concat(r,".").concat(o)})(e,a),l="".concat(a,"/").concat(o),{error:n}=await t.N.storage.from(x.BUCKET_NAME).upload(l,e,{cacheControl:"3600",upsert:!1});if(n)throw new Error("Erro no upload: ".concat(n.message));const{data:{publicUrl:i}}=t.N.storage.from(x.BUCKET_NAME).getPublicUrl(l);return{id:Date.now(),url:l,publicUrl:i,descricao:s.trim()||"Imagem da escola ".concat(a),created_at:(new Date).toISOString()}}catch(r){throw console.error("Erro no upload da imagem da escola:",r),r}},f=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"professor";try{const o=b(e,p);if(!o.isValid)throw new Error(o.error);const l=((e,a,s)=>{const r=Date.now(),o=Math.random().toString(36).substring(2,8),t=e.name.split(".").pop().toLowerCase();return"".concat(s,"_").concat(a,"_").concat(r,"_").concat(o,".").concat(t)})(e,a,r),n="".concat(a,"/").concat(l),{error:i}=await t.N.storage.from(p.BUCKET_NAME).upload(n,e,{cacheControl:"3600",upsert:!1});if(i)throw console.error("Erro detalhado do upload:",i),new Error("Erro no upload: ".concat(i.message));const{data:{publicUrl:d}}=t.N.storage.from(p.BUCKET_NAME).getPublicUrl(n);return{id:Date.now(),url:n,publicUrl:d,descricao:s.trim()||"Imagem do ".concat(r," da escola ").concat(a),genero:r,created_at:(new Date).toISOString()}}catch(o){throw console.error("Erro no upload da imagem do professor:",o),o}},y=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.BUCKET_NAME;try{const{data:s,error:r}=await t.N.storage.from(a).list("".concat(e,"/"));if(r)throw r;if(!s||0===s.length)return[];return s.map(((s,r)=>{const o="".concat(e,"/").concat(s.name),{data:{publicUrl:l}}=t.N.storage.from(a).getPublicUrl(o);return{id:r+1,url:o,publicUrl:l,descricao:"Imagem ".concat(r+1),created_at:s.created_at||(new Date).toISOString()}}))}catch(s){throw console.error("Erro ao buscar imagens da escola:",s),s}},v=async(e,a,s)=>{try{const{error:e}=await t.N.storage.from(s).remove([a]);if(e)throw new Error("Erro ao deletar arquivo: ".concat(e.message))}catch(r){throw console.error("Erro ao deletar imagem:",r),r}},j=async(e,a)=>{try{const s=a===p.BUCKET_NAME?p:x,{data:r,error:o}=await t.N.storage.from(a).list("".concat(e,"/"));if(o)throw o;const l=r?r.length:0;return{current:l,limit:s.MAX_IMAGES_PER_SCHOOL,canUpload:l<s.MAX_IMAGES_PER_SCHOOL}}catch(s){throw console.error("Erro ao verificar limite de imagens:",s),s}};var N=s(237),w=s(579);const A=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[t,l]=(0,o.useState)([]),[x,p]=(0,o.useState)(!1),[b,f]=(0,o.useState)(0),[A,E]=(0,o.useState)(""),[k,_]=(0,o.useState)(""),[C,P]=(0,o.useState)([]),[S,D]=(0,o.useState)(!0),[T,I]=(0,o.useState)({current:0,limit:10,canUpload:!0}),[M,L]=(0,o.useState)(null),[U,q]=(0,o.useState)(""),O=(0,o.useCallback)((async()=>{if(a)try{D(!0);const e=await y(a,"imagens-das-escolas");P(e);const s=await j(a,"imagens-das-escolas");I(s)}catch(e){console.error("Erro ao buscar imagens:",e),E("Erro ao carregar imagens existentes")}finally{D(!1)}}),[a]);(0,o.useEffect)((()=>{O()}),[O]),(0,o.useEffect)((()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos..."),(0,N.iy)())}),[a]),(0,o.useEffect)((()=>{(async()=>{if(!C.length)return;console.log("Buscando legendas para",C.length,"imagens");const e={};for(const s of C){console.log("Buscando legenda para imagem:",s.url);const r=await(0,N.qP)(s.url,a,"escola");console.log("Legenda encontrada:",r),e[s.url]=r}P((a=>a.map((a=>(0,r.A)((0,r.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[C.length,a]),(0,o.useEffect)((()=>{if(A||k){const e=setTimeout((()=>{E(""),_("")}),5e3);return()=>clearTimeout(e)}}),[A,k]);const z=(0,o.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;if(!T.canUpload)return void E("Limite de ".concat(T.limit," imagens atingido. Remova algumas imagens antes de adicionar novas."));if(C.length+t.length+a.length>T.limit)return void E("Voc\xea pode adicionar no m\xe1ximo ".concat(T.limit-C.length-t.length," imagens."));const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(l((e=>[...e,...s])),E(""))}),[T,C.length,t.length]),F=(0,o.useCallback)((e=>{e.preventDefault()}),[]),G=(e,a,s)=>{P((o=>o.map((o=>o.id===e?(0,r.A)((0,r.A)({},o),{},{legendaData:(0,r.A)((0,r.A)({},o.legendaData),{},{[a]:s})}):o))))};return S?(0,w.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,w.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,w.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,w.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens..."})]})}):(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(n,{className:"w-5 h-5 text-blue-600"}),(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens da Escola"})]}),(0,w.jsxs)("div",{className:"text-sm text-gray-500",children:[T.current,"/",T.limit," imagens"]})]}),A&&(0,w.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,w.jsx)(i,{className:"w-5 h-5 text-red-600"}),(0,w.jsx)("span",{className:"text-red-700",children:A})]}),k&&(0,w.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,w.jsx)(d.A,{className:"w-5 h-5 text-green-600"}),(0,w.jsx)("span",{className:"text-green-700",children:k})]}),T.canUpload&&(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(x?"border-gray-300 bg-gray-50":"border-blue-300 bg-blue-50 hover:border-blue-400 hover:bg-blue-100"),onDrop:z,onDragOver:F,children:[(0,w.jsx)(c,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),(0,w.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens aqui ou clique para selecionar"}),(0,w.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo"}),(0,w.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,w.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;if(!T.canUpload)return void E("Limite de ".concat(T.limit," imagens atingido. Remova algumas imagens antes de adicionar novas."));if(C.length+t.length+a.length>T.limit)return void E("Voc\xea pode adicionar no m\xe1ximo ".concat(T.limit-C.length-t.length," imagens."));const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||E('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||E('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(l((e=>[...e,...s])),E(""))},className:"hidden",disabled:x}),"Selecionar Arquivos"]})]}),x&&(0,w.jsxs)("div",{className:"space-y-2",children:[(0,w.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,w.jsx)("span",{children:"Fazendo upload..."}),(0,w.jsxs)("span",{children:[Math.round(b),"%"]})]}),(0,w.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,w.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(b,"%")}})})]}),t.length>0&&(0,w.jsxs)("div",{className:"space-y-3",children:[(0,w.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",t.length,")"]}),(0,w.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:t.map(((e,a)=>(0,w.jsxs)("div",{className:"relative group",children:[(0,w.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,w.jsx)("button",{onClick:()=>(e=>{l((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,w.jsx)(g.A,{className:"w-3 h-3"})}),(0,w.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,w.jsx)("button",{onClick:async()=>{if(0!==t.length){p(!0),f(0),E("");try{const e=[];for(let s=0;s<t.length;s++){const r=t[s],o=(s+1)/t.length*100;f(o);const l=await h(r,a);e.push(l)}P((a=>[...a,...e])),l([]),f(0),_("".concat(e.length," imagem(ns) carregada(s) com sucesso!"));const r=await j(a,"imagens-das-escolas");I(r),s&&s()}catch(e){console.error("Erro no upload:",e),E("Erro ao fazer upload: ".concat(e.message))}finally{p(!1),f(0)}}},disabled:x,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Fazendo Upload...":"Fazer Upload"})]})]}),C.length>0&&(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens da Escola (",C.length,")"]}),(0,w.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map((e=>{var o,t,l,n,i;return(0,w.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,w.jsxs)("div",{className:"relative group",children:[(0,w.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem da escola",className:"w-full h-48 object-cover"}),(0,w.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,w.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,w.jsx)("button",{onClick:()=>(async(e,r)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem?"))try{await v(0,r,"imagens-das-escolas"),P((a=>a.filter((a=>a.id!==e))));const o=await j(a,"imagens-das-escolas");I(o),_("Imagem exclu\xedda com sucesso!"),s&&s()}catch(o){console.error("Erro ao deletar imagem:",o),E("Erro ao excluir imagem: ".concat(o.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,w.jsx)(m.A,{className:"w-5 h-5"})})})})]}),(0,w.jsxs)("div",{className:"p-4 space-y-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,w.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(o=e.legendaData)||void 0===o?void 0:o.legenda)||"",onChange:a=>G(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,w.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(t=e.legendaData)||void 0===t?void 0:t.descricao_detalhada)||"",onChange:a=>G(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,w.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(l=e.legendaData)||void 0===l?void 0:l.autor_foto)||"",onChange:a=>G(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,w.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(n=e.legendaData)||void 0===n?void 0:n.data_foto)||"",onChange:a=>G(e.id,"data_foto",a.target.value)}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,w.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(i=e.legendaData)||void 0===i?void 0:i.categoria)||"",onChange:a=>G(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,w.jsx)("div",{className:"flex gap-2 pt-2",children:(0,w.jsxs)("button",{onClick:()=>(async e=>{console.log("=== DEBUG: Salvando legenda ==="),console.log("Imagem completa:",e);const o=e.url,t=e.legendaData;console.log("URL relativa:",o),console.log("Dados da legenda:",t),console.log("Escola ID:",a);try{console.log("Buscando legenda existente...");let e=await(0,N.qP)(o,a,"escola");if(console.log("Legenda existente encontrada:",e),e){console.log("Atualizando legenda existente...");const a=(0,r.A)((0,r.A)({},t),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",a);const s=await(0,N.w_)(e.id,a);console.log("Legenda atualizada com sucesso:",s)}else{console.log("Criando nova legenda...");const e=(0,r.A)((0,r.A)({escola_id:a,imagem_url:o},t),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"escola"});console.log("Dados para nova legenda:",e);const s=await(0,N.eP)(e);console.log("Nova legenda criada:",s)}_("Legenda salva com sucesso!"),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(l){console.error("=== ERRO ao salvar legenda ==="),console.error("Erro completo:",l),console.error("Mensagem de erro:",l.message),console.error("Stack trace:",l.stack),E("Erro ao salvar legenda: "+l.message)}})(e),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",type:"button",children:[(0,w.jsx)(u,{className:"w-5 h-5"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===C.length&&!x&&(0,w.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,w.jsx)(n,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,w.jsx)("p",{children:"Nenhuma imagem adicionada ainda."}),(0,w.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar a escola."})]})]})};var E=s(4562);const k=async e=>{const{data:a,error:s}=await t.N.from("imagens_professores").insert([e]).select().single();if(s)throw s;return a},_=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[l,n]=(0,o.useState)([]),[x,p]=(0,o.useState)(!1),[b,h]=(0,o.useState)(0),[A,_]=(0,o.useState)(""),[C,P]=(0,o.useState)(""),[S,D]=(0,o.useState)([]),[T,I]=(0,o.useState)(!0),[M,L]=(0,o.useState)({current:0,limit:5,canUpload:!0}),[U,q]=(0,o.useState)(null),[O,z]=(0,o.useState)(""),[F,G]=(0,o.useState)("professor"),[B,R]=(0,o.useState)(""),V=(0,o.useCallback)((async()=>{if(a)try{I(!0);const e=await y(a,"imagens-professores");D(e);const s=await j(a,"imagens-professores");L(s)}catch(e){console.error("Erro ao buscar imagens dos professores:",e),_("Erro ao carregar imagens dos professores")}finally{I(!1)}}),[a]);(0,o.useEffect)((()=>{V()}),[V]),(0,o.useEffect)((()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos (professores)..."),(0,N.iy)())}),[a]),(0,o.useEffect)((()=>{(async()=>{if(!S.length)return;console.log("Buscando legendas para",S.length,"imagens de professores");const e={};for(const s of S){console.log("Buscando legenda para imagem de professor:",s.url);const r=await(0,N.qP)(s.url,a,"professor");console.log("Legenda encontrada para professor:",r),e[s.url]=r}D((a=>a.map((a=>(0,r.A)((0,r.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[S.length,a]),(0,o.useEffect)((()=>{if(A||C){const e=setTimeout((()=>{_(""),P("")}),5e3);return()=>clearTimeout(e)}}),[A,C]);const H=(0,o.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;if(!M.canUpload)return void _("Limite de ".concat(M.limit," imagens dos professores atingido. Remova algumas imagens antes de adicionar novas."));if(S.length+l.length+a.length>M.limit)return void _("Voc\xea pode adicionar no m\xe1ximo ".concat(M.limit-S.length-l.length," imagens dos professores."));const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(n((e=>[...e,...s])),_(""))}),[M,S.length,l.length]),Q=(0,o.useCallback)((e=>{e.preventDefault()}),[]),W=(e,a,s)=>{D((o=>o.map((o=>o.id===e?(0,r.A)((0,r.A)({},o),{},{legendaData:(0,r.A)((0,r.A)({},o.legendaData),{},{[a]:s})}):o))))},X=async e=>{console.log("=== DEBUG: Salvando legenda de professor ==="),console.log("Imagem completa:",e);const o=e.url,l=e.legendaData;console.log("URL relativa:",o),console.log("Dados da legenda:",l),console.log("Escola ID:",a);try{console.log("Buscando legenda existente...");let n=await(0,N.qP)(o,a,"professor");if(console.log("Legenda existente encontrada:",n),n){console.log("Atualizando legenda existente...");const e=(0,r.A)((0,r.A)({},l),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",e);const a=await(0,N.w_)(n.id,e);console.log("Legenda de professor atualizada com sucesso:",a)}else{console.log("Criando nova legenda...");const e=(0,r.A)((0,r.A)({escola_id:a,imagem_url:o},l),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"professor"});console.log("Dados para nova legenda:",e);const s=await(0,N.eP)(e);console.log("Nova legenda de professor criada:",s)}console.log("Atualizando metadados da imagem...");let i=await(async(e,a)=>{const{data:s,error:r}=await t.N.from("imagens_professores").select("*").eq("imagem_url",e).eq("escola_id",a).eq("ativo",!0).single();if(r&&"PGRST116"!==r.code)throw r;return s||null})(e.publicUrl,a);i?(console.log("Metadados encontrados:",i),await(async(e,a)=>{const{data:s,error:r}=await t.N.from("imagens_professores").update(a).eq("id",e).select().single();if(r)throw r;return s})(i.id,{autor:l.autor_foto,updated_at:(new Date).toISOString()}),console.log("Metadados atualizados com sucesso")):console.log("Nenhum metadado encontrado para atualizar"),P("Legenda salva com sucesso!"),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(n){console.error("=== ERRO ao salvar legenda de professor ==="),console.error("Erro completo:",n),console.error("Mensagem de erro:",n.message),console.error("Stack trace:",n.stack),_("Erro ao salvar legenda: "+n.message)}};return T?(0,w.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,w.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,w.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,w.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens dos professores..."})]})}):(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(E.A,{className:"w-5 h-5 text-green-600"}),(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens dos Professores"})]}),(0,w.jsxs)("div",{className:"text-sm text-gray-500",children:[M.current,"/",M.limit," imagens"]})]}),A&&(0,w.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,w.jsx)(i,{className:"w-5 h-5 text-red-600"}),(0,w.jsx)("span",{className:"text-red-700",children:A})]}),C&&(0,w.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,w.jsx)(d.A,{className:"w-5 h-5 text-green-600"}),(0,w.jsx)("span",{className:"text-green-700",children:C})]}),M.canUpload&&(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(x?"border-gray-300 bg-gray-50":"border-green-300 bg-green-50 hover:border-green-400 hover:bg-green-100"),onDrop:H,onDragOver:Q,children:[(0,w.jsx)(c,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),(0,w.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens dos professores aqui ou clique para selecionar"}),(0,w.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo \u2022 M\xe1ximo 5 imagens"}),(0,w.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer transition-colors",children:[(0,w.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;if(!M.canUpload)return void _("Limite de ".concat(M.limit," imagens dos professores atingido. Remova algumas imagens antes de adicionar novas."));if(S.length+l.length+a.length>M.limit)return void _("Voc\xea pode adicionar no m\xe1ximo ".concat(M.limit-S.length-l.length," imagens dos professores."));const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||_('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||_('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(n((e=>[...e,...s])),_(""))},className:"hidden",disabled:x}),"Selecionar Arquivos"]})]}),x&&(0,w.jsxs)("div",{className:"space-y-2",children:[(0,w.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,w.jsx)("span",{children:"Fazendo upload das imagens dos professores..."}),(0,w.jsxs)("span",{children:[Math.round(b),"%"]})]}),(0,w.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,w.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(b,"%")}})})]}),l.length>0&&(0,w.jsxs)("div",{className:"space-y-3",children:[(0,w.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",l.length,")"]}),(0,w.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:l.map(((e,a)=>(0,w.jsxs)("div",{className:"relative group",children:[(0,w.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,w.jsx)("button",{onClick:()=>(e=>{n((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,w.jsx)(g.A,{className:"w-3 h-3"})}),(0,w.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,w.jsx)("button",{onClick:async()=>{if(0!==l.length){p(!0),h(0),_("");try{const e=[];for(let s=0;s<l.length;s++){const r=l[s],o=(s+1)/l.length*100;h(o);const t=await f(r,a,"",F,B);e.push(t),await k({escola_id:a,imagem_url:t.url,nome_arquivo:r.name,autor:"",ativo:!0})}D((a=>[...a,...e])),n([]),h(0),P("".concat(e.length," imagem(ns) do(s) professor(es) carregada(s) com sucesso!"));const r=await j(a,"imagens-professores");L(r),s&&s()}catch(e){console.error("Erro no upload:",e),_("Erro ao fazer upload: ".concat(e.message))}finally{p(!1),h(0)}}},disabled:x,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Fazendo Upload...":"Fazer Upload"})]})]}),S.length>0&&(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens dos Professores (",S.length,")"]}),(0,w.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map((e=>{var r,o,t,l,n;return(0,w.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,w.jsxs)("div",{className:"relative group",children:[(0,w.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem do professor",className:"w-full h-48 object-cover"}),(0,w.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,w.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,w.jsx)("button",{onClick:()=>(async(e,r)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem do professor?"))try{await v(0,r,"imagens-professores"),D((a=>a.filter((a=>a.id!==e))));const o=await j(a,"imagens-professores");L(o),P("Imagem do professor exclu\xedda com sucesso!"),s&&s()}catch(o){console.error("Erro ao deletar imagem:",o),_("Erro ao excluir imagem: ".concat(o.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,w.jsx)(m.A,{className:"w-5 h-5"})})})})]}),(0,w.jsxs)("div",{className:"p-4 space-y-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,w.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(r=e.legendaData)||void 0===r?void 0:r.legenda)||"",onChange:a=>W(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,w.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(o=e.legendaData)||void 0===o?void 0:o.descricao_detalhada)||"",onChange:a=>W(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,w.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(t=e.legendaData)||void 0===t?void 0:t.autor_foto)||"",onChange:a=>W(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,w.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(l=e.legendaData)||void 0===l?void 0:l.data_foto)||"",onChange:a=>W(e.id,"data_foto",a.target.value)}),(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,w.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(n=e.legendaData)||void 0===n?void 0:n.categoria)||"",onChange:a=>W(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,w.jsx)("div",{className:"flex gap-2 pt-2",children:(0,w.jsxs)("button",{onClick:()=>X(e),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",type:"button",children:[(0,w.jsx)(u,{className:"w-5 h-5"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===S.length&&!x&&(0,w.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,w.jsx)(E.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,w.jsx)("p",{children:"Nenhuma imagem dos professores adicionada ainda."}),(0,w.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar os professores da escola."})]})]})};s(4581);var C=s(3303),P=s(7986),S=s(197);const D=(0,l.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),T=(0,l.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),I=(0,l.A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),M=(0,l.A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),L=(0,l.A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);var U=s(2006);const q=e=>{let{escolaId:a,escolaNome:s}=e;console.log("render historia manager",{escolaId:a,escolaNome:s});const[t,l]=(0,o.useState)([]),[n,i]=(0,o.useState)(!0),[d,c]=(0,o.useState)(null),[x,p]=(0,o.useState)(!1),[b,h]=(0,o.useState)(null),[f,y]=(0,o.useState)(null),[v,j]=(0,o.useState)(""),[N,A]=(0,o.useState)({nome_professor:"",historia:"",ordem:1,ativo:!0}),E=async()=>{try{i(!0),c(null);const e=await(0,U.Y8)(a);l(e)}catch(e){c(e.message)}finally{i(!1)}};(0,o.useEffect)((()=>{a&&E()}),[a]);const k=()=>{A({nome_professor:"",historia:"",ordem:1,ativo:!0}),h(null),p(!1)},_=async(e,a)=>{const s=t.findIndex((a=>a.id===e));if(-1===s)return;const r=[...t],o="up"===a?s-1:s+1;if(o<0||o>=r.length)return;[r[s],r[o]]=[r[o],r[s]];const l=r.map(((e,a)=>({id:e.id,ordem:a+1})));try{for(const e of l)await(0,U.e0)(e.id,{ordem:e.ordem});j("Ordem atualizada com sucesso!"),E()}catch(n){c(n.message)}};return n?(0,w.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,w.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,w.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,w.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando hist\xf3rias do professor..."})]})}):(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-3",children:[(0,w.jsx)(S.A,{className:"w-6 h-6 text-green-700"}),(0,w.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Hist\xf3rias do Professor - ",s]})]}),(0,w.jsxs)("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,w.jsx)(D,{className:"w-5 h-5"}),"Nova Hist\xf3ria"]})]}),d&&(0,w.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,w.jsx)("p",{className:"text-red-600",children:d})}),v&&(0,w.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,w.jsx)("p",{className:"text-green-600",children:v})}),(0,w.jsx)("div",{className:"space-y-4",children:0===t.length?(0,w.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,w.jsx)(S.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,w.jsx)("p",{className:"text-gray-500",children:"Nenhuma hist\xf3ria do professor cadastrada."}),(0,w.jsx)("button",{onClick:()=>p(!0),className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Criar primeira hist\xf3ria"})]}):t.map(((e,a)=>(console.log("Renderizando hist\xf3ria:",e),(0,w.jsx)("div",{className:"p-6 bg-white rounded-lg border ".concat(e.ativo?"":"opacity-60"),children:(0,w.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,w.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["#",e.ordem]}),e.nome_professor&&(0,w.jsx)("h4",{className:"font-medium text-gray-900",children:e.nome_professor}),!e.ativo&&(0,w.jsxs)("span",{className:"flex items-center gap-1 text-orange-600 text-sm",children:[(0,w.jsx)(T,{className:"w-5 h-5"}),"Inativa"]})]}),(0,w.jsx)("p",{className:"text-gray-700 line-clamp-3",children:e.historia})]}),(0,w.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,w.jsx)("button",{onClick:()=>_(e.id,"up"),disabled:0===a,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Mover para cima",children:(0,w.jsx)(I,{className:"w-5 h-5"})}),(0,w.jsx)("button",{onClick:()=>_(e.id,"down"),disabled:a===t.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Mover para baixo",children:(0,w.jsx)(M,{className:"w-5 h-5"})}),(0,w.jsx)("button",{onClick:()=>{console.log("CLICOU NO BOT\xc3O EDITAR",e),(e=>{console.log("Entrou em handleEdit:",e),h(e),A({nome_professor:e.nome_professor||"",historia:e.historia,ordem:e.ordem,ativo:e.ativo}),p(!0)})(e)},className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg",title:"Editar",children:(0,w.jsx)(L,{className:"w-5 h-5"})}),(0,w.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir esta hist\xf3ria?"))try{await(0,U.g2)(e),j("Hist\xf3ria exclu\xedda com sucesso!"),E()}catch(a){c(a.message)}})(e.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg",title:"Excluir",children:(0,w.jsx)(m.A,{className:"w-5 h-5"})})]})]})},e.id))))}),x&&(0,w.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[b?console.log("Abrindo formul\xe1rio de edi\xe7\xe3o:",b):console.log("Abrindo formul\xe1rio de cria\xe7\xe3o"),(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:b?"Editar Hist\xf3ria":"Nova Hist\xf3ria"}),(0,w.jsx)("button",{onClick:k,className:"text-gray-400 hover:text-gray-600",children:(0,w.jsx)(g.A,{className:"w-5 h-5"})})]}),(0,w.jsxs)("form",{onSubmit:async e=>{if(console.log("\ud83d\udd0d SUBMIT CHAMADO - ID:",null===b||void 0===b?void 0:b.id),console.log("\ud83d\udcdd Evento recebido:",e),console.log("\ud83d\udcdd Evento type:",e.type),console.log("\ud83d\udcdd Evento target:",e.target),e.preventDefault(),console.log("\u2705 preventDefault executado"),console.log("submit historia",b),!N.nome_professor.trim())return void c("O nome do professor \xe9 obrigat\xf3rio.");if(!N.historia.trim())return void c("A hist\xf3ria \xe9 obrigat\xf3ria");const s={escola_id:Number(a),nome_professor:N.nome_professor.trim(),historia:N.historia.trim(),ordem:Number(N.ordem)||1,ativo:Boolean(N.ativo)};b&&console.log("Payload enviado para updateHistoriaProfessor:",s),console.log("Payload enviado para createHistoriaProfessor:",s);try{c(""),j(""),b?(await(0,U.e0)(b.id,s),j("Hist\xf3ria atualizada com sucesso!")):(await(0,U.lz)(s),j("Hist\xf3ria criada com sucesso!")),k(),E()}catch(r){c(r.message),console.log("ERRO AO CRIAR/EDITAR HIST\xd3RIA:",r)}},className:"space-y-4",children:[(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Professor *"}),(0,w.jsx)("input",{type:"text",value:N.nome_professor,onChange:e=>A((0,r.A)((0,r.A)({},N),{},{nome_professor:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Nome do professor",required:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ordem"}),(0,w.jsx)("input",{type:"number",min:"1",value:N.ordem,onChange:e=>A((0,r.A)((0,r.A)({},N),{},{ordem:parseInt(e.target.value)||1})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hist\xf3ria *"}),(0,w.jsx)("textarea",{value:N.historia,onChange:e=>A((0,r.A)((0,r.A)({},N),{},{historia:e.target.value})),rows:6,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Digite a hist\xf3ria do professor...",required:!0})]}),(0,w.jsx)("div",{className:"flex items-center gap-4",children:(0,w.jsxs)("label",{className:"flex items-center gap-2",children:[(0,w.jsx)("input",{type:"checkbox",checked:N.ativo,onChange:e=>A((0,r.A)((0,r.A)({},N),{},{ativo:e.target.checked})),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,w.jsx)("span",{className:"text-sm text-gray-700",children:"Ativa"})]})}),(0,w.jsxs)("div",{className:"flex gap-3",children:[(0,w.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,w.jsx)(u,{className:"w-5 h-5"}),b?"Atualizar":"Criar"]}),(0,w.jsx)("button",{type:"button",onClick:k,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})]})};const O=e=>{let{escolaId:a}=e;const[s,l]=(0,o.useState)([]),[n,i]=(0,o.useState)(!0),[d,c]=(0,o.useState)(null),[g,x]=(0,o.useState)(""),[p,b]=(0,o.useState)(!1),[h,f]=(0,o.useState)(null),[y,v]=(0,o.useState)({titulo:"",video_url:"",descricao:"",plataforma:"youtube",categoria:"geral",ativo:!0}),j=async()=>{try{i(!0),c(null);const e=await async function(e){const{data:a,error:s}=await t.N.from("titulos_videos").select("*").eq("escola_id",e).eq("ativo",!0).order("created_at",{ascending:!1});if(s)throw s;return a}(a);l(e)}catch(e){c(e.message)}finally{i(!1)}};(0,o.useEffect)((()=>{a&&j()}),[a]);const N=()=>{v({titulo:"",video_url:"",descricao:"",plataforma:"youtube",categoria:"geral",ativo:!0}),f(null),b(!1)},A=async e=>{if(window.confirm("Tem certeza que deseja excluir este v\xeddeo?"))try{await async function(e){const{error:a}=await t.N.from("titulos_videos").delete().eq("id",e);if(a)throw a;return!0}(e),x("V\xeddeo exclu\xeddo com sucesso!"),j()}catch(a){c(a.message)}};return n?(0,w.jsx)("div",{className:"p-6 text-center",children:"Carregando v\xeddeos..."}):(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"V\xeddeos da Escola"}),(0,w.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,w.jsx)(D,{className:"w-5 h-5"}),"Novo V\xeddeo"]})]}),d&&(0,w.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-600",children:d}),g&&(0,w.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg text-green-600",children:g}),(0,w.jsx)("div",{className:"space-y-4",children:0===s.length?(0,w.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,w.jsx)("p",{className:"text-gray-500",children:"Nenhum v\xeddeo cadastrado."}),(0,w.jsx)("button",{onClick:()=>b(!0),className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Adicionar v\xeddeo"})]}):s.map((e=>(0,w.jsx)("div",{className:"p-6 bg-white rounded-lg border ".concat(e.ativo?"":"opacity-60"),children:(0,w.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,w.jsx)("h4",{className:"font-medium text-gray-900",children:e.titulo}),!e.ativo&&(0,w.jsx)("span",{className:"flex items-center gap-1 text-orange-600 text-sm",children:"Inativo"})]}),(0,w.jsx)("p",{className:"text-gray-700 text-sm mb-2",children:e.descricao}),(0,w.jsx)("div",{className:"mb-2",children:(0,w.jsx)("iframe",{src:e.video_url,title:e.titulo,className:"w-full aspect-video rounded-lg border",allowFullScreen:!0})}),(0,w.jsxs)("div",{className:"text-xs text-gray-500",children:["Plataforma: ",e.plataforma," | Categoria: ",e.categoria]})]}),(0,w.jsxs)("div",{className:"flex flex-col gap-2 ml-4",children:[(0,w.jsx)("button",{onClick:()=>(e=>{f(e),v({titulo:e.titulo||"",video_url:e.video_url||"",descricao:e.descricao||"",plataforma:e.plataforma||"youtube",categoria:e.categoria||"geral",ativo:e.ativo}),b(!0)})(e),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg",title:"Editar",children:(0,w.jsx)(L,{className:"w-5 h-5"})}),(0,w.jsx)("button",{onClick:()=>A(e.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg",title:"Excluir",children:(0,w.jsx)(m.A,{className:"w-5 h-5"})})]})]})},e.id)))}),p&&(0,w.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:h?"Editar V\xeddeo":"Novo V\xeddeo"}),(0,w.jsxs)("button",{onClick:N,className:"text-gray-400 hover:text-gray-600",children:[(0,w.jsx)("span",{className:"sr-only",children:"Fechar"}),"\xd7"]})]}),(0,w.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!y.titulo.trim()||!y.video_url.trim())return void c("T\xedtulo e URL do v\xeddeo s\xe3o obrigat\xf3rios.");const s=(0,r.A)((0,r.A)({escola_id:Number(a)},y),{},{ativo:Boolean(y.ativo)});try{c(""),x(""),h?(await async function(e,a){const{data:s,error:r}=await t.N.from("titulos_videos").update(a).eq("id",e).select();if(r)throw r;return null===s||void 0===s?void 0:s[0]}(h.id,s),x("V\xeddeo atualizado com sucesso!")):(await async function(e){const{data:a,error:s}=await t.N.from("titulos_videos").insert([e]).select();if(s)throw s;return null===a||void 0===a?void 0:a[0]}(s),x("V\xeddeo criado com sucesso!")),N(),j()}catch(o){c(o.message)}},className:"space-y-4",children:[(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo *"}),(0,w.jsx)("input",{type:"text",value:y.titulo,onChange:e=>v((0,r.A)((0,r.A)({},y),{},{titulo:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"T\xedtulo do v\xeddeo",required:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo *"}),(0,w.jsx)("input",{type:"url",value:y.video_url,onChange:e=>v((0,r.A)((0,r.A)({},y),{},{video_url:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"https://www.youtube.com/embed/...",required:!0})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,w.jsx)("textarea",{value:y.descricao,onChange:e=>v((0,r.A)((0,r.A)({},y),{},{descricao:e.target.value})),rows:3,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Descri\xe7\xe3o do v\xeddeo (opcional)"})]}),(0,w.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plataforma"}),(0,w.jsx)("input",{type:"text",value:y.plataforma,onChange:e=>v((0,r.A)((0,r.A)({},y),{},{plataforma:e.target.value})),className:"w-full border rounded-lg px-3 py-2",placeholder:"youtube, vimeo..."})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,w.jsx)("input",{type:"text",value:y.categoria,onChange:e=>v((0,r.A)((0,r.A)({},y),{},{categoria:e.target.value})),className:"w-full border rounded-lg px-3 py-2",placeholder:"geral, institucional..."})]}),(0,w.jsxs)("div",{className:"flex items-center gap-2 mt-6",children:[(0,w.jsx)("input",{type:"checkbox",checked:y.ativo,onChange:e=>v((0,r.A)((0,r.A)({},y),{},{ativo:e.target.checked})),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,w.jsx)("span",{className:"text-sm text-gray-700",children:"Ativo"})]})]}),(0,w.jsxs)("div",{className:"flex gap-3",children:[(0,w.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,w.jsx)(u,{className:"w-5 h-5"}),h?"Atualizar":"Criar"]}),(0,w.jsx)("button",{type:"button",onClick:N,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})]})},z=()=>{const{triggerRefresh:e}=(0,C.b)(),[a,s]=(0,o.useState)([]),[l,n]=(0,o.useState)(""),[i,d]=(0,o.useState)("todos"),[c,g]=(0,o.useState)(null),[m,u]=(0,o.useState)(!1),[x,p]=(0,o.useState)(null),[b,h]=(0,o.useState)(!1),[f,y]=(0,o.useState)([]),[v,j]=(0,o.useState)(!1),[N,E]=(0,o.useState)(!1),[k,S]=(0,o.useState)(null),[D,T]=(0,o.useState)({titulo:"",autoria:"",tipo:"",link_pdf:""}),[I,M]=(0,o.useState)(!1),L="undefined"!==typeof window&&window.innerWidth<=768;(0,o.useEffect)((()=>{(async()=>{try{const{data:e,error:a}=await t.N.from("escolas_completa").select("*").order("Escola",{ascending:!0});if(a)throw a;const o=e.map((e=>(0,r.A)((0,r.A)({},e),{},{logradouro:e.logradouro||"",numero:e.numero||"",complemento:e.complemento||"",bairro:e.bairro||"",cep:e.cep||"",estado:e.estado||"SP"})));s(o)}catch(e){console.error("Erro ao buscar escolas:",e)}})()}),[]);(0,o.useEffect)((()=>{null!==c&&void 0!==c&&c.id&&(async e=>{try{j(!0);const{data:a,error:s}=await t.N.from("documentos_escola").select("*").eq("escola_id",e).order("titulo",{ascending:!0});if(s)throw s;y(a||[])}catch(a){console.error("Erro ao buscar documentos:",a),y([])}finally{j(!1)}})(c.id)}),[null===c||void 0===c?void 0:c.id]);return(0,w.jsxs)("div",{className:"flex min-h-screen bg-gray-950",children:[L&&!I&&(0,w.jsx)("button",{className:"fixed top-4 left-4 z-50 bg-gray-900 rounded-full shadow-lg p-2 border border-gray-800",onClick:()=>M(!0),"aria-label":"Abrir menu lateral",children:(0,w.jsx)(P.A,{className:"w-6 h-6 text-gray-200"})}),(!L||I)&&(0,w.jsxs)("aside",{className:"bg-white border-r border-gray-200 rounded-r-2xl shadow-lg p-4 overflow-y-auto h-screen sticky top-0 z-40 transition-transform duration-300 ".concat(L?"fixed left-0 top-0 w-64 max-w-[80vw] shadow-2xl":"w-64"),style:{transform:L&&!I?"translateX(-100%)":"translateX(0)",top:L?0:72},children:[L&&(0,w.jsx)("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-green-400",onClick:()=>M(!1),"aria-label":"Fechar menu lateral",children:(0,w.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,w.jsx)("h2",{className:"text-xl font-bold tracking-wide text-green-700 uppercase mb-6 sticky top-0 bg-white pb-2",children:"Escolas"}),(0,w.jsx)("div",{className:"mb-4 sticky top-24 mt-8 bg-gray-900 pb-2",children:(0,w.jsx)("input",{type:"text",placeholder:"Buscar escola...",className:"w-full px-3 py-2 border border-gray-700 rounded text-sm bg-gray-800 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-amber-400 focus:border-amber-400",value:l,onChange:e=>n(e.target.value)})}),(0,w.jsx)("ul",{className:"space-y-1",children:a.filter((e=>{var a;return null===(a=e.Escola)||void 0===a?void 0:a.toLowerCase().includes(l.toLowerCase())})).map((e=>(0,w.jsx)("li",{children:(0,w.jsx)("button",{className:"block w-full text-left px-2 py-1 rounded hover:bg-green-900 text-sm text-gray-800 ".concat((null===c||void 0===c?void 0:c.id)===e.id?"bg-green-200 font-bold":""),onClick:()=>{(e=>{const a={id:e.id,Escola:e.Escola,"Munic\xedpio":e["Munic\xedpio"],"Endere\xe7o":e["Endere\xe7o"],"Terra Indigena (TI)":e["Terra Indigena (TI)"],"Parcerias com o munic\xedpio":e["Parcerias com o munic\xedpio"],"Diretoria de Ensino":e["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":e["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":e["Povos indigenas"],"Linguas faladas":e["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":e["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":e["Numero de alunos"],turnos_funcionamento:e.turnos_funcionamento||"","Espa\xe7o escolar e estrutura":e["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":e["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":e["Tem coleta de lixo?"],"Acesso \xe0 internet":e["Acesso \xe0 internet"],"Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":e["Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)"],"Modo de acesso \xe0 escola":e["Modo de acesso \xe0 escola"],"Gest\xe3o/Nome":e["Gest\xe3o/Nome"],"Outros funcion\xe1rios":e["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":e["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":e["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":e["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":e["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":e["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":e["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":e["PPP elaborado com a comunidade?"],"Projetos em andamento":e["Projetos em andamento"],"Parcerias com universidades?":e["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":e["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":e["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":e["Escola utiliza redes sociais?"],"Links das redes sociais":e["Links das redes sociais"],historia_da_escola:e.historia_da_escola,latitude:e.latitude,longitude:e.longitude,links:e.links,link_para_videos:e.link_para_videos,logradouro:e.logradouro||"",numero:e.numero||"",complemento:e.complemento||"",bairro:e.bairro||"",cep:e.cep||"",estado:e.estado||"SP",activeTab:"dados-basicos"};g(a)})(e),L&&M(!1)},children:e.Escola})},e.id)))})]}),(0,w.jsxs)("main",{className:"flex-1 p-6 overflow-y-auto h-screen bg-gray-950",children:[(0,w.jsx)("h1",{className:"text-2xl font-bold text-gray-100 mb-6",children:"Painel de Administra\xe7\xe3o"}),(0,w.jsx)("div",{className:"bg-gray-900 p-4 rounded-lg shadow mb-6 border border-gray-800",children:(0,w.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,w.jsx)("div",{className:"relative flex-1",children:(0,w.jsx)("input",{type:"text",placeholder:"Buscar por t\xedtulo ou descri\xe7\xe3o...",className:"w-full pl-10 pr-4 py-2 border border-gray-700 rounded-lg bg-gray-800 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-amber-400 focus:border-amber-400",value:l,onChange:e=>n(e.target.value)})}),(0,w.jsx)("div",{className:"relative",children:(0,w.jsx)("select",{className:"pl-10 pr-4 py-2 border border-gray-700 rounded-lg bg-gray-800 text-gray-100 focus:ring-2 focus:ring-amber-400 focus:border-amber-400",value:i,onChange:e=>d(e.target.value),children:(0,w.jsx)("option",{value:"todos",children:"Todos"})})}),(0,w.jsx)("button",{onClick:()=>g({Escola:"","Munic\xedpio":"","Endere\xe7o":"","Terra Indigena (TI)":"","Parcerias com o munic\xedpio":"","Diretoria de Ensino":"","Ano de cria\xe7\xe3o da escola":"","Povos indigenas":"","Linguas faladas":"","Modalidade de Ensino/turnos de funcionamento":"","Numero de alunos":"",turnos_funcionamento:"","Espa\xe7o escolar e estrutura":"","Acesso \xe0 \xe1gua":"","Tem coleta de lixo?":"","Acesso \xe0 internet":"","Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":"","Modo de acesso \xe0 escola":"","Gest\xe3o/Nome":"","Outros funcion\xe1rios":"","Quantidade de professores ind\xedgenas":"","Quantidade de professores n\xe3o ind\xedgenas":"","Professores falam a l\xedngua ind\xedgena?":"","Forma\xe7\xe3o dos professores":"","Forma\xe7\xe3o continuada oferecida":"","A escola possui PPP pr\xf3prio?":"","PPP elaborado com a comunidade?":"","Projetos em andamento":"","Parcerias com universidades?":"","A\xe7\xf5es com ONGs ou coletivos?":"","Desejos da comunidade para a escola":"","Escola utiliza redes sociais?":"","Links das redes sociais":"",historia_da_escola:"",latitude:"",longitude:"",links:"",link_para_videos:"",logradouro:"",numero:"",complemento:"",bairro:"",cep:"",estado:"SP",nome_professor:"",professores_indigenas:"",professores_nao_indigenas:"",professores_falam_lingua_indigena:"",formacao_professores:"",visitas_supervisores_formacao:"",outros_funcionarios:"",gestao:"",merenda_diferenciada:"",cozinha:"",merenda_escolar:"",diferenciada:"",activeTab:"dados-basicos"}),className:"px-4 py-2 bg-green-700 text-white rounded-lg hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors",children:"+ Nova Escola"})]})}),c&&"object"===typeof c&&void 0!==c.Escola&&(0,w.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-lg p-6 max-h-[calc(100vh-200px)] overflow-hidden flex flex-col border border-gray-800",children:[(0,w.jsxs)("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[(0,w.jsx)("h2",{className:"text-lg font-semibold text-gray-100",children:c.id?"Editar Escola":"Nova Escola"}),(0,w.jsx)("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-200",children:"Fechar"})]}),(0,w.jsx)("div",{className:"border-b border-gray-800 mb-6 flex-shrink-0 bg-gray-800 rounded-t-lg",children:(0,w.jsx)("nav",{className:"-mb-px flex space-x-8 overflow-x-auto",children:[{id:"dados-basicos",label:"Dados B\xe1sicos"},{id:"povos-linguas",label:"Povos"},{id:"modalidades",label:"Modalidades"},{id:"infraestrutura",label:"Infraestrutura"},{id:"gestao-professores",label:"Gestores"},{id:"material-pedagogico",label:"Material Pedag\xf3gico"},{id:"projetos-parcerias",label:"Projetos e Parcerias"},{id:"redes-sociais",label:"Redes Sociais"},{id:"video",label:"V\xeddeo"},{id:"historias",label:"Hist\xf3rias"},{id:"historia-professores",label:"Hist\xf3ria dos Professores"},{id:"coordenadas",label:"Coordenadas"},{id:"imagens-escola",label:"Imagens da Escola"},{id:"imagens-professores",label:"Imagens dos Professores"},{id:"documentos",label:"Documentos"}].map((e=>(0,w.jsx)("button",{type:"button",onClick:()=>g((0,r.A)((0,r.A)({},c),{},{activeTab:e.id})),className:"whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors ".concat((c.activeTab||"dados-basicos")===e.id?"border-green-400 text-green-300 bg-gray-900":"border-transparent text-gray-400 hover:text-green-200 hover:bg-gray-700"),children:e.label},e.id)))})}),(0,w.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const o=(e=>{const a=[];return e.Escola&&""!==e.Escola.trim()||a.push("Nome da escola \xe9 obrigat\xf3rio"),a})(c);if(o.length>0)p(o.join(", "));else{u(!0),p(null),h(!1);try{"municipio"in c&&delete c.municipio;const e={Escola:c.Escola,"Munic\xedpio":c.Munic\u00edpio,"Endere\xe7o":c.Endere\u00e7o,logradouro:c.logradouro,numero:c.numero,complemento:c.complemento,bairro:c.bairro,cep:c.cep,estado:c.estado,"Terra Indigena (TI)":c["Terra Indigena (TI)"],"Parcerias com o munic\xedpio":c["Parcerias com o munic\xedpio"],"Diretoria de Ensino":c["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":c["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":c["Povos indigenas"],"Linguas faladas":c["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":c["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":c["Numero de alunos"],turnos_funcionamento:c.turnos_funcionamento,"Espa\xe7o escolar e estrutura":c["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":c["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":c["Tem coleta de lixo?"],"Acesso \xe0 internet":c["Acesso \xe0 internet"],"Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":c["Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)"],"Modo de acesso \xe0 escola":c["Modo de acesso \xe0 escola"],Cozinha:c.cozinha,"Merenda Escolar":c.merenda_escolar,"Merenda Diferenciada":c.diferenciada,"Merenda Diferenciada (Detalhes)":c.merenda_diferenciada,"Gest\xe3o/Nome":c["Gest\xe3o/Nome"],"Outros funcion\xe1rios":c["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":c["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":c["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":c["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":c["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":c["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":c["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":c["PPP elaborado com a comunidade?"],"Linguas faladas":c["Linguas faladas"],"Projetos em andamento":c["Projetos em andamento"],"Parcerias com universidades?":c["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":c["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":c["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":c["Escola utiliza redes sociais?"],"Links das redes sociais":c["Links das redes sociais"],links:c.links,link_para_videos:c.link_para_videos,historia_da_escola:c.historia_da_escola,latitude:c.latitude,longitude:c.longitude};console.log("=== DEBUG: Campos sendo enviados para o Supabase ==="),console.log("updateData:",e),console.log('Campos com "municipio" (sem acento):',Object.keys(e).filter((e=>e.includes("municipio")))),console.log('Campos com "Munic\xedpio" (com acento):',Object.keys(e).filter((e=>e.includes("Munic\xedpio")))),console.log("editingLocation completo:",c),console.log("Todas as chaves do editingLocation:",Object.keys(c)),console.log('Chaves que cont\xeam "municipio":',Object.keys(c).filter((e=>e.includes("municipio")))),console.log("==================================================");const{error:o}=await t.N.from("escolas_completa").update(e).eq("id",c.id);if(o)throw o;s(a.map((e=>e.id===c.id?(0,r.A)((0,r.A)({},e),c):e))),h(!0),setTimeout((()=>{h(!1)}),3e3)}catch(l){console.error("Erro ao salvar:",l),p("Erro ao salvar: ".concat(l.message))}finally{u(!1)}}},className:"flex-1 flex flex-col overflow-hidden",children:[(0,w.jsxs)("div",{className:"flex-1 overflow-y-auto",children:["dados-basicos"===(c.activeTab||"dados-basicos")&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Nome da Escola *"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.Escola||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{Escola:e.target.value})),required:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Munic\xedpio"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.Munic\u00edpio||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Munic\xedpio":e.target.value}))})]}),(0,w.jsxs)("div",{className:"md:col-span-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Endere\xe7o Detalhado"}),(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-sm",value:c.logradouro||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{logradouro:e.target.value})),placeholder:"Logradouro (Rua, Avenida, etc.)"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-sm",value:c.numero||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{numero:e.target.value})),placeholder:"N\xfamero"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-sm",value:c.complemento||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{complemento:e.target.value})),placeholder:"Complemento"})]}),(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mt-2",children:[(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-sm",value:c.bairro||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{bairro:e.target.value})),placeholder:"Bairro"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-sm",value:c.cep||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{cep:e.target.value})),placeholder:"CEP"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-sm",value:c.estado||"SP",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{estado:e.target.value})),placeholder:"Estado"})]})]}),(0,w.jsxs)("div",{className:"md:col-span-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Endere\xe7o Completo"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.Endere\u00e7o||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Endere\xe7o":e.target.value})),placeholder:"Digite o endere\xe7o completo da escola..."})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Terra Ind\xedgena (TI)"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Terra Indigena (TI)"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Terra Indigena (TI)":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Diretoria de Ensino"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Diretoria de Ensino"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Diretoria de Ensino":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Ano de Cria\xe7\xe3o"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Ano de cria\xe7\xe3o da escola"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Ano de cria\xe7\xe3o da escola":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Parcerias com o Munic\xedpio"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Parcerias com o munic\xedpio"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Parcerias com o munic\xedpio":e.target.value})),placeholder:"Descreva as parcerias com o munic\xedpio..."})]})]}),"povos-linguas"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Povos"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Povos indigenas"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Povos indigenas":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"L\xednguas Faladas"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Linguas faladas"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Linguas faladas":e.target.value}))})]})]}),"modalidades"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Modalidade de Ensino/Turnos"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Modalidade de Ensino/turnos de funcionamento"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Modalidade de Ensino/turnos de funcionamento":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"N\xfamero de Alunos"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Numero de alunos"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Numero de alunos":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Turnos de Funcionamento"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.turnos_funcionamento||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{turnos_funcionamento:e.target.value})),placeholder:"Ex: Diurno, Noturno, Vespertino, etc."})]})]}),"infraestrutura"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{className:"md:col-span-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Espa\xe7o Escolar e Estrutura"}),(0,w.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Espa\xe7o escolar e estrutura"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Espa\xe7o escolar e estrutura":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Acesso \xe0 \xc1gua"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Acesso \xe0 \xe1gua"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Acesso \xe0 \xe1gua":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Coleta de Lixo"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Tem coleta de lixo?"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Tem coleta de lixo?":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Acesso \xe0 Internet"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Acesso \xe0 internet"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Acesso \xe0 internet":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Equipamentos Tecnol\xf3gicos"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Modo de Acesso \xe0 Escola"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Modo de acesso \xe0 escola"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Modo de acesso \xe0 escola":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Cozinha"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.cozinha||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{cozinha:e.target.value})),placeholder:"Ex: Sim, N\xe3o, Em constru\xe7\xe3o..."})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Escolar"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.merenda_escolar||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{merenda_escolar:e.target.value})),placeholder:"Ex: Sim, N\xe3o, Parcial..."})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Diferenciada"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.diferenciada||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{diferenciada:e.target.value})),placeholder:"Ex: Sim, N\xe3o, Espec\xedfica..."})]}),(0,w.jsxs)("div",{className:"md:col-span-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Diferenciada (Detalhes)"}),(0,w.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.merenda_diferenciada||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{merenda_diferenciada:e.target.value})),placeholder:"Descreva a situa\xe7\xe3o do fornecimento de merenda (ex: se a escola recebe, se h\xe1 interrup\xe7\xf5es, etc.)"})]})]}),"gestao-professores"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Gest\xe3o/Nome"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Gest\xe3o/Nome"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Gest\xe3o/Nome":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores Ind\xedgenas"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Quantidade de professores ind\xedgenas"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Quantidade de professores ind\xedgenas":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores N\xe3o Ind\xedgenas"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Quantidade de professores n\xe3o ind\xedgenas"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Quantidade de professores n\xe3o ind\xedgenas":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores Falam L\xedngua Ind\xedgena?"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Professores falam a l\xedngua ind\xedgena?"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Professores falam a l\xedngua ind\xedgena?":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Forma\xe7\xe3o dos Professores"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Forma\xe7\xe3o dos professores"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Forma\xe7\xe3o dos professores":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Forma\xe7\xe3o Continuada"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Forma\xe7\xe3o continuada oferecida"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Forma\xe7\xe3o continuada oferecida":e.target.value}))})]})]}),"material-pedagogico"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"A escola possui PPP pr\xf3prio?"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["A escola possui PPP pr\xf3prio?"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"A escola possui PPP pr\xf3prio?":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"PPP elaborado com a comunidade?"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["PPP elaborado com a comunidade?"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"PPP elaborado com a comunidade?":e.target.value}))})]})]}),"projetos-parcerias"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Projetos em Andamento"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Projetos em andamento"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Projetos em andamento":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Parcerias com Universidades?"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Parcerias com universidades?"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Parcerias com universidades?":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"A\xe7\xf5es com ONGs ou Coletivos?"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["A\xe7\xf5es com ONGs ou coletivos?"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"A\xe7\xf5es com ONGs ou coletivos?":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Desejos da Comunidade"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Desejos da comunidade para a escola"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Desejos da comunidade para a escola":e.target.value}))})]})]}),"redes-sociais"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Escola utiliza redes sociais?"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Escola utiliza redes sociais?"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Escola utiliza redes sociais?":e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Links das Redes Sociais"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c["Links das redes sociais"]||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{"Links das redes sociais":e.target.value}))})]})]}),"video"===c.activeTab&&(0,w.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,w.jsx)("p",{children:"Use o gerenciador de v\xeddeos acima para adicionar e editar v\xeddeos."})}),"historias"===c.activeTab&&(0,w.jsx)("div",{className:"grid grid-cols-1 gap-4 md:gap-6",children:(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Hist\xf3ria da Escola"}),(0,w.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.historia_da_escola||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{historia_da_escola:e.target.value}))})]})}),"coordenadas"===c.activeTab&&(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Latitude"}),(0,w.jsx)("input",{type:"number",step:"any",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.latitude||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{latitude:e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Longitude"}),(0,w.jsx)("input",{type:"number",step:"any",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:c.longitude||"",onChange:e=>g((0,r.A)((0,r.A)({},c),{},{longitude:e.target.value}))})]})]}),"imagens-escola"===c.activeTab&&(0,w.jsx)("div",{className:"space-y-4",children:(0,w.jsx)(A,{escolaId:c.id,onImagesUpdate:()=>{e&&e()}})}),"imagens-professores"===c.activeTab&&(0,w.jsx)("div",{className:"space-y-4",children:(0,w.jsx)(_,{escolaId:c.id,onImagesUpdate:()=>{e&&e()}})}),"documentos"===c.activeTab&&(0,w.jsxs)("div",{className:"space-y-4",children:[!N&&(0,w.jsx)("button",{type:"button",onClick:()=>E(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors",children:"+ Adicionar Documento"}),N&&(0,w.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[(0,w.jsx)("h5",{className:"font-medium text-green-800 mb-4",children:"Adicionar Novo Documento"}),(0,w.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),null!==c&&void 0!==c&&c.id)try{const{data:e,error:a}=await t.N.from("documentos_escola").insert([(0,r.A)((0,r.A)({},D),{},{escola_id:c.id})]).select();if(a)throw a;y([...f,e[0]]),T({titulo:"",autoria:"",tipo:"",link_pdf:""}),E(!1)}catch(a){console.error("Erro ao adicionar documento:",a),alert("Erro ao adicionar documento. Tente novamente.")}},className:"space-y-4",children:[(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"T\xedtulo *"}),(0,w.jsx)("input",{type:"text",required:!0,className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:D.titulo,onChange:e=>T((0,r.A)((0,r.A)({},D),{},{titulo:e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Autor"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:D.autoria,onChange:e=>T((0,r.A)((0,r.A)({},D),{},{autoria:e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Tipo"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:D.tipo,onChange:e=>T((0,r.A)((0,r.A)({},D),{},{tipo:e.target.value}))})]}),(0,w.jsxs)("div",{className:"md:col-span-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Link do PDF *"}),(0,w.jsx)("input",{type:"url",required:!0,className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:D.link_pdf,onChange:e=>T((0,r.A)((0,r.A)({},D),{},{link_pdf:e.target.value})),placeholder:"https://drive.google.com/file/d/..."}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Recomendado: Link do Google Drive com permiss\xe3o p\xfablica"})]})]}),(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)("button",{type:"submit",className:"px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors min-h-[44px] text-base",disabled:m,children:m?"Salvando...":"Salvar Altera\xe7\xf5es"}),(0,w.jsx)("button",{type:"button",className:"px-4 py-3 bg-gray-700 text-gray-200 rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors min-h-[44px] text-base",onClick:()=>{E(!1),T({titulo:"",autoria:"",tipo:"",link_pdf:""})},disabled:m,children:"Cancelar"})]})]})]}),!v&&f.length>0&&(0,w.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,w.jsx)("h5",{className:"font-medium text-gray-800 mb-4",children:"Gerenciar Documentos"}),(0,w.jsx)("div",{className:"space-y-3",children:f.map((e=>(0,w.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsx)("h6",{className:"font-medium text-gray-800",children:e.titulo}),e.autoria&&(0,w.jsxs)("p",{className:"text-sm text-gray-600",children:["Por: ",e.autoria]}),e.tipo&&(0,w.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:e.tipo})]}),(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)("button",{type:"button",onClick:()=>S(e),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Editar"}),(0,w.jsx)("button",{type:"button",onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este documento?"))try{const{error:a}=await t.N.from("documentos_escola").delete().eq("id",e);if(a)throw a;y(f.filter((a=>a.id!==e)))}catch(a){console.error("Erro ao excluir documento:",a),alert("Erro ao excluir documento. Tente novamente.")}})(e.id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Excluir"})]})]},e.id)))})]}),k&&(0,w.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,w.jsx)("h5",{className:"font-medium text-yellow-800 mb-4",children:"Editar Documento"}),(0,w.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),null!==k&&void 0!==k&&k.id)try{const{error:e}=await t.N.from("documentos_escola").update(k).eq("id",k.id);if(e)throw e;y(f.map((e=>e.id===k.id?k:e))),S(null)}catch(a){console.error("Erro ao atualizar documento:",a),alert("Erro ao atualizar documento. Tente novamente.")}},className:"space-y-4",children:[(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"T\xedtulo *"}),(0,w.jsx)("input",{type:"text",required:!0,className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:k.titulo,onChange:e=>S((0,r.A)((0,r.A)({},k),{},{titulo:e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Autor"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:k.autoria||"",onChange:e=>S((0,r.A)((0,r.A)({},k),{},{autoria:e.target.value}))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Tipo"}),(0,w.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:k.tipo||"",onChange:e=>S((0,r.A)((0,r.A)({},k),{},{tipo:e.target.value}))})]}),(0,w.jsxs)("div",{className:"md:col-span-2",children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Link do PDF *"}),(0,w.jsx)("input",{type:"url",required:!0,className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:k.link_pdf,onChange:e=>S((0,r.A)((0,r.A)({},k),{},{link_pdf:e.target.value}))})]})]}),(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)("button",{type:"submit",className:"px-4 py-3 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors min-h-[44px] text-base",children:"Atualizar Documento"}),(0,w.jsx)("button",{type:"button",className:"px-4 py-3 bg-gray-700 text-gray-200 rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors min-h-[44px] text-base",children:"Cancelar"})]})]})]}),(0,w.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,w.jsx)("h5",{className:"font-medium text-blue-800 mb-2",children:"Sobre os Documentos"}),(0,w.jsxs)("p",{className:"text-sm text-blue-700 mb-3",children:["Os documentos s\xe3o armazenados na tabela ",(0,w.jsx)("code",{children:"documentos_escola"})," no Supabase. Voc\xea pode adicionar, editar e remover documentos diretamente neste painel."]}),(0,w.jsxs)("div",{className:"text-xs text-blue-600",children:[(0,w.jsx)("p",{children:(0,w.jsx)("strong",{children:"Estrutura da tabela:"})}),(0,w.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,w.jsxs)("li",{children:[(0,w.jsx)("code",{children:"id"})," - ID \xfanico do documento"]}),(0,w.jsxs)("li",{children:[(0,w.jsx)("code",{children:"escola_id"})," - ID da escola (preenchido automaticamente)"]}),(0,w.jsxs)("li",{children:[(0,w.jsx)("code",{children:"titulo"})," - T\xedtulo do documento"]}),(0,w.jsxs)("li",{children:[(0,w.jsx)("code",{children:"autoria"})," - Autor do documento (opcional)"]}),(0,w.jsxs)("li",{children:[(0,w.jsx)("code",{children:"tipo"})," - Tipo do documento (opcional)"]}),(0,w.jsxs)("li",{children:[(0,w.jsx)("code",{children:"link_pdf"})," - URL do documento (Google Drive ou outro)"]})]})]})]})]})]}),(0,w.jsxs)("div",{className:"flex gap-2 mt-6 pt-6 border-t border-gray-800 flex-shrink-0",children:[(0,w.jsx)("button",{type:"submit",className:"px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 disabled:opacity-50 disabled:cursor-not-allowed transition-colors min-h-[44px] text-base",disabled:m,children:m?"Salvando...":"Salvar Altera\xe7\xf5es"}),(0,w.jsx)("button",{type:"button",className:"px-4 py-3 bg-gray-700 text-gray-200 rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors min-h-[44px] text-base",onClick:()=>g(null),disabled:m,children:"Cancelar"})]})]}),"historia-professores"===c.activeTab&&(0,w.jsx)(q,{escolaId:c.id,escolaNome:c.Escola}),"video"===c.activeTab&&(0,w.jsx)(O,{escolaId:c.id}),x&&(0,w.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4 flex-shrink-0",children:x}),b&&(0,w.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded mb-4 flex-shrink-0",children:"Escola salva com sucesso!"})]})]})]})};const F=o.memo(z)}}]);
//# sourceMappingURL=901.4f7edd0b.chunk.js.map