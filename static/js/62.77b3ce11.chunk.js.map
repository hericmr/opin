{"version":3,"file":"static/js/62.77b3ce11.chunk.js","mappings":"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","sources":["components/CustomIcon.js","components/Marcadores.js"],"sourcesContent":["import L from \"leaflet\";\n\n// Tamanho mínimo para área de toque em dispositivos móveis (44x44px)\nconst TOUCH_TARGET_SIZE = 44;\n\nconst createIcon = (color) =>\n  new L.DivIcon({\n    className: `custom-marker-${color}`,\n    html: `\n      <div class=\"relative\" role=\"button\" tabindex=\"0\" aria-label=\"Marcador de localização\">\n        <div class=\"marker-container\" style=\"min-width: ${TOUCH_TARGET_SIZE}px; min-height: ${TOUCH_TARGET_SIZE}px; display: flex; align-items: center; justify-content: center;\">\n          <svg \n            xmlns=\"http://www.w3.org/2000/svg\" \n            viewBox=\"0 0 24 24\" \n            class=\"w-8 h-8\"\n            aria-hidden=\"true\"\n            focusable=\"false\"\n          >\n            <path \n              fill=\"${color}\" \n              d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\"\n            />\n            <circle cx=\"12\" cy=\"9\" r=\"3\" fill=\"white\" class=\"marker-pulse\"/>\n          </svg>\n        </div>\n      </div>\n      <style>\n        .custom-marker-${color} {\n          filter: drop-shadow(0 1px 3px rgb(0 0 0 / 0.2));\n        }\n        .marker-container {\n          transform-origin: bottom center;\n          animation: bounce 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n          cursor: pointer;\n          border-radius: 50%;\n          transition: transform 0.2s ease, filter 0.2s ease;\n        }\n        .marker-container:hover, .marker-container:focus {\n          transform: scale(1.1);\n          filter: brightness(1.1);\n          outline: 2px solid ${color};\n          outline-offset: 2px;\n        }\n        .marker-container:focus {\n          outline: 2px solid ${color};\n          outline-offset: 2px;\n        }\n        .marker-pulse {\n          animation: pulse 4s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n        }\n        @keyframes bounce {\n          0%, 100% { transform: translateY(0); }\n          50% { transform: translateY(-2px); }\n        }\n        @keyframes pulse {\n          0%, 100% { opacity: 0.9; }\n          50% { opacity: 0.7; }\n        }\n        @media (hover: none) {\n          .marker-container:hover {\n            transform: none;\n            filter: none;\n          }\n        }\n      </style>\n    `,\n    iconSize: [TOUCH_TARGET_SIZE, TOUCH_TARGET_SIZE],\n    iconAnchor: [TOUCH_TARGET_SIZE/2, TOUCH_TARGET_SIZE],\n    popupAnchor: [0, -TOUCH_TARGET_SIZE],\n  });\n\n// Criando ícones com cores personalizadas\nexport const blueIcon = createIcon(\"#2196F3\");\nexport const greenIcon = createIcon(\"#4CAF50\");\nexport const yellowIcon = createIcon(\"#FFC107\");\nexport const redIcon = createIcon(\"#F44336\");\nexport const violetIcon = new L.Icon({\n  iconUrl: 'data:image/svg+xml;base64,' + btoa(`\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n      <path fill=\"#3B82F6\" d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z\"/>\n      <circle cx=\"12\" cy=\"9\" r=\"3\" fill=\"white\"/>\n    </svg>\n  `),\n  iconSize: [24, 24],\n  iconAnchor: [12, 24],\n  popupAnchor: [0, -24]\n});\nexport const blackIcon = createIcon(\"#212121\");\nexport const orangeIcon = createIcon(\"#FF5722\");\nexport const orangeBairroIcon = createIcon(\"#FF9800\");","import React, { useEffect, useRef, useMemo, useCallback } from \"react\";\nimport { MapContainer, TileLayer, useMap } from \"react-leaflet\";\nimport { violetIcon } from \"./CustomIcon\";\nimport L from 'leaflet';\nimport 'leaflet.markercluster';\nimport 'leaflet.markercluster/dist/MarkerCluster.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport { capitalizeWords } from \"../utils/textFormatting\";\n\n// Constante para definir a proximidade entre marcadores (em graus)\nconst PROXIMITY_THRESHOLD = 0.00005;\n// Tempo em ms para o tooltip fechar automaticamente em mobile\nconst TOOLTIP_TIMEOUT = 2000;\n\n// Função para criar o conector entre marcadores\nconst createConnector = (map, centerLat, centerLng, markerLat, markerLng) => {\n  return L.polyline([[centerLat, centerLng], [markerLat, markerLng]], {\n    color: '#A0522D',\n    weight: 1.2,\n    dashArray: '3,3',\n    opacity: 0.6,\n    className: 'marker-connector'\n  }).addTo(map);\n};\n\n// Função para encontrar pares de marcadores próximos\nconst findNearbyPairs = (pontos) => {\n  const pairs = [];\n  const used = new Set();\n\n  for (let i = 0; i < pontos.length; i++) {\n    if (used.has(i)) continue;\n\n    for (let j = i + 1; j < pontos.length; j++) {\n      if (used.has(j)) continue;\n\n      const p1 = pontos[i];\n      const p2 = pontos[j];\n\n      const latDiff = Math.abs(parseFloat(p1.latitude) - parseFloat(p2.latitude));\n      const lngDiff = Math.abs(parseFloat(p1.longitude) - parseFloat(p2.longitude));\n\n      if (latDiff < PROXIMITY_THRESHOLD && lngDiff < PROXIMITY_THRESHOLD) {\n        pairs.push([i, j]);\n        used.add(i);\n        used.add(j);\n        break;\n      }\n    }\n  }\n\n  return pairs;\n};\n\n// Componente interno que usa o hook useMap\nconst MarcadoresInternos = ({ dataPoints, visibility, onClick, mapView }) => {\n  const map = useMap();\n  const clusterGroupRef = useRef(null);\n  const connectorsRef = useRef([]);\n  const isMobile = useMemo(() => L.Browser.mobile, []);\n  \n  // Refs para controle de interação touch\n  const lastTouchedMarker = useRef(null);\n  const touchTimeout = useRef(null);\n\n  // Sincronizar view com o mapa OpenLayers\n  useEffect(() => {\n    if (map && mapView) {\n      map.setView(mapView.center, mapView.zoom, { animate: false });\n    }\n  }, [map, mapView]);\n\n  // Sincronizar view inicial quando o mapa for criado\n  useEffect(() => {\n    if (map && mapView && map.getZoom() !== mapView.zoom) {\n      map.setView(mapView.center, mapView.zoom, { animate: false });\n    }\n  }, [map, mapView]);\n\n  // Função para limpar timeout do tooltip\n  const clearTooltipTimeout = useCallback(() => {\n    if (touchTimeout.current) {\n      clearTimeout(touchTimeout.current);\n      touchTimeout.current = null;\n    }\n  }, []);\n\n  // Função para gerenciar interação touch em mobile\n  const handleTouchInteraction = useCallback((marker, ponto, e) => {\n    if (!isMobile) return;\n\n    // Previne propagação do evento\n    e.originalEvent.stopPropagation();\n\n    // Se for o mesmo marcador do último toque\n    if (lastTouchedMarker.current === marker) {\n      clearTooltipTimeout();\n      marker.closeTooltip();\n      onClick?.(ponto);\n      lastTouchedMarker.current = null;\n    } else {\n      // Se for um marcador diferente\n      if (lastTouchedMarker.current) {\n        lastTouchedMarker.current.closeTooltip();\n      }\n      \n      // Atualiza referência e mostra tooltip\n      lastTouchedMarker.current = marker;\n      marker.openTooltip();\n      \n      // Configura timeout para fechar tooltip\n      clearTooltipTimeout();\n      touchTimeout.current = setTimeout(() => {\n        marker.closeTooltip();\n        lastTouchedMarker.current = null;\n      }, TOOLTIP_TIMEOUT);\n    }\n  }, [isMobile, onClick, clearTooltipTimeout]);\n\n  // Filtra os pontos válidos\n  const pontosValidos = React.useMemo(() => {\n    if (!Array.isArray(dataPoints) || dataPoints.length === 0) {\n      console.warn(\"Marcadores: Nenhum ponto de dados recebido\");\n      return [];\n    }\n\n    // Log inicial com total de pontos\n    console.log(\"Total de escolas recebidas:\", dataPoints.length);\n\n    // Array para armazenar escolas com coordenadas inválidas\n    const escolasComProblemas = [];\n\n    const pontosFiltrados = dataPoints.filter(ponto => {\n      // Verifica se o ponto tem as propriedades básicas\n      if (!ponto.titulo || !ponto.latitude || !ponto.longitude) {\n        escolasComProblemas.push({\n          escola: ponto.titulo || \"Sem nome\",\n          problema: \"Dados básicos ausentes\",\n          detalhes: {\n            titulo: !!ponto.titulo,\n            latitude: !!ponto.latitude,\n            longitude: !!ponto.longitude\n          }\n        });\n        return false;\n      }\n\n      const lat = parseFloat(ponto.latitude);\n      const lng = parseFloat(ponto.longitude);\n      \n      // Verifica se as coordenadas são números válidos\n      if (isNaN(lat) || isNaN(lng)) {\n        escolasComProblemas.push({\n          escola: ponto.titulo,\n          problema: \"Coordenadas não são números válidos\",\n          detalhes: {\n            latitude: ponto.latitude,\n            longitude: ponto.longitude\n          }\n        });\n        return false;\n      }\n\n      // Verifica se as coordenadas estão dentro dos limites válidos\n      if (lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        escolasComProblemas.push({\n          escola: ponto.titulo,\n          problema: \"Coordenadas fora dos limites válidos\",\n          detalhes: {\n            latitude: lat,\n            longitude: lng,\n            limites: {\n              latMin: -90,\n              latMax: 90,\n              lngMin: -180,\n              lngMax: 180\n            }\n          }\n        });\n        return false;\n      }\n\n      return true;\n    });\n\n    // Log detalhado das escolas com problemas\n    if (escolasComProblemas.length > 0) {\n      console.group(\"Escolas com coordenadas inválidas:\");\n      escolasComProblemas.forEach(escola => {\n        console.group(escola.escola);\n        console.log(\"Problema:\", escola.problema);\n        console.log(\"Detalhes:\", escola.detalhes);\n        console.groupEnd();\n      });\n      console.groupEnd();\n      console.log(`Total de escolas com problemas: ${escolasComProblemas.length}`);\n    }\n\n    // Log do resultado final\n    console.log(`Escolas válidas: ${pontosFiltrados.length} de ${dataPoints.length}`);\n\n    return pontosFiltrados;\n  }, [dataPoints]);\n\n  // Configuração do ícone para escolas indígenas\n  const escolaIcon = violetIcon;\n\n  // Função para criar o conteúdo do tooltip com melhor acessibilidade\n  const createTooltipContent = useCallback((ponto) => {\n    return `\n      <div class=\"bg-white/95 text-gray-800 text-sm font-medium px-3 py-1.5 rounded shadow-sm border border-gray-100 text-left w-full hover:text-violet-700 focus:text-violet-700 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-opacity-50 transition-colors duration-200\">\n        <button \n          onclick=\"event.stopPropagation(); window.dispatchEvent(new CustomEvent('marker-click', { detail: ${JSON.stringify(ponto)} }));\"\n          aria-label=\"Ver detalhes da escola ${capitalizeWords(ponto.titulo)}\"\n          class=\"w-full text-left\"\n        >\n          <strong>${capitalizeWords(ponto.titulo)}</strong>\n          ${ponto.etnia ? `<div class=\"mt-1 text-xs text-gray-600\">Etnia: ${ponto.etnia}</div>` : ''}\n        </button>\n      </div>\n    `;\n  }, []);\n\n  useEffect(() => {\n    if (!Array.isArray(dataPoints) || dataPoints.length === 0) {\n      console.warn(\"Marcadores: Nenhum ponto de dados válido recebido\");\n      return;\n    }\n\n    if (!map || !pontosValidos.length || !visibility.educacao) return;\n\n    // Remove o grupo de clusters anterior e conectores\n    if (clusterGroupRef.current) {\n      map.removeLayer(clusterGroupRef.current);\n    }\n    connectorsRef.current.forEach(connector => map.removeLayer(connector));\n    connectorsRef.current = [];\n\n    // Limpa referências de touch\n    lastTouchedMarker.current = null;\n    clearTooltipTimeout();\n\n    // Encontra pares de marcadores próximos\n    const nearbyPairs = findNearbyPairs(pontosValidos);\n    const usedIndices = new Set(nearbyPairs.flat());\n\n    // Cria um novo grupo de clusters com configurações otimizadas\n    const clusterGroup = new L.MarkerClusterGroup({\n      // Configurações básicas\n      chunkedLoading: true,\n      maxClusterRadius: 4,\n      spiderfyOnMaxZoom: true,\n      showCoverageOnHover: !isMobile, // Desativa em mobile\n      zoomToBoundsOnClick: true,\n      removeOutsideVisibleBounds: true,\n      animate: true,\n      \n      // Configurações de zoom otimizadas\n      disableClusteringAtZoom: 12,\n      minZoom: 4,\n      maxZoom: 18,\n      \n      // Configurações de ícones com estética indígena e acessibilidade\n      iconCreateFunction: function(cluster) {\n        const count = cluster.getChildCount();\n        let size = 'small';\n        let background = '#A0522D';\n        let textColor = '#fff';\n\n        if (count > 100) {\n          size = 'large';\n          background = '#4B2E14';\n        } else if (count > 20) {\n          size = 'medium';\n          background = '#8B5A2B';\n        }\n\n        const iconUrl = violetIcon.options.iconUrl;\n        const iconSize = violetIcon.options.iconSize || [44, 44];\n\n        // Adiciona tooltip ao cluster\n        cluster.bindTooltip(`\n          <div class=\"bg-white/95 text-gray-800 text-sm font-medium px-3 py-1.5 rounded shadow-sm border border-gray-100\">\n            <strong>${count} escola${count > 1 ? 's' : ''} indígena${count > 1 ? 's' : ''}</strong>\n            <br/>\n            <span class=\"text-xs text-gray-600\">Clique para expandir</span>\n          </div>\n        `, {\n          className: \"cluster-tooltip\",\n          direction: \"top\",\n          offset: [0, -10],\n          opacity: 1,\n          permanent: false,\n          sticky: !isMobile\n        });\n\n        return L.divIcon({\n          html: `\n            <div \n              role=\"button\"\n              tabindex=\"0\"\n              aria-label=\"Grupo de ${count} escolas indígenas. Clique para expandir.\"\n              style=\"\n              background: radial-gradient(circle at 30% 30%, ${background}, #3b2e2a);\n              color: ${textColor};\n              border-radius: 50%;\n                width: ${iconSize[0]}px;\n                height: ${iconSize[1]}px;\n              display: flex;\n              flex-direction: column;\n              align-items: center;\n              justify-content: center;\n              font-weight: bold;\n              border: 2px solid #f5f5dc;\n              box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);\n                transition: transform 0.3s ease, box-shadow 0.3s ease;\n              padding: 2px;\n                cursor: pointer;\n              \"\n            >\n              <img \n                src=\"${iconUrl}\" \n                width=\"${iconSize[0] * 0.6}\" \n                height=\"${iconSize[1] * 0.6}\" \n                style=\"margin-bottom: 2px;\"\n                alt=\"\"\n                aria-hidden=\"true\"\n              />\n              <span \n                style=\"\n                font-size: ${size === 'large' ? '16px' : size === 'medium' ? '14px' : '12px'};\n                \"\n              >${count}</span>\n            </div>`,\n          className: `marker-cluster marker-cluster-${size}`,\n          iconSize: L.point(iconSize[0], iconSize[1])\n        });\n      },\n      \n      // Configurações de animação suaves\n      animateAddingMarkers: true,\n      spiderLegPolylineOptions: { \n        weight: 1.3,\n        color: '#5C4033',\n        opacity: 0.5,\n        dashArray: '2,4'\n      },\n      \n      // Configurações de performance\n      chunkInterval: isMobile ? 100 : 200,\n      chunkDelay: isMobile ? 25 : 50,\n      \n      // Configurações de interatividade\n      singleMarkerMode: false,\n      spiderfyDistanceMultiplier: isMobile ? 2 : 1.5\n    });\n\n    // Adiciona eventos de interação ao cluster\n    clusterGroup.on('clusterclick', function(e) {\n      const cluster = e.layer;\n      const markers = cluster.getAllChildMarkers();\n      \n      // Se estiver no zoom máximo, mostra tooltip explicando a expansão\n      if (map.getZoom() >= cluster.options.disableClusteringAtZoom) {\n        const tooltip = L.tooltip({\n          className: 'cluster-expand-tooltip',\n          direction: 'center',\n          permanent: true,\n          opacity: 0.9\n        })\n        .setContent(`\n          <div class=\"bg-white/95 text-gray-800 text-sm font-medium px-3 py-1.5 rounded shadow-sm border border-gray-100\">\n            <strong>Expandindo ${markers.length} escola${markers.length > 1 ? 's' : ''}</strong>\n            <br/>\n            <span class=\"text-xs text-gray-600\">Toque em um marcador para ver detalhes</span>\n          </div>\n        `)\n        .setLatLng(cluster.getLatLng());\n        \n        tooltip.addTo(map);\n        setTimeout(() => tooltip.remove(), 2000);\n      }\n    });\n\n    // Adiciona os marcadores ao grupo\n    pontosValidos.forEach((ponto, index) => {\n      const lat = parseFloat(ponto.latitude);\n      const lng = parseFloat(ponto.longitude);\n      \n      const marker = L.marker([lat, lng], { \n        icon: escolaIcon,\n        zIndexOffset: 1000,\n        keyboard: true,\n        alt: `Marcador para ${capitalizeWords(ponto.titulo)}`,\n        riseOnHover: true,\n        interactive: true,\n        tooltip: null\n      });\n\n      // Remove qualquer tooltip existente antes de adicionar o novo\n      marker.unbindTooltip();\n      \n      // Adiciona apenas o tooltip customizado\n      marker.bindTooltip(createTooltipContent(ponto), {\n        className: \"custom-tooltip\",\n        direction: \"top\",\n        offset: [0, -10],\n        opacity: 1,\n        permanent: false,\n        sticky: !isMobile, // Tooltip só é sticky em desktop\n        interactive: true, // Permite interação com o tooltip\n        // Desabilita o tooltip padrão do Leaflet\n        tooltip: null\n      });\n\n      // Adiciona eventos de interação\n      marker.on('click', (e) => {\n        // Previne propagação do evento\n        if (e.originalEvent) {\n          e.originalEvent.stopPropagation();\n        }\n        console.log('Marcador clicado:', ponto.titulo);\n        onClick?.(ponto);\n      });\n      \n      // Adiciona evento de touch para mobile\n      if (isMobile) {\n        marker.on('touchend', (e) => {\n          e.originalEvent.stopPropagation();\n          e.originalEvent.preventDefault();\n          console.log('Marcador tocado (mobile):', ponto.titulo);\n          onClick?.(ponto);\n        });\n      }\n\n      // Verifica se este marcador faz parte de um par próximo\n      const pairIndex = nearbyPairs.findIndex(pair => pair.includes(index));\n      if (pairIndex !== -1) {\n        const [first, second] = nearbyPairs[pairIndex];\n        const isFirst = index === first;\n        const otherIndex = isFirst ? second : first;\n        const otherPonto = pontosValidos[otherIndex];\n\n        // Aplica o efeito de fan-out aprimorado apenas em desktop\n        if (!isMobile) {\n          marker.on('add', function() {\n            const transform = isFirst \n              ? 'perspective(500px) rotateY(-20deg) translateX(-20px) rotate(-25deg) scale(0.9)'\n              : 'perspective(500px) rotateY(20deg) translateX(20px) rotate(25deg) scale(0.9)';\n            \n            this._icon.style.transform = transform;\n            this._icon.style.transition = 'transform 0.5s ease-out, filter 0.3s ease-in';\n            this._icon.style.filter = 'drop-shadow(0 4px 12px rgba(160, 82, 45, 0.35))';\n            this._icon.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.35)';\n          });\n        }\n\n        // Cria o conector entre os marcadores\n        const connector = createConnector(\n          map,\n          lat,\n          lng,\n          parseFloat(otherPonto.latitude),\n          parseFloat(otherPonto.longitude)\n        );\n        connectorsRef.current.push(connector);\n      }\n\n      clusterGroup.addLayer(marker);\n    });\n\n    // Adiciona o grupo ao mapa\n    map.addLayer(clusterGroup);\n    clusterGroupRef.current = clusterGroup;\n\n    // Adiciona listener global para o evento de clique no tooltip\n    const handleTooltipClick = (event) => {\n      const ponto = event.detail;\n      onClick?.(ponto);\n    };\n\n    window.addEventListener('marker-click', handleTooltipClick);\n\n    // Limpa o listener quando o componente for desmontado\n    return () => {\n      window.removeEventListener('marker-click', handleTooltipClick);\n      if (clusterGroupRef.current) {\n        map.removeLayer(clusterGroupRef.current);\n      }\n      connectorsRef.current.forEach(connector => map.removeLayer(connector));\n      connectorsRef.current = [];\n      clearTooltipTimeout();\n      lastTouchedMarker.current = null;\n    };\n  }, [\n    map, \n    pontosValidos, \n    onClick, \n    escolaIcon, \n    visibility.educacao, \n    dataPoints, \n    isMobile, \n    createTooltipContent, \n    handleTouchInteraction, \n    clearTooltipTimeout\n  ]);\n\n  return null;\n};\n\n// Componente principal que cria o mapa Leaflet\nconst Marcadores = ({ dataPoints, visibility, onClick, mapView }) => {\n  return (\n    <MapContainer\n      center={mapView?.center || [-23.5505, -46.6333]} // Usar view sincronizada ou padrão\n      zoom={mapView?.zoom || 8}\n      style={{ height: '100%', width: '100%', background: 'transparent' }}\n      attributionControl={false}\n      zoomControl={false}\n      doubleClickZoom={false}\n      scrollWheelZoom={false}\n      dragging={false}\n      touchZoom={false}\n      boxZoom={false}\n      keyboard={false}\n      tap={false}\n      className=\"markers-only-map\"\n      preferCanvas={true}\n      zoomSnap={0}\n      zoomDelta={0}\n      wheelPxPerZoomLevel={0}\n      wheelDebounceTime={0}\n      wheelSensitivity={0}\n    >\n      {/* TileLayer transparente para não interferir com o mapa OpenLayers */}\n      <TileLayer\n        url=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"\n        attribution=\"\"\n        opacity={0}\n        zIndex={-1000}\n      />\n      <MarcadoresInternos \n        dataPoints={dataPoints}\n        visibility={visibility}\n        onClick={onClick}\n        mapView={mapView}\n      />\n    </MapContainer>\n  );\n};\n\nexport default Marcadores; "],"names":["TOUCH_TARGET_SIZE","createIcon","color","L","className","concat","html","iconSize","iconAnchor","popupAnchor","violetIcon","iconUrl","btoa","PROXIMITY_THRESHOLD","MarcadoresInternos","_ref","dataPoints","visibility","onClick","mapView","map","useMap","clusterGroupRef","useRef","connectorsRef","isMobile","useMemo","mobile","lastTouchedMarker","touchTimeout","useEffect","setView","center","zoom","animate","getZoom","clearTooltipTimeout","useCallback","current","clearTimeout","handleTouchInteraction","marker","ponto","e","originalEvent","stopPropagation","closeTooltip","openTooltip","setTimeout","pontosValidos","React","Array","isArray","length","console","warn","log","escolasComProblemas","pontosFiltrados","filter","titulo","latitude","longitude","push","escola","problema","detalhes","lat","parseFloat","lng","isNaN","limites","latMin","latMax","lngMin","lngMax","group","forEach","groupEnd","escolaIcon","createTooltipContent","JSON","stringify","capitalizeWords","etnia","educacao","removeLayer","connector","nearbyPairs","pontos","pairs","used","Set","i","has","j","p1","p2","latDiff","Math","abs","lngDiff","add","findNearbyPairs","clusterGroup","flat","chunkedLoading","maxClusterRadius","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","removeOutsideVisibleBounds","disableClusteringAtZoom","minZoom","maxZoom","iconCreateFunction","cluster","count","getChildCount","size","background","options","bindTooltip","direction","offset","opacity","permanent","sticky","animateAddingMarkers","spiderLegPolylineOptions","weight","dashArray","chunkInterval","chunkDelay","singleMarkerMode","spiderfyDistanceMultiplier","on","layer","markers","getAllChildMarkers","tooltip","setContent","setLatLng","getLatLng","addTo","remove","index","icon","zIndexOffset","keyboard","alt","riseOnHover","interactive","unbindTooltip","preventDefault","pairIndex","findIndex","pair","includes","first","second","isFirst","otherPonto","transform","this","_icon","style","transition","boxShadow","createConnector","centerLat","centerLng","markerLat","markerLng","addLayer","handleTooltipClick","event","detail","window","addEventListener","removeEventListener","_ref2","_jsxs","MapContainer","height","width","attributionControl","zoomControl","doubleClickZoom","scrollWheelZoom","dragging","touchZoom","boxZoom","tap","preferCanvas","zoomSnap","zoomDelta","wheelPxPerZoomLevel","wheelDebounceTime","wheelSensitivity","children","_jsx","TileLayer","url","attribution","zIndex"],"sourceRoot":""}