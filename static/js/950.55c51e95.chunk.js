"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[950],{4128:(e,a,t)=>{t.d(a,{k:()=>o});const s=["EE","EEI"],o=e=>{if(!e||"string"!==typeof e)return"";return e.split(/\s+/).map((e=>s.includes(e.toUpperCase())?e.toUpperCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(" ")}},9550:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Ea});var s=t(5043),o=t(154),r=t(5351),n=t(6528),l=t(5366),i=t(495),c=t(6644),d=t(9468),u=t(2463),m=t(3241),g=t(3104),x=t(1060),h=t(2861),p=t(3908),f=t(9333),b=t(9826);t(3976);const v={center:[-48.4129,-22.3794],zoom:7.63,maxZoom:18,minZoom:4,mobile:{center:[-48.5935,-21.9212],zoom:5.7},clusterDistance:30,proximityThreshold:5e-5,disableClusteringAtZoom:12,tooltipOffset:10};var w=t(9845),j=t(9379),y=t(579);const N=s.forwardRef(((e,a)=>(0,y.jsx)("div",(0,j.A)({id:"map",className:"w-full h-full",ref:a},e))));var k=t(5921),A=t(1247),_=t(7790);function C(e){const a="Regularizada"===e.getProperties().fase_ti;return new k.Ay({fill:new A.A({color:a?"rgba(220, 20, 60, 0.3)":"rgba(139, 0, 0, 0.25)"}),stroke:new _.A({color:"#B22222",width:2,lineDash:[3,3]})})}function E(){return new k.Ay({fill:new A.A({color:"rgba(0, 0, 0, 0.3)"}),stroke:new _.A({color:"#000000",width:2})})}var S=t(5263),z=t(3361);function L(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{borderColor:s=null,showShadow:o=!0,showGradient:r=!0,showGlow:n=!1,isNearbyPair:l=!1}=t,i=e,c=s||i,d=a/2,u=a/24,m=3*u,g=2*u,x="M".concat(d," ").concat(2*u,"C").concat(d-3.87*u," ").concat(2*u," ").concat(d-7*u," ").concat(5.13*u," ").concat(d-7*u," ").concat(9*u,"c0 ").concat(5.25*u," ").concat(7*u," ").concat(13*u," ").concat(7*u," ").concat(13*u,"s").concat(7*u," -").concat(7.75*u," ").concat(7*u," -").concat(13*u,"c0 -").concat(3.87*u," -").concat(3.13*u," -").concat(7*u," -").concat(7*u," -").concat(7*u,"z");return'\n    <svg width="'.concat(a,'" height="').concat(a,'" viewBox="0 0 ').concat(a," ").concat(a,'" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        ').concat(o?'\n        <filter id="shadow-'.concat(a,'" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="').concat(2*u,'" stdDeviation="').concat(3*u,'" flood-color="rgba(0,0,0,0.3)"/>\n        </filter>\n        '):"","\n        ").concat(r?'\n        <linearGradient id="gradient-'.concat(a,'" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:').concat(i,';stop-opacity:1" />\n          <stop offset="100%" style="stop-color:').concat(c,';stop-opacity:1" />\n        </linearGradient>\n        '):"","\n        ").concat(n?'\n        <filter id="glow-'.concat(a,'" x="-50%" y="-50%" width="200%" height="200%">\n          <feGaussianBlur stdDeviation="').concat(1*u,'" result="coloredBlur"/>\n          <feMerge> \n            <feMergeNode in="coloredBlur"/>\n            <feMergeNode in="SourceGraphic"/>\n          </feMerge>\n        </filter>\n        '):"","\n      </defs>\n      \n      \x3c!-- Brilho sutil de fundo --\x3e\n      ").concat(n?'\n      <circle cx="'.concat(d-2*u,'" cy="').concat(d-2*u,'" r="').concat(g,'" fill="white" opacity="0.2"/>\n      '):"",'\n      \n      \x3c!-- Marcador principal (gota invertida) --\x3e\n      <path d="').concat(x,'" \n            fill="').concat(r?"url(#gradient-".concat(a,")"):i,'" \n            ').concat(o?'filter="url(#shadow-'.concat(a,')"'):"","\n            ").concat(n?'filter="url(#glow-'.concat(a,')"'):"",'/>\n      \n      \x3c!-- C\xedrculo interno branco (bolinha) --\x3e\n      <circle cx="').concat(d,'" cy="').concat(9*u,'" r="').concat(m,'" fill="white" opacity="0.9"/>\n      \n      \x3c!-- Brilho sutil no c\xedrculo --\x3e\n      <circle cx="').concat(d-2*u,'" cy="').concat(7*u,'" r="').concat(.6*m,'" fill="white" opacity="0.4"/>\n      \n      \x3c!-- Indicador de par pr\xf3ximo (se aplic\xe1vel) --\x3e\n      ').concat(l?'\n      <circle cx="'.concat(a-4*u,'" cy="').concat(4*u,'" r="').concat(3*u,'" fill="#FF6B6B" opacity="0.8"/>\n      <text x="').concat(a-4*u,'" y="').concat(6*u,'" text-anchor="middle" font-size="').concat(8*u,'" fill="white" font-weight="bold">P</text>\n      '):"","\n    </svg>\n  ")}function I(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const t=e.get("schoolData");if(!t)return null;const s="#3B82F6",o="#1E40AF",r=e.get("isNearbyPair"),n=L(s,24,{borderColor:o,showShadow:!0,showGradient:!0,showGlow:!1,isNearbyPair:r}),l="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(n),i=new k.Ay({image:new S.A({src:l,scale:r?1.1:1,anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction"})});return a&&i.setText(new z.A({text:t.titulo||"Escola",font:"bold 10px Arial",fill:new A.A({color:"#FFFFFF"}),stroke:new _.A({color:"#000000",width:2}),offsetY:r?-35:-30,textAlign:"center",textBaseline:"middle"})),i}catch(t){return null}}function P(e,a){try{const t=e.get("features");if(!t||0===t.length)return null;const s=t.length;if(1===s){const e=t[0];return e?a(e):null}let o="#3B82F6",r=32;s>100?(o="#1E40AF",r=40):s>50?(o="#2563EB",r=36):s>20?(o="#3B82F6",r=34):s>10&&(o="#60A5FA",r=33);const n=Math.min(1+.015*s,1.8),l=Math.round(r*n),i=L(o,l,{borderColor:o,showShadow:!0,showGradient:!0,showGlow:s>20,isNearbyPair:!1}),c="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(i);let d="12px",u="bold";return s>100?d="14px":s>50?d="13px":s>20&&(d="12px"),new k.Ay({image:new S.A({src:c,scale:1,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction"}),text:new z.A({text:s.toString(),font:"".concat(u," ").concat(d," Arial"),fill:new A.A({color:"#FFFFFF"}),stroke:new _.A({color:"#000000",width:2}),offsetY:.6*l})})}catch(t){return null}}b.A.defs("EPSG:4674","+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs"),(0,f.kz)(b.A);const F=e=>{let{dataPoints:a=[],onPainelOpen:t,center:f=v.center,zoom:b=v.zoom,className:j="h-screen w-full",terrasIndigenasData:k=null,estadoSPData:A=null,showTerrasIndigenas:_=!0,showEstadoSP:S=!0,showMarcadores:z=!0,showNomesEscolas:L=!1}=e;const F=(0,s.useRef)(null),M=(0,s.useRef)(null),D=(0,s.useRef)(null),R=(0,s.useRef)(null),T=(0,s.useRef)(null),B=(0,s.useRef)(null),[U,G]=(0,s.useState)({lng:f[0],lat:f[1],zoom:b}),W=(0,s.useRef)(null),O=(0,s.useRef)(null),V=(0,s.useCallback)(((e,a)=>{const s=e.get("schoolData");s&&((0,w.F)()&&console.log("[MOBILE] Marcador de escola clicado:",s),null===t||void 0===t||t(s))}),[t]),q=(0,s.useCallback)((()=>({satelliteLayer:new n.A({source:new d.A({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:'\xa9 <a href="https://www.esri.com/">Esri</a>',maxZoom:19,wrapX:!1,tilePixelRatio:1,tileSize:256}),preload:1,useInterimTilesOnError:!1})})),[]),H=(0,s.useCallback)((e=>e.titulo||"Escola Ind\xedgena"),[]);return(0,s.useEffect)((()=>{if(M.current)return;const e=(0,w.F)(),a=e?v.mobile.center:f,t=e?v.mobile.zoom:b;D.current=new i.A,R.current=new c.A({distance:L?15:5,source:D.current,geometryFunction:e=>{const a=e.getGeometry();return"Point"===a.getType()?a:null}}),T.current=new l.A({source:R.current,style:e=>P(e,(e=>I(e,L))),zIndex:15});const{satelliteLayer:s}=q();B.current=s,M.current=new o.A({target:F.current,layers:[B.current,T.current],view:new r.Ay({center:(0,u.Rb)(a),zoom:t,maxZoom:18,minZoom:4,enableRotation:!1}),controls:(0,x.N)(),interactions:(0,h.N)({dragRotate:!1,pinchRotate:!1})}),M.current.on("moveend",(()=>{const e=M.current.getView(),a=(0,u.WP)(e.getCenter()),t={lng:a[0].toFixed(4),lat:a[1].toFixed(4),zoom:e.getZoom().toFixed(2)};G(t)})),M.current.on("moveend",(()=>{T.current&&T.current.changed()})),M.current.on("click",(e=>{const a=M.current.forEachFeatureAtPixel(e.pixel,(e=>e));if(a)if(a.get("features")){const t=a.get("features");if(1===t.length)console.log("[CLUSTER] Clique em cluster com 1 marcador",t[0].get("schoolData")),V(t[0],e);else if(t.length>1){console.log("[CLUSTER] Clique em cluster com",t.length,"marcadores. Fazendo zoom.");const e=a.getGeometry().getExtent(),s=M.current.getView().getZoom();let o=12;o=t.length>20?10:t.length>10?11:t.length>5?12:13,o=Math.max(o,s+1),M.current.getView().fit(e,{duration:800,padding:[80,80,80,80],maxZoom:o})}}else console.log("[MARCADOR] Clique em marcador individual",a.get("schoolData")),V(a,e)}));let n=null;M.current.on("pointermove",(e=>{if((0,w.F)())return;n&&(n.remove(),n=null);const a=M.current.forEachFeatureAtPixel(e.pixel,(e=>e));if(a)if(a.get("features")){const t=a.get("features");if(1===t.length){const a=t[0].get("schoolData");a&&(n=d(e,a,"school"))}else n=m(e,t.length)}else{const t=a.get("schoolData"),s=a.get("terraIndigenaInfo");t?n=d(e,t,"school"):s&&(n=d(e,s,"terra_indigena"))}}));const d=(e,a,t)=>{const s=document.createElement("div");let o,r,n;s.className="ol-tooltip",s.setAttribute("data-type",t),"school"===t?(o=H(a),r="rgba(59, 130, 246, 0.95)",n="rgba(37, 99, 235, 0.8)"):"terra_indigena"===t&&(o="Terra Ind\xedgena ".concat(a.titulo||"Ind\xedgena"),r="rgba(220, 20, 60, 0.95)",n="rgba(185, 28, 28, 0.8)"),s.textContent=o,s.style.position="absolute",s.style.backgroundColor=r,s.style.color="white",s.style.padding="8px 12px",s.style.borderRadius="8px",s.style.fontSize="13px",s.style.fontFamily="Arial, sans-serif",s.style.fontWeight="500",s.style.maxWidth="200px",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",s.style.zIndex="1000",s.style.pointerEvents="none",s.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.25)",s.style.border="1px solid ".concat(n),s.style.backdropFilter="blur(4px)";const l=e.coordinate,i=M.current.getPixelFromCoordinate(l);return s.style.left=i[0]+-100+"px",s.style.top=i[1]+-40+"px",F.current.appendChild(s),s},m=(e,a)=>{const t=document.createElement("div");t.className="ol-tooltip",t.textContent="".concat(a," escolas ind\xedgenas"),t.style.position="absolute",t.style.backgroundColor="rgba(255, 255, 255, 0.95)",t.style.color="#374151",t.style.padding="8px 12px",t.style.borderRadius="8px",t.style.fontSize="13px",t.style.fontFamily="Arial, sans-serif",t.style.fontWeight="500",t.style.maxWidth="200px",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.zIndex="1000",t.style.pointerEvents="none",t.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",t.style.border="1px solid rgba(0, 0, 0, 0.1)",t.style.backdropFilter="blur(4px)";const s=e.coordinate,o=M.current.getPixelFromCoordinate(s);return t.style.left=o[0]+-100+"px",t.style.top=o[1]+-40+"px",F.current.appendChild(t),t};return M.current.on("dblclick",(e=>{const a=M.current.forEachFeatureAtPixel(e.pixel,(e=>e));a&&(!a.get("features")||a.get("features")&&1===a.get("features").length)&&(e.preventDefault(),e.stopPropagation(),console.log("[DBLCLICK] Zoom desabilitado em marcador individual ou cluster de 1 escola"))})),()=>{M.current&&(M.current.setTarget(void 0),M.current=null)}}),[f,b,q,P,H,t,V]),(0,s.useEffect)((()=>{if(!M.current)return;const e=(0,w.F)(),a=e?v.mobile.center:f,t=e?v.mobile.zoom:b,s=M.current.getView(),o=(0,u.WP)(s.getCenter()),r=s.getZoom();o[0]===a[0]&&o[1]===a[1]&&r===t||(s.setCenter((0,u.Rb)(a)),s.setZoom(t))}),[f,b,L]),(0,s.useEffect)((()=>{if(!D.current||!a||!z)return;D.current.clear();const e=a.filter((e=>{if(!e.latitude||!e.longitude)return!1;const a=parseFloat(e.latitude),t=parseFloat(e.longitude);return!isNaN(a)&&!isNaN(t)&&a>=-90&&a<=90&&t>=-180&&t<=180})),t=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e-5;const t=[],s=new Set;for(let o=0;o<e.length;o++)if(!s.has(o))for(let r=o+1;r<e.length;r++){if(s.has(r))continue;const n=e[o],l=e[r],i=Math.abs(parseFloat(n.latitude)-parseFloat(l.latitude)),c=Math.abs(parseFloat(n.longitude)-parseFloat(l.longitude));if(i<a&&c<a){t.push([o,r]),s.add(o),s.add(r);break}}return t}(e);new Set(t.flat());e.forEach(((e,a)=>{if(e.latitude&&e.longitude){const s=new g.A({geometry:new m.A((0,u.Rb)([e.longitude,e.latitude]))});s.set("schoolData",e);-1!==t.findIndex((e=>e.includes(a)))&&s.set("isNearbyPair",!0),D.current.addFeature(s)}}))}),[a,z]),(0,s.useEffect)((()=>{T.current&&T.current.setStyle((e=>P(e,(e=>I(e,L)))))}),[L,P]),(0,s.useEffect)((()=>{T.current&&(T.current.setStyle((e=>P(e,(e=>I(e,L))))),T.current.changed())}),[L,P]),(0,s.useEffect)((()=>{M.current&&D.current&&(T.current&&M.current.removeLayer(T.current),R.current=new c.A({distance:L?15:10,source:D.current,geometryFunction:e=>{const a=e.getGeometry();return"Point"===a.getType()?a:null}}),T.current=new l.A({source:R.current,style:e=>P(e,(e=>I(e,L))),zIndex:15}),M.current.addLayer(T.current))}),[L,P]),(0,s.useEffect)((()=>{if(!M.current)return;let e=null,a=null,s=0;const o=o=>{const r=M.current.forEachFeatureAtPixel(o.pixel,(e=>e));if(r){const o=r.get("terraIndigenaInfo");if(o)if((0,w.F)())t&&t(o);else if(a===r?s++:(a=r,s=1),e&&clearTimeout(e),e=setTimeout((()=>{s=0,a=null}),500),1===s){const e=r.getGeometry();if(e){const a=e.getExtent();M.current.getView().fit(a,{duration:800,padding:[50,50,50,50],maxZoom:15})}}else 2===s&&(t&&t(o),s=0,a=null,e&&(clearTimeout(e),e=null))}};return M.current.on("click",o),()=>{M.current&&M.current.un("click",o),e&&clearTimeout(e)}}),[t]),(0,s.useEffect)((()=>{M.current&&D.current&&(T.current&&M.current.removeLayer(T.current),R.current=new c.A({distance:L?15:10,source:D.current,geometryFunction:e=>{const a=e.getGeometry();return"Point"===a.getType()?a:null}}),T.current=new l.A({source:R.current,style:e=>P(e,(e=>I(e,L))),zIndex:15}),M.current.addLayer(T.current))}),[L,P]),(0,s.useEffect)((()=>{if(M.current){if(W.current&&(M.current.removeLayer(W.current),W.current=null),O.current&&(M.current.removeLayer(O.current),O.current=null),_&&k){if(!k.features||0===k.features.length)return;try{const e=new p.A({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).readFeatures(k);if(e.length>0){e[0].getGeometry()}const a=new l.A({source:new i.A({features:e}),style:C,zIndex:10});a.getSource().getFeatures().forEach((e=>{const a=e.getProperties();e.set("terraIndigenaInfo",{titulo:a.terrai_nom,tipo:"terra_indigena",etnia:a.etnia_nome,municipio:a.municipio_,uf:a.uf_sigla,superficie:a.superficie,fase:a.fase_ti,modalidade:a.modalidade,reestudo:a.reestudo_t,cr:a.cr,faixa_fron:a.faixa_fron,undadm_nom:a.undadm_nom,undadm_sig:a.undadm_sig,dominio_un:a.dominio_un,data_atual:a.data_atual,terrai_cod:a.terrai_cod,undadm_cod:a.undadm_cod})})),M.current.addLayer(a),W.current=a}catch(e){}}if(S&&A){if(!A.features||0===A.features.length)return;try{const e=new p.A({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).readFeatures(A);if(e.length>0){e[0].getGeometry()}const a=new l.A({source:new i.A({features:e}),style:E,zIndex:5,interactive:!1});M.current.addLayer(a),O.current=a}catch(e){}}}}),[_,S,k,A]),(0,y.jsx)(N,{ref:F})},M={},D=e=>{const[a,t]=(0,s.useState)(null),[o,r]=(0,s.useState)(!1),[n,l]=(0,s.useState)(null);return(0,s.useEffect)((()=>{if(!e)return;(async()=>{if(M[e])return console.log("useGeoJSONCache: Dados de ".concat(e," encontrados no cache")),void t(M[e]);r(!0);try{var a,s;const o="".concat("/escolasindigenas","/").concat(e,".geojson");console.log("useGeoJSONCache: Carregando ".concat(e," de:"),o);const r=await fetch(o);if(!r.ok)throw new Error("Erro ao buscar GeoJSON (".concat(r.status,")"));const n=await r.json();console.log("useGeoJSONCache: ".concat(e," carregado com sucesso:"),{type:n.type,features:(null===(a=n.features)||void 0===a?void 0:a.length)||0,crs:n.crs,firstFeature:null!==(s=n.features)&&void 0!==s&&s[0]?{type:n.features[0].type,properties:n.features[0].properties?Object.keys(n.features[0].properties):"Sem propriedades",geometry:n.features[0].geometry?{type:n.features[0].geometry.type,coordinates:n.features[0].geometry.coordinates?"".concat(n.features[0].geometry.coordinates.length," arrays"):"Sem coordenadas"}:"Sem geometria"}:"Nenhum feature"}),M[e]=n,t(n)}catch(o){console.error("useGeoJSONCache: Erro ao carregar ".concat(e,":"),o),l(o)}finally{r(!1)}})()}),[e]),{data:a,loading:o,error:n}},R=e=>{let{dataPoints:a,onPainelOpen:t,painelAberto:o=!1,className:r="h-screen w-full"}=e;const{data:n,loading:l,error:i}=D("terras_indigenas"),{data:c,loading:d,error:u}=D("SP"),[m,g]=(0,s.useState)(!0),[x,h]=(0,s.useState)(!0),[p,f]=(0,s.useState)(!0),[b,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),k=(0,s.useCallback)((()=>{w(window.innerWidth<=768)}),[]);(0,s.useEffect)((()=>(k(),window.addEventListener("resize",k),()=>{window.removeEventListener("resize",k)})),[k]);const A=(0,s.useCallback)((()=>N((e=>!e))),[]);(0,s.useEffect)((()=>{var e,a,t,s;console.log("MapSelector: Status das camadas GeoJSON:",{terrasIndigenas:{loading:l,error:i,hasData:!!n,features:(null===n||void 0===n||null===(e=n.features)||void 0===e?void 0:e.length)||0,type:null===n||void 0===n?void 0:n.type,firstFeature:null!==n&&void 0!==n&&null!==(a=n.features)&&void 0!==a&&a[0]?{type:n.features[0].type,properties:n.features[0].properties?Object.keys(n.features[0].properties):"Sem propriedades"}:"Nenhum feature"},estadoSP:{loading:d,error:u,hasData:!!c,features:(null===c||void 0===c||null===(t=c.features)||void 0===t?void 0:t.length)||0,type:null===c||void 0===c?void 0:c.type,firstFeature:null!==c&&void 0!==c&&null!==(s=c.features)&&void 0!==s&&s[0]?{type:c.features[0].type,properties:c.features[0].properties?Object.keys(c.features[0].properties):"Sem propriedades"}:"Nenhum feature"}})}),[n,c,l,d,i,u]),(0,s.useEffect)((()=>{console.log("MapSelector: useEffect painelAberto mudou:",{painelAberto:o,isMobile:b,showMarcadores:p,shouldReactivate:!o&&b}),!o&&b&&(console.log("MapSelector: Painel fechado em mobile, reativando marcadores"),f(!0))}),[o,b]),(0,s.useEffect)((()=>{console.log("MapSelector: showMarcadores mudou para:",p)}),[p]);const _=e=>{let{onMinimize:a,isMobile:t,isMinimized:s}=e;return(0,y.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-100 bg-white",children:[(0,y.jsx)("h3",{className:"text-sm font-medium text-gray-800",children:"Camadas do Mapa"}),(0,y.jsx)("div",{className:"flex items-center gap-2",children:(0,y.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 transition-colors p-1","aria-label":s?"Expandir":"Minimizar",type:"button",children:s?"\u25be":"\u25b4"})})]})},C=e=>{let{id:a,label:t,checked:s,onChange:o,disabled:r=!1,loading:n=!1,error:l=!1,total:i,color:c,subItems:d=null}=e;return(0,y.jsxs)("button",{type:"button",onClick:o,disabled:r,className:"w-full flex items-center gap-2 px-3 py-2 rounded-md transition-colors ".concat(s?"bg-gray-50":"hover:bg-gray-50"," ").concat(r?"opacity-50 cursor-not-allowed":""),children:[d?(0,y.jsx)("div",{className:"flex flex-col gap-1",children:d.map(((e,a)=>(0,y.jsxs)("div",{className:"flex items-center gap-1",children:[(0,y.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),(0,y.jsx)("span",{className:"text-xs text-gray-600",children:e.label})]},a)))}):(0,y.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:c}}),(0,y.jsx)("span",{className:"text-sm text-gray-800",children:t}),void 0!==i&&(0,y.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["(",i,")"]}),n&&(0,y.jsx)("span",{className:"text-blue-500 ml-1",children:"(carregando...)"}),l&&(0,y.jsx)("span",{className:"text-red-500 ml-1",children:"(erro)"}),d?(0,y.jsx)("div",{className:"ml-auto w-2 h-2 rounded-full bg-gray-300"}):(0,y.jsx)("div",{className:"ml-auto w-2 h-2 rounded-full",style:{backgroundColor:c}})]})},E=b?v.mobile.center:v.center,S=b?v.mobile.zoom:v.zoom;return console.log("MapSelector - Debug zoom:",{isMobile:b,mobileZoom:v.mobile.zoom,desktopZoom:v.zoom,selectedZoom:S,mobileCenter:v.mobile.center,desktopCenter:v.center,selectedCenter:E}),(0,y.jsxs)("div",{className:r,style:{position:"relative"},children:[b?(0,y.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-20",children:(0,y.jsxs)("div",{className:"bg-white border-t border-gray-100 shadow-lg",children:[(0,y.jsx)(_,{onMinimize:A,isMobile:!0,isMinimized:j}),!j&&(0,y.jsxs)("div",{className:"p-2 flex flex-col gap-1 max-h-60 overflow-y-auto",children:[(0,y.jsx)(C,{id:"estado-sp",label:"Estado de S\xe3o Paulo",checked:x,onChange:()=>h(!x),loading:d,error:u,color:"#10B981"}),(0,y.jsx)(C,{id:"marcadores",label:"Escolas Ind\xedgenas",checked:p,onChange:()=>f(!p),total:null===a||void 0===a?void 0:a.length,color:"#3B82F6"}),(0,y.jsx)(C,{id:"terras-indigenas",label:"Terras Ind\xedgenas",checked:m,onChange:()=>g(!m),loading:l,error:i,subItems:[{label:"Regularizadas",color:"#DC143C"},{label:"Declaradas",color:"#8B0000"}]})]})]})}):(0,y.jsxs)("div",{className:"fixed top-24 right-4 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[(0,y.jsx)(_,{onMinimize:A,isMobile:!1,isMinimized:j}),!j&&(0,y.jsxs)("div",{className:"p-2 flex flex-col gap-1 max-h-96 overflow-y-auto",children:[(0,y.jsx)(C,{id:"estado-sp",label:"Estado de S\xe3o Paulo",checked:x,onChange:()=>h(!x),loading:d,error:u,color:"#10B981"}),(0,y.jsx)(C,{id:"marcadores",label:"Escolas Ind\xedgenas",checked:p,onChange:()=>f(!p),total:null===a||void 0===a?void 0:a.length,color:"#3B82F6"}),(0,y.jsx)(C,{id:"terras-indigenas",label:"Terras Ind\xedgenas",checked:m,onChange:()=>g(!m),loading:l,error:i,subItems:[{label:"Regularizadas",color:"#DC143C"},{label:"Declaradas",color:"#8B0000"}]})]})]}),(0,y.jsx)(F,{dataPoints:p?a:[],onPainelOpen:t,className:"h-full w-full",center:E,zoom:S,terrasIndigenasData:n,estadoSPData:c,showTerrasIndigenas:m,showEstadoSP:x,showMarcadores:p})]})},T=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").trim();var B=t(2880);const U=e=>{const[a,t]=(0,s.useState)([]),[o,r]=(0,s.useState)(!0),[n,l]=(0,s.useState)(null);return(0,s.useEffect)((()=>{(async()=>{if(console.log("\ud83d\udd04 Iniciando busca de documentos para escola:",e,"tipo:",typeof e),!e)return console.log("\u26a0\ufe0f Nenhum ID de escola fornecido, retornando array vazio"),t([]),void r(!1);try{r(!0),console.log("\ud83d\udce1 Consultando tabela documentos_escola...");const{data:a,error:s}=await B.N.auth.getSession();console.log("\ud83d\udd10 Estado da autentica\xe7\xe3o:",{temSessao:!(null===a||void 0===a||!a.session),error:s});const{data:o,error:n}=await B.N.from("documentos_escola").select("count").limit(1);console.log("\ud83d\udd11 Verifica\xe7\xe3o de permiss\xf5es:",{podeAcessar:!n,error:n?{code:n.code,message:n.message,details:n.details,hint:n.hint}:null});const{data:l,error:i}=await B.N.from("documentos_escola").select("*");i?console.error("\u274c Erro ao buscar todos os documentos:",{code:i.code,message:i.message,details:i.details,hint:i.hint}):(console.log("\ud83d\udcca Todos os documentos na tabela:",l),l&&l.length>0?(console.log("\ud83d\udcca Exemplo de documento:",l[0]),console.log("\ud83d\udcca Tipos de escola_id encontrados:",l.map((e=>({id:e.id,escola_id:e.escola_id,tipo_escola_id:typeof e.escola_id,valor_escola_id:e.escola_id}))))):console.log("\u26a0\ufe0f Tabela est\xe1 vazia ou n\xe3o temos permiss\xe3o para ver os dados")),console.log("\ud83d\udd0d Buscando documentos para escola_id:",e);const{data:c,error:d}=await B.N.from("documentos_escola").select("*").eq("escola_id",e.toString()).order("created_at",{ascending:!1});if(d)throw console.error("\u274c Erro na consulta Supabase:",{code:d.code,message:d.message,details:d.details,hint:d.hint}),d;if(console.log("\u2705 Documentos encontrados:",(null===c||void 0===c?void 0:c.length)||0),0===(null===c||void 0===c?void 0:c.length)){console.log("\u2139\ufe0f Nenhum documento encontrado para a escola ID:",e),console.log("\u2139\ufe0f Tentando buscar com diferentes formatos de escola_id...");const{data:a,error:t}=await B.N.from("documentos_escola").select("*").eq("escola_id",Number(e)),{data:s,error:o}=await B.N.from("documentos_escola").select("*").eq("escola_id",String(e));console.log("Resultados com escola_id como n\xfamero:",{count:(null===a||void 0===a?void 0:a.length)||0,error:t}),console.log("Resultados com escola_id como string:",{count:(null===s||void 0===s?void 0:s.length)||0,error:o})}else console.log("\ud83d\udcc4 Dados dos documentos:",c);t(c||[])}catch(s){console.error("\u274c Erro ao buscar documentos:",s),l(s.message)}finally{r(!1),console.log("\ud83c\udfc1 Estado final:",{documentos:a.length,isLoading:o,error:n||"nenhum"})}})()}),[e]),{documentos:a,isLoading:o,error:n}};var G=t(193),W=t(7669),O=t(1209),V=t(4387),q=t(9816),H=t(225),Z=t(9769),K=t(6863),Y=t(6093),J=t(4183);const X=(0,s.memo)((e=>{let{children:a,columns:t="auto-fit",gap:s=4,className:o=""}=e;return(0,y.jsx)("div",{className:"grid ".concat({"auto-fit":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",2:"grid-cols-1 sm:grid-cols-2",3:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4"}[t]," gap-").concat(s," ").concat(o," [&>*]:bg-green-100"),children:a})})),$=(0,s.memo)((e=>{let{data:a,className:t=""}=e;return a&&0!==a.length?(0,y.jsx)("div",{className:"bg-green-100 rounded-lg overflow-hidden ".concat(t),children:(0,y.jsx)("table",{className:"w-full",children:(0,y.jsx)("tbody",{children:a.map(((e,a)=>(0,y.jsxs)("tr",{className:a%2===0?"bg-white":"bg-green-50",children:[(0,y.jsx)("td",{className:"px-4 py-3 text-sm font-medium text-gray-700 border-r border-green-200",children:e.label}),(0,y.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.value})]},a)))})})}):null})),Q=(0,s.memo)((e=>{let{stats:a,className:t=""}=e;return a&&0!==a.length?(0,y.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 ".concat(t," [&>*]:border-b [&>*]:border-gray-200 [&>*]:pb-2 [&>*]:mb-2"),children:a.map(((e,a)=>(0,y.jsxs)("div",{className:"text-center rounded-lg p-4",children:[(0,y.jsx)("div",{className:"flex justify-center mb-2",children:e.icon&&(0,y.jsx)(e.icon,{className:"w-6 h-6 text-green-600"})}),(0,y.jsx)("div",{className:"text-2xl font-bold text-green-800",children:e.value}),(0,y.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:e.label})]},a)))}):null})),ee=(0,s.memo)((e=>{let{title:a,icon:t,children:o,description:r,defaultCollapsed:n=!1,className:l="",layout:i="default",layoutProps:c={}}=e;const[d,u]=(0,s.useState)(n);return(0,y.jsxs)("section",{className:"\n        bg-white rounded-2xl p-5 \n        shadow-sm transition-all duration-200\n        ".concat(l,"\n      "),children:[(0,y.jsx)("button",{onClick:()=>u(!d),className:" w-full flex items-center justify-between  text-base font-semibold mb-4 text-gray-900 hover:text-gray-800  transition-colors focus:outline-none ","aria-expanded":!d,"aria-controls":"".concat(a,"-content"),children:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,y.jsx)(t,{className:"w-5 h-5 text-green-600"}),(0,y.jsx)("span",{className:"tracking-wide",children:a})]})}),!d&&(0,y.jsxs)("div",{id:"".concat(a,"-content"),className:"space-y-4",role:"region","aria-labelledby":"".concat(a,"-button"),children:[r&&(0,y.jsx)("div",{className:"bg-green-100 rounded-lg p-4",children:(0,y.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed",children:r})}),(()=>{if(!o)return null;switch(i){case"grid":return(0,y.jsx)(X,(0,j.A)((0,j.A)({},c),{},{children:o}));case"table":return(0,y.jsx)($,{data:c.data,className:c.className});case"stats":return(0,y.jsx)(Q,{stats:c.stats,className:c.className});default:return(0,y.jsx)("div",{className:"space-y-4",children:o})}})()]})]})})),ae=ee,te=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():"",se=e=>{let{icon:a,label:t,value:s,type:o="text"}=e;return(0,y.jsxs)("div",{className:"p-1 rounded-md transition-all",children:[(0,y.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,y.jsx)(a,{className:"w-5 h-5 text-gray-600"}),(0,y.jsx)("span",{className:"text-xs text-gray-500 font-medium",children:t})]}),"boolean"===o?s?(0,y.jsxs)("span",{className:"flex items-center gap-1 text-green-600 text-sm",children:[(0,y.jsx)(G.A,{className:"w-5 h-5"}),"Sim"]}):(0,y.jsxs)("span",{className:"flex items-center gap-1 text-red-500 text-sm",children:[(0,y.jsx)(W.A,{className:"w-5 h-5"}),"N\xe3o"]}):(0,y.jsx)("span",{className:"text-sm text-gray-800 truncate",children:s})]})},oe=e=>{let{icon:a,label:t,value:s}=e;return(0,y.jsxs)("div",{className:"flex items-center gap-2 bg-green-100 p-1.5 rounded-md text-xs",children:[(0,y.jsx)(a,{className:"w-5 h-5 text-green-600"}),(0,y.jsxs)("span",{className:"text-gray-700 font-medium",children:[t,":"]}),(0,y.jsx)("span",{className:"font-semibold text-green-800",children:te(s)})]})},re=e=>{let{escola:a}=e;if(!(a.logradouro||a.numero||a.bairro||a.cep))return(0,y.jsx)("div",{className:"mt-2 p-2 bg-green-100 rounded-md",children:(0,y.jsx)("p",{className:"text-xs text-gray-700 leading-snug",children:te(a.endereco)})});return(0,y.jsxs)("div",{className:"mt-2 space-y-1",children:[[{field:"logradouro",label:"Logradouro"},{field:"numero",label:"N\xfamero"},{field:"complemento",label:"Complemento"},{field:"bairro",label:"Bairro"}].map((e=>{let{field:t,label:s}=e;return a[t]&&(0,y.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 rounded-md",children:[(0,y.jsx)(O.A,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-0.5",children:s}),(0,y.jsx)("div",{className:"text-xs text-gray-800 leading-snug",children:a[t]})]})]},t)})),(a.cep||a.estado)&&(0,y.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 rounded-md",children:[(0,y.jsx)(O.A,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-0.5",children:"Localiza\xe7\xe3o"}),(0,y.jsx)("div",{className:"text-xs text-gray-800 leading-snug",children:[a.municipio,a.estado,a.cep].filter(Boolean).join(", ")})]})]})]})},ne=e=>{let{escola:a}=e;if(!(a.latitude&&a.longitude))return null;return(0,y.jsxs)("button",{onClick:()=>{window.open("https://www.google.com/maps?q=".concat(a.latitude,",").concat(a.longitude),"_blank")},className:"mt-2 w-full flex items-center justify-center gap-2 p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors text-xs font-medium",children:[(0,y.jsx)(V.A,{className:"w-5 h-5"}),"Ver no Google Maps"]})},le=e=>{let{links:a,expanded:t,onToggle:s}=e;const o=(a||"").split(",").map((e=>e.trim())).filter(Boolean);return 0===o.length?null:(0,y.jsxs)("div",{className:"bg-green-100 rounded-md",children:[(0,y.jsxs)("button",{onClick:()=>s("social"),className:"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs","aria-expanded":t.social,children:[(0,y.jsxs)("span",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,y.jsx)(q.A,{className:"w-5 h-5 text-blue-600"}),"Redes sociais (",o.length,")"]}),(0,y.jsx)(H.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(t.social?"rotate-90":"")})]}),t.social&&(0,y.jsx)("div",{className:"px-2 pb-2 border-t border-green-200 bg-white",children:(0,y.jsx)("div",{className:"mt-1 space-y-1",children:o.map(((e,a)=>(0,y.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 p-1.5 bg-green-100 rounded-md hover:bg-green-200 group text-xs",children:[(0,y.jsx)(Z.A,{className:"w-5 h-5 text-blue-600"}),(0,y.jsx)("span",{className:"truncate flex-1 text-gray-700",children:e}),(0,y.jsx)(K.A,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600"})]},a)))})})]})},ie=(0,s.memo)((e=>{let{escola:a}=e;const[t,o]=(0,s.useState)({});if(!a)return null;const r=e=>{o((a=>(0,j.A)((0,j.A)({},a),{},{[e]:!a[e]})))},n=[{icon:Y.A,label:"Munic\xedpio",value:te(a.municipio)},{icon:J.A,label:"Funda\xe7\xe3o",value:a.ano_criacao},{icon:q.A,label:"Redes sociais",value:a.usa_redes_sociais,type:"boolean"}].filter((e=>e.value));return(0,y.jsxs)(y.Fragment,{children:[a.povos_indigenas&&(0,y.jsx)("div",{className:"mb-4",children:(0,y.jsxs)("div",{className:"text-lg sm:text-xl font-bold text-green-800",children:["Povos Ind\xedgenas: ",(0,y.jsx)("span",{className:"font-semibold text-black",children:a.povos_indigenas})]})}),(0,y.jsxs)(ae,{title:"Localiza\xe7\xe3o",icon:O.A,children:[(0,y.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mb-3 [&>*]:bg-green-100",children:n.map(((e,a)=>(0,y.jsx)(se,(0,j.A)({},e),a)))}),(0,y.jsxs)("div",{className:"space-y-1.5",children:[a.diretoria_ensino&&(0,y.jsx)(oe,{icon:Y.A,label:"Diretoria de ensino",value:a.diretoria_ensino}),a.endereco&&(0,y.jsxs)("div",{className:"bg-green-100 rounded-md",children:[(0,y.jsxs)("button",{onClick:()=>r("endereco"),className:"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs","aria-expanded":t.endereco,children:[(0,y.jsxs)("span",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,y.jsx)(Y.A,{className:"w-5 h-5"}),"Endere\xe7o"]}),(0,y.jsx)(H.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(t.endereco?"rotate-90":"")})]}),t.endereco&&(0,y.jsxs)("div",{className:"px-2 pb-2 border-t border-green-200 bg-white",children:[(0,y.jsx)(re,{escola:a}),(0,y.jsx)(ne,{escola:a})]})]}),(0,y.jsx)(le,{links:a.links_redes_sociais,expanded:t,onToggle:r})]})]})]})}));var ce=t(5349),de=t(237);const ue=e=>{let{escola_id:a,refreshKey:t=0}=e;const[o,r]=(0,s.useState)([]),[n,l]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(""),m=(0,s.useRef)({}),[g,x]=(0,s.useState)(0);(0,s.useEffect)((()=>{t>0&&(console.log("ImagensdasEscolas: refreshKey mudou, for\xe7ando recarga"),p())}),[t]);const h=(0,s.useCallback)((()=>{c(null),document.body.style.overflow="auto"}),[]);(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&h()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[h]);const p=(0,s.useCallback)((()=>{console.log("Limpando cache e recarregando imagens..."),m.current={},x((e=>e+1)),r([]),l(!0),u("")}),[]);return(0,s.useEffect)((()=>{if(!a)return void l(!1);const e="".concat(a,"_v").concat(g);if(m.current[e])return console.log("Usando cache para escola",a),r(m.current[e]),void l(!1);(async()=>{console.log("Buscando imagens para escola",a);try{const{data:t,error:s}=await B.N.storage.from("imagens-das-escolas").list("".concat(a,"/"));if(s)throw s;if(!t||0===t.length)return console.log("Nenhum arquivo encontrado para escola",a),r([]),void l(!1);console.log("Arquivos encontrados:",t.length);const o=await Promise.all(t.map((async(e,t)=>{var o,r,n,l,i;const c="".concat(a,"/").concat(e.name),{data:{publicUrl:d}}=B.N.storage.from("imagens-das-escolas").getPublicUrl(c);let u=null;try{console.log("Buscando legenda para:",c),u=await(0,de.qP)(c,a,"escola"),console.log("Legenda encontrada:",u)}catch(s){console.warn("Erro ao buscar legenda para",c,":",s)}return{id:"".concat(a,"-").concat(e.name),publicURL:d,descricao:(null===(o=u)||void 0===o?void 0:o.legenda)||"Imagem ".concat(t+1),descricaoDetalhada:null===(r=u)||void 0===r?void 0:r.descricao_detalhada,autor:null===(n=u)||void 0===n?void 0:n.autor_foto,dataFoto:null===(l=u)||void 0===l?void 0:l.data_foto,categoria:null===(i=u)||void 0===i?void 0:i.categoria,urlError:null}})));console.log("Imagens processadas:",o.length),m.current[e]=o,r(o),0===o.length&&u("Nenhuma imagem encontrada para esta escola.")}catch(d){console.error("Erro ao processar imagens:",d),u("Erro ao carregar imagens da escola.")}finally{l(!1)}})()}),[a,g]),n?(0,y.jsxs)("div",{className:"text-gray-500 flex items-center gap-2",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Carregando imagens da escola..."]}):d?(0,y.jsxs)("div",{className:"text-red-600 flex items-center gap-2",children:[(0,y.jsx)("span",{children:d}),(0,y.jsx)("button",{onClick:p,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:(0,y.jsx)(ce.A,{className:"w-5 h-5"})})]}):o.length?(0,y.jsxs)("section",{className:"my-6",children:[(0,y.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:o.map((e=>(0,y.jsxs)("figure",{className:"rounded-lg overflow-hidden border bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md",onClick:()=>e.publicURL&&c(e),children:[(0,y.jsx)("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:(0,y.jsx)("img",{src:e.publicURL,alt:e.descricao,className:"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105",loading:"lazy",style:{maxHeight:"350px"}})}),e.descricao&&(0,y.jsxs)("figcaption",{className:"p-3 bg-white",children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:e.descricao}),(0,y.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.categoria&&(0,y.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:e.categoria}),e.autor&&(0,y.jsxs)("span",{children:["Por: ",e.autor]}),e.dataFoto&&(0,y.jsx)("span",{children:new Date(e.dataFoto).toLocaleDateString("pt-BR")})]}),e.descricaoDetalhada&&(0,y.jsx)("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:e.descricaoDetalhada})]})]},e.id)))}),i&&(0,y.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4 cursor-zoom-out",onClick:h,children:[(0,y.jsx)("button",{onClick:h,className:"absolute top-4 right-4 text-white hover:text-red-400 transition","aria-label":"Fechar",children:(0,y.jsx)(W.A,{size:32})}),(0,y.jsxs)("div",{className:"max-w-4xl max-h-full",children:[(0,y.jsx)("img",{src:i.publicURL,alt:i.descricao,className:"max-w-full max-h-full rounded-lg shadow-2xl border-4 border-white",onClick:e=>e.stopPropagation()}),i.descricao&&(0,y.jsxs)("div",{className:"mt-4 bg-white rounded-lg p-4 shadow-lg",children:[(0,y.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:i.descricao}),(0,y.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[i.categoria&&(0,y.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:i.categoria}),i.autor&&(0,y.jsxs)("span",{children:["Fot\xf3grafo: ",i.autor]}),i.dataFoto&&(0,y.jsxs)("span",{children:["Data: ",new Date(i.dataFoto).toLocaleDateString("pt-BR")]})]}),i.descricaoDetalhada&&(0,y.jsx)("p",{className:"text-gray-700 leading-relaxed",children:i.descricaoDetalhada})]})]})]})]}):(0,y.jsxs)("div",{className:"text-yellow-700 flex items-center gap-2",children:[(0,y.jsx)("span",{children:"Nenhuma imagem encontrada para esta escola."}),(0,y.jsx)("button",{onClick:p,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:(0,y.jsx)(ce.A,{className:"w-5 h-5"})})]})},me=s.memo(ue),ge=(0,s.memo)((e=>{let{escola:a,refreshKey:t=0}=e;return null!==a&&void 0!==a&&a.historia_da_escola?(0,y.jsxs)("article",{className:"\n        mt-8 mb-12\n        max-w-4xl mx-auto\n        prose\n        prose-sm sm:prose-base md:prose-lg lg:prose-xl\n        prose-headings:text-green-900\n        prose-p:text-green-800\n        prose-p:leading-relaxed\n        prose-p:text-justify\n        prose-img:rounded-xl\n        prose-img:shadow-lg\n        prose-a:text-green-700\n        prose-a:no-underline\n        prose-a:border-b-2\n        prose-a:border-green-100\n        prose-a:transition-colors\n        hover:prose-a:border-green-600\n        bg-white\n        rounded-2xl\n        px-4 sm:px-6 md:px-8 py-6\n        shadow-lg\n      ",children:[(0,y.jsxs)("header",{className:"mb-6 sm:mb-8",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[(0,y.jsx)("span",{className:"bg-green-300 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:(0,y.jsx)("img",{src:"".concat("/escolasindigenas","/onca.svg"),alt:"\xcdcone de on\xe7a",className:"w-32 h-32 sm:w-36 sm:h-36",style:{filter:"none",borderRadius:"0",boxShadow:"none",marginTop:"80px"},"aria-hidden":"true"})}),(0,y.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-900 m-0",children:"Hist\xf3ria da Escola"})]}),(0,y.jsx)("div",{className:"h-1 w-20 sm:w-24 bg-green-300 rounded-full"})]}),(0,y.jsx)("div",{className:"text-base sm:text-lg leading-relaxed text-neutral-800",children:a.historia_da_escola}),(0,y.jsx)(me,{escola_id:a.id,refreshKey:t})]}):null}));var xe=t(8242),he=t(6735),pe=t(2065),fe=t(3531),be=t(197);const ve=(0,s.memo)((e=>{let{value:a}=e;return void 0===a||null===a?null:(0,y.jsx)("span",{className:"font-medium ".concat(a?"text-green-600":"text-neutral-400"),children:a?"Sim":"N\xe3o"})}));const we=e=>{let{items:a,maxVisible:t=3}=e;return a&&0!==a.length?(0,y.jsx)("div",{className:"-mt-1",children:(0,y.jsx)("ul",{className:"list-none text-gray-800 text-xs pl-0 ml-0",children:a.map(((e,a)=>(0,y.jsxs)("li",{className:"leading-tight m-0 p-0 pl-0 ml-0 flex items-start",children:[(0,y.jsx)("span",{className:"mr-1 text-green-700 select-none",style:{minWidth:"1em",display:"inline-block"},children:"\u2022"}),(0,y.jsx)("span",{children:e})]},a)))})}):null},je=e=>{let{icon:a,label:t,value:s}=e;return(0,y.jsxs)("div",{className:"flex items-start rounded-lg p-2 text-sm",children:[(0,y.jsx)(a,{className:"w-6 h-6 text-gray-600 mt-0.5 flex-shrink-0"}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"text-xs text-gray-500",children:t}),(0,y.jsx)("div",{className:"text-gray-800 font-medium p-0 m-0",children:s})]})]})},ye=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const t=a.turnos_funcionamento||a.turnos_funcionamento||"",s=(o=a.modalidade_ensino)&&"string"===typeof o?o.split("\u2013").map((e=>e.trim())).filter(Boolean):[];var o;xe.A;const r=[t&&{icon:he.A,label:"Turnos de Funcionamento",value:t},{icon:pe.A,label:"N\xfamero de Alunos",value:a.numero_alunos},{icon:fe.A,label:"L\xednguas Faladas",value:a.linguas_faladas}].filter(Boolean),n=[{icon:be.A,label:"Material Pedag\xf3gico N\xe3o Ind\xedgena",value:(0,y.jsx)(ve,{value:a.material_nao_indigena})},{icon:be.A,label:"Material Pedag\xf3gico Ind\xedgena",value:(0,y.jsx)(ve,{value:a.material_indigena})}];return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(ae,{title:"Modalidades",icon:xe.A,children:[(0,y.jsx)("div",{className:"mb-4 bg-green-100 rounded-lg p-2",children:(0,y.jsx)(we,{items:s,maxVisible:3})}),(0,y.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mt-1 [&>*]:bg-green-100",children:r.map(((e,a)=>(0,y.jsx)(je,{icon:e.icon,label:e.label,value:e.value},a)))})]}),(0,y.jsx)(ae,{title:"Materiais Pedag\xf3gicos",icon:be.A,description:"Diferenciados e n\xe3o diferenciados, produzidos dentro e fora da comunidade.",children:(0,y.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mt-1 [&>*]:bg-green-100",children:n.map(((e,a)=>(0,y.jsx)(je,{icon:e.icon,label:e.label,value:e.value},a)))})})]})}));var Ne=t(2499),ke=t(1184),Ae=t(6920),_e=t(1799),Ce=t(4758),Ee=t(8493),Se=t(141),ze=t(1441);const Le=e=>{let{icon:a,label:t,value:s}=e;return(0,y.jsxs)("div",{className:"flex items-start gap-2 rounded-lg p-2 text-sm",children:[(0,y.jsx)(a,{className:"w-6 h-6 text-gray-600 mt-0.5 flex-shrink-0"}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"text-gray-500",children:t}),(0,y.jsx)("div",{className:"text-gray-800 font-medium",children:s})]})]})},Ie=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const t=[{icon:Ne.A,label:"Acesso \xe0 \xc1gua",value:a.acesso_agua},{icon:ke.A,label:"Coleta de Lixo",value:a.coleta_lixo},{icon:Ae.A,label:"Acesso \xe0 Internet",value:(0,y.jsx)(ve,{value:a.acesso_internet})},{icon:_e.A,label:"Equipamentos Tecnol\xf3gicos",value:a.equipamentos},{icon:O.A,label:"Modo de Acesso \xe0 Escola",value:a.modo_acesso},{icon:Ce.A,label:"Cozinha",value:(0,y.jsx)(ve,{value:a.cozinha})},{icon:Ee.A,label:"Merenda Escolar",value:(0,y.jsx)(ve,{value:a.merenda_escolar})},{icon:Se.A,label:"Merenda Diferenciada",value:(0,y.jsx)(ve,{value:a.diferenciada})}];return(0,y.jsxs)(ae,{title:"Infraestrutura",icon:ze.A,children:[a.espaco_escolar&&(0,y.jsx)("div",{className:"p-2 text-sm text-gray-800 border-b border-gray-200 whitespace-pre-wrap",children:a.espaco_escolar}),(0,y.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mt-3 [&>*]:bg-green-100",children:t.map(((e,a)=>(0,y.jsx)(Le,{icon:e.icon,label:e.label,value:e.value},a)))})]})}));var Pe=t(1172),Fe=t(2427),Me=t(6635),De=t(9449),Re=t(4562),Te=t(3626);const Be=e=>{let{icon:a,label:t,value:s,description:o}=e;return(0,y.jsxs)("div",{className:"flex items-start gap-2 rounded-lg p-2 text-sm",children:[(0,y.jsx)(a,{className:"w-6 h-6 text-gray-600 mt-0.5 flex-shrink-0"}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"text-xs text-gray-500",children:t}),(0,y.jsx)("div",{className:"text-gray-800 font-medium mt-0.5",children:s}),o&&(0,y.jsx)("div",{className:"text-xs text-gray-600 mt-1 whitespace-pre-line",children:o})]})]})},Ue=e=>{const a=String(e).trim().toLowerCase();return"sim"===a?(0,y.jsxs)("div",{className:"flex items-center gap-1 text-green-700",children:[(0,y.jsx)(G.A,{className:"w-5 h-5"}),"Sim"]}):"n\xe3o"===a||"nao"===a?(0,y.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,y.jsx)(W.A,{className:"w-5 h-5"}),"N\xe3o"]}):e},Ge=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const t=(e=>{if(!e)return null;const[a,...t]=e.split("/"),s=t.join("/").trim();return{status:"sim"===a.trim().toLowerCase()?"Sim":a.trim(),descricao:s||null}})(a.formacao_professores),s=(e=>{if(!e)return null;const[a,...t]=e.split("/"),s=t.join("/").trim();return{status:"sim"===a.trim().toLowerCase()?"Sim":a.trim(),descricao:s||null}})(a.formacao_continuada);return(0,y.jsxs)(ae,{title:"Gestores",icon:Pe.A,children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mt-1 [&>*]:bg-green-100",children:[(0,y.jsx)(Be,{icon:Fe.A,label:"Professores Ind\xedgenas",value:a.professores_indigenas}),(0,y.jsx)(Be,{icon:Me.A,label:"Professores N\xe3o Ind\xedgenas",value:a.professores_nao_indigenas}),(0,y.jsx)(Be,{icon:fe.A,label:"Professores que falam l\xedngua ind\xedgena",value:Ue(a.professores_falam_lingua)}),(null===t||void 0===t?void 0:t.status)&&(0,y.jsx)(Be,{icon:De.A,label:"Forma\xe7\xe3o dos Professores",value:Ue(t.status),description:t.descricao})]}),(0,y.jsxs)("div",{className:"space-y-2 mt-4 [&>*]:bg-green-100",children:[(0,y.jsx)(Be,{icon:Re.A,label:"Gest\xe3o/Nome",value:a.gestao}),(0,y.jsx)(Be,{icon:Pe.A,label:"Outros Funcion\xe1rios",value:a.outros_funcionarios}),(null===s||void 0===s?void 0:s.status)&&(0,y.jsx)(Be,{icon:Te.A,label:"Visitas de Supervisores e Forma\xe7\xe3o Continuada",value:Ue(s.status),description:s.descricao})]})]})}));var We=t(6192),Oe=t(4621),Ve=t(1204);const qe=e=>{let{icon:a,label:t,value:s}=e;const o="n\xe3o"===(null===s||void 0===s?void 0:s.trim().toLowerCase());return(0,y.jsxs)("div",{className:"flex items-start gap-4 rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,y.jsx)("div",{className:"mt-1",children:(0,y.jsx)(a,{className:"w-5 h-5 text-green-600 flex-shrink-0"})}),(0,y.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,y.jsx)("div",{className:"text-sm font-semibold text-gray-800",children:t}),o?(0,y.jsxs)("div",{className:"text-sm text-gray-400 flex items-center gap-1",children:[(0,y.jsx)(W.A,{className:"w-5 h-5 text-gray-400"}),"N\xe3o"]}):(0,y.jsx)("div",{className:"text-sm text-gray-700 leading-relaxed",children:s})]})]})},He=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const t=[{field:"projetos_andamento",icon:be.A,label:"Projetos em andamento"},{field:"parcerias_universidades",icon:We.A,label:"Parcerias com universidades"},{field:"acoes_ongs",icon:pe.A,label:"A\xe7\xf5es com ONGs ou coletivos"},{field:"desejos_comunidade",icon:Oe.A,label:"Desejos da comunidade para a escola"},{field:"parcerias_municipio",icon:Ve.A,label:"Parcerias com o munic\xedpio"}].filter((e=>a[e.field]&&a[e.field].trim()));return 0===t.length?null:(0,y.jsx)(ae,{title:"Projetos e Parcerias",icon:Ve.A,children:(0,y.jsx)("div",{className:"grid grid-cols-1 gap-3 [&>*]:bg-green-100",children:t.map((e=>(0,y.jsx)(qe,{icon:e.icon,label:e.label,value:a[e.field]},e.field)))})})})),Ze=e=>{let{escola_id:a,refreshKey:t=0}=e;const[o,r]=(0,s.useState)([]),[n,l]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),m=(0,s.useCallback)((()=>u(null)),[]);return(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&m()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[m]),(0,s.useEffect)((()=>{t>0&&(console.log("ImagemHistoriadoProfessor: refreshKey mudou, for\xe7ando recarga"),r([]),l(!0),c(null))}),[t]),(0,s.useEffect)((()=>{a&&(l(!0),c(null),B.N.storage.from("imagens-professores").list("".concat(a,"/")).then((async e=>{let{data:t,error:s}=e;if(s)return c(s.message),void l(!1);if(t&&t.length>0){console.log("Arquivos de professores encontrados:",t.length);const e=await Promise.all(t.map((async(e,t)=>{var o,r,n,l,i;const{data:{publicUrl:c}}=B.N.storage.from("imagens-professores").getPublicUrl("".concat(a,"/").concat(e.name));let d="professor";e.name.startsWith("professora_")?d="professora":e.name.startsWith("professor_")&&(d="professor");let u=null;try{const t="".concat(a,"/").concat(e.name);console.log("Buscando legenda para professor:",t),u=await(0,de.qP)(t,a,"professor"),console.log("Legenda encontrada para professor:",u)}catch(s){console.warn("Erro ao buscar legenda:",s)}return{id:t+1,publicURL:c,genero:d,nome:e.name,created_at:e.created_at||"",legenda:(null===(o=u)||void 0===o?void 0:o.legenda)||"Imagem do ".concat(d),descricaoDetalhada:null===(r=u)||void 0===r?void 0:r.descricao_detalhada,autor:null===(n=u)||void 0===n?void 0:n.autor_foto,dataFoto:null===(l=u)||void 0===l?void 0:l.data_foto,categoria:null===(i=u)||void 0===i?void 0:i.categoria}})));r(e)}else r([]);l(!1)})).catch((e=>{c("Erro inesperado: ".concat(e.message)),l(!1)})))}),[a]),n?(0,y.jsx)("div",{className:"text-gray-500",children:"Carregando imagens do professor..."}):i?(0,y.jsxs)("div",{className:"text-red-600",children:["Erro ao carregar imagens: ",i]}):o.length?(0,y.jsxs)("section",{className:"my-6",children:[(0,y.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:o.map((e=>(0,y.jsxs)("figure",{className:"rounded-lg overflow-hidden border bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md",onClick:()=>e.publicURL&&u(e),children:[(0,y.jsx)("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:(0,y.jsx)("img",{src:e.publicURL,alt:e.legenda,className:"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105",loading:"lazy",style:{maxHeight:"350px"}})}),e.legenda&&(0,y.jsxs)("figcaption",{className:"p-3 bg-white",children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:e.legenda}),(0,y.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.categoria&&(0,y.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:e.categoria}),e.autor&&(0,y.jsxs)("span",{children:["Por: ",e.autor]}),e.dataFoto&&(0,y.jsx)("span",{children:new Date(e.dataFoto).toLocaleDateString("pt-BR")})]}),e.descricaoDetalhada&&(0,y.jsx)("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:e.descricaoDetalhada})]})]},e.id)))}),d&&(0,y.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4 cursor-zoom-out",onClick:m,children:[(0,y.jsx)("button",{onClick:m,className:"absolute top-4 right-4 text-white hover:text-red-400 transition","aria-label":"Fechar",children:(0,y.jsx)(W.A,{size:32})}),(0,y.jsxs)("div",{className:"max-w-4xl max-h-full",children:[(0,y.jsx)("img",{src:d.publicURL,alt:d.legenda,className:"max-w-full max-h-full rounded-lg shadow-2xl border-4 border-white",onClick:e=>e.stopPropagation()}),d.legenda&&(0,y.jsxs)("div",{className:"mt-4 bg-white rounded-lg p-4 shadow-lg",children:[(0,y.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:d.legenda}),(0,y.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[d.categoria&&(0,y.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:d.categoria}),d.autor&&(0,y.jsxs)("span",{children:["Fot\xf3grafo: ",d.autor]}),d.dataFoto&&(0,y.jsxs)("span",{children:["Data: ",new Date(d.dataFoto).toLocaleDateString("pt-BR")]})]}),d.descricaoDetalhada&&(0,y.jsx)("p",{className:"text-gray-700 leading-relaxed",children:d.descricaoDetalhada})]})]})]})]}):null},Ke=s.memo(Ze);var Ye=t(8438),Je=t(2006);const Xe=(0,s.memo)((e=>{let{escola:a,refreshKey:t=0}=e;const[o,r]=(0,s.useState)([]),[n,l]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(0),[m,g]=(0,s.useState)(null),x=(0,s.useCallback)((()=>g(null)),[]);(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&x()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[x]),(0,s.useEffect)((()=>{if(null===a||void 0===a||!a.id)return void l(!1);(async()=>{try{l(!0),c(null);const e=await(0,Je.Y8)(a.id);r(e||[]),u(0)}catch(e){c(e.message)}finally{l(!1)}})()}),[null===a||void 0===a?void 0:a.id,t]);const h=(0,s.useCallback)((()=>{u((e=>e<o.length-1?e+1:0))}),[o.length]),p=(0,s.useCallback)((()=>{u((e=>e>0?e-1:o.length-1))}),[o.length]);if((0,s.useEffect)((()=>{const e=e=>{o.length<=1||("ArrowRight"===e.key?h():"ArrowLeft"===e.key&&p())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[o.length,h,p]),n)return(0,y.jsx)("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-green-100/50",children:(0,y.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,y.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando hist\xf3rias do professor..."})]})});if(i)return(0,y.jsx)("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-red-100/50",children:(0,y.jsx)("div",{className:"text-center py-8",children:(0,y.jsxs)("p",{className:"text-red-600",children:["Erro ao carregar hist\xf3rias do professor: ",i]})})});if(!o.length)return null;const f=o[d],b=o.length>1;return(0,y.jsxs)("article",{className:" mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg prose prose-sm sm:prose-base md:prose-lg lg:prose-xl prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify prose-img:rounded-xl prose-img:shadow-lg prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600 ",children:[(0,y.jsxs)("header",{className:"mb-6 sm:mb-8",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("span",{className:"bg-green-300 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:(0,y.jsx)("img",{src:"".concat("/escolasindigenas","/passaro.svg"),alt:"\xcdcone de p\xe1ssaro",className:"w-12 h-12 sm:w-24 sm:h-24",style:{filter:"none",borderRadius:"0",boxShadow:"none",margin:"0",padding:"0",border:"none",outline:"none"},"aria-hidden":"true"})}),(0,y.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-black m-0",children:"Hist\xf3ria dos Professores"})]}),b&&(0,y.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:(0,y.jsxs)("span",{children:[d+1," de ",o.length]})})]}),(0,y.jsx)("div",{className:"h-1 w-20 sm:w-24 bg-green-300 rounded-full"})]}),(0,y.jsxs)("section",{className:"text-base sm:text-lg leading-relaxed text-neutral-800",children:[f.nome_professor&&(0,y.jsx)("h3",{className:"text-lg sm:text-xl font-semibold text-green-800 mb-4",children:f.nome_professor}),(0,y.jsx)("div",{children:f.historia}),f.imagem_public_url&&(0,y.jsx)("figure",{className:"my-6",children:(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)("img",{src:f.imagem_public_url,alt:f.descricao_imagem||"Imagem da hist\xf3ria do professor",className:"w-full max-w-2xl mx-auto rounded-xl shadow-lg cursor-pointer transition-transform duration-200 hover:scale-105",onClick:()=>g(f),loading:"lazy"}),f.descricao_imagem&&(0,y.jsx)("figcaption",{className:"text-center text-sm text-gray-600 mt-2",children:f.descricao_imagem})]})})]}),b&&(0,y.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200",children:[(0,y.jsxs)("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Hist\xf3ria anterior",children:[(0,y.jsx)(Ye.A,{className:"w-5 h-5"}),(0,y.jsx)("span",{className:"hidden sm:inline",children:"Anterior"})]}),(0,y.jsx)("div",{className:"flex gap-2",children:o.map(((e,a)=>(0,y.jsx)("button",{onClick:()=>u(a),className:"w-3 h-3 rounded-full border-2 ".concat(a===d?"bg-green-600 border-green-600":"bg-white border-gray-300"," transition-colors"),"aria-label":"Ir para hist\xf3ria ".concat(a+1)},a)))}),(0,y.jsxs)("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Pr\xf3xima hist\xf3ria",children:[(0,y.jsx)("span",{className:"hidden sm:inline",children:"Pr\xf3xima"}),(0,y.jsx)(H.A,{className:"w-5 h-5"})]})]}),m&&(0,y.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",onClick:x,children:(0,y.jsxs)("div",{className:"relative max-w-3xl w-full p-4",onClick:e=>e.stopPropagation(),children:[(0,y.jsx)("button",{className:"absolute top-2 right-2 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-80",onClick:x,"aria-label":"Fechar zoom",children:(0,y.jsx)(W.A,{className:"w-6 h-6"})}),(0,y.jsx)("img",{src:m.imagem_public_url,alt:m.descricao_imagem||"Imagem da hist\xf3ria do professor",className:"w-full max-h-[80vh] object-contain rounded-xl shadow-2xl"}),m.descricao_imagem&&(0,y.jsx)("figcaption",{className:"text-center text-base text-gray-200 mt-4",children:m.descricao_imagem})]})}),(0,y.jsx)(Ke,{escola_id:a.id,refreshKey:t})]})})),$e=(0,s.memo)((e=>{let{children:a,shouldUseGrid:t}=e;const s=t?"masonry-grid":"space-y-4";return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("style",{children:"\n  .masonry-grid {\n    column-count: 1;\n    column-gap: 1.5rem;\n    column-fill: balance;\n  }\n  \n  .masonry-grid > * {\n    display: block;\n    break-inside: avoid;\n    page-break-inside: avoid;\n    margin-bottom: 1.5rem;\n  }\n  \n  /* Mobile: 1 coluna */\n  @media (max-width: 767px) {\n    .masonry-grid {\n      column-count: 1;\n    }\n  }\n  \n  /* Tablet e Desktop: 2 colunas */\n  @media (min-width: 768px) {\n    .masonry-grid {\n      column-count: 2;\n    }\n  }\n"}),(0,y.jsx)("div",{className:"".concat(s," transition-all duration-300 ease-in-out"),children:a})]})})),Qe=(0,s.memo)((e=>{let{escola:a,shouldUseGrid:t=!1,refreshKey:s=0}=e;if(console.log("EscolaInfo recebeu:",a),!a)return console.log("EscolaInfo: escola \xe9 null ou undefined"),null;const o=[{Component:ie,props:{escola:a}},{Component:ye,props:{escola:a}},{Component:Ie,props:{escola:a}},{Component:Ge,props:{escola:a}},{Component:He,props:{escola:a}}];return(0,y.jsxs)("div",{className:"space-y-8",children:[(0,y.jsx)($e,{shouldUseGrid:t,children:o.map(((e,a)=>{let{Component:t,props:s}=e;return(0,y.jsx)(t,(0,j.A)({},s),a)}))}),(0,y.jsx)(ge,{escola:a,refreshKey:s}),(0,y.jsx)(Xe,{escola:a,refreshKey:s})]})}));var ea=t(3986);const aa=["className"],ta=e=>{let{className:a="w-5 h-5"}=e,t=(0,ea.A)(e,aa);return(0,y.jsx)("svg",(0,j.A)((0,j.A)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",fill:"currentColor",className:a},t),{},{children:(0,y.jsx)("path",{d:"M200,80H184V64a32,32,0,0,0-56-21.13A32,32,0,0,0,72.21,60.42,32,32,0,0,0,24,88v40a104,104,0,0,0,208,0V112A32,32,0,0,0,200,80ZM152,48a16,16,0,0,1,16,16V80H136V64A16,16,0,0,1,152,48ZM88,64a16,16,0,0,1,32,0v40a16,16,0,0,1-32,0ZM40,88a16,16,0,0,1,32,0v16a16,16,0,0,1-32,0Zm176,40a88,88,0,0,1-175.92,3.75A31.93,31.93,0,0,0,80,125.13a31.93,31.93,0,0,0,44.58,3.35,32.21,32.21,0,0,0,11.8,11.44A47.88,47.88,0,0,0,120,176a8,8,0,0,0,16,0,32,32,0,0,1,32-32,8,8,0,0,0,0-16H152a16,16,0,0,1-16-16V96h64a16,16,0,0,1,16,16Z"})}))},sa=(0,s.memo)((e=>{let{label:a,value:t,className:s="",isTextArea:o=!1}=e;if(!t)return null;const r=s.includes("flex flex-col")?"flex flex-col gap-1 text-sm py-0.5":"grid grid-cols-[auto,1fr] gap-x-2 text-sm py-0.5";return(0,y.jsxs)("div",{className:"".concat(r," ").concat(s),children:[(0,y.jsxs)("span",{className:"font-medium text-neutral-800",children:[a,":"]}),o?(0,y.jsx)("div",{className:"text-neutral-600",children:(0,y.jsx)("div",{className:"whitespace-pre-wrap break-words text-sm leading-relaxed",children:t})}):(0,y.jsx)("span",{className:"text-neutral-600 break-words",children:t})]})})),oa=e=>(0,y.jsx)(ta,(0,j.A)({className:"w-8 h-8"},e)),ra=(0,s.memo)((e=>{let{terraIndigena:a}=e;if(!a)return console.log("TerraIndigenaInfo: terraIndigena \xe9 null ou undefined"),null;return(0,y.jsxs)(ae,{title:"Informa\xe7\xf5es da Terra Ind\xedgena",icon:oa,children:[(0,y.jsx)(sa,{label:"Povos Ind\xedgenas",value:a.etnia}),(0,y.jsx)(sa,{label:"Localiza\xe7\xe3o",value:"".concat(a.municipio||"",", ").concat(a.uf||"").trim()}),(0,y.jsx)(sa,{label:"Superf\xedcie",value:a.superficie?"Superf\xedcie: ".concat(parseFloat(a.superficie).toFixed(2)," ha"):null}),(0,y.jsx)(sa,{label:"Fase",value:a.fase}),(0,y.jsx)(sa,{label:"Modalidade",value:a.modalidade}),(0,y.jsx)(sa,{label:"Reestudo",value:a.reestudo}),(0,y.jsx)(sa,{label:"Coordena\xe7\xe3o Regional",value:a.cr}),(0,y.jsx)(sa,{label:"Faixa de Fronteira",value:a.faixa_fron}),(0,y.jsx)(sa,{label:"Unidade Administrativa",value:a.undadm_nom}),(0,y.jsx)(sa,{label:"Sigla Unidade",value:a.undadm_sig}),(0,y.jsx)(sa,{label:"Dom\xednio",value:a.dominio_un}),(0,y.jsx)(sa,{label:"Data de Atualiza\xe7\xe3o",value:a.data_atual}),(0,y.jsx)(sa,{label:"C\xf3digo Terra Ind\xedgena",value:a.terrai_cod}),(0,y.jsx)(sa,{label:"C\xf3digo Unidade Administrativa",value:a.undadm_cod})]})}));var na=t(519);const la=e=>{let{children:a,text:t,position:o="top"}=e;const[r,n]=(0,s.useState)(!1);return(0,y.jsxs)("div",{className:"relative inline-block",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onFocus:()=>n(!0),onBlur:()=>n(!1),children:[a,r&&(0,y.jsxs)("div",{className:"\n          absolute z-50 px-2 py-1 text-xs text-white bg-gray-900 rounded shadow-lg whitespace-nowrap\n          ".concat({top:"bottom-full left-1/2 transform -translate-x-1/2 mb-2",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-2"}[o],"\n        "),children:[t,(0,y.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},ia=e=>{let{onClick:a,url:t,title:o,description:r=""}=e;const[n,l]=(0,s.useState)(!1),i=["Conhe\xe7a a escola ind\xedgena: ".concat(o),"Descubra esta escola ind\xedgena: ".concat(o),"Escola ind\xedgena incr\xedvel: ".concat(o),"Educa\xe7\xe3o ind\xedgena em destaque: ".concat(o),"Conhe\xe7a esta escola: ".concat(o),"Escola ind\xedgena que inspira: ".concat(o),"Educa\xe7\xe3o que transforma: ".concat(o),"Escola ind\xedgena de refer\xeancia: ".concat(o)],c=i[Math.floor(Math.random()*i.length)],d=t||window.location.href;return(0,y.jsx)("div",{className:"px-2 pb-2 border-t border-green-200 bg-white",children:(0,y.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,y.jsx)(la,{text:n?"Link copiado!":"Copiar link para clipboard",children:(0,y.jsxs)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(t),l(!0),setTimeout((()=>l(!1)),2e3)}catch(e){const a=document.createElement("input");a.value=t,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),l(!0),setTimeout((()=>l(!1)),2e3)}},className:"\n              w-full flex items-start gap-2 p-1.5 rounded-md transition-colors\n              focus:outline-none focus:ring-1 focus:ring-green-500\n              ".concat(n?"bg-green-100":"bg-green-100 hover:bg-green-200","\n            "),"aria-label":"Copiar link para clipboard",children:[(0,y.jsx)("svg",{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,y.jsx)("div",{className:"flex-1",children:(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700",children:n?"Link Copiado":"Copiar Link"})})]})}),(0,y.jsx)(la,{text:"Compartilhar no WhatsApp",children:(0,y.jsx)(na.Kz,{url:d,title:c,className:"w-full transition-colors focus:outline-none focus:ring-1 focus:ring-green-500 rounded-md","aria-label":"Compartilhar no WhatsApp",children:(0,y.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 hover:bg-green-200 rounded-md",children:[(0,y.jsx)(na.Y4,{size:20,round:!1,className:"mt-0.5 flex-shrink-0"}),(0,y.jsx)("div",{className:"flex-1",children:(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700",children:"WhatsApp"})})]})})}),(0,y.jsx)(la,{text:"Compartilhar no Facebook",children:(0,y.jsx)(na.uI,{url:d,quote:c,className:"w-full transition-colors focus:outline-none focus:ring-1 focus:ring-green-500 rounded-md","aria-label":"Compartilhar no Facebook",children:(0,y.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 hover:bg-green-200 rounded-md",children:[(0,y.jsx)(na.ik,{size:20,round:!1,className:"mt-0.5 flex-shrink-0"}),(0,y.jsx)("div",{className:"flex-1",children:(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700",children:"Facebook"})})]})})}),(0,y.jsx)(la,{text:"Compartilhar no Twitter",children:(0,y.jsx)(na.r6,{url:d,title:c,className:"w-full transition-colors focus:outline-none focus:ring-1 focus:ring-green-500 rounded-md","aria-label":"Compartilhar no Twitter",children:(0,y.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 hover:bg-green-200 rounded-md",children:[(0,y.jsx)(na.Fi,{size:20,round:!1,className:"mt-0.5 flex-shrink-0"}),(0,y.jsx)("div",{className:"flex-1",children:(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700",children:"Twitter"})})]})})}),(0,y.jsx)(la,{text:"Compartilhar no LinkedIn",children:(0,y.jsx)(na.wk,{url:d,title:o,summary:r,className:"w-full transition-colors focus:outline-none focus:ring-1 focus:ring-green-500 rounded-md","aria-label":"Compartilhar no LinkedIn",children:(0,y.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 hover:bg-green-200 rounded-md",children:[(0,y.jsx)(na._z,{size:20,round:!1,className:"mt-0.5 flex-shrink-0"}),(0,y.jsx)("div",{className:"flex-1",children:(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700",children:"LinkedIn"})})]})})}),navigator.share&&(0,y.jsx)(la,{text:"Compartilhar usando op\xe7\xf5es do sistema",children:(0,y.jsxs)("button",{onClick:a,className:"w-full flex items-start gap-2 p-1.5 bg-green-100 hover:bg-green-200 rounded-md transition-colors focus:outline-none focus:ring-1 focus:ring-green-500","aria-label":"Compartilhar usando op\xe7\xf5es do sistema",children:[(0,y.jsx)("svg",{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),(0,y.jsx)("div",{className:"flex-1",children:(0,y.jsx)("div",{className:"text-xs font-medium text-gray-700",children:"Compartilhar"})})]})})]})})},ca=s.memo(ia),da=(0,s.memo)((e=>{let{copiarLink:a,compartilhar:t,painelInfo:s}=e;return(0,y.jsx)(ca,{onClick:t,url:(()=>{if(null===s||void 0===s||!s.titulo)return window.location.href;return window.location.origin+window.location.pathname+"?panel="+s.titulo.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()})(),title:(null===s||void 0===s?void 0:s.titulo)||"Painel de Escola Ind\xedgena",description:(null===s||void 0===s?void 0:s.descricao)||"Confira informa\xe7\xf5es sobre esta escola ind\xedgena no Observat\xf3rio de Professores Ind\xedgenas."})}));var ua=t(7977);const ma=e=>{let{descricao:a,className:t=""}=e;const o=(0,s.useMemo)((()=>a?ua.A.sanitize((e=>{if(!e)return"";let a=e.replace(/\n\n+/g,"</p><p>");return a=a.replace(/\n/g,"<br>"),a.startsWith("<p>")||(a="<p>"+a),a.endsWith("</p>")||(a+="</p>"),a=a.replace(/>\s+</g,"><"),a})(a),{ALLOWED_TAGS:["b","i","em","strong","a","p","br","ul","ol","li","div","span","img","h1","h2","h3","h4","h5","h6","center","blockquote","code","pre","hr","table","thead","tbody","tr","th","td"],ALLOWED_ATTR:["href","target","rel","class","style","src","alt","width","height","id","title","aria-label","aria-describedby"],ADD_TAGS:["center","blockquote"],ADD_ATTR:["target","className","title"],KEEP_CONTENT:!0,ALLOW_DATA_ATTR:!1}):""),[a]);return a?(0,y.jsx)("div",{className:"mb-6 ".concat(t),children:(0,y.jsx)("div",{className:"prose prose-lg lg:prose-xl max-w-none px-1",style:{"--tw-prose-body":"#1f2937","--tw-prose-headings":"#111827","--tw-prose-links":"#059669","--tw-prose-bold":"#111827","--tw-prose-counters":"#1f2937","--tw-prose-bullets":"#4b5563","--tw-prose-hr":"#e5e7eb","--tw-prose-quotes":"#111827","--tw-prose-quote-borders":"#10b981","--tw-prose-captions":"#6b7280","--tw-prose-code":"#111827","--tw-prose-pre-code":"#e5e7eb","--tw-prose-pre-bg":"#1f2937","--tw-prose-th-borders":"#d1d5db","--tw-prose-td-borders":"#e5e7eb",lineHeight:"1.8",fontSize:"1.125rem",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',letterSpacing:"0.015em"},dangerouslySetInnerHTML:{__html:o},"aria-live":"polite"})}):null},ga=s.memo(ma),xa=(0,s.memo)((e=>{let{painelInfo:a}=e;return(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsx)("div",{className:"prose prose-lg lg:prose-xl max-w-none",children:(0,y.jsx)("div",{className:"bg-green-100 rounded-lg p-6",children:(0,y.jsx)(ga,{descricao:a.descricao_detalhada})})}),a.audioUrl&&(0,y.jsx)("div",{className:"mt-6",children:(0,y.jsxs)("audio",{controls:!0,className:"w-full",children:[(0,y.jsx)("source",{src:a.audioUrl,type:"audio/mpeg"}),"Seu navegador n\xe3o suporta o elemento de \xe1udio."]})})]})}));var ha=t(2922),pa=t(4224),fa=t(4128);const ba=e=>{let{titulo:a,closePainel:t,toggleMaximize:s,isMaximized:o}=e;const r=window.innerWidth<=768,n=r&&window.innerWidth>window.innerHeight,l=n&&window.innerWidth<=850;return(0,y.jsxs)("header",{className:"relative px-3 sm:px-4 md:px-6 lg:px-8 py-3 sm:py-4 md:py-6 border-b border-green-100 ".concat(n?"min-h-[60px]":""),children:[(0,y.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between pr-12",children:(0,y.jsx)("h2",{id:"painel-titulo",className:"font-semibold text-gray-900 leading-tight tracking-normal break-words ".concat(l?"text-base":n?"text-lg sm:text-xl":"text-xl sm:text-2xl md:text-3xl"),style:l?{fontSize:"clamp(1rem, 4vw, 1.25rem)"}:{},children:(0,fa.k)(a)})}),(0,y.jsxs)("div",{className:"absolute top-2 sm:top-4 right-2 sm:right-4 flex items-center gap-2",children:[!r&&(0,y.jsx)("button",{onClick:s,className:"p-2 text-green-700 hover:text-green-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":o?"Restaurar painel":"Maximizar painel",title:o?"Restaurar":"Maximizar",children:o?(0,y.jsx)(ha.A,{size:18,className:"stroke-2","aria-hidden":"true"}):(0,y.jsx)(pa.A,{size:18,className:"stroke-2","aria-hidden":"true"})}),(0,y.jsx)("button",{onClick:t,className:"text-gray-700 hover:text-gray-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ".concat(n?"p-1.5":"p-2"),"aria-label":"Fechar painel",children:(0,y.jsx)(W.A,{size:n?18:20,"aria-hidden":"true",className:"stroke-2"})})]})]})},va=e=>{const[a,t]=(0,s.useState)(!1),[o,r]=(0,s.useState)(window.innerWidth<=768);return console.log("usePainelVisibility - painelInfo:",e),(0,s.useEffect)((()=>{const e=()=>{const e=window.innerWidth<=768,a=window.innerWidth>window.innerHeight&&window.innerWidth<=1024;r(e||a)};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}),[]),(0,s.useEffect)((()=>(console.group("usePainelVisibility - Effect"),console.log("painelInfo recebido:",e),e&&"object"===typeof e?(console.log("painelInfo v\xe1lido, definindo visibilidade como true"),t(!0),document.body.style.overflow="hidden"):(console.log("painelInfo inv\xe1lido ou undefined, definindo visibilidade como false"),t(!1),document.body.style.overflow=""),console.log("Estado atual:",{isVisible:a,isMobile:o}),console.groupEnd(),()=>{document.body.style.overflow=""})),[e]),console.log("usePainelVisibility - returning state:",{isVisible:a,isMobile:o}),{isVisible:a,isMobile:o}},wa=e=>{let{painelInfo:a,closePainel:t,children:o,isMaximized:r,onToggleMaximize:n}=e;const{isVisible:l,isMobile:i}=va(a),c=((e,a)=>{const[t,o]=(0,s.useState)(window.innerWidth),[r,n]=(0,s.useState)(window.innerHeight),l={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};return(0,s.useEffect)((()=>{const e=()=>{o(window.innerWidth),n(window.innerHeight)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,s.useMemo)((()=>{const s=e&&t>r,o="calc(100vh - ".concat(s?48:e?56:72,"px)"),n=t>=l.md;let i;return i=e||a?"100%":t>=l.lg?"49%":"75%",{height:o,maxHeight:e?"96vh":"92vh",width:i,isDesktop:n,isMobileLandscape:s,shouldUseGrid:n&&a,breakpoints:l,zIndex:1e3}}),[e,a,t,r])})(i,r);if(!a)return null;const d=i&&window.innerWidth>window.innerHeight?48:i?56:72,u="\n    fixed\n    ".concat(i?"inset-x-0 top-0 w-full h-full":"top-30 bottom-0 right-0 w-full sm:w-3/4 lg:w-[49%] h-auto","\n    rounded-t-xl shadow-xl z-[9999] transform transition-all duration-500 ease-in-out\n    bg-white border-t-4 border-white\n  "),m=l?"translate-y-0 opacity-100":"translate-y-full opacity-0";return(0,y.jsxs)("div",{role:"dialog","aria-labelledby":"painel-titulo","aria-describedby":"painel-descricao","aria-modal":"true",className:"".concat(u," ").concat(m).concat(i?" painel-informacoes-mobile":""),style:(0,j.A)({height:c.height,maxHeight:c.maxHeight,width:i?"100%":c.width,top:i?"".concat(d,"px"):72,display:"flex",flexDirection:"column"},i&&{borderRadius:c.isMobileLandscape?"0":"1rem 1rem 0 0",boxShadow:c.isMobileLandscape?"0 0 0 0":"0 -4px 6px -1px rgba(0, 0, 0, 0.1), 0 -2px 4px -1px rgba(0, 0, 0, 0.06)"}),children:[(0,y.jsx)(ba,{titulo:a.titulo,closePainel:t,toggleMaximize:n,isMaximized:r}),(0,y.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-green-600/40 scrollbar-track-green-50/20",children:(0,y.jsx)("div",{className:"".concat(i?"p-3 sm:p-4":"p-6"," space-y-6 sm:space-y-8"),children:(0,y.jsx)("div",{className:"prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none",children:o})})})]})},ja=s.memo(wa);var ya=t(4581);const Na=e=>{let{videoUrl:a,title:t="V\xeddeo",escolaId:o}=e;const[r,n]=(0,s.useState)(null),[l,i]=(0,s.useState)(!1);if((0,s.useEffect)((()=>{(async()=>{if(a&&o)try{i(!0);const e=await(0,de.jW)(a,o);n(e)}catch(e){console.warn("Erro ao buscar t\xedtulo personalizado:",e)}finally{i(!1)}})()}),[a,o]),!a)return null;const c=(e=>{if(!e||"string"!==typeof e)return null;const a=e.split("?")[0],t=[/youtube\.com\/embed\/([^/?&]+)/,/youtube\.com\/watch\?v=([^&]+)/,/youtu\.be\/([^?&]+)/,/youtube\.com\/v\/([^?&]+)/];for(const s of t){const e=a.match(s);if(e&&e[1])return e[1]}return null})(a);return c?(0,y.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,y.jsxs)("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[(null===r||void 0===r?void 0:r.titulo)||t,":"]}),r&&(0,y.jsxs)("div",{className:"mb-4 p-4 bg-green-100 rounded-lg",children:[r.descricao&&(0,y.jsx)("p",{className:"text-gray-700 mb-2",children:r.descricao}),(0,y.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[r.categoria&&(0,y.jsx)("span",{className:"capitalize bg-green-200 text-green-800 px-2 py-1 rounded",children:r.categoria}),r.plataforma&&(0,y.jsx)("span",{className:"capitalize",children:r.plataforma}),r.duracao&&(0,y.jsxs)("span",{children:["Dura\xe7\xe3o: ",r.duracao]})]})]}),(0,y.jsx)("div",{className:"rounded-lg overflow-hidden shadow-lg bg-white",children:(0,y.jsx)("div",{className:"relative pb-[56.25%] h-0",children:(0,y.jsx)("iframe",{className:"absolute top-0 left-0 w-full h-full",src:"https://www.youtube.com/embed/".concat(c),title:(null===r||void 0===r?void 0:r.titulo)||t,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy",referrerPolicy:"origin"})})}),(0,y.jsx)("div",{className:"mt-4 text-center",children:(0,y.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-green-700 hover:text-green-800 hover:underline",children:[(0,y.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Ver v\xeddeo no YouTube"]})})]}):(0,y.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,y.jsxs)("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[(null===r||void 0===r?void 0:r.titulo)||t,":"]}),(0,y.jsxs)("div",{className:"p-6 text-center text-gray-600 bg-gray-50 rounded-lg",children:[(0,y.jsx)("p",{className:"mb-3 text-lg",children:"Link do v\xeddeo inv\xe1lido ou n\xe3o suportado."}),(0,y.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[(0,y.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Tentar abrir no YouTube"]})]})]})},ka=s.memo(Na),Aa=e=>{let{painelInfo:a,closePainel:t,escola_id:o,refreshKey:r=0}=e;const n=(0,s.useRef)(null),[l,i]=(0,s.useState)(!1),{gerarLinkCustomizado:c,copiarLink:d,compartilhar:u}=(e=>{const a=()=>window.location.origin+window.location.pathname+"?panel="+T(e.titulo);return{gerarLinkCustomizado:a,copiarLink:async()=>{const e=a();try{await navigator.clipboard.writeText(e),alert("Link copiado!")}catch(t){const a=document.createElement("input");a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),alert("Link copiado!")}},compartilhar:()=>{const t=a(),s="Confira este painel: ".concat(e.titulo);navigator.share?navigator.share({title:e.titulo,text:s,url:t}):window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(s),"&url=").concat(encodeURIComponent(t)),"_blank")}}})(a),{documentos:m}=U(null===a||void 0===a?void 0:a.id);var g,x;if(((e,a)=>{const t=(0,s.useRef)(null),o=(0,s.useRef)(null);(0,s.useEffect)((()=>{if(e)return o.current&&clearTimeout(o.current),o.current=setTimeout((()=>{const e=a();if(e!==t.current)try{window.history.replaceState({},"",e),t.current=e}catch(s){console.warn("Erro ao atualizar URL:",s)}}),300),()=>{o.current&&clearTimeout(o.current)}}),[e,a])})(a,c),g=n,x=t,(0,s.useEffect)((()=>{const e=e=>{let a=e.target,t=!1;for(;a;){var s,o,r,n;if(a.classList&&a.classList.contains("leaflet-container")){t=!0;break}if(a.classList&&a.classList.contains("ol-marker")||"true"===(null===(s=(o=a).getAttribute)||void 0===s?void 0:s.call(o,"data-marker"))||"true"===(null===(r=(n=a).getAttribute)||void 0===r?void 0:r.call(n,"data-map-marker")))return;a=a.parentElement}t&&g.current&&!g.current.contains(e.target)&&x()};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[g,x]),(0,s.useEffect)((()=>{console.log("PainelInformacoes: refreshKey mudou para",r)}),[r]),!a)return null;const h="terra_indigena"===a.tipo,p="Sobre o site"===a.titulo;return(0,y.jsx)("div",{ref:n,children:(0,y.jsxs)(ja,{painelInfo:a,closePainel:t,isMaximized:l,onToggleMaximize:()=>i((e=>!e)),children:[p?(0,y.jsx)(xa,{painelInfo:a}):h?(0,y.jsx)(ra,{terraIndigena:a}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Qe,{escola:a,shouldUseGrid:!0,refreshKey:r}),m&&m.length>0&&(0,y.jsx)(ya.A,{documentos:m,title:"Produ\xe7\xf5es e materiais da escola"}),a.link_para_videos&&(0,y.jsx)(ka,{videoUrl:a.link_para_videos,title:"V\xeddeo da escola",escolaId:a.id})]}),(0,y.jsx)(da,{copiarLink:d,compartilhar:u,painelInfo:a})]})})},_a=s.memo(Aa);var Ca=t(3303);const Ea=e=>{let{dataPoints:a,onPainelOpen:t}=e;console.log("DataPoints recebidos no MapaEscolasIndigenas:",a?{quantidade:a.length,exemplo:a[0]?{titulo:a[0].titulo,latitude:a[0].latitude,longitude:a[0].longitude,tipo:a[0].tipo}:"Nenhum ponto"}:"Nenhum dataPoint");const{refreshKey:o}=(0,Ca.b)(),r=(0,s.useMemo)((()=>new URLSearchParams(window.location.search)),[]).get("panel"),n=(0,s.useMemo)((()=>{if(r&&""!==r&&a&&a.length>0){return a.find((e=>T(e.titulo)===r))||null}return null}),[r,a]),[l,i]=(0,s.useState)(n),c=(0,s.useMemo)((()=>a?a.filter((e=>e.pontuacao>=0)):[]),[a]);(0,s.useMemo)((()=>c.length),[c]);(0,s.useEffect)((()=>{console.group("MapaEscolasIndigenas - painelInfo state changed"),console.log("Novo valor de painelInfo:",{titulo:null===l||void 0===l?void 0:l.titulo,tipo:null===l||void 0===l?void 0:l.tipo,hasLink:!(null===l||void 0===l||!l.link_para_documentos),linkValue:null===l||void 0===l?void 0:l.link_para_documentos,isInitialPanel:l===n,isNull:null===l,isUndefined:void 0===l}),console.groupEnd()}),[l,n]);const d=(0,s.useCallback)((e=>{e&&i(e)}),[]),u=(0,s.useCallback)((()=>{console.log("For\xe7ando refresh do painel de informa\xe7\xf5es")}),[]);(0,s.useEffect)((()=>{console.log("MapaEscolasIndigenas: onPainelOpen dispon\xedvel:",!!t),console.log("MapaEscolasIndigenas: abrirPainel dispon\xedvel:",!!d),t&&"function"===typeof t&&(console.log("MapaEscolasIndigenas: Expondo fun\xe7\xe3o abrirPainel e refreshPainel"),t(d,u))}),[d,t,u]);const m=(0,s.useCallback)((()=>{i(null)}),[]);return(0,y.jsxs)("div",{className:"relative h-screen w-full overflow-hidden",children:[(0,y.jsx)(R,{dataPoints:c,onPainelOpen:d,painelAberto:!!l,className:"h-full w-full"}),l&&(0,y.jsxs)(y.Fragment,{children:[console.log("MapaEscolasIndigenas - Renderizando PainelInformacoes com:",{painelInfo:l,hasLink:null===l||void 0===l?void 0:l.link_para_documentos,linkValue:null===l||void 0===l?void 0:l.link_para_documentos}),(0,y.jsx)(_a,{painelInfo:l,closePainel:m,refreshKey:o})]})]})}},9845:(e,a,t)=>{t.d(a,{F:()=>s});const s=()=>window.innerWidth<=768}}]);
//# sourceMappingURL=950.55c51e95.chunk.js.map