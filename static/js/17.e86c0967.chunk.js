/*! For license information please see 17.e86c0967.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[17],{193:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(1114).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},1184:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(1114).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1440:(e,a,s)=>{s.d(a,{BZ:()=>m,Gw:()=>c,gE:()=>i,vS:()=>d,vx:()=>u,wG:()=>n});var t=s(2880);const r={BUCKET_NAME:"imagens-das-escolas",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:10,MIN_DIMENSIONS:{width:200,height:200}},o={BUCKET_NAME:"imagens-professores",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:5,MIN_DIMENSIONS:{width:200,height:200}},l=(e,a)=>{if(!a.ALLOWED_TYPES.includes(e.type))return{isValid:!1,error:"Tipo de arquivo n\xe3o suportado. Use apenas: ".concat(a.ALLOWED_TYPES.map((e=>e.split("/")[1].toUpperCase())).join(", "))};if(e.size>a.MAX_FILE_SIZE)return{isValid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(a.MAX_FILE_SIZE/1048576,"MB")};const s=e.name.split(".").pop().toLowerCase(),t=a.ALLOWED_TYPES.map((e=>e.split("/")[1]));return t.includes(s)?{isValid:!0}:{isValid:!1,error:"Extens\xe3o n\xe3o permitida. Use apenas: ".concat(t.join(", "))}},i=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const o=l(e,r);if(!o.isValid)throw new Error(o.error);const i=((e,a)=>{const s=Date.now(),t=Math.random().toString(36).substring(2,8),r=e.name.split(".").pop().toLowerCase();return"".concat(a,"_").concat(s,"_").concat(t,".").concat(r)})(e,a),n="".concat(a,"/").concat(i),{error:c}=await t.N.storage.from(r.BUCKET_NAME).upload(n,e,{cacheControl:"3600",upsert:!1});if(c)throw new Error("Erro no upload: ".concat(c.message));const{data:{publicUrl:d}}=t.N.storage.from(r.BUCKET_NAME).getPublicUrl(n);return{id:Date.now(),url:n,publicUrl:d,descricao:s.trim()||"Imagem da escola ".concat(a),created_at:(new Date).toISOString()}}catch(o){throw console.error("Erro no upload da imagem da escola:",o),o}},n=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"professor";try{const i=l(e,o);if(!i.isValid)throw new Error(i.error);const n=((e,a,s)=>{const t=Date.now(),r=Math.random().toString(36).substring(2,8),o=e.name.split(".").pop().toLowerCase();return"".concat(s,"_").concat(a,"_").concat(t,"_").concat(r,".").concat(o)})(e,a,r),c="".concat(a,"/").concat(n),{error:d}=await t.N.storage.from(o.BUCKET_NAME).upload(c,e,{cacheControl:"3600",upsert:!1});if(d)throw console.error("Erro detalhado do upload:",d),new Error("Erro no upload: ".concat(d.message));const{data:{publicUrl:u}}=t.N.storage.from(o.BUCKET_NAME).getPublicUrl(c);return{id:Date.now(),url:c,publicUrl:u,descricao:s.trim()||"Imagem do ".concat(r," da escola ").concat(a),genero:r,created_at:(new Date).toISOString()}}catch(i){throw console.error("Erro no upload da imagem do professor:",i),i}},c=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BUCKET_NAME;try{const{data:s,error:r}=await t.N.storage.from(a).list("".concat(e,"/"));if(r)throw r;if(!s||0===s.length)return[];return s.map(((s,r)=>{const o="".concat(e,"/").concat(s.name),{data:{publicUrl:l}}=t.N.storage.from(a).getPublicUrl(o);return{id:r+1,url:o,publicUrl:l,descricao:"Imagem ".concat(r+1),created_at:s.created_at||(new Date).toISOString()}}))}catch(s){throw console.error("Erro ao buscar imagens da escola:",s),s}},d=async(e,a,s)=>{try{const{error:e}=await t.N.storage.from(s).remove([a]);if(e)throw new Error("Erro ao deletar arquivo: ".concat(e.message))}catch(r){throw console.error("Erro ao deletar imagem:",r),r}},u=async(e,a)=>{try{return{id:e,descricao:a.trim()}}catch(s){throw console.error("Erro ao atualizar descri\xe7\xe3o da imagem:",s),s}},m=async(e,a)=>{try{const s=a===o.BUCKET_NAME?o:r,{data:l,error:i}=await t.N.storage.from(a).list("".concat(e,"/"));if(i)throw i;const n=l?l.length:0;return{current:n,limit:s.MAX_IMAGES_PER_SCHOOL,canUpload:n<s.MAX_IMAGES_PER_SCHOOL}}catch(s){throw console.error("Erro ao verificar limite de imagens:",s),s}}},2308:(e,a,s)=>{s.d(a,{A:()=>j});var t=s(2555),r=s(5043),o=s(6464),l=s(6637),i=s(1114);const n=(0,i.A)("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),c=(0,i.A)("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);var d=s(6478),u=s(193),m=s(7669),g=s(4562);const x=(0,i.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var p=s(4488);const h=(0,i.A)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),b=(0,i.A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);var f=s(1184),v=s(237),y=s(579);const j=e=>{let{escolaId:a,onLegendasUpdate:s}=e;const[i,j]=(0,r.useState)([]),[N,w]=(0,r.useState)(!0),[A,_]=(0,r.useState)(""),[E,k]=(0,r.useState)(""),[S,C]=(0,r.useState)(!1),[D,I]=(0,r.useState)(null),[L,M]=(0,r.useState)("escola"),[U,P]=(0,r.useState)({imagem_url:"",legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral",tipo_foto:"escola"}),T=(0,r.useCallback)((async()=>{if(a)try{w(!0);const e=await(0,v.Fo)(a,L);j(e)}catch(e){console.error("Erro ao buscar legendas:",e),_("Erro ao carregar legendas de fotos")}finally{w(!1)}}),[a,L]);(0,r.useEffect)((()=>{T()}),[T]),(0,r.useEffect)((()=>{if(A||E){const e=setTimeout((()=>{_(""),k("")}),5e3);return()=>clearTimeout(e)}}),[A,E]);const q=()=>{P({imagem_url:"",legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral",tipo_foto:L}),I(null),C(!1)};return N?(0,y.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,y.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,y.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando legendas..."})]})}):(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(o.A,{className:"w-5 h-5 text-blue-600"}),(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Legendas de Fotos"})]}),(0,y.jsxs)("button",{onClick:()=>C(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,y.jsx)(l.A,{className:"w-4 h-4"}),"Adicionar Legenda"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,y.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Tipo de Foto:"}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsxs)("button",{onClick:()=>M("escola"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("escola"===L?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:[(0,y.jsx)(n,{className:"w-4 h-4"}),"Fotos da Escola"]}),(0,y.jsxs)("button",{onClick:()=>M("professor"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("professor"===L?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:[(0,y.jsx)(c,{className:"w-4 h-4"}),"Fotos dos Professores"]})]})]}),A&&(0,y.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,y.jsx)(d.A,{className:"w-5 h-5 text-red-600"}),(0,y.jsx)("span",{className:"text-red-700",children:A})]}),E&&(0,y.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,y.jsx)(u.A,{className:"w-5 h-5 text-green-600"}),(0,y.jsx)("span",{className:"text-green-700",children:E})]}),S&&(0,y.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg border",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,y.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:D?"Editar Legenda":"Adicionar Legenda"}),(0,y.jsx)("button",{onClick:q,className:"text-gray-500 hover:text-gray-700",children:(0,y.jsx)(m.A,{className:"w-5 h-5"})})]}),(0,y.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!U.imagem_url.trim()||!U.legenda.trim())return void _("URL da imagem e legenda s\xe3o obrigat\xf3rios");const r=function(e){const a=e.match(/imagens-das-escolas\/([\w\/-]+\.[a-zA-Z0-9]+)/);return a?a[1]:e}(U.imagem_url);try{if(D){console.log("Atualizando legenda:",D.id,(0,t.A)((0,t.A)({},U),{},{imagem_url:r}));const e=await(0,v.w_)(D.id,(0,t.A)((0,t.A)({},U),{},{imagem_url:r,escola_id:a}));console.log("Resultado do update:",e),k("Legenda atualizada com sucesso!")}else{if(await(0,v.qP)(r,a,L))return void _("J\xe1 existe uma legenda para esta imagem");await(0,v.eP)((0,t.A)((0,t.A)({},U),{},{imagem_url:r,escola_id:a,tipo_foto:L,ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()})),k("Legenda adicionada com sucesso!")}q(),T(),s&&s()}catch(o){console.error("Erro ao salvar legenda:",o),_("Erro ao salvar legenda: ".concat(o.message))}},className:"space-y-4",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL da Imagem *"}),(0,y.jsx)("input",{type:"url",value:U.imagem_url,onChange:e=>P((0,t.A)((0,t.A)({},U),{},{imagem_url:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"escola"===L?"https://exemplo.com/imagem-escola.jpg":"https://exemplo.com/imagem-professor.jpg",required:!0})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,y.jsx)("select",{value:U.categoria,onChange:e=>P((0,t.A)((0,t.A)({},U),{},{categoria:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[{value:"geral",label:"Geral"},{value:"infraestrutura",label:"Infraestrutura"},{value:"atividades",label:"Atividades"},{value:"professores",label:"Professores"},{value:"alunos",label:"Alunos"},{value:"comunidade",label:"Comunidade"},{value:"eventos",label:"Eventos"},{value:"outros",label:"Outros"}].map((e=>(0,y.jsx)("option",{value:e.value,children:e.label},e.value)))})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda *"}),(0,y.jsx)("input",{type:"text",value:U.legenda,onChange:e=>P((0,t.A)((0,t.A)({},U),{},{legenda:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descri\xe7\xe3o curta da foto do ".concat(L),required:!0})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,y.jsx)("textarea",{value:U.descricao_detalhada,onChange:e=>P((0,t.A)((0,t.A)({},U),{},{descricao_detalhada:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",placeholder:"Descri\xe7\xe3o mais detalhada da foto do ".concat(L,"...")})]}),(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,y.jsx)("input",{type:"text",value:U.autor_foto,onChange:e=>P((0,t.A)((0,t.A)({},U),{},{autor_foto:e.target.value})),className:"w-full border rounded-lg pl-10 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome do fot\xf3grafo"})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,y.jsx)("input",{type:"date",value:U.data_foto,onChange:e=>P((0,t.A)((0,t.A)({},U),{},{data_foto:e.target.value})),className:"w-full border rounded-lg pl-10 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,y.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,y.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,y.jsx)(p.A,{className:"w-4 h-4"}),D?"Atualizar":"Salvar"]}),(0,y.jsx)("button",{type:"button",onClick:q,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})]}),i.length>0?(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("h4",{className:"font-medium text-gray-900",children:["Legendas de ","escola"===L?"Fotos da Escola":"Fotos dos Professores"," (",i.length,")"]}),(0,y.jsx)("div",{className:"grid gap-4",children:i.map((e=>(0,y.jsx)("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,y.jsx)(h,{className:"w-4 h-4 text-gray-400"}),(0,y.jsx)("span",{className:"text-sm text-gray-500 capitalize",children:e.categoria}),(0,y.jsx)("span",{className:"text-gray-300",children:"\u2022"}),(0,y.jsx)("span",{className:"text-sm text-gray-500 capitalize",children:"escola"===e.tipo_foto?"Escola":"Professor"})]}),(0,y.jsx)("h5",{className:"font-medium text-gray-900 mb-1",children:e.legenda}),e.descricao_detalhada&&(0,y.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.descricao_detalhada}),(0,y.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.autor_foto&&(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)(g.A,{className:"w-3 h-3"}),e.autor_foto]}),e.data_foto&&(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)(x,{className:"w-3 h-3"}),new Date(e.data_foto).toLocaleDateString("pt-BR")]})]}),(0,y.jsx)("p",{className:"text-xs text-blue-600 mt-2 truncate",children:e.imagem_url})]}),(0,y.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,y.jsx)("button",{onClick:()=>(e=>{I(e),P({imagem_url:e.imagem_url,legenda:e.legenda,descricao_detalhada:e.descricao_detalhada||"",autor_foto:e.autor_foto||"",data_foto:e.data_foto||"",categoria:e.categoria||"geral",tipo_foto:e.tipo_foto||L}),C(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar legenda",children:(0,y.jsx)(b,{className:"w-4 h-4"})}),(0,y.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir esta legenda?"))try{await(0,v.YR)(e),k("Legenda exclu\xedda com sucesso!"),T(),s&&s()}catch(a){console.error("Erro ao deletar legenda:",a),_("Erro ao excluir legenda: ".concat(a.message))}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir legenda",children:(0,y.jsx)(f.A,{className:"w-4 h-4"})})]})]})},e.id)))})]}):(0,y.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,y.jsx)(o.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,y.jsxs)("p",{children:["Nenhuma legenda adicionada para ","escola"===L?"fotos da escola":"fotos dos professores","."]}),(0,y.jsx)("p",{className:"text-sm",children:"Adicione legendas para melhorar a descri\xe7\xe3o das fotos."})]})]})}},3882:(e,a,s)=>{s.d(a,{A:()=>p});var t=s(2555),r=s(5043);const o=(0,s(1114).A)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var l=s(8590),i=s(6637),n=s(1184),c=s(7669),d=s(4488),u=s(6478),m=s(193),g=s(237),x=s(579);const p=e=>{var a;let{escolaId:s,videoUrl:p,onVideoUrlChange:h,onTitulosUpdate:b}=e;const[f,v]=(0,r.useState)([]),[y,j]=(0,r.useState)(!0),[N,w]=(0,r.useState)(""),[A,_]=(0,r.useState)(""),[E,k]=(0,r.useState)(!1),[S,C]=(0,r.useState)({url:"",titulo:""}),D=(0,r.useCallback)((async()=>{if(s)try{j(!0);const e=(await(0,g.L6)(s)).map((e=>({id:e.id,url:e.video_url,titulo:e.titulo,plataforma:e.plataforma,categoria:e.categoria})));v(e)}catch(e){console.error("Erro ao buscar v\xeddeos:",e),w("Erro ao carregar v\xeddeos")}finally{j(!1)}}),[s]);(0,r.useEffect)((()=>{D()}),[D]),(0,r.useEffect)((()=>{if(N||A){const e=setTimeout((()=>{w(""),_("")}),5e3);return()=>clearTimeout(e)}}),[N,A]);const I=async(e,a)=>{if(a.trim())try{await(0,g.KM)(e,{titulo:a,escola_id:s}),D(),b&&b()}catch(t){console.error("Erro ao atualizar t\xedtulo:",t),w("Erro ao atualizar t\xedtulo")}},L=e=>{if(!e)return"";const a=e.match(/(?:youtu.be\/|youtube.com\/(?:watch\?v=|embed\/|v\/))([\w-]{11})/);if(a)return"https://www.youtube.com/embed/".concat(a[1]);const s=e.match(/vimeo.com\/(\d+)/);return s?"https://player.vimeo.com/video/".concat(s[1]):e};return(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(o,{className:"w-5 h-5 text-blue-600"}),(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"V\xeddeo Principal"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo"}),(0,x.jsx)("input",{type:"url",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:p||"",onChange:e=>h(e.target.value),placeholder:"Cole aqui o link do v\xeddeo (YouTube, Vimeo, etc)"}),(0,x.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: https://www.youtube.com/watch?v=..."})]}),p&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo do V\xeddeo"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(a=f.find((e=>e.url===p)))||void 0===a?void 0:a.titulo)||"",onChange:e=>{const a=f.find((e=>e.url===p));a&&I(a.id,e.target.value)},placeholder:"Digite o t\xedtulo do v\xeddeo"}),(0,x.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Exemplo: "Aula de Matem\xe1tica na Escola Ind\xedgena"'})]}),p&&L(p)&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,x.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black rounded-lg overflow-hidden",children:(0,x.jsx)("iframe",{src:L(p),title:"Pr\xe9-visualiza\xe7\xe3o do v\xeddeo",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full"})})]})]}),(0,x.jsxs)("div",{className:"border-t pt-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(l.A,{className:"w-5 h-5 text-green-600"}),(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Outros V\xeddeos"})]}),(0,x.jsxs)("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,x.jsx)(i.A,{className:"w-4 h-4"}),"Adicionar Outro V\xeddeo"]})]}),f.filter((e=>e.url!==p)).length>0&&(0,x.jsx)("div",{className:"space-y-4",children:f.filter((e=>e.url!==p)).map((e=>(0,x.jsxs)("div",{className:"bg-gray-50 border rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo do V\xeddeo"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:e.titulo,onChange:a=>I(e.id,a.target.value),placeholder:"Digite o t\xedtulo do v\xeddeo"})]}),(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja remover este v\xeddeo?"))try{await(0,g.qp)(e),_("V\xeddeo removido com sucesso!"),D(),b&&b()}catch(a){console.error("Erro ao remover v\xeddeo:",a),w("Erro ao remover v\xeddeo")}})(e.id),className:"ml-3 p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remover v\xeddeo",children:(0,x.jsx)(n.A,{className:"w-4 h-4"})})]}),(0,x.jsxs)("div",{className:"mb-3",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo"}),(0,x.jsx)("input",{type:"url",className:"w-full border rounded-lg px-3 py-2 bg-gray-100",value:e.url,disabled:!0})]}),L(e.url)&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,x.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black rounded-lg overflow-hidden",children:(0,x.jsx)("iframe",{src:L(e.url),title:e.titulo,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full"})})]})]},e.id)))}),0===f.filter((e=>e.url!==p)).length&&!E&&(0,x.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,x.jsx)(l.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,x.jsx)("p",{children:"Nenhum v\xeddeo adicional adicionado."}),(0,x.jsx)("p",{className:"text-sm",children:'Clique em "Adicionar Outro V\xeddeo" para incluir mais v\xeddeos.'})]}),E&&(0,x.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,x.jsx)("h4",{className:"text-lg font-medium text-blue-800",children:"Adicionar Novo V\xeddeo"}),(0,x.jsx)("button",{onClick:()=>{k(!1),C({url:"",titulo:""})},className:"text-blue-500 hover:text-blue-700",children:(0,x.jsx)(c.A,{className:"w-5 h-5"})})]}),(0,x.jsxs)("form",{onSubmit:async e=>{var a;if(e.preventDefault(),S.url.trim()&&S.titulo.trim())try{if(f.find((e=>e.url===S.url)))return void w("Este v\xeddeo j\xe1 foi adicionado");await(0,g.I5)({video_url:S.url,titulo:S.titulo,plataforma:(a=S.url,a.includes("youtube.com")||a.includes("youtu.be")?"youtube":a.includes("vimeo.com")?"vimeo":a.includes("facebook.com")?"facebook":a.includes("instagram.com")?"instagram":"outro"),categoria:"geral",escola_id:s}),_("V\xeddeo adicionado com sucesso!"),C({url:"",titulo:""}),k(!1),D(),b&&b()}catch(t){console.error("Erro ao adicionar v\xeddeo:",t),w("Erro ao adicionar v\xeddeo")}else w("URL e t\xedtulo s\xe3o obrigat\xf3rios")},className:"space-y-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo *"}),(0,x.jsx)("input",{type:"url",required:!0,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:S.url,onChange:e=>C((0,t.A)((0,t.A)({},S),{},{url:e.target.value})),placeholder:"https://www.youtube.com/watch?v=..."})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo do V\xeddeo *"}),(0,x.jsx)("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:S.titulo,onChange:e=>C((0,t.A)((0,t.A)({},S),{},{titulo:e.target.value})),placeholder:"Digite o t\xedtulo do v\xeddeo"})]}),(0,x.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,x.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,x.jsx)(d.A,{className:"w-4 h-4"}),"Adicionar V\xeddeo"]}),(0,x.jsx)("button",{type:"button",onClick:()=>{k(!1),C({url:"",titulo:""})},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})]})]}),N&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,x.jsx)(u.A,{className:"w-5 h-5 text-red-600"}),(0,x.jsx)("span",{className:"text-red-700",children:N})]}),A&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,x.jsx)(m.A,{className:"w-5 h-5 text-green-600"}),(0,x.jsx)("span",{className:"text-green-700",children:A})]})]})}},4488:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(1114).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4562:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(1114).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},6017:(e,a,s)=>{s.r(a),s.d(a,{default:()=>f});var t=s(2555),r=s(5043),o=s(197),l=s(6464),i=s(4562),n=s(2623),c=s(8590),d=s(1209),u=s(2065);const m=(0,s(1114).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var g=s(7484),x=s(6208),p=s(2308),h=s(3882),b=s(579);const f=e=>{let{escola:a,onClose:s,onSave:f}=e;const[v,y]=(0,r.useState)((null===a||void 0===a?void 0:a.Escola)||""),[j,N]=(0,r.useState)(!1),[w,A]=(0,r.useState)(""),[_,E]=(0,r.useState)("dados-basicos"),k=[{id:"dados-basicos",label:"Dados B\xe1sicos",icon:o.A,description:"Informa\xe7\xf5es principais da escola"},{id:"imagens-escola",label:"Imagens da Escola",icon:l.A,description:"Upload e gerenciamento de imagens da escola (m\xe1x. 10)"},{id:"imagens-professores",label:"Imagens dos Professores",icon:i.A,description:"Upload e gerenciamento de imagens dos professores (m\xe1x. 5)"},{id:"legendas-fotos",label:"Legendas de Fotos",icon:n.A,description:"Gerenciar legendas descritivas das fotos"},{id:"video",label:"V\xeddeo",icon:c.A,description:"Link do v\xeddeo e gerenciamento de t\xedtulos"},{id:"localizacao",label:"Localiza\xe7\xe3o",icon:d.A,description:"Coordenadas e endere\xe7o da escola"},{id:"gestao",label:"Gest\xe3o",icon:u.A,description:"Informa\xe7\xf5es sobre gest\xe3o e funcion\xe1rios"},{id:"configuracoes",label:"Configura\xe7\xf5es",icon:m,description:"Configura\xe7\xf5es avan\xe7adas da escola"}],S=()=>{console.log("Imagens atualizadas - PainelInformacoes deve ser atualizado")},C=()=>{console.log("Legendas atualizadas - PainelInformacoes deve ser atualizado")},D=()=>{console.log("T\xedtulos atualizados - PainelInformacoes deve ser atualizado")};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[90vh] flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Editar Escola: ",(null===a||void 0===a?void 0:a.Escola)||"Nova Escola"]}),(0,b.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,b.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsx)("div",{className:"flex border-b bg-gray-50",children:k.map((e=>{const a=e.icon;return(0,b.jsxs)("button",{onClick:()=>E(e.id),className:"flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors ".concat(_===e.id?"text-blue-600 border-b-2 border-blue-600 bg-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),title:e.description,children:[(0,b.jsx)(a,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:e.label})]},e.id)}))}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,b.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),v.trim()){A(""),N(!0);try{await f((0,t.A)((0,t.A)({},a),{},{Escola:v})),s()}catch(r){A("Erro ao salvar.")}finally{N(!1)}}else A("O nome da escola \xe9 obrigat\xf3rio.")},children:[(0,b.jsx)("div",{className:"min-h-[400px]",children:(()=>{switch(_){case"dados-basicos":return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Escola *"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:v,onChange:e=>y(e.target.value),disabled:j,placeholder:"Digite o nome da escola"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Munic\xedpio"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a["Munic\xedpio"])||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{"Munic\xedpio":e.target.value})),placeholder:"Nome do munic\xedpio"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terra Ind\xedgena (TI)"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a["Terra Indigena (TI)"])||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{"Terra Indigena (TI)":e.target.value})),placeholder:"Nome da terra ind\xedgena"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Endere\xe7o"}),(0,b.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",value:(null===a||void 0===a?void 0:a["Endere\xe7o"])||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{"Endere\xe7o":e.target.value})),placeholder:"Endere\xe7o completo da escola"})]})]});case"imagens-escola":return(0,b.jsx)(g.A,{escolaId:null===a||void 0===a?void 0:a.id,onImagesUpdate:S});case"imagens-professores":return(0,b.jsx)(x.A,{escolaId:null===a||void 0===a?void 0:a.id,onImagesUpdate:S});case"legendas-fotos":return(0,b.jsx)(p.A,{escolaId:null===a||void 0===a?void 0:a.id,onLegendasUpdate:C});case"video":return(0,b.jsx)(h.A,{escolaId:null===a||void 0===a?void 0:a.id,videoUrl:(null===a||void 0===a?void 0:a.link_para_videos)||"",onVideoUrlChange:e=>f((0,t.A)((0,t.A)({},a),{},{link_para_videos:e})),onTitulosUpdate:D});case"localizacao":return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),(0,b.jsx)("input",{type:"number",step:"any",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.latitude)||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{latitude:parseFloat(e.target.value)||null})),placeholder:"Ex: -23.5505"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),(0,b.jsx)("input",{type:"number",step:"any",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.longitude)||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{longitude:parseFloat(e.target.value)||null})),placeholder:"Ex: -46.6333"})]})]}),(0,b.jsx)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,b.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,b.jsx)("strong",{children:"Dica:"})," Use o Google Maps para encontrar as coordenadas exatas da escola. Clique com o bot\xe3o direito no local da escola e selecione as coordenadas."]})})]});case"gestao":return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gest\xe3o/Nome"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.gestao)||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{gestao:e.target.value})),placeholder:"Nome da gest\xe3o atual"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Professores Ind\xedgenas"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.professores_indigenas)||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{professores_indigenas:e.target.value})),placeholder:"Quantidade ou nomes"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Professores N\xe3o Ind\xedgenas"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.professores_nao_indigenas)||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{professores_nao_indigenas:e.target.value})),placeholder:"Quantidade ou nomes"})]})]})]});case"infraestrutura":return(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Merenda diferenciada"}),(0,b.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",value:(null===a||void 0===a?void 0:a.merenda_diferenciada)||"",onChange:e=>f((0,t.A)((0,t.A)({},a),{},{merenda_diferenciada:e.target.value})),placeholder:"Descreva a situa\xe7\xe3o do fornecimento de merenda (ex: se a escola recebe, se h\xe1 interrup\xe7\xf5es, etc.)"})]})});case"configuracoes":return(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsx)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,b.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,b.jsx)("strong",{children:"Configura\xe7\xf5es Avan\xe7adas:"})," Esta se\xe7\xe3o ser\xe1 implementada em breve. Aqui voc\xea poder\xe1 configurar permiss\xf5es, notifica\xe7\xf5es e outras op\xe7\xf5es avan\xe7adas."]})})});default:return null}})()}),w&&(0,b.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-red-700 text-sm",children:w})}),(0,b.jsxs)("div",{className:"flex gap-3 mt-6 pt-6 border-t border-gray-200",children:[(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:j,children:j?"Salvando...":"Salvar Altera\xe7\xf5es"}),(0,b.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",onClick:s,disabled:j,children:"Cancelar"})]})]})})]})})}},6208:(e,a,s)=>{s.d(a,{A:()=>b});var t=s(2555),r=s(5043),o=s(4562),l=s(6478),i=s(193),n=s(256),c=s(7669),d=s(1184),u=s(4488),m=s(1440),g=s(237),x=s(2880);const p=async e=>{const{data:a,error:s}=await x.N.from("imagens_professores").insert([e]).select().single();if(s)throw s;return a};var h=s(579);const b=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[b,f]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[j,N]=(0,r.useState)(0),[w,A]=(0,r.useState)(""),[_,E]=(0,r.useState)(""),[k,S]=(0,r.useState)([]),[C,D]=(0,r.useState)(!0),[I,L]=(0,r.useState)({current:0,limit:5,canUpload:!0}),[M,U]=(0,r.useState)(null),[P,T]=(0,r.useState)(""),[q,z]=(0,r.useState)("professor"),[V,O]=(0,r.useState)(""),F=(0,r.useCallback)((async()=>{if(a)try{D(!0);const e=await(0,m.Gw)(a,"imagens-professores");S(e);const s=await(0,m.BZ)(a,"imagens-professores");L(s)}catch(e){console.error("Erro ao buscar imagens dos professores:",e),A("Erro ao carregar imagens dos professores")}finally{D(!1)}}),[a]);(0,r.useEffect)((()=>{F()}),[F]),(0,r.useEffect)((()=>{(async()=>{if(!k.length)return;const e={};for(const s of k){console.log("Buscando legenda para:",s.publicUrl,a,"professor");const t=await(0,g.qP)(s.publicUrl,a,"professor");e[s.publicUrl]=t}S((a=>a.map((a=>(0,t.A)((0,t.A)({},a),{},{legendaData:e[a.publicUrl]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[k.length,a]),(0,r.useEffect)((()=>{if(w||_){const e=setTimeout((()=>{A(""),E("")}),5e3);return()=>clearTimeout(e)}}),[w,_]);const B=(0,r.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;if(!I.canUpload)return void A("Limite de ".concat(I.limit," imagens dos professores atingido. Remova algumas imagens antes de adicionar novas."));if(k.length+b.length+a.length>I.limit)return void A("Voc\xea pode adicionar no m\xe1ximo ".concat(I.limit-k.length-b.length," imagens dos professores."));const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(f((e=>[...e,...s])),A(""))}),[I,k.length,b.length]),G=(0,r.useCallback)((e=>{e.preventDefault()}),[]),R=(e,a,s)=>{S((r=>r.map((r=>r.id===e?(0,t.A)((0,t.A)({},r),{},{legendaData:(0,t.A)((0,t.A)({},r.legendaData),{},{[a]:s})}):r))))},W=async e=>{const r=e.publicUrl,o=e.legendaData;console.log("Salvando legenda para:",r,o);try{let e=await(0,g.qP)(r,a,"professor");e?await(0,g.w_)(e.id,(0,t.A)((0,t.A)({},o),{},{updated_at:(new Date).toISOString()})):await(0,g.eP)((0,t.A)((0,t.A)({escola_id:a,imagem_url:r},o),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"professor"}));let l=await(async(e,a)=>{const{data:s,error:t}=await x.N.from("imagens_professores").select("*").eq("imagem_url",e).eq("escola_id",a).eq("ativo",!0).single();if(t&&"PGRST116"!==t.code)throw t;return s||null})(r,a);l&&await(async(e,a)=>{const{data:s,error:t}=await x.N.from("imagens_professores").update(a).eq("id",e).select().single();if(t)throw t;return s})(l.id,{autor:o.autor_foto,updated_at:(new Date).toISOString()}),E("Legenda salva com sucesso!"),s&&s()}catch(l){A("Erro ao salvar legenda: "+l.message)}};return C?(0,h.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,h.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,h.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,h.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens dos professores..."})]})}):(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(o.A,{className:"w-5 h-5 text-green-600"}),(0,h.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens dos Professores"})]}),(0,h.jsxs)("div",{className:"text-sm text-gray-500",children:[I.current,"/",I.limit," imagens"]})]}),w&&(0,h.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,h.jsx)(l.A,{className:"w-5 h-5 text-red-600"}),(0,h.jsx)("span",{className:"text-red-700",children:w})]}),_&&(0,h.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,h.jsx)(i.A,{className:"w-5 h-5 text-green-600"}),(0,h.jsx)("span",{className:"text-green-700",children:_})]}),I.canUpload&&(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(v?"border-gray-300 bg-gray-50":"border-green-300 bg-green-50 hover:border-green-400 hover:bg-green-100"),onDrop:B,onDragOver:G,children:[(0,h.jsx)(n.A,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),(0,h.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens dos professores aqui ou clique para selecionar"}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo \u2022 M\xe1ximo 5 imagens"}),(0,h.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer transition-colors",children:[(0,h.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;if(!I.canUpload)return void A("Limite de ".concat(I.limit," imagens dos professores atingido. Remova algumas imagens antes de adicionar novas."));if(k.length+b.length+a.length>I.limit)return void A("Voc\xea pode adicionar no m\xe1ximo ".concat(I.limit-k.length-b.length," imagens dos professores."));const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||A('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||A('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(f((e=>[...e,...s])),A(""))},className:"hidden",disabled:v}),"Selecionar Arquivos"]})]}),v&&(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,h.jsx)("span",{children:"Fazendo upload das imagens dos professores..."}),(0,h.jsxs)("span",{children:[Math.round(j),"%"]})]}),(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,h.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(j,"%")}})})]}),b.length>0&&(0,h.jsxs)("div",{className:"space-y-3",children:[(0,h.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",b.length,")"]}),(0,h.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:b.map(((e,a)=>(0,h.jsxs)("div",{className:"relative group",children:[(0,h.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,h.jsx)("button",{onClick:()=>(e=>{f((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,h.jsx)(c.A,{className:"w-3 h-3"})}),(0,h.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,h.jsx)("button",{onClick:async()=>{if(0!==b.length){y(!0),N(0),A("");try{const e=[];for(let s=0;s<b.length;s++){const t=b[s],r=(s+1)/b.length*100;N(r);const o=await(0,m.wG)(t,a,"",q,V);e.push(o),await p({escola_id:a,imagem_url:o.url,nome_arquivo:t.name,autor:"",ativo:!0})}S((a=>[...a,...e])),f([]),N(0),E("".concat(e.length," imagem(ns) do(s) professor(es) carregada(s) com sucesso!"));const t=await(0,m.BZ)(a,"imagens-professores");L(t),s&&s()}catch(e){console.error("Erro no upload:",e),A("Erro ao fazer upload: ".concat(e.message))}finally{y(!1),N(0)}}},disabled:v,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Fazendo Upload...":"Fazer Upload"})]})]}),k.length>0&&(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens dos Professores (",k.length,")"]}),(0,h.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map((e=>{var t,r,o,l,i;return(0,h.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,h.jsxs)("div",{className:"relative group",children:[(0,h.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem do professor",className:"w-full h-48 object-cover"}),(0,h.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,h.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,h.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem do professor?"))try{await(0,m.vS)(e,t,"imagens-professores"),S((a=>a.filter((a=>a.id!==e))));const r=await(0,m.BZ)(a,"imagens-professores");L(r),E("Imagem do professor exclu\xedda com sucesso!"),s&&s()}catch(r){console.error("Erro ao deletar imagem:",r),A("Erro ao excluir imagem: ".concat(r.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,h.jsx)(d.A,{className:"w-4 h-4"})})})})]}),(0,h.jsxs)("div",{className:"p-4 space-y-2",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(t=e.legendaData)||void 0===t?void 0:t.legenda)||"",onChange:a=>R(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,h.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(r=e.legendaData)||void 0===r?void 0:r.descricao_detalhada)||"",onChange:a=>R(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(o=e.legendaData)||void 0===o?void 0:o.autor_foto)||"",onChange:a=>R(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,h.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(l=e.legendaData)||void 0===l?void 0:l.data_foto)||"",onChange:a=>R(e.id,"data_foto",a.target.value)}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(i=e.legendaData)||void 0===i?void 0:i.categoria)||"",onChange:a=>R(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,h.jsx)("div",{className:"flex gap-2 pt-2",children:(0,h.jsxs)("button",{onClick:()=>W(e),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",type:"button",children:[(0,h.jsx)(u.A,{className:"w-4 h-4"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===k.length&&!v&&(0,h.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,h.jsx)(o.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,h.jsx)("p",{children:"Nenhuma imagem dos professores adicionada ainda."}),(0,h.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar os professores da escola."})]})]})}},6464:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(1114).A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},6637:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(1114).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7484:(e,a,s)=>{s.d(a,{A:()=>p});var t=s(2555),r=s(5043),o=s(6464),l=s(6478),i=s(193),n=s(256),c=s(7669),d=s(1184),u=s(4488),m=s(1440),g=s(237),x=s(579);const p=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[p,h]=(0,r.useState)([]),[b,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)(0),[j,N]=(0,r.useState)(""),[w,A]=(0,r.useState)(""),[_,E]=(0,r.useState)([]),[k,S]=(0,r.useState)(!0),[C,D]=(0,r.useState)({current:0,limit:10,canUpload:!0}),[I,L]=(0,r.useState)(null),[M,U]=(0,r.useState)(""),P=(0,r.useCallback)((async()=>{if(a)try{S(!0);const e=await(0,m.Gw)(a,"imagens-das-escolas");E(e);const s=await(0,m.BZ)(a,"imagens-das-escolas");D(s)}catch(e){console.error("Erro ao buscar imagens:",e),N("Erro ao carregar imagens existentes")}finally{S(!1)}}),[a]);(0,r.useEffect)((()=>{P()}),[P]),(0,r.useEffect)((()=>{(async()=>{if(!_.length)return;const e={};for(const s of _){const t=await(0,g.qP)(s.url,a,"escola");e[s.url]=t}E((a=>a.map((a=>(0,t.A)((0,t.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[_.length,a]),(0,r.useEffect)((()=>{if(j||w){const e=setTimeout((()=>{N(""),A("")}),5e3);return()=>clearTimeout(e)}}),[j,w]);const T=(0,r.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;if(!C.canUpload)return void N("Limite de ".concat(C.limit," imagens atingido. Remova algumas imagens antes de adicionar novas."));if(_.length+p.length+a.length>C.limit)return void N("Voc\xea pode adicionar no m\xe1ximo ".concat(C.limit-_.length-p.length," imagens."));const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(h((e=>[...e,...s])),N(""))}),[C,_.length,p.length]),q=(0,r.useCallback)((e=>{e.preventDefault()}),[]),z=(e,a,s)=>{E((r=>r.map((r=>r.id===e?(0,t.A)((0,t.A)({},r),{},{legendaData:(0,t.A)((0,t.A)({},r.legendaData),{},{[a]:s})}):r))))};return k?(0,x.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,x.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,x.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens..."})]})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(o.A,{className:"w-5 h-5 text-blue-600"}),(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens da Escola"})]}),(0,x.jsxs)("div",{className:"text-sm text-gray-500",children:[C.current,"/",C.limit," imagens"]})]}),j&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,x.jsx)(l.A,{className:"w-5 h-5 text-red-600"}),(0,x.jsx)("span",{className:"text-red-700",children:j})]}),w&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,x.jsx)(i.A,{className:"w-5 h-5 text-green-600"}),(0,x.jsx)("span",{className:"text-green-700",children:w})]}),C.canUpload&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(b?"border-gray-300 bg-gray-50":"border-blue-300 bg-blue-50 hover:border-blue-400 hover:bg-blue-100"),onDrop:T,onDragOver:q,children:[(0,x.jsx)(n.A,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),(0,x.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens aqui ou clique para selecionar"}),(0,x.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo"}),(0,x.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,x.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;if(!C.canUpload)return void N("Limite de ".concat(C.limit," imagens atingido. Remova algumas imagens antes de adicionar novas."));if(_.length+p.length+a.length>C.limit)return void N("Voc\xea pode adicionar no m\xe1ximo ".concat(C.limit-_.length-p.length," imagens."));const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||N('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||N('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(h((e=>[...e,...s])),N(""))},className:"hidden",disabled:b}),"Selecionar Arquivos"]})]}),b&&(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,x.jsx)("span",{children:"Fazendo upload..."}),(0,x.jsxs)("span",{children:[Math.round(v),"%"]})]}),(0,x.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,x.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(v,"%")}})})]}),p.length>0&&(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",p.length,")"]}),(0,x.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:p.map(((e,a)=>(0,x.jsxs)("div",{className:"relative group",children:[(0,x.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,x.jsx)("button",{onClick:()=>(e=>{h((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,x.jsx)(c.A,{className:"w-3 h-3"})}),(0,x.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,x.jsx)("button",{onClick:async()=>{if(0!==p.length){f(!0),y(0),N("");try{const e=[];for(let s=0;s<p.length;s++){const t=p[s],r=(s+1)/p.length*100;y(r);const o=await(0,m.gE)(t,a);e.push(o)}E((a=>[...a,...e])),h([]),y(0),A("".concat(e.length," imagem(ns) carregada(s) com sucesso!"));const t=await(0,m.BZ)(a,"imagens-das-escolas");D(t),s&&s()}catch(e){console.error("Erro no upload:",e),N("Erro ao fazer upload: ".concat(e.message))}finally{f(!1),y(0)}}},disabled:b,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Fazendo Upload...":"Fazer Upload"})]})]}),_.length>0&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens da Escola (",_.length,")"]}),(0,x.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map((e=>{var r,o,l,i,n;return(0,x.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,x.jsxs)("div",{className:"relative group",children:[(0,x.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem da escola",className:"w-full h-48 object-cover"}),(0,x.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,x.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,x.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem?"))try{await(0,m.vS)(e,t,"imagens-das-escolas"),E((a=>a.filter((a=>a.id!==e))));const r=await(0,m.BZ)(a,"imagens-das-escolas");D(r),A("Imagem exclu\xedda com sucesso!"),s&&s()}catch(r){console.error("Erro ao deletar imagem:",r),N("Erro ao excluir imagem: ".concat(r.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,x.jsx)(d.A,{className:"w-4 h-4"})})})})]}),(0,x.jsxs)("div",{className:"p-4 space-y-2",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(r=e.legendaData)||void 0===r?void 0:r.legenda)||"",onChange:a=>z(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,x.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(o=e.legendaData)||void 0===o?void 0:o.descricao_detalhada)||"",onChange:a=>z(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(l=e.legendaData)||void 0===l?void 0:l.autor_foto)||"",onChange:a=>z(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,x.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(i=e.legendaData)||void 0===i?void 0:i.data_foto)||"",onChange:a=>z(e.id,"data_foto",a.target.value)}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(n=e.legendaData)||void 0===n?void 0:n.categoria)||"",onChange:a=>z(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,x.jsx)("div",{className:"flex gap-2 pt-2",children:(0,x.jsxs)("button",{onClick:()=>(async e=>{const r=e.url,o=e.legendaData;try{let e=await(0,g.qP)(r,a,"escola");e?await(0,g.w_)(e.id,(0,t.A)((0,t.A)({},o),{},{updated_at:(new Date).toISOString()})):await(0,g.eP)((0,t.A)((0,t.A)({escola_id:a,imagem_url:r},o),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"escola"})),A("Legenda salva com sucesso!"),s&&s()}catch(l){N("Erro ao salvar legenda: "+l.message)}})(e),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",type:"button",children:[(0,x.jsx)(u.A,{className:"w-4 h-4"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===_.length&&!b&&(0,x.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,x.jsx)(o.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,x.jsx)("p",{children:"Nenhuma imagem adicionada ainda."}),(0,x.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar a escola."})]})]})}},8590:(e,a,s)=>{s.d(a,{A:()=>t});const t=(0,s(1114).A)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]])}}]);
//# sourceMappingURL=17.e86c0967.chunk.js.map