/*! For license information please see 17.d67b13a1.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[17],{1440:(e,a,s)=>{s.d(a,{BZ:()=>g,Gw:()=>c,gE:()=>n,vS:()=>d,vx:()=>m,wG:()=>i});var o=s(2880);const r={BUCKET_NAME:"imagens-das-escolas",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:10,MIN_DIMENSIONS:{width:200,height:200}},t={BUCKET_NAME:"imagens-professores",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:5,MIN_DIMENSIONS:{width:200,height:200}},l=(e,a)=>{if(!a.ALLOWED_TYPES.includes(e.type))return{isValid:!1,error:"Tipo de arquivo n\xe3o suportado. Use apenas: ".concat(a.ALLOWED_TYPES.map((e=>e.split("/")[1].toUpperCase())).join(", "))};if(e.size>a.MAX_FILE_SIZE)return{isValid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(a.MAX_FILE_SIZE/1048576,"MB")};const s=e.name.split(".").pop().toLowerCase(),o=a.ALLOWED_TYPES.map((e=>e.split("/")[1]));return o.includes(s)?{isValid:!0}:{isValid:!1,error:"Extens\xe3o n\xe3o permitida. Use apenas: ".concat(o.join(", "))}},n=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const t=l(e,r);if(!t.isValid)throw new Error(t.error);const n=((e,a)=>{const s=Date.now(),o=Math.random().toString(36).substring(2,8),r=e.name.split(".").pop().toLowerCase();return"".concat(a,"_").concat(s,"_").concat(o,".").concat(r)})(e,a),i="".concat(a,"/").concat(n),{error:c}=await o.N.storage.from(r.BUCKET_NAME).upload(i,e,{cacheControl:"3600",upsert:!1});if(c)throw new Error("Erro no upload: ".concat(c.message));const{data:{publicUrl:d}}=o.N.storage.from(r.BUCKET_NAME).getPublicUrl(i);return{id:Date.now(),url:i,publicUrl:d,descricao:s.trim()||"Imagem da escola ".concat(a),created_at:(new Date).toISOString()}}catch(t){throw console.error("Erro no upload da imagem da escola:",t),t}},i=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"professor";try{const n=l(e,t);if(!n.isValid)throw new Error(n.error);const i=((e,a,s)=>{const o=Date.now(),r=Math.random().toString(36).substring(2,8),t=e.name.split(".").pop().toLowerCase();return"".concat(s,"_").concat(a,"_").concat(o,"_").concat(r,".").concat(t)})(e,a,r),c="".concat(a,"/").concat(i),{error:d}=await o.N.storage.from(t.BUCKET_NAME).upload(c,e,{cacheControl:"3600",upsert:!1});if(d)throw console.error("Erro detalhado do upload:",d),new Error("Erro no upload: ".concat(d.message));const{data:{publicUrl:m}}=o.N.storage.from(t.BUCKET_NAME).getPublicUrl(c);return{id:Date.now(),url:c,publicUrl:m,descricao:s.trim()||"Imagem do ".concat(r," da escola ").concat(a),genero:r,created_at:(new Date).toISOString()}}catch(n){throw console.error("Erro no upload da imagem do professor:",n),n}},c=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BUCKET_NAME;try{const{data:s,error:r}=await o.N.storage.from(a).list("".concat(e,"/"));if(r)throw r;if(!s||0===s.length)return[];return s.map(((s,r)=>{const t="".concat(e,"/").concat(s.name),{data:{publicUrl:l}}=o.N.storage.from(a).getPublicUrl(t);return{id:r+1,url:t,publicUrl:l,descricao:"Imagem ".concat(r+1),created_at:s.created_at||(new Date).toISOString()}}))}catch(s){throw console.error("Erro ao buscar imagens da escola:",s),s}},d=async(e,a,s)=>{try{const{error:e}=await o.N.storage.from(s).remove([a]);if(e)throw new Error("Erro ao deletar arquivo: ".concat(e.message))}catch(r){throw console.error("Erro ao deletar imagem:",r),r}},m=async(e,a)=>{try{return{id:e,descricao:a.trim()}}catch(s){throw console.error("Erro ao atualizar descri\xe7\xe3o da imagem:",s),s}},g=async(e,a)=>{try{const s=a===t.BUCKET_NAME?t:r,{data:l,error:n}=await o.N.storage.from(a).list("".concat(e,"/"));if(n)throw n;const i=l?l.length:0;return{current:i,limit:s.MAX_IMAGES_PER_SCHOOL,canUpload:i<s.MAX_IMAGES_PER_SCHOOL}}catch(s){throw console.error("Erro ao verificar limite de imagens:",s),s}}},2481:(e,a,s)=>{s.d(a,{A:()=>o});const o=(0,s(1114).A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]])},4488:(e,a,s)=>{s.d(a,{A:()=>o});const o=(0,s(1114).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4677:(e,a,s)=>{s.d(a,{A:()=>p});var o=s(9379),r=s(5043),t=s(9769),l=s(8590),n=s(6637),i=s(1184),c=s(7669),d=s(4488),m=s(6478),g=s(193),u=s(237),x=s(579);const p=e=>{var a;let{escolaId:s,videoUrl:p,onVideoUrlChange:h,onTitulosUpdate:b}=e;const[f,v]=(0,r.useState)([]),[y,j]=(0,r.useState)(!0),[N,w]=(0,r.useState)(""),[A,E]=(0,r.useState)(""),[_,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)({url:"",titulo:""}),I=(0,r.useCallback)((async()=>{if(s)try{j(!0);const e=(await(0,u.L6)(s)).map((e=>({id:e.id,url:e.video_url,titulo:e.titulo,plataforma:e.plataforma,categoria:e.categoria})));v(e)}catch(e){console.error("Erro ao buscar v\xeddeos:",e),w("Erro ao carregar v\xeddeos")}finally{j(!1)}}),[s]);(0,r.useEffect)((()=>{I()}),[I]),(0,r.useEffect)((()=>{if(N||A){const e=setTimeout((()=>{w(""),E("")}),5e3);return()=>clearTimeout(e)}}),[N,A]);const D=async(e,a)=>{if(a.trim())try{await(0,u.KM)(e,{titulo:a,escola_id:s}),I(),b&&b()}catch(o){console.error("Erro ao atualizar t\xedtulo:",o),w("Erro ao atualizar t\xedtulo")}},U=e=>{if(!e)return"";const a=e.match(/(?:youtu.be\/|youtube.com\/(?:watch\?v=|embed\/|v\/))([\w-]{11})/);if(a)return"https://www.youtube.com/embed/".concat(a[1]);const s=e.match(/vimeo.com\/(\d+)/);return s?"https://player.vimeo.com/video/".concat(s[1]):e};return(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(t.A,{className:"w-5 h-5 text-blue-600"}),(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"V\xeddeo Principal"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo"}),(0,x.jsx)("input",{type:"url",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:p||"",onChange:e=>h(e.target.value),placeholder:"Cole aqui o link do v\xeddeo (YouTube, Vimeo, etc)"}),(0,x.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: https://www.youtube.com/watch?v=..."})]}),p&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo do V\xeddeo"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(a=f.find((e=>e.url===p)))||void 0===a?void 0:a.titulo)||"",onChange:e=>{const a=f.find((e=>e.url===p));a&&D(a.id,e.target.value)},placeholder:"Das crian\xe7as da Aldeia Uru'ity para o mundo"}),(0,x.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Exemplo: "Das crian\xe7as da Aldeia Uru\'ity para o mundo"'})]}),p&&U(p)&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,x.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black rounded-lg overflow-hidden",children:(0,x.jsx)("iframe",{src:U(p),title:"Pr\xe9-visualiza\xe7\xe3o do v\xeddeo",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full"})})]})]}),(0,x.jsxs)("div",{className:"border-t pt-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(l.A,{className:"w-5 h-5 text-green-600"}),(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Outros V\xeddeos"})]}),(0,x.jsxs)("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,x.jsx)(n.A,{className:"w-4 h-4"}),"Adicionar Outro V\xeddeo"]})]}),f.filter((e=>e.url!==p)).length>0&&(0,x.jsx)("div",{className:"space-y-4",children:f.filter((e=>e.url!==p)).map((e=>(0,x.jsxs)("div",{className:"bg-gray-50 border rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo do V\xeddeo"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:e.titulo,onChange:a=>D(e.id,a.target.value),placeholder:"Digite o t\xedtulo do v\xeddeo"})]}),(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja remover este v\xeddeo?"))try{await(0,u.qp)(e),E("V\xeddeo removido com sucesso!"),I(),b&&b()}catch(a){console.error("Erro ao remover v\xeddeo:",a),w("Erro ao remover v\xeddeo")}})(e.id),className:"ml-3 p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remover v\xeddeo",children:(0,x.jsx)(i.A,{className:"w-4 h-4"})})]}),(0,x.jsxs)("div",{className:"mb-3",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo"}),(0,x.jsx)("input",{type:"url",className:"w-full border rounded-lg px-3 py-2 bg-gray-100",value:e.url,disabled:!0})]}),U(e.url)&&(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,x.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black rounded-lg overflow-hidden",children:(0,x.jsx)("iframe",{src:U(e.url),title:e.titulo,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full"})})]})]},e.id)))}),0===f.filter((e=>e.url!==p)).length&&!_&&(0,x.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,x.jsx)(l.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,x.jsx)("p",{children:"Nenhum v\xeddeo adicional adicionado."}),(0,x.jsx)("p",{className:"text-sm",children:'Clique em "Adicionar Outro V\xeddeo" para incluir mais v\xeddeos.'})]}),_&&(0,x.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,x.jsx)("h4",{className:"text-lg font-medium text-blue-800",children:"Adicionar Novo V\xeddeo"}),(0,x.jsx)("button",{onClick:()=>{k(!1),S({url:"",titulo:""})},className:"text-blue-500 hover:text-blue-700",children:(0,x.jsx)(c.A,{className:"w-5 h-5"})})]}),(0,x.jsxs)("form",{onSubmit:async e=>{var a;if(e.preventDefault(),C.url.trim()&&C.titulo.trim())try{if(f.find((e=>e.url===C.url)))return void w("Este v\xeddeo j\xe1 foi adicionado");await(0,u.I5)({video_url:C.url,titulo:C.titulo,plataforma:(a=C.url,a.includes("youtube.com")||a.includes("youtu.be")?"youtube":a.includes("vimeo.com")?"vimeo":a.includes("facebook.com")?"facebook":a.includes("instagram.com")?"instagram":"outro"),categoria:"geral",escola_id:s}),E("V\xeddeo adicionado com sucesso!"),S({url:"",titulo:""}),k(!1),I(),b&&b()}catch(o){console.error("Erro ao adicionar v\xeddeo:",o),w("Erro ao adicionar v\xeddeo")}else w("URL e t\xedtulo s\xe3o obrigat\xf3rios")},className:"space-y-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo *"}),(0,x.jsx)("input",{type:"url",required:!0,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:C.url,onChange:e=>S((0,o.A)((0,o.A)({},C),{},{url:e.target.value})),placeholder:"https://www.youtube.com/watch?v=..."})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo do V\xeddeo *"}),(0,x.jsx)("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:C.titulo,onChange:e=>S((0,o.A)((0,o.A)({},C),{},{titulo:e.target.value})),placeholder:"Digite o t\xedtulo do v\xeddeo"})]}),(0,x.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,x.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,x.jsx)(d.A,{className:"w-4 h-4"}),"Adicionar V\xeddeo"]}),(0,x.jsx)("button",{type:"button",onClick:()=>{k(!1),S({url:"",titulo:""})},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})]})]}),N&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,x.jsx)(m.A,{className:"w-5 h-5 text-red-600"}),(0,x.jsx)("span",{className:"text-red-700",children:N})]}),A&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,x.jsx)(g.A,{className:"w-5 h-5 text-green-600"}),(0,x.jsx)("span",{className:"text-green-700",children:A})]})]})}},6017:(e,a,s)=>{s.r(a),s.d(a,{default:()=>b});var o=s(9379),r=s(5043),t=s(197),l=s(6464),n=s(4562),i=s(8590),c=s(1209),d=s(2065);const m=(0,s(1114).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var g=s(7484),u=s(6208),x=s(4677),p=s(9872),h=s(579);const b=e=>{let{escola:a,onClose:s,onSave:b}=e;const[f,v]=(0,r.useState)((null===a||void 0===a?void 0:a.Escola)||""),[y,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)(""),[A,E]=(0,r.useState)("dados-basicos");console.log("render painel",A);const _=[{id:"dados-basicos",label:"Dados B\xe1sicos",icon:t.A,description:"Informa\xe7\xf5es principais da escola"},{id:"imagens-escola",label:"Imagens da Escola",icon:l.A,description:"Upload e gerenciamento de imagens da escola (m\xe1x. 10)"},{id:"imagens-professores",label:"Imagens dos Professores",icon:n.A,description:"Upload e gerenciamento de imagens dos professores (m\xe1x. 5)"},{id:"video",label:"V\xeddeo",icon:i.A,description:"Link do v\xeddeo e gerenciamento de t\xedtulos"},{id:"localizacao",label:"Localiza\xe7\xe3o",icon:c.A,description:"Coordenadas e endere\xe7o da escola"},{id:"gestao",label:"Gest\xe3o",icon:d.A,description:"Informa\xe7\xf5es sobre gest\xe3o e funcion\xe1rios"},{id:"configuracoes",label:"Configura\xe7\xf5es",icon:m,description:"Configura\xe7\xf5es avan\xe7adas da escola"},{id:"historia-professores",label:"Hist\xf3ria dos Professores",icon:t.A,description:"Gerencie as hist\xf3rias dos professores desta escola"}],k=()=>{console.log("Imagens atualizadas - PainelInformacoes deve ser atualizado")},C=()=>{console.log("T\xedtulos atualizados - PainelInformacoes deve ser atualizado")},S=()=>{switch(A){case"dados-basicos":return(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Escola *"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:f,onChange:e=>v(e.target.value),disabled:y,placeholder:"Digite o nome da escola"})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Munic\xedpio"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a["Munic\xedpio"])||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{"Munic\xedpio":e.target.value})),placeholder:"Nome do munic\xedpio"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terra Ind\xedgena (TI)"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a["Terra Indigena (TI)"])||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{"Terra Indigena (TI)":e.target.value})),placeholder:"Nome da terra ind\xedgena"})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Endere\xe7o"}),(0,h.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",value:(null===a||void 0===a?void 0:a["Endere\xe7o"])||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{"Endere\xe7o":e.target.value})),placeholder:"Endere\xe7o completo da escola"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turnos de Funcionamento"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.turnos_funcionamento)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{turnos_funcionamento:e.target.value})),placeholder:"Ex: Diurno, Noturno, Vespertino, etc."})]})]});case"imagens-escola":return(0,h.jsx)(g.A,{escolaId:null===a||void 0===a?void 0:a.id,onImagesUpdate:k});case"imagens-professores":return(0,h.jsx)(u.A,{escolaId:null===a||void 0===a?void 0:a.id,onImagesUpdate:k});case"video":return(0,h.jsx)(x.A,{escolaId:null===a||void 0===a?void 0:a.id,videoUrl:(null===a||void 0===a?void 0:a.link_para_videos)||"",onVideoUrlChange:e=>b((0,o.A)((0,o.A)({},a),{},{link_para_videos:e})),onTitulosUpdate:C});case"localizacao":return(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),(0,h.jsx)("input",{type:"number",step:"any",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.latitude)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{latitude:parseFloat(e.target.value)||null})),placeholder:"Ex: -23.5505"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),(0,h.jsx)("input",{type:"number",step:"any",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.longitude)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{longitude:parseFloat(e.target.value)||null})),placeholder:"Ex: -46.6333"})]})]}),(0,h.jsx)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,h.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,h.jsx)("strong",{children:"Dica:"})," Use o Google Maps para encontrar as coordenadas exatas da escola. Clique com o bot\xe3o direito no local da escola e selecione as coordenadas."]})})]});case"gestao":return(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gest\xe3o/Nome"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.gestao)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{gestao:e.target.value})),placeholder:"Nome da gest\xe3o atual"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Professor Principal"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.nome_professor)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{nome_professor:e.target.value})),placeholder:"Nome do professor principal"})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Professores Ind\xedgenas"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.professores_indigenas)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{professores_indigenas:e.target.value})),placeholder:"Quantidade ou nomes"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Professores N\xe3o Ind\xedgenas"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===a||void 0===a?void 0:a.professores_nao_indigenas)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{professores_nao_indigenas:e.target.value})),placeholder:"Quantidade ou nomes"})]})]})]});case"infraestrutura":return(0,h.jsx)("div",{className:"space-y-4",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Merenda diferenciada"}),(0,h.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",value:(null===a||void 0===a?void 0:a.merenda_diferenciada)||"",onChange:e=>b((0,o.A)((0,o.A)({},a),{},{merenda_diferenciada:e.target.value})),placeholder:"Descreva a situa\xe7\xe3o do fornecimento de merenda (ex: se a escola recebe, se h\xe1 interrup\xe7\xf5es, etc.)"})]})});case"configuracoes":return(0,h.jsx)("div",{className:"space-y-4",children:(0,h.jsx)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,h.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,h.jsx)("strong",{children:"Configura\xe7\xf5es Avan\xe7adas:"})," Esta se\xe7\xe3o ser\xe1 implementada em breve. Aqui voc\xea poder\xe1 configurar permiss\xf5es, notifica\xe7\xf5es e outras op\xe7\xf5es avan\xe7adas."]})})});case"historia-professores":return(0,h.jsx)("div",{className:"space-y-4",children:(0,h.jsx)(p.A,{escolaId:null===a||void 0===a?void 0:a.id,escolaNome:null===a||void 0===a?void 0:a.Escola})});default:return null}},I="undefined"!==typeof window&&window.innerWidth<=768;return console.log("activeTab",A),(0,h.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 ".concat(I?"p-0":""),style:{padding:I?0:void 0},children:(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[90vh] flex flex-col ".concat(I?"rounded-none h-screen max-w-full":""),style:{width:I?"100vw":"min(100vw, 640px)",height:I?"100vh":"min(90vh, 900px)",maxWidth:I?"100vw":"96vw",maxHeight:I?"100vh":"90vh",overflow:"hidden"},children:[(0,h.jsxs)("div",{className:"flex items-center justify-between ".concat(I?"p-4":"p-6"," border-b"),children:[(0,h.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 ".concat(I?"text-lg":""),children:["Editar Escola: ",(null===a||void 0===a?void 0:a.Escola)||"Nova Escola"]}),(0,h.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 ".concat(I?"w-8 h-8":""),style:I?{fontSize:24}:{},children:(0,h.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,h.jsx)("nav",{className:"flex border-b bg-gray-50 ".concat(I?"overflow-x-auto no-scrollbar":""),style:I?{WebkitOverflowScrolling:"touch",scrollBehavior:"smooth"}:{},role:"tablist","aria-label":"Abas de edi\xe7\xe3o da escola",children:_.map(((e,a)=>{const s=e.icon,o=A===e.id;return(0,h.jsxs)("button",{id:"tab-".concat(e.id),onClick:()=>E(e.id),className:"flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 ".concat(o?"text-blue-700 border-b-4 border-blue-600 bg-white shadow-sm":"text-gray-600 hover:text-blue-700 hover:bg-blue-50"," ").concat(I?"px-2 py-2 text-xs":""),title:e.description,role:"tab","aria-selected":o,"aria-controls":"tabpanel-".concat(e.id),tabIndex:o?0:-1,children:[(0,h.jsx)(s,{className:"w-5 h-5 ".concat(o?"text-blue-700":"text-gray-400")}),(0,h.jsx)("span",{className:"".concat(I?"hidden xs:inline":""),children:e.label})]},e.id)}))}),(0,h.jsx)("div",{className:"flex-1 overflow-y-auto ".concat(I?"p-3":"p-6"),style:I?{fontSize:"1rem"}:{},children:"historia-professores"===A?S():(0,h.jsxs)("form",{onSubmit:async e=>{if(console.log("submit painel"),e.preventDefault(),f.trim()){w(""),j(!0);try{await b((0,o.A)((0,o.A)({},a),{},{Escola:f})),s()}catch(r){w("Erro ao salvar.")}finally{j(!1)}}else w("O nome da escola \xe9 obrigat\xf3rio.")},children:[(0,h.jsx)("div",{className:"min-h-[300px] md:min-h-[400px]",id:"tabpanel-".concat(A),role:"tabpanel","aria-labelledby":"tab-".concat(A),children:S()}),N&&(0,h.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,h.jsx)("p",{className:"text-red-700 text-sm",children:N})}),(0,h.jsxs)("div",{className:"flex gap-3 mt-6 pt-6 border-t border-gray-200 ".concat(I?"flex-col":""),style:I?{gap:8}:{},children:[(0,h.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ".concat(I?"w-full text-base":""),disabled:y,children:y?"Salvando...":"Salvar Altera\xe7\xf5es"}),(0,h.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors ".concat(I?"w-full text-base":""),onClick:s,disabled:y,children:"Cancelar"})]})]})})]})})}},6208:(e,a,s)=>{s.d(a,{A:()=>b});var o=s(9379),r=s(5043),t=s(4562),l=s(6478),n=s(193),i=s(256),c=s(7669),d=s(1184),m=s(4488),g=s(1440),u=s(237),x=s(2880);const p=async e=>{const{data:a,error:s}=await x.N.from("imagens_professores").insert([e]).select().single();if(s)throw s;return a};var h=s(579);const b=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[b,f]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[j,N]=(0,r.useState)(0),[w,A]=(0,r.useState)(""),[E,_]=(0,r.useState)(""),[k,C]=(0,r.useState)([]),[S,I]=(0,r.useState)(!0),[D,U]=(0,r.useState)({current:0,limit:5,canUpload:!0}),[M,L]=(0,r.useState)(null),[P,T]=(0,r.useState)(""),[z,O]=(0,r.useState)("professor"),[q,B]=(0,r.useState)(""),V=(0,r.useCallback)((async()=>{if(a)try{I(!0);const e=await(0,g.Gw)(a,"imagens-professores");C(e);const s=await(0,g.BZ)(a,"imagens-professores");U(s)}catch(e){console.error("Erro ao buscar imagens dos professores:",e),A("Erro ao carregar imagens dos professores")}finally{I(!1)}}),[a]);(0,r.useEffect)((()=>{V()}),[V]),(0,r.useEffect)((()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos (professores)..."),(0,u.iy)())}),[a]),(0,r.useEffect)((()=>{(async()=>{if(!k.length)return;console.log("Buscando legendas para",k.length,"imagens de professores");const e={};for(const s of k){console.log("Buscando legenda para imagem de professor:",s.url);const o=await(0,u.qP)(s.url,a,"professor");console.log("Legenda encontrada para professor:",o),e[s.url]=o}C((a=>a.map((a=>(0,o.A)((0,o.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[k.length,a]),(0,r.useEffect)((()=>{if(w||E){const e=setTimeout((()=>{A(""),_("")}),5e3);return()=>clearTimeout(e)}}),[w,E]);const R=(0,r.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;if(!D.canUpload)return void A("Limite de ".concat(D.limit," imagens dos professores atingido. Remova algumas imagens antes de adicionar novas."));if(k.length+b.length+a.length>D.limit)return void A("Voc\xea pode adicionar no m\xe1ximo ".concat(D.limit-k.length-b.length," imagens dos professores."));const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(f((e=>[...e,...s])),A(""))}),[D,k.length,b.length]),G=(0,r.useCallback)((e=>{e.preventDefault()}),[]),F=(e,a,s)=>{C((r=>r.map((r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{legendaData:(0,o.A)((0,o.A)({},r.legendaData),{},{[a]:s})}):r))))},H=async e=>{console.log("=== DEBUG: Salvando legenda de professor ==="),console.log("Imagem completa:",e);const r=e.url,t=e.legendaData;console.log("URL relativa:",r),console.log("Dados da legenda:",t),console.log("Escola ID:",a);try{console.log("Buscando legenda existente...");let l=await(0,u.qP)(r,a,"professor");if(console.log("Legenda existente encontrada:",l),l){console.log("Atualizando legenda existente...");const e=(0,o.A)((0,o.A)({},t),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",e);const a=await(0,u.w_)(l.id,e);console.log("Legenda de professor atualizada com sucesso:",a)}else{console.log("Criando nova legenda...");const e=(0,o.A)((0,o.A)({escola_id:a,imagem_url:r},t),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"professor"});console.log("Dados para nova legenda:",e);const s=await(0,u.eP)(e);console.log("Nova legenda de professor criada:",s)}console.log("Atualizando metadados da imagem...");let n=await(async(e,a)=>{const{data:s,error:o}=await x.N.from("imagens_professores").select("*").eq("imagem_url",e).eq("escola_id",a).eq("ativo",!0).single();if(o&&"PGRST116"!==o.code)throw o;return s||null})(e.publicUrl,a);n?(console.log("Metadados encontrados:",n),await(async(e,a)=>{const{data:s,error:o}=await x.N.from("imagens_professores").update(a).eq("id",e).select().single();if(o)throw o;return s})(n.id,{autor:t.autor_foto,updated_at:(new Date).toISOString()}),console.log("Metadados atualizados com sucesso")):console.log("Nenhum metadado encontrado para atualizar"),_("Legenda salva com sucesso!"),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(l){console.error("=== ERRO ao salvar legenda de professor ==="),console.error("Erro completo:",l),console.error("Mensagem de erro:",l.message),console.error("Stack trace:",l.stack),A("Erro ao salvar legenda: "+l.message)}};return S?(0,h.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,h.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,h.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,h.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens dos professores..."})]})}):(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(t.A,{className:"w-5 h-5 text-green-600"}),(0,h.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens dos Professores"})]}),(0,h.jsxs)("div",{className:"text-sm text-gray-500",children:[D.current,"/",D.limit," imagens"]})]}),w&&(0,h.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,h.jsx)(l.A,{className:"w-5 h-5 text-red-600"}),(0,h.jsx)("span",{className:"text-red-700",children:w})]}),E&&(0,h.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,h.jsx)(n.A,{className:"w-5 h-5 text-green-600"}),(0,h.jsx)("span",{className:"text-green-700",children:E})]}),D.canUpload&&(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(v?"border-gray-300 bg-gray-50":"border-green-300 bg-green-50 hover:border-green-400 hover:bg-green-100"),onDrop:R,onDragOver:G,children:[(0,h.jsx)(i.A,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),(0,h.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens dos professores aqui ou clique para selecionar"}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo \u2022 M\xe1ximo 5 imagens"}),(0,h.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer transition-colors",children:[(0,h.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;if(!D.canUpload)return void A("Limite de ".concat(D.limit," imagens dos professores atingido. Remova algumas imagens antes de adicionar novas."));if(k.length+b.length+a.length>D.limit)return void A("Voc\xea pode adicionar no m\xe1ximo ".concat(D.limit-k.length-b.length," imagens dos professores."));const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||A('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||A('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(f((e=>[...e,...s])),A(""))},className:"hidden",disabled:v}),"Selecionar Arquivos"]})]}),v&&(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,h.jsx)("span",{children:"Fazendo upload das imagens dos professores..."}),(0,h.jsxs)("span",{children:[Math.round(j),"%"]})]}),(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,h.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(j,"%")}})})]}),b.length>0&&(0,h.jsxs)("div",{className:"space-y-3",children:[(0,h.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",b.length,")"]}),(0,h.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:b.map(((e,a)=>(0,h.jsxs)("div",{className:"relative group",children:[(0,h.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,h.jsx)("button",{onClick:()=>(e=>{f((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,h.jsx)(c.A,{className:"w-3 h-3"})}),(0,h.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,h.jsx)("button",{onClick:async()=>{if(0!==b.length){y(!0),N(0),A("");try{const e=[];for(let s=0;s<b.length;s++){const o=b[s],r=(s+1)/b.length*100;N(r);const t=await(0,g.wG)(o,a,"",z,q);e.push(t),await p({escola_id:a,imagem_url:t.url,nome_arquivo:o.name,autor:"",ativo:!0})}C((a=>[...a,...e])),f([]),N(0),_("".concat(e.length," imagem(ns) do(s) professor(es) carregada(s) com sucesso!"));const o=await(0,g.BZ)(a,"imagens-professores");U(o),s&&s()}catch(e){console.error("Erro no upload:",e),A("Erro ao fazer upload: ".concat(e.message))}finally{y(!1),N(0)}}},disabled:v,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Fazendo Upload...":"Fazer Upload"})]})]}),k.length>0&&(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens dos Professores (",k.length,")"]}),(0,h.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map((e=>{var o,r,t,l,n;return(0,h.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,h.jsxs)("div",{className:"relative group",children:[(0,h.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem do professor",className:"w-full h-48 object-cover"}),(0,h.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,h.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,h.jsx)("button",{onClick:()=>(async(e,o)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem do professor?"))try{await(0,g.vS)(e,o,"imagens-professores"),C((a=>a.filter((a=>a.id!==e))));const r=await(0,g.BZ)(a,"imagens-professores");U(r),_("Imagem do professor exclu\xedda com sucesso!"),s&&s()}catch(r){console.error("Erro ao deletar imagem:",r),A("Erro ao excluir imagem: ".concat(r.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,h.jsx)(d.A,{className:"w-4 h-4"})})})})]}),(0,h.jsxs)("div",{className:"p-4 space-y-2",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(o=e.legendaData)||void 0===o?void 0:o.legenda)||"",onChange:a=>F(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,h.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(r=e.legendaData)||void 0===r?void 0:r.descricao_detalhada)||"",onChange:a=>F(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(t=e.legendaData)||void 0===t?void 0:t.autor_foto)||"",onChange:a=>F(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,h.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(l=e.legendaData)||void 0===l?void 0:l.data_foto)||"",onChange:a=>F(e.id,"data_foto",a.target.value)}),(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,h.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(n=e.legendaData)||void 0===n?void 0:n.categoria)||"",onChange:a=>F(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,h.jsx)("div",{className:"flex gap-2 pt-2",children:(0,h.jsxs)("button",{onClick:()=>H(e),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",type:"button",children:[(0,h.jsx)(m.A,{className:"w-4 h-4"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===k.length&&!v&&(0,h.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,h.jsx)(t.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,h.jsx)("p",{children:"Nenhuma imagem dos professores adicionada ainda."}),(0,h.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar os professores da escola."})]})]})}},6464:(e,a,s)=>{s.d(a,{A:()=>o});const o=(0,s(1114).A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},6637:(e,a,s)=>{s.d(a,{A:()=>o});const o=(0,s(1114).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7484:(e,a,s)=>{s.d(a,{A:()=>p});var o=s(9379),r=s(5043),t=s(6464),l=s(6478),n=s(193),i=s(256),c=s(7669),d=s(1184),m=s(4488),g=s(1440),u=s(237),x=s(579);const p=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[p,h]=(0,r.useState)([]),[b,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)(0),[j,N]=(0,r.useState)(""),[w,A]=(0,r.useState)(""),[E,_]=(0,r.useState)([]),[k,C]=(0,r.useState)(!0),[S,I]=(0,r.useState)({current:0,limit:10,canUpload:!0}),[D,U]=(0,r.useState)(null),[M,L]=(0,r.useState)(""),P=(0,r.useCallback)((async()=>{if(a)try{C(!0);const e=await(0,g.Gw)(a,"imagens-das-escolas");_(e);const s=await(0,g.BZ)(a,"imagens-das-escolas");I(s)}catch(e){console.error("Erro ao buscar imagens:",e),N("Erro ao carregar imagens existentes")}finally{C(!1)}}),[a]);(0,r.useEffect)((()=>{P()}),[P]),(0,r.useEffect)((()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos..."),(0,u.iy)())}),[a]),(0,r.useEffect)((()=>{(async()=>{if(!E.length)return;console.log("Buscando legendas para",E.length,"imagens");const e={};for(const s of E){console.log("Buscando legenda para imagem:",s.url);const o=await(0,u.qP)(s.url,a,"escola");console.log("Legenda encontrada:",o),e[s.url]=o}_((a=>a.map((a=>(0,o.A)((0,o.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[E.length,a]),(0,r.useEffect)((()=>{if(j||w){const e=setTimeout((()=>{N(""),A("")}),5e3);return()=>clearTimeout(e)}}),[j,w]);const T=(0,r.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;if(!S.canUpload)return void N("Limite de ".concat(S.limit," imagens atingido. Remova algumas imagens antes de adicionar novas."));if(E.length+p.length+a.length>S.limit)return void N("Voc\xea pode adicionar no m\xe1ximo ".concat(S.limit-E.length-p.length," imagens."));const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(h((e=>[...e,...s])),N(""))}),[S,E.length,p.length]),z=(0,r.useCallback)((e=>{e.preventDefault()}),[]),O=(e,a,s)=>{_((r=>r.map((r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{legendaData:(0,o.A)((0,o.A)({},r.legendaData),{},{[a]:s})}):r))))};return k?(0,x.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,x.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,x.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens..."})]})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(t.A,{className:"w-5 h-5 text-blue-600"}),(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens da Escola"})]}),(0,x.jsxs)("div",{className:"text-sm text-gray-500",children:[S.current,"/",S.limit," imagens"]})]}),j&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,x.jsx)(l.A,{className:"w-5 h-5 text-red-600"}),(0,x.jsx)("span",{className:"text-red-700",children:j})]}),w&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,x.jsx)(n.A,{className:"w-5 h-5 text-green-600"}),(0,x.jsx)("span",{className:"text-green-700",children:w})]}),S.canUpload&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(b?"border-gray-300 bg-gray-50":"border-blue-300 bg-blue-50 hover:border-blue-400 hover:bg-blue-100"),onDrop:T,onDragOver:z,children:[(0,x.jsx)(i.A,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),(0,x.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens aqui ou clique para selecionar"}),(0,x.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo"}),(0,x.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,x.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;if(!S.canUpload)return void N("Limite de ".concat(S.limit," imagens atingido. Remova algumas imagens antes de adicionar novas."));if(E.length+p.length+a.length>S.limit)return void N("Voc\xea pode adicionar no m\xe1ximo ".concat(S.limit-E.length-p.length," imagens."));const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||N('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||N('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(h((e=>[...e,...s])),N(""))},className:"hidden",disabled:b}),"Selecionar Arquivos"]})]}),b&&(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,x.jsx)("span",{children:"Fazendo upload..."}),(0,x.jsxs)("span",{children:[Math.round(v),"%"]})]}),(0,x.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,x.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(v,"%")}})})]}),p.length>0&&(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",p.length,")"]}),(0,x.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:p.map(((e,a)=>(0,x.jsxs)("div",{className:"relative group",children:[(0,x.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,x.jsx)("button",{onClick:()=>(e=>{h((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,x.jsx)(c.A,{className:"w-3 h-3"})}),(0,x.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,x.jsx)("button",{onClick:async()=>{if(0!==p.length){f(!0),y(0),N("");try{const e=[];for(let s=0;s<p.length;s++){const o=p[s],r=(s+1)/p.length*100;y(r);const t=await(0,g.gE)(o,a);e.push(t)}_((a=>[...a,...e])),h([]),y(0),A("".concat(e.length," imagem(ns) carregada(s) com sucesso!"));const o=await(0,g.BZ)(a,"imagens-das-escolas");I(o),s&&s()}catch(e){console.error("Erro no upload:",e),N("Erro ao fazer upload: ".concat(e.message))}finally{f(!1),y(0)}}},disabled:b,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Fazendo Upload...":"Fazer Upload"})]})]}),E.length>0&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens da Escola (",E.length,")"]}),(0,x.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map((e=>{var r,t,l,n,i;return(0,x.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,x.jsxs)("div",{className:"relative group",children:[(0,x.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem da escola",className:"w-full h-48 object-cover"}),(0,x.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,x.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,x.jsx)("button",{onClick:()=>(async(e,o)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem?"))try{await(0,g.vS)(e,o,"imagens-das-escolas"),_((a=>a.filter((a=>a.id!==e))));const r=await(0,g.BZ)(a,"imagens-das-escolas");I(r),A("Imagem exclu\xedda com sucesso!"),s&&s()}catch(r){console.error("Erro ao deletar imagem:",r),N("Erro ao excluir imagem: ".concat(r.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,x.jsx)(d.A,{className:"w-4 h-4"})})})})]}),(0,x.jsxs)("div",{className:"p-4 space-y-2",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(r=e.legendaData)||void 0===r?void 0:r.legenda)||"",onChange:a=>O(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,x.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(t=e.legendaData)||void 0===t?void 0:t.descricao_detalhada)||"",onChange:a=>O(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(l=e.legendaData)||void 0===l?void 0:l.autor_foto)||"",onChange:a=>O(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,x.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(n=e.legendaData)||void 0===n?void 0:n.data_foto)||"",onChange:a=>O(e.id,"data_foto",a.target.value)}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(i=e.legendaData)||void 0===i?void 0:i.categoria)||"",onChange:a=>O(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,x.jsx)("div",{className:"flex gap-2 pt-2",children:(0,x.jsxs)("button",{onClick:()=>(async e=>{console.log("=== DEBUG: Salvando legenda ==="),console.log("Imagem completa:",e);const r=e.url,t=e.legendaData;console.log("URL relativa:",r),console.log("Dados da legenda:",t),console.log("Escola ID:",a);try{console.log("Buscando legenda existente...");let e=await(0,u.qP)(r,a,"escola");if(console.log("Legenda existente encontrada:",e),e){console.log("Atualizando legenda existente...");const a=(0,o.A)((0,o.A)({},t),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",a);const s=await(0,u.w_)(e.id,a);console.log("Legenda atualizada com sucesso:",s)}else{console.log("Criando nova legenda...");const e=(0,o.A)((0,o.A)({escola_id:a,imagem_url:r},t),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"escola"});console.log("Dados para nova legenda:",e);const s=await(0,u.eP)(e);console.log("Nova legenda criada:",s)}A("Legenda salva com sucesso!"),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(l){console.error("=== ERRO ao salvar legenda ==="),console.error("Erro completo:",l),console.error("Mensagem de erro:",l.message),console.error("Stack trace:",l.stack),N("Erro ao salvar legenda: "+l.message)}})(e),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",type:"button",children:[(0,x.jsx)(m.A,{className:"w-4 h-4"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===E.length&&!b&&(0,x.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,x.jsx)(t.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,x.jsx)("p",{children:"Nenhuma imagem adicionada ainda."}),(0,x.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar a escola."})]})]})}},8590:(e,a,s)=>{s.d(a,{A:()=>o});const o=(0,s(1114).A)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]])},9872:(e,a,s)=>{s.d(a,{A:()=>b});var o=s(9379),r=s(5043),t=s(197),l=s(6637),n=s(1114);const i=(0,n.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),c=(0,n.A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),d=(0,n.A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var m=s(2481),g=s(1184),u=s(7669),x=s(4488),p=s(2006),h=s(579);const b=e=>{let{escolaId:a,escolaNome:s}=e;console.log("render historia manager",{escolaId:a,escolaNome:s});const[n,b]=(0,r.useState)([]),[f,v]=(0,r.useState)(!0),[y,j]=(0,r.useState)(null),[N,w]=(0,r.useState)(!1),[A,E]=(0,r.useState)(null),[_,k]=(0,r.useState)(null),[C,S]=(0,r.useState)(""),[I,D]=(0,r.useState)({nome_professor:"",historia:"",ordem:1,ativo:!0}),U=async()=>{try{v(!0),j(null);const e=await(0,p.Y8)(a);b(e)}catch(e){j(e.message)}finally{v(!1)}};(0,r.useEffect)((()=>{a&&U()}),[a]);const M=()=>{D({nome_professor:"",historia:"",ordem:1,ativo:!0}),E(null),w(!1)},L=async(e,a)=>{const s=n.findIndex((a=>a.id===e));if(-1===s)return;const o=[...n],r="up"===a?s-1:s+1;if(r<0||r>=o.length)return;[o[s],o[r]]=[o[r],o[s]];const t=o.map(((e,a)=>({id:e.id,ordem:a+1})));try{for(const e of t)await(0,p.e0)(e.id,{ordem:e.ordem});S("Ordem atualizada com sucesso!"),U()}catch(l){j(l.message)}};return f?(0,h.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,h.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,h.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,h.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando hist\xf3rias do professor..."})]})}):(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3",children:[(0,h.jsx)(t.A,{className:"w-6 h-6 text-green-700"}),(0,h.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Hist\xf3rias do Professor - ",s]})]}),(0,h.jsxs)("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,h.jsx)(l.A,{className:"w-4 h-4"}),"Nova Hist\xf3ria"]})]}),y&&(0,h.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,h.jsx)("p",{className:"text-red-600",children:y})}),C&&(0,h.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,h.jsx)("p",{className:"text-green-600",children:C})}),(0,h.jsx)("div",{className:"space-y-4",children:0===n.length?(0,h.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,h.jsx)(t.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,h.jsx)("p",{className:"text-gray-500",children:"Nenhuma hist\xf3ria do professor cadastrada."}),(0,h.jsx)("button",{onClick:()=>w(!0),className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Criar primeira hist\xf3ria"})]}):n.map(((e,a)=>(console.log("Renderizando hist\xf3ria:",e),(0,h.jsx)("div",{className:"p-6 bg-white rounded-lg border ".concat(e.ativo?"":"opacity-60"),children:(0,h.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,h.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["#",e.ordem]}),e.nome_professor&&(0,h.jsx)("h4",{className:"font-medium text-gray-900",children:e.nome_professor}),!e.ativo&&(0,h.jsxs)("span",{className:"flex items-center gap-1 text-orange-600 text-sm",children:[(0,h.jsx)(i,{className:"w-4 h-4"}),"Inativa"]})]}),(0,h.jsx)("p",{className:"text-gray-700 line-clamp-3",children:e.historia})]}),(0,h.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,h.jsx)("button",{onClick:()=>L(e.id,"up"),disabled:0===a,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Mover para cima",children:(0,h.jsx)(c,{className:"w-4 h-4"})}),(0,h.jsx)("button",{onClick:()=>L(e.id,"down"),disabled:a===n.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Mover para baixo",children:(0,h.jsx)(d,{className:"w-4 h-4"})}),(0,h.jsx)("button",{onClick:()=>{console.log("CLICOU NO BOT\xc3O EDITAR",e),(e=>{console.log("Entrou em handleEdit:",e),E(e),D({nome_professor:e.nome_professor||"",historia:e.historia,ordem:e.ordem,ativo:e.ativo}),w(!0)})(e)},className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg",title:"Editar",children:(0,h.jsx)(m.A,{className:"w-4 h-4"})}),(0,h.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir esta hist\xf3ria?"))try{await(0,p.g2)(e),S("Hist\xf3ria exclu\xedda com sucesso!"),U()}catch(a){j(a.message)}})(e.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg",title:"Excluir",children:(0,h.jsx)(g.A,{className:"w-4 h-4"})})]})]})},e.id))))}),N&&(0,h.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[A?console.log("Abrindo formul\xe1rio de edi\xe7\xe3o:",A):console.log("Abrindo formul\xe1rio de cria\xe7\xe3o"),(0,h.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,h.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:A?"Editar Hist\xf3ria":"Nova Hist\xf3ria"}),(0,h.jsx)("button",{onClick:M,className:"text-gray-400 hover:text-gray-600",children:(0,h.jsx)(u.A,{className:"w-5 h-5"})})]}),(0,h.jsxs)("form",{onSubmit:async e=>{if(console.log("\ud83d\udd0d SUBMIT CHAMADO - ID:",null===A||void 0===A?void 0:A.id),console.log("\ud83d\udcdd Evento recebido:",e),console.log("\ud83d\udcdd Evento type:",e.type),console.log("\ud83d\udcdd Evento target:",e.target),e.preventDefault(),console.log("\u2705 preventDefault executado"),console.log("submit historia",A),!I.nome_professor.trim())return void j("O nome do professor \xe9 obrigat\xf3rio.");if(!I.historia.trim())return void j("A hist\xf3ria \xe9 obrigat\xf3ria");const s={escola_id:Number(a),nome_professor:I.nome_professor.trim(),historia:I.historia.trim(),ordem:Number(I.ordem)||1,ativo:Boolean(I.ativo)};A&&console.log("Payload enviado para updateHistoriaProfessor:",s),console.log("Payload enviado para createHistoriaProfessor:",s);try{j(""),S(""),A?(await(0,p.e0)(A.id,s),S("Hist\xf3ria atualizada com sucesso!")):(await(0,p.lz)(s),S("Hist\xf3ria criada com sucesso!")),M(),U()}catch(o){j(o.message),console.log("ERRO AO CRIAR/EDITAR HIST\xd3RIA:",o)}},className:"space-y-4",children:[(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Professor *"}),(0,h.jsx)("input",{type:"text",value:I.nome_professor,onChange:e=>D((0,o.A)((0,o.A)({},I),{},{nome_professor:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Nome do professor",required:!0})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ordem"}),(0,h.jsx)("input",{type:"number",min:"1",value:I.ordem,onChange:e=>D((0,o.A)((0,o.A)({},I),{},{ordem:parseInt(e.target.value)||1})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hist\xf3ria *"}),(0,h.jsx)("textarea",{value:I.historia,onChange:e=>D((0,o.A)((0,o.A)({},I),{},{historia:e.target.value})),rows:6,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Digite a hist\xf3ria do professor...",required:!0})]}),(0,h.jsx)("div",{className:"flex items-center gap-4",children:(0,h.jsxs)("label",{className:"flex items-center gap-2",children:[(0,h.jsx)("input",{type:"checkbox",checked:I.ativo,onChange:e=>D((0,o.A)((0,o.A)({},I),{},{ativo:e.target.checked})),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,h.jsx)("span",{className:"text-sm text-gray-700",children:"Ativa"})]})}),(0,h.jsxs)("div",{className:"flex gap-3",children:[(0,h.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,h.jsx)(x.A,{className:"w-4 h-4"}),A?"Atualizar":"Criar"]}),(0,h.jsx)("button",{type:"button",onClick:M,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})]})}}}]);
//# sourceMappingURL=17.d67b13a1.chunk.js.map