"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[423],{83879:(e,a,s)=>{s.r(a),s.d(a,{default:()=>wa});var r=s(89379),o=s(65043),t=s(52480),n=s(79750),i=s(5452);class l{static async obterAutorAtual(){try{if(!await n.u.isAuthenticated())return null;const e=await n.u.getCurrentUser();return(null===e||void 0===e?void 0:e.username)||"admin"}catch(e){return i.A.warn("Erro ao obter autor atual:",e),null}}static async registrarVersaoDados(e){let{nomeTabela:a,chaveLinha:s,nomeCampo:r=null,fonteId:o=null,autor:n=null,observacoes:l=null}=e;try{if(!a||""===a.trim())throw new Error("nomeTabela \xe9 obrigat\xf3rio");if(!s||""===s.toString().trim())throw new Error("chaveLinha \xe9 obrigat\xf3rio");let e=n;e||(e=await this.obterAutorAtual());const d={nome_tabela:a.trim(),chave_linha:s.toString().trim(),autor:e,criado_em:(new Date).toISOString()};r&&""!==r.trim()&&(d.nome_campo=r.trim()),o&&(d.fonte_id=o),l&&""!==l.trim()&&(d.observacoes=l.trim());const{data:c,error:m}=await t.N.from("versoes_dados").insert(d).select().single();if(m)throw i.A.error("Erro ao registrar vers\xe3o de dados:",m),m;return{success:!0,data:c}}catch(d){return i.A.error("Erro no servi\xe7o de versionamento:",d),{success:!1,error:d.message||"Erro ao registrar vers\xe3o de dados"}}}static async buscarFontesDados(){try{const{data:e,error:a}=await t.N.from("fontes_dados").select("id, nome, descricao").order("nome",{ascending:!0});if(a)throw a;return{success:!0,data:e||[]}}catch(e){return i.A.error("Erro ao buscar fontes de dados:",e),{success:!1,error:e.message||"Erro ao buscar fontes de dados",data:[]}}}static async buscarVersoesPorLinha(e,a){try{const{data:s,error:r}=await t.N.from("versoes_dados").select("\n          id,\n          nome_tabela,\n          chave_linha,\n          autor,\n          observacoes,\n          criado_em,\n          fonte_id,\n          fontes_dados:nome,\n          fontes_dados:descricao\n        ").eq("nome_tabela",e).eq("chave_linha",a.toString()).order("criado_em",{ascending:!1});if(r)throw r;return{success:!0,data:s||[]}}catch(s){return i.A.error("Erro ao buscar vers\xf5es:",s),{success:!1,error:s.message||"Erro ao buscar vers\xf5es",data:[]}}}}const d=()=>{const[e,a]=(0,o.useState)([]),[s,n]=(0,o.useState)(!0),[d,c]=(0,o.useState)(null),[m,u]=(0,o.useState)(""),[g,x]=(0,o.useState)("todos"),b=(0,o.useCallback)(async()=>{try{n(!0),c(null);const{data:e,error:s}=await t.N.from("escolas_completa").select("*").order("Escola",{ascending:!0});if(s)throw s;const o=e.map(e=>(0,r.A)((0,r.A)({},e),{},{logradouro:e.logradouro||"",numero:e.numero||"",complemento:e.complemento||"",bairro:e.bairro||"",cep:e.cep||"",estado:e.estado||"SP"}));a(o)}catch(e){i.A.error("Erro ao buscar escolas:",e),c(e.message)}finally{n(!1)}},[]),h=(0,o.useCallback)((e,s)=>{a(a=>a.map(a=>a.id===e?(0,r.A)((0,r.A)({},a),s):a))},[]),p=(0,o.useCallback)(e=>{a(a=>[...a,e])},[]),f=(0,o.useCallback)(e=>{a(a=>a.filter(a=>a.id!==e))},[]),v=(0,o.useCallback)(a=>e.find(e=>e.id===a),[e]),y=(0,o.useCallback)(a=>e.find(e=>{var s;return(null===(s=e.Escola)||void 0===s?void 0:s.toLowerCase())===a.toLowerCase()}),[e]),j=(0,o.useCallback)(async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(c(null),e.id){const{data:r,error:o}=await t.N.from("escolas_completa").update({Escola:e.Escola,"Munic\xedpio":e["Munic\xedpio"],"Endere\xe7o":e["Endere\xe7o"],"Terra Indigena (TI)":e["Terra Indigena (TI)"],"Escola Estadual ou Municipal":e["Escola Estadual ou Municipal"],"Parcerias com o munic\xedpio":e["Parcerias com o munic\xedpio"],"Diretoria de Ensino":e["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":e["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":e["Povos indigenas"],"Linguas faladas":e["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":e["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":e["Numero de alunos"],turnos_funcionamento:e.turnos_funcionamento,"Espa\xe7o escolar e estrutura":e["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":e["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":e["Tem coleta de lixo?"],"Acesso \xe0 internet":e["Acesso \xe0 internet"],"Equipamentos Tecs":e["Equipamentos Tecs"],"Modo de acesso \xe0 escola":e["Modo de acesso \xe0 escola"],"Gest\xe3o/Nome":e["Gest\xe3o/Nome"],"Outros funcion\xe1rios":e["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":e["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":e["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":e["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":e["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":e["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":e["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":e["PPP elaborado com a comunidade?"],"Material pedag\xf3gico n\xe3o ind\xedgena":e["Material pedag\xf3gico n\xe3o ind\xedgena"],"Material pedag\xf3gico ind\xedgena":e["Material pedag\xf3gico ind\xedgena"],"Pr\xe1ticas pedag\xf3gicas ind\xedgenas":e["Pr\xe1ticas pedag\xf3gicas ind\xedgenas"],"Formas de avalia\xe7\xe3o":e["Formas de avalia\xe7\xe3o"],"Projetos em andamento":e["Projetos em andamento"],"Parcerias com universidades?":e["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":e["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":e["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":e["Escola utiliza redes sociais?"],"Links das redes sociais":e["Links das redes sociais"],historia_da_escola:e.historia_da_escola,Latitude:e.Latitude,Longitude:e.Longitude,link_para_videos:e.link_para_videos,logradouro:e.logradouro,numero:e.numero,complemento:e.complemento,bairro:e.bairro,cep:e.cep,estado:e.estado,Cozinha:e.cozinha,Merenda_escolar:e.merenda_escolar,diferenciada:e.diferenciada,imagem_header:e.imagem_header,cards_visibilidade:e.cards_visibilidade||null}).eq("id",e.id).select();if(o)throw o;if(h(e.id,r[0]),null!==a)try{await l.registrarVersaoDados({nomeTabela:"escolas_completa",chaveLinha:e.id.toString(),fonteId:(null===a||void 0===a?void 0:a.fonte_id)||null,autor:(null===a||void 0===a?void 0:a.autor)||null,observacoes:(null===a||void 0===a?void 0:a.observacoes)||null})}catch(s){i.A.warn("Erro ao registrar vers\xe3o de dados (n\xe3o cr\xedtico):",s)}return{success:!0,data:r[0]}}{const{data:r,error:o}=await t.N.from("escolas_completa").insert({Escola:e.Escola,"Munic\xedpio":e["Munic\xedpio"],"Endere\xe7o":e["Endere\xe7o"],"Terra Indigena (TI)":e["Terra Indigena (TI)"],"Escola Estadual ou Municipal":e["Escola Estadual ou Municipal"],"Parcerias com o munic\xedpio":e["Parcerias com o munic\xedpio"],"Diretoria de Ensino":e["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":e["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":e["Povos indigenas"],"Linguas faladas":e["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":e["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":e["Numero de alunos"],turnos_funcionamento:e.turnos_funcionamento,"Espa\xe7o escolar e estrutura":e["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":e["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":e["Tem coleta de lixo?"],"Acesso \xe0 internet":e["Acesso \xe0 internet"],"Equipamentos Tecs":e["Equipamentos Tecs"],"Modo de acesso \xe0 escola":e["Modo de acesso \xe0 escola"],"Gest\xe3o/Nome":e["Gest\xe3o/Nome"],"Outros funcion\xe1rios":e["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":e["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":e["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":e["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":e["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":e["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":e["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":e["PPP elaborado com a comunidade?"],"Material pedag\xf3gico n\xe3o ind\xedgena":e["Material pedag\xf3gico n\xe3o ind\xedgena"],"Material pedag\xf3gico ind\xedgena":e["Material pedag\xf3gico ind\xedgena"],"Pr\xe1ticas pedag\xf3gicas ind\xedgenas":e["Pr\xe1ticas pedag\xf3gicas ind\xedgenas"],"Formas de avalia\xe7\xe3o":e["Formas de avalia\xe7\xe3o"],"Projetos em andamento":e["Projetos em andamento"],"Parcerias com universidades?":e["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":e["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":e["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":e["Escola utiliza redes sociais?"],"Links das redes sociais":e["Links das redes sociais"],historia_da_escola:e.historia_da_escola,Latitude:e.Latitude,Longitude:e.Longitude,link_para_videos:e.link_para_videos,logradouro:e.logradouro,numero:e.numero,complemento:e.complemento,bairro:e.bairro,cep:e.cep,estado:e.estado,Cozinha:e.cozinha,Merenda_escolar:e.merenda_escolar,diferenciada:e.diferenciada,imagem_header:e.imagem_header,cards_visibilidade:e.cards_visibilidade||null}).select();if(o)throw o;if(p(r[0]),null!==a)try{await l.registrarVersaoDados({nomeTabela:"escolas_completa",chaveLinha:r[0].id.toString(),fonteId:(null===a||void 0===a?void 0:a.fonte_id)||null,autor:(null===a||void 0===a?void 0:a.autor)||null,observacoes:(null===a||void 0===a?void 0:a.observacoes)||null})}catch(s){i.A.warn("Erro ao registrar vers\xe3o de dados (n\xe3o cr\xedtico):",s)}return{success:!0,data:r[0]}}}catch(r){return i.A.error("Erro ao salvar escola:",r),c(r.message),{success:!1,error:r.message}}},[h,p]),N=(0,o.useCallback)(async e=>{try{c(null);const{error:a}=await t.N.from("escolas_completa").delete().eq("id",e);if(a)throw a;return f(e),{success:!0}}catch(a){return i.A.error("Erro ao deletar escola:",a),c(a.message),{success:!1,error:a.message}}},[f]);return(0,o.useEffect)(()=>{b()},[b]),{escolas:e,loading:s,error:d,searchTerm:m,selectedType:g,setSearchTerm:u,setSelectedType:x,fetchEscolas:b,updateEscolaInList:h,addEscolaToList:p,removeEscolaFromList:f,saveEscola:j,deleteEscola:N,getEscolaById:v,getEscolaByName:y}},c=["Educa\xe7\xe3o Infantil","Educa\xe7\xe3o Infantil (Idade 0 a 6 anos)","Educa\xe7\xe3o Infantil (Pr\xe9-escola I e II) \u2013 1 sala multisseriada","Educa\xe7\xe3o Infantil (Pr\xe9-escola I) \u2013 1 sala regular","Educa\xe7\xe3o Infantil + Ensino Fundamental \u2013 multisseriado","Educa\xe7\xe3o Infantil + Ensino Fundamental \u2013 regular e multisseriado","Educa\xe7\xe3o Infantil + Ensino Fundamental","Educa\xe7\xe3o Infantil + Ensino Fundamental (Anos Iniciais e Anos Finais)","Educa\xe7\xe3o Infantil + Ensino Fundamental (Anos Iniciais multisseriado + Anos Finais multisseriado)","Educa\xe7\xe3o Infantil + Ensino Fundamental (1\xba ao 9\xba ano) \u2013 Salas multisseriadas","Educa\xe7\xe3o Infantil + Ensino Fundamental (Pr\xe9 I + 1\xba ao 4\xba ano) \u2013 1 sala multisseriada","Educa\xe7\xe3o Infantil + Ensino Fundamental com EJA \u2013 Multisseriado","Ensino Fundamental Anos Iniciais (1\xba ao 3\xba)","Ensino Fundamental Anos Iniciais (1\xba ao 5\xba ano) \u2013 1 sala multisseriada","Ensino Fundamental Anos Iniciais (4\xba e 5\xba ano) \u2013 1 sala multisseriada","Ensino Fundamental Anos Iniciais \u2013 EJA (1\xba ao 5\xba ano) \u2013 multisseriado","Ensino Fundamental Anos Finais (6\xba ao 9\xba ano) \u2013 1 sala multisseriada","Ensino Fundamental Anos Finais \u2013 EJA (6\xba ao 9\xba ano) \u2013 multisseriado","Ensino Fundamental (Anos Iniciais e Finais) \u2013 regular e multisseriado","Ensino Fundamental \u2013 Atendimento tempor\xe1rio em escola n\xe3o ind\xedgena","Ensino M\xe9dio (1\xba ao 3\xba ano) \u2013 regular","Ensino M\xe9dio (1\xba ao 3\xba ano) \u2013 multisseriado","Ensino M\xe9dio \u2013 EJA (1\xba ao 3\xba ano) \u2013 multisseriado","Ensino M\xe9dio \u2013 N\xe3o h\xe1 atendimento"],m=[{id:"educacao-infantil",titulo:"1. Educa\xe7\xe3o Infantil",indices:[0,1,2,3,4,5]},{id:"educacao-infantil-fundamental",titulo:"2. Educa\xe7\xe3o Infantil + Ensino Fundamental",indices:[6,7,8,9,10,11,12]},{id:"ensino-fundamental",titulo:"3. Ensino Fundamental",indices:[13,14,15,16,17,18,19,20]},{id:"ensino-medio",titulo:"4. Ensino M\xe9dio",indices:[21,22,23,24]}],u=()=>{const[e,a]=(0,o.useState)([]),[s,r]=(0,o.useState)(""),t=(0,o.useCallback)(e=>{a(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},[]),n=(0,o.useCallback)(e=>{r(e),a(a=>{const s=a.some(e=>e.startsWith("Outro:"));return e.trim()?s?a.map(a=>a.startsWith("Outro:")?"Outro: ".concat(e):a):[...a,"Outro: ".concat(e)]:a.filter(e=>!e.startsWith("Outro:"))})},[]),i=(0,o.useCallback)(()=>e.join("; "),[e]),l=(0,o.useCallback)(e=>{if(!e)return a([]),void r("");const s=e.split(";").map(e=>e.trim()),o=[];let t="";s.forEach(e=>{e.startsWith("Outro:")?(t=e.replace("Outro:","").trim(),o.push(e)):c.includes(e)?o.push(e):e&&(t=e,o.push("Outro: ".concat(e)))}),a(o),r(t)},[]),d=(0,o.useCallback)(()=>{a([]),r("")},[]),m=(0,o.useCallback)(()=>e.join("; ")||"Nenhuma modalidade selecionada",[e]),u=(0,o.useCallback)(()=>e.length>0,[e]);return{selectedModalidades:e,outroModalidade:s,handleModalidadeChange:t,handleOutroModalidadeChange:n,saveModalidades:i,loadExistingModalidades:l,clearModalidades:d,getModalidadesPreview:m,hasSelectedModalidades:u}};var g=s(80074);const x=[{id:"dados-basicos",label:"Dados B\xe1sicos"},{id:"povos-linguas",label:"Povos"},{id:"modalidades",label:"Modalidades"},{id:"infraestrutura",label:"Infraestrutura"},{id:"gestao-professores",label:"Gestores"},{id:"material-pedagogico",label:"Material Pedag\xf3gico"},{id:"projetos-parcerias",label:"Projetos e Parcerias"},{id:"redes-sociais",label:"Redes Sociais"},{id:"video",label:"V\xeddeo"},{id:"historias",label:"Hist\xf3rias"},{id:"historia-professores",label:"Hist\xf3ria dos Professores"},{id:"coordenadas",label:"Coordenadas"},{id:"imagens-escola",label:"Imagens da Escola"},{id:"imagens-professores",label:"Imagens dos Professores"},{id:"documentos",label:"Documentos"}],b=g.LO.mobile,h=72,p="dados-basicos";var f=s(77986),v=s(7669),y=s(86953),j=s(70579);const N=e=>{let{isMobile:a,sidebarOpen:s,setSidebarOpen:r,editingLocation:o,onEscolaSelect:t,searchTerm:n,setSearchTerm:i,filteredEscolas:l}=e;return(0,j.jsxs)(j.Fragment,{children:[a&&s&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-30",onClick:()=>r(!1)}),a&&!s&&(0,j.jsx)("button",{className:"fixed top-4 left-4 z-50 bg-gray-900/90 backdrop-blur-sm rounded-full shadow-lg p-3 border border-gray-800/50 hover:bg-gray-800/90 transition-all duration-200",onClick:()=>r(!0),"aria-label":"Abrir menu lateral",children:(0,j.jsx)(f.A,{className:"w-6 h-6 text-gray-200"})}),(!a||s)&&(0,j.jsxs)("aside",{className:"bg-gray-900/95 backdrop-blur-sm border-r border-gray-800/50 rounded-r-2xl shadow-2xl p-6 overflow-y-auto h-screen sticky top-0 z-40 transition-all duration-300 ".concat(a?"fixed left-0 top-0 w-80 max-w-[85vw] shadow-2xl":"w-80"),style:{transform:a&&!s?"translateX(-100%)":"translateX(0)",top:a?0:h},children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-2xl font-bold tracking-wide text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-emerald-300 uppercase",children:"Escolas"}),(0,j.jsxs)("p",{className:"text-gray-400 text-sm mt-1",children:[l.length," escola",1!==l.length?"s":""]})]}),a&&(0,j.jsx)("button",{className:"text-gray-400 hover:text-gray-200 hover:bg-gray-800 rounded-lg p-2 transition-colors",onClick:()=>r(!1),"aria-label":"Fechar menu lateral",children:(0,j.jsx)(v.A,{className:"w-5 h-5"})})]}),(0,j.jsx)("div",{className:"mb-6",children:(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)(y.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,j.jsx)("input",{type:"text",placeholder:"Buscar escola...",className:"w-full pl-10 pr-4 py-3 border border-gray-700/50 rounded-xl text-sm bg-gray-800/50 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-all duration-200 backdrop-blur-sm",value:n,onChange:e=>i(e.target.value)})]})}),(0,j.jsx)("div",{className:"space-y-2",children:l.length>0?l.map(e=>(0,j.jsx)("button",{className:"w-full text-left p-4 rounded-xl hover:bg-gray-800/50 transition-all duration-200 border border-transparent hover:border-gray-700/50 ".concat((null===o||void 0===o?void 0:o.id)===e.id?"bg-gradient-to-r from-green-600/20 to-green-700/20 border-green-500/50 text-white shadow-lg":"text-gray-200 hover:text-white"),onClick:()=>{t(e),a&&r(!1)},children:(0,j.jsxs)("div",{className:"flex items-start justify-between",children:[(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsx)("h3",{className:"font-medium truncate ".concat((null===o||void 0===o?void 0:o.id)===e.id?"text-green-300":"text-gray-200"),children:e.Escola}),e["Munic\xedpio"]&&(0,j.jsx)("p",{className:"text-sm text-gray-400 truncate mt-1",children:e["Munic\xedpio"]})]}),(null===o||void 0===o?void 0:o.id)===e.id&&(0,j.jsx)("div",{className:"ml-2 flex-shrink-0",children:(0,j.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full"})})]})},e.id)):n?(0,j.jsxs)("div",{className:"text-center py-8",children:[(0,j.jsx)("div",{className:"w-16 h-16 bg-gray-800/50 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,j.jsx)(y.A,{className:"w-8 h-8 text-gray-400"})}),(0,j.jsx)("p",{className:"text-gray-400 text-sm",children:"Nenhuma escola encontrada"}),(0,j.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Tente ajustar sua busca"})]}):(0,j.jsxs)("div",{className:"text-center py-8",children:[(0,j.jsx)("div",{className:"w-16 h-16 bg-gray-800/50 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,j.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,j.jsx)("p",{className:"text-gray-400 text-sm",children:"Nenhuma escola dispon\xedvel"})]})}),(0,j.jsx)("div",{className:"mt-auto pt-6 border-t border-gray-800/50",children:(0,j.jsx)("div",{className:"text-center",children:(0,j.jsxs)("p",{className:"text-gray-500 text-xs",children:["Opin - desenvolvido por ",(0,j.jsx)("a",{href:"https://hericmr.github.io/me/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-gray-400",children:"Heric mr"})]})})})]})]})},w=e=>{let{searchTerm:a,setSearchTerm:s,selectedType:r,setSelectedType:o,onNovaEscola:t}=e;return null};var A=s(30342),E=s(47808),k=s(79732),C=s(56478),_=s(22651);const L=e=>{let{isOpen:a,onClose:s,onSuccess:r}=e;const[t,i]=(0,o.useState)(""),[l,d]=(0,o.useState)(!1),[c,m]=(0,o.useState)(!1),[u,g]=(0,o.useState)(""),[x,b]=(0,o.useState)(""),[h,p]=(0,o.useState)(0),[f,y]=(0,o.useState)(!1),[N,w]=(0,o.useState)(0),A=(0,o.useRef)(null);(0,o.useEffect)(()=>{a&&(i(""),g(""),b(""),d(!1),setTimeout(()=>{A.current&&A.current.focus()},100))},[a]),(0,o.useEffect)(()=>{if(f&&N>0){const e=setTimeout(()=>{w(e=>e-1)},1e3);return 1===N&&(y(!1),w(0),p(0)),()=>clearTimeout(e)}},[f,N]);const L=()=>{c||(i(""),g(""),b(""),d(!1),s())};return a?(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",onClick:e=>e.target===e.currentTarget&&L(),onKeyDown:e=>{"Escape"===e.key&&L()},tabIndex:-1,children:(0,j.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-2xl border border-gray-800 max-w-sm w-full",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,j.jsx)("h3",{className:"text-lg font-medium text-gray-100",children:"Acesso Administrativo"}),(0,j.jsx)("button",{onClick:L,className:"p-1 hover:bg-gray-800 rounded transition-colors",disabled:c,children:(0,j.jsx)(v.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,j.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),!f)if(t.trim()){m(!0),g(""),b("");try{const e=await n.u.authenticate(t);if(e.success)n.u.setToken(e.token),b("Login realizado com sucesso!"),setTimeout(()=>{r(e.user),s()},1e3);else{const a=h+1;p(a),a>=3?(y(!0),w(30),g("Muitas tentativas. Aguarde 30 segundos.")):g(e.error||"Erro na autentica\xe7\xe3o")}}catch(a){console.error("Erro no login:",a),g("Erro interno. Tente novamente.")}finally{m(!1)}}else g("Por favor, digite a senha")},className:"p-4",children:(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Senha"}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("input",{ref:A,type:l?"text":"password",value:t,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 pr-10 bg-gray-800 border border-gray-600 rounded-md text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",placeholder:"Digite sua senha...",disabled:c||f,autoComplete:"current-password"}),(0,j.jsx)("button",{type:"button",onClick:()=>d(!l),className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1 hover:bg-gray-700 rounded transition-colors",disabled:c||f,children:l?(0,j.jsx)(E.A,{className:"w-4 h-4 text-gray-400"}):(0,j.jsx)(k.A,{className:"w-4 h-4 text-gray-400"})})]}),t&&(0,j.jsxs)("div",{className:"mt-2 flex items-center gap-1",children:[(0,j.jsx)("span",{className:"text-xs text-gray-500",children:"Caracteres:"}),(0,j.jsx)("div",{className:"flex gap-1",children:t.split("").map((e,a)=>(0,j.jsx)("span",{className:"text-lg font-mono text-gray-300",children:l?e:"\u2022"},a))}),(0,j.jsxs)("span",{className:"text-xs text-gray-400 ml-2",children:["(",t.length,")"]})]})]}),h>0&&h<3&&(0,j.jsxs)("div",{className:"text-sm text-orange-400",children:["Tentativas: ",h,"/3"]}),f&&(0,j.jsxs)("div",{className:"text-sm text-red-400",children:["Bloqueado por ",N," segundos"]}),u&&(0,j.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-red-900/30 border border-red-700 rounded text-sm",children:[(0,j.jsx)(C.A,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),(0,j.jsx)("span",{className:"text-red-300",children:u})]}),x&&(0,j.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-green-900/30 border border-green-700 rounded text-sm",children:[(0,j.jsx)(_.A,{className:"w-4 h-4 text-green-400 flex-shrink-0"}),(0,j.jsx)("span",{className:"text-green-300",children:x})]}),(0,j.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,j.jsx)("button",{type:"button",onClick:L,className:"flex-1 px-3 py-2 border border-gray-600 text-gray-300 rounded hover:bg-gray-800 transition-colors text-sm",disabled:c||f,children:"Cancelar"}),(0,j.jsx)("button",{type:"submit",className:"flex-1 px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm flex items-center justify-center gap-2",disabled:c||f||!t.trim(),children:c?(0,j.jsx)(j.Fragment,{children:"Entrando..."}):"Entrar"})]})]})})]})}):null},P=e=>{let{children:a}=e;const{isAuthenticated:s,loading:r}=(0,A.A)(),[t,n]=o.useState(!1);return r?(0,j.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,j.jsx)("div",{className:"text-center",children:(0,j.jsx)("p",{className:"text-gray-600",children:"Verificando autentica\xe7\xe3o..."})})}):s?a:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,j.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,j.jsxs)("div",{className:"mb-6",children:[(0,j.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,j.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,j.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acesso Restrito"}),(0,j.jsxs)("p",{className:"text-gray-600 mb-6",children:["Esta \xe1rea \xe9 restrita a administradores autorizados.",(0,j.jsx)("br",{}),"Fa\xe7a login para continuar."]})]}),(0,j.jsx)("button",{onClick:()=>n(!0),className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Fazer Login"})]})}),(0,j.jsx)(L,{isOpen:t,onClose:()=>n(!1),onSuccess:()=>{n(!1)}})]})};var S=s(39394);const D=e=>{let{escolas:a,onSave:s,loading:t=!1,error:n=null}=e;const[i,l]=(0,o.useState)(!1),d=(0,o.useRef)(null);(0,o.useEffect)(()=>{const e=()=>{if(d.current){const e=d.current.scrollWidth>d.current.clientWidth,a=d.current.scrollHeight>d.current.clientHeight;l(e||a)}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[a]);const[c,m]=(0,o.useState)(null),[u,g]=(0,o.useState)(""),[x,b]=(0,o.useState)(""),h=[{key:"Escola",label:"Escola",width:"w-32"},{key:"Munic\xedpio",label:"Munic\xedpio",width:"w-28"},{key:"Endere\xe7o",label:"Endere\xe7o",width:"w-40"},{key:"Terra Indigena (TI)",label:"Terra Ind\xedgena",width:"w-32"},{key:"Parcerias com o munic\xedpio",label:"Parcerias",width:"w-32"},{key:"Diretoria de Ensino",label:"Diretoria",width:"w-32"},{key:"Ano de cria\xe7\xe3o da escola",label:"Ano Cria\xe7\xe3o",width:"w-24"},{key:"Povos indigenas",label:"Povos",width:"w-32"},{key:"Linguas faladas",label:"L\xednguas",width:"w-32"},{key:"Modalidade de Ensino/turnos de funcionamento",label:"Modalidade",width:"w-48"},{key:"Numero de alunos",label:"Alunos",width:"w-20"},{key:"turnos_funcionamento",label:"Turnos",width:"w-24"},{key:"Espa\xe7o escolar e estrutura",label:"Estrutura",width:"w-40"},{key:"Acesso \xe0 \xe1gua",label:"\xc1gua",width:"w-24"},{key:"Tem coleta de lixo?",label:"Coleta Lixo",width:"w-24"},{key:"Acesso \xe0 internet",label:"Internet",width:"w-24"},{key:"Equipamentos Tecs",label:"Equipamentos",width:"w-32"},{key:"Modo de acesso \xe0 escola",label:"Acesso",width:"w-32"},{key:"Gest\xe3o/Nome",label:"Gest\xe3o",width:"w-32"},{key:"Outros funcion\xe1rios",label:"Funcion\xe1rios",width:"w-32"},{key:"Quantidade de professores ind\xedgenas",label:"Prof. Ind\xedgenas",width:"w-28"},{key:"Quantidade de professores n\xe3o ind\xedgenas",label:"Prof. N\xe3o Ind\xedgenas",width:"w-32"},{key:"Professores falam a l\xedngua ind\xedgena?",label:"Falam L\xedngua",width:"w-24"},{key:"Forma\xe7\xe3o dos professores",label:"Forma\xe7\xe3o",width:"w-32"},{key:"Forma\xe7\xe3o continuada oferecida",label:"Forma\xe7\xe3o Cont.",width:"w-32"},{key:"A escola possui PPP pr\xf3prio?",label:"PPP Pr\xf3prio",width:"w-24"},{key:"PPP elaborado com a comunidade?",label:"PPP Comunidade",width:"w-28"},{key:"Projetos em andamento",label:"Projetos",width:"w-32"},{key:"Parcerias com universidades?",label:"Parcerias Univ.",width:"w-28"},{key:"A\xe7\xf5es com ONGs ou coletivos?",label:"ONGs",width:"w-24"},{key:"Desejos da comunidade para a escola",label:"Desejos",width:"w-40"},{key:"Escola utiliza redes sociais?",label:"Redes Sociais",width:"w-24"},{key:"Links das redes sociais",label:"Links Redes",width:"w-40"},{key:"historia_da_escola",label:"Hist\xf3ria",width:"w-40"},{key:"Latitude",label:"Latitude",width:"w-20"},{key:"Longitude",label:"Longitude",width:"w-20"},{key:"links",label:"Links",width:"w-32"},{key:"link_para_videos",label:"V\xeddeos",width:"w-32"},{key:"logradouro",label:"Logradouro",width:"w-32"},{key:"numero",label:"N\xfamero",width:"w-16"},{key:"complemento",label:"Complemento",width:"w-24"},{key:"bairro",label:"Bairro",width:"w-24"},{key:"cep",label:"CEP",width:"w-20"},{key:"estado",label:"Estado",width:"w-16"},{key:"nome_professor",label:"Nome Professor",width:"w-32"},{key:"professores_indigenas",label:"Prof. Ind\xedgenas (Det.)",width:"w-32"},{key:"professores_nao_indigenas",label:"Prof. N\xe3o Ind\xedgenas (Det.)",width:"w-32"},{key:"professores_falam_lingua_indigena",label:"Falam L\xedngua (Det.)",width:"w-32"},{key:"formacao_professores",label:"Forma\xe7\xe3o (Det.)",width:"w-32"},{key:"visitas_supervisores_formacao",label:"Visitas Supervisores",width:"w-32"},{key:"outros_funcionarios",label:"Outros Funcion\xe1rios (Det.)",width:"w-32"},{key:"gestao",label:"Gest\xe3o (Det.)",width:"w-32"},{key:"merenda_diferenciada",label:"Merenda Diferenciada",width:"w-32"},{key:"cozinha",label:"Cozinha",width:"w-24"},{key:"merenda_escolar",label:"Merenda Escolar",width:"w-28"},{key:"diferenciada",label:"Diferenciada",width:"w-24"},{key:"actions",label:"A\xe7\xf5es",width:"w-32"}],p=(0,o.useCallback)((e,a,s)=>{m({rowIndex:e,columnKey:a}),g(s||""),b(s||"")},[]),f=(0,o.useCallback)(()=>{m(null),g(""),b("")},[]),v=(0,o.useCallback)(async()=>{if(!c)return;const{rowIndex:e,columnKey:o}=c,t=a[e];if(u!==x){const e=(0,r.A)((0,r.A)({},t),{},{[o]:u}),a=h.find(e=>e.key===o),n=a?a.label:o,i={campo:o,valorAntigo:x,valorNovo:u,label:n};await s(e,i)}f()},[c,u,x,a,s,f,h]),y=(0,o.useCallback)(e=>{"Enter"===e.key?(e.preventDefault(),v()):"Escape"===e.key&&(e.preventDefault(),f())},[v,f]),N=(e,a,s)=>{const o=(null===c||void 0===c?void 0:c.rowIndex)===s&&(null===c||void 0===c?void 0:c.columnKey)===a.key,t=e[a.key]||"";if("actions"===a.key)return(0,j.jsx)("div",{className:"flex items-center justify-center",children:(0,j.jsx)("div",{className:"text-gray-500 text-xs",children:o?"Editando...":"Editar"})});if(o){let e="text",s={};return"Numero de alunos"===a.key?(e="number",s={min:0,step:1}):"Modalidade de Ensino/turnos de funcionamento"===a.key&&(e="textarea"),"textarea"===e?(0,j.jsx)("textarea",{value:u,onChange:e=>g(e.target.value),onKeyDown:y,onBlur:v,className:"w-full px-2 py-1 text-sm bg-gray-800 border border-blue-400 rounded text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3,autoFocus:!0}):(0,j.jsx)("input",(0,r.A)({type:e,value:u,onChange:e=>g(e.target.value),onKeyDown:y,onBlur:v,className:"w-full px-2 py-1 text-sm bg-gray-800 border border-blue-400 rounded text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0},s))}return(0,j.jsx)("div",{className:"cursor-pointer hover:bg-gray-700/50 px-2 py-1.5 rounded transition-colors group relative",onClick:()=>p(s,a.key,t),title:"Clique para editar",children:(0,j.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,j.jsx)("span",{className:"text-gray-300 group-hover:text-white text-xs flex-1 truncate",children:t&&t.length>30?"".concat(t.substring(0,30),"..."):t||(0,j.jsx)("span",{className:"text-gray-500",children:"-"})}),(0,j.jsx)(S.A,{size:12,className:"text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})})};return(0,j.jsxs)("div",{className:"h-full flex flex-col bg-gray-900",children:[(t||n)&&(0,j.jsx)("div",{className:"flex-shrink-0 bg-gray-800/50 px-4 py-2 border-b border-gray-700/50",children:(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[t&&(0,j.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400 text-sm",children:[(0,j.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-yellow-400"}),(0,j.jsx)("span",{children:"Salvando altera\xe7\xf5es..."})]}),n&&(0,j.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,j.jsx)(C.A,{size:14}),(0,j.jsx)("span",{children:n})]})]})}),(0,j.jsx)("div",{ref:d,className:"editable-table-scroll flex-1 relative ".concat(i?"can-scroll":""),style:{overflow:"auto"},children:(0,j.jsxs)("table",{className:"w-full min-w-[3000px]",children:[(0,j.jsx)("thead",{className:"bg-gray-800/80 sticky top-0 z-10",children:(0,j.jsx)("tr",{children:h.map(e=>(0,j.jsx)("th",{className:"".concat(e.width," px-3 py-3 text-left text-xs font-semibold text-gray-200 uppercase tracking-wider border-b border-gray-700"),children:(0,j.jsx)("div",{className:"truncate",title:e.label,children:e.label})},e.key))})}),(0,j.jsx)("tbody",{className:"bg-gray-900 divide-y divide-gray-800",children:0===a.length?(0,j.jsx)("tr",{children:(0,j.jsx)("td",{colSpan:h.length,className:"px-4 py-8 text-center text-gray-400",children:"Nenhuma escola encontrada"})}):a.map((e,a)=>(0,j.jsx)("tr",{className:"hover:bg-gray-800/50 transition-colors",children:h.map(s=>(0,j.jsx)("td",{className:"px-3 py-2.5 text-xs",children:N(e,s,a)},s.key))},e.id||a))})]})})]})};var I=s(63412),M=s(7473);const T=e=>{let{setEditingLocation:a,onShowMetadadosModal:s}=e;const{escolas:r,loading:t,error:n,saveEscola:l}=d(),[c,m]=(0,o.useState)(!1),[u,g]=(0,o.useState)(null),[x,b]=(0,o.useState)(!1),[h,p]=(0,o.useState)(""),[f,N]=(0,o.useState)(()=>{const e="undefined"!==typeof window?localStorage.getItem("opin:textScale"):null;return e?parseFloat(e):1});(0,o.useEffect)(()=>{const e=Math.min(1.3,Math.max(.9,f));if(e!==f)return void N(e);document.documentElement.style.fontSize="".concat(16*e,"px");try{localStorage.setItem("opin:textScale",String(e))}catch(a){}},[f]);const w=(0,o.useMemo)(()=>{if(!h.trim())return r;const e=h.toLowerCase();return r.filter(a=>{var s,r,o,t;return(null===(s=a.Escola)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(r=a["Munic\xedpio"])||void 0===r?void 0:r.toLowerCase().includes(e))||(null===(o=a["Endere\xe7o"])||void 0===o?void 0:o.toLowerCase().includes(e))||(null===(t=a["Terra Indigena (TI)"])||void 0===t?void 0:t.toLowerCase().includes(e))})},[r,h]);return t?(0,j.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-800",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto mb-2"}),(0,j.jsx)("span",{className:"text-gray-400",children:"Carregando escolas..."})]})}):(0,j.jsxs)("div",{className:"flex flex-col h-full bg-gray-900",children:[(0,j.jsx)("div",{className:"flex-shrink-0 bg-gray-800 border-b-2 border-gray-600",children:(0,j.jsx)("div",{className:"px-4 py-4",children:(0,j.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,j.jsxs)("button",{onClick:()=>a(null),className:"flex items-center gap-1.5 px-3 py-2.5 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-sm font-medium",title:"Voltar ao painel principal",children:[(0,j.jsx)(I.A,{size:16}),(0,j.jsx)("span",{children:"Voltar"})]}),(0,j.jsxs)("div",{className:"flex-shrink-0",children:[(0,j.jsx)("h2",{className:"text-lg font-semibold text-white leading-normal",children:"Edi\xe7\xe3o em Tabela"}),(0,j.jsx)("p",{className:"text-xs text-gray-400 leading-normal mt-0.5",children:"Clique em qualquer c\xe9lula para editar"})]}),(0,j.jsxs)("div",{className:"relative flex-1 min-w-[200px] max-w-md",children:[(0,j.jsx)(y.A,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,j.jsx)("input",{type:"text",placeholder:"Buscar escola, munic\xedpio...",value:h,onChange:e=>p(e.target.value),className:"w-full pl-8 pr-8 py-2.5 text-sm bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-green-500 focus:border-transparent"}),h&&(0,j.jsx)("button",{onClick:()=>p(""),className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white transition-colors",children:(0,j.jsx)(v.A,{size:14})})]}),h&&(0,j.jsxs)("div",{className:"text-xs text-gray-400 whitespace-nowrap",children:[w.length," de ",r.length]}),x&&(0,j.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-2.5 bg-green-900/30 border border-green-700/50 rounded-lg text-green-400 text-xs whitespace-nowrap",children:[(0,j.jsx)("span",{children:"\u2713"}),(0,j.jsx)("span",{children:"Salvo"})]}),(0,j.jsxs)("button",{type:"button",onClick:()=>N(e=>e>=1.3?1:Math.round(100*(e+.15))/100),className:"flex items-center gap-1.5 px-2.5 py-2.5 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors","aria-label":"Ajustar tamanho do texto",title:"Tamanho do texto: ".concat(Math.round(100*f),"%"),children:[(0,j.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,j.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.6117 5.00684C6.86862 5.02589 7.11696 5.11134 7.3324 5.25488C7.57862 5.41908 7.77125 5.65263 7.88514 5.92578L11.9232 15.6162C12.1352 16.1258 11.8947 16.7115 11.3851 16.9238C10.8755 17.1362 10.2901 16.8942 10.0775 16.3848L9.08338 14H3.91736L2.92322 16.3857C2.71049 16.8948 2.12502 17.1359 1.6156 16.9238C1.10605 16.7114 0.865522 16.1258 1.07752 15.6162L5.11658 5.92578L5.16248 5.8252C5.27895 5.59518 5.45376 5.39859 5.66932 5.25488L5.76307 5.19727C5.98766 5.07035 6.24213 5.00195 6.50135 5.00195L6.6117 5.00684ZM4.75135 12H8.25037L6.50037 7.80176L4.75135 12Z",fill:"#CDE8CF"}),(0,j.jsx)("path",{d:"M18.0209 6.00098C18.0385 6.00133 18.0561 6.00165 18.0736 6.00293C18.0913 6.00421 18.1089 6.00562 18.1263 6.00781C18.1434 6.00996 18.1602 6.01358 18.1771 6.0166C18.1869 6.01835 18.1968 6.01946 18.2064 6.02148C18.234 6.02726 18.2614 6.03388 18.2885 6.04199C18.2921 6.04309 18.2956 6.04476 18.2992 6.0459C18.317 6.05145 18.3344 6.05789 18.3519 6.06445C18.368 6.07049 18.3841 6.07618 18.3998 6.08301C18.5114 6.13159 18.6161 6.20168 18.7074 6.29297L22.7074 10.293C23.0977 10.6835 23.0979 11.3166 22.7074 11.707C22.3169 12.0975 21.6839 12.0973 21.2933 11.707L19.0004 9.41406V16C19.0004 16.5522 18.5526 16.9999 18.0004 17C17.4481 17 17.0004 16.5523 17.0004 16V9.41406L14.7074 11.707C14.3169 12.0975 13.6839 12.0973 13.2933 11.707C12.9028 11.3165 12.9028 10.6835 13.2933 10.293L17.2933 6.29297C17.3386 6.2477 17.3876 6.20587 17.4408 6.16992C17.4934 6.13439 17.5488 6.10452 17.6058 6.08008C17.6512 6.06059 17.6989 6.04587 17.7474 6.0332C17.7614 6.02955 17.7753 6.0255 17.7894 6.02246C17.8033 6.01948 17.8173 6.01704 17.8314 6.01465C17.847 6.01199 17.8626 6.00973 17.8783 6.00781C17.8961 6.00565 17.914 6.00415 17.932 6.00293C17.948 6.00184 17.9639 6.00131 17.9799 6.00098C17.9866 6.00084 17.9936 6 18.0004 6C18.0072 6 18.0141 6.00084 18.0209 6.00098Z",fill:"#CDE8CF"})]}),(0,j.jsxs)("span",{className:"text-xs text-gray-300 hidden sm:inline",children:[Math.round(100*f),"%"]})]}),(0,j.jsxs)("button",{onClick:()=>{const e=[["Escola","Munic\xedpio","Endere\xe7o","Terra Ind\xedgena","Parcerias","Diretoria de Ensino","Ano Cria\xe7\xe3o","Povos","L\xednguas","Modalidade","Alunos","Turnos","Estrutura","\xc1gua","Coleta Lixo","Internet","Equipamentos","Acesso","Gest\xe3o","Funcion\xe1rios","Prof. Ind\xedgenas","Prof. N\xe3o Ind\xedgenas","Falam L\xedngua","Forma\xe7\xe3o","Forma\xe7\xe3o Cont.","PPP Pr\xf3prio","PPP Comunidade","Projetos","Parcerias Univ.","ONGs","Desejos","Redes Sociais","Links Redes","Hist\xf3ria","Latitude","Longitude","Links","V\xeddeos","Logradouro","N\xfamero","Complemento","Bairro","CEP","Estado","Nome Professor","Prof. Ind\xedgenas (Det.)","Prof. N\xe3o Ind\xedgenas (Det.)","Falam L\xedngua (Det.)","Forma\xe7\xe3o (Det.)","Visitas Supervisores","Outros Funcion\xe1rios (Det.)","Gest\xe3o (Det.)","Merenda Diferenciada","Cozinha","Merenda Escolar","Diferenciada"].join(","),...r.map(e=>['"'.concat(e.nome_escola||"",'"'),'"'.concat(e.municipio||"",'"'),'"'.concat(e.endereco||"",'"'),'"'.concat(e.terra_indigena||"",'"'),'"'.concat(e.parcerias||"",'"'),'"'.concat(e.diretoria_ensino||"",'"'),'"'.concat(e.ano_criacao||"",'"'),'"'.concat(e.povos||"",'"'),'"'.concat(e.linguas||"",'"'),'"'.concat(e.modalidade||"",'"'),'"'.concat(e.numero_alunos||"",'"'),'"'.concat(e.turnos||"",'"'),'"'.concat(e.estrutura||"",'"'),'"'.concat(e.agua||"",'"'),'"'.concat(e.coleta_lixo||"",'"'),'"'.concat(e.internet||"",'"'),'"'.concat(e.equipamentos||"",'"'),'"'.concat(e.acesso||"",'"'),'"'.concat(e.gestao||"",'"'),'"'.concat(e.funcionarios||"",'"'),'"'.concat(e.professores_indigenas||"",'"'),'"'.concat(e.professores_nao_indigenas||"",'"'),'"'.concat(e.falam_lingua_indigena||"",'"'),'"'.concat(e.formacao_professores||"",'"'),'"'.concat(e.formacao_continuada||"",'"'),'"'.concat(e.ppp_proprio||"",'"'),'"'.concat(e.ppp_comunidade||"",'"'),'"'.concat(e.projetos||"",'"'),'"'.concat(e.parcerias_universidades||"",'"'),'"'.concat(e.parcerias_ongs||"",'"'),'"'.concat(e.desejos_comunidade||"",'"'),'"'.concat(e.redes_sociais||"",'"'),'"'.concat(e.links_redes_sociais||"",'"'),'"'.concat(e.historia_escola||"",'"'),'"'.concat(e.latitude||"",'"'),'"'.concat(e.longitude||"",'"'),'"'.concat(e.links_uteis||"",'"'),'"'.concat(e.link_para_videos||"",'"'),'"'.concat(e.logradouro||"",'"'),'"'.concat(e.numero||"",'"'),'"'.concat(e.complemento||"",'"'),'"'.concat(e.bairro||"",'"'),'"'.concat(e.cep||"",'"'),'"'.concat(e.estado||"",'"'),'"'.concat(e.nome_professor||"",'"'),'"'.concat(e.professores_indigenas_detalhado||"",'"'),'"'.concat(e.professores_nao_indigenas_detalhado||"",'"'),'"'.concat(e.falam_lingua_indigena_detalhado||"",'"'),'"'.concat(e.formacao_professores_detalhado||"",'"'),'"'.concat(e.visitas_supervisores||"",'"'),'"'.concat(e.outros_funcionarios_detalhado||"",'"'),'"'.concat(e.gestao_detalhado||"",'"'),'"'.concat(e.merenda_diferenciada||"",'"'),'"'.concat(e.cozinha||"",'"'),'"'.concat(e.merenda_escolar||"",'"'),'"'.concat(e.merenda_diferenciada_detalhado||"",'"')].join(","))].join("\n"),a=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),o=URL.createObjectURL(a);s.setAttribute("href",o),s.setAttribute("download","escolas_indigenas.csv"),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},className:"flex items-center gap-1.5 px-3 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium whitespace-nowrap",children:[(0,j.jsx)(M.A,{size:16}),(0,j.jsx)("span",{className:"hidden sm:inline",children:"Exportar CSV"}),(0,j.jsx)("span",{className:"sm:hidden",children:"CSV"})]})]})})}),(0,j.jsx)("div",{className:"flex-1 overflow-hidden",children:n?(0,j.jsx)("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-4 m-4",children:(0,j.jsx)("div",{className:"flex items-center gap-2 text-red-400",children:(0,j.jsxs)("span",{children:["Erro ao carregar escolas: ",n]})})}):(0,j.jsx)("div",{className:"h-full",children:(0,j.jsx)(D,{escolas:w,onSave:async(e,a)=>{try{m(!0),g(null);const r=await l(e,null);if(r.success){if(b(!0),setTimeout(()=>b(!1),3e3),s&&a){const o=[{campo:a.campo,valorAntigo:a.valorAntigo||"",valorNovo:a.valorNovo||"",label:a.label||a.campo}];s(e.id||r.data.id,e.Escola||"Escola",o)}}else g(r.error||"Erro ao salvar escola")}catch(r){i.A.error("Erro ao salvar escola:",r),g(r.message)}finally{m(!1)}},loading:c,error:u})})})]})};var F=s(99097),z=s(84488),O=s(57367),U=s(94309);const q=e=>{let{card:a,isVisible:s,onToggle:r}=e;return(0,j.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-800/30 rounded-lg border border-gray-700/30 hover:border-gray-600/50 transition-colors",children:[(0,j.jsx)("div",{className:"flex-1",children:(0,j.jsx)("h4",{className:"text-sm font-medium text-gray-200",children:a.label})}),(0,j.jsx)("button",{onClick:r,className:"\n          relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900\n          ".concat(s?"bg-green-600":"bg-gray-600","\n        "),role:"switch","aria-checked":s,"aria-label":"".concat(s?"Ocultar":"Mostrar"," ").concat(a.label),children:(0,j.jsx)("span",{className:"\n            inline-block h-4 w-4 transform rounded-full bg-white transition-transform\n            ".concat(s?"translate-x-6":"translate-x-1","\n          ")})})]})},B=()=>{const[e,a]=(0,o.useState)((0,O.gD)()),[s,t]=(0,o.useState)(!0),[n,l]=(0,o.useState)(!1),[d,c]=(0,o.useState)(null),[m,u]=(0,o.useState)(!1);(0,o.useEffect)(()=>{g()},[]);const g=async()=>{try{t(!0);const e=await U.B.getGlobalCardsVisibility();if(e){const s=(0,O.gD)();a((0,r.A)((0,r.A)({},s),e))}else a((0,O.gD)())}catch(e){i.A.error("Erro ao carregar configura\xe7\xe3o global:",e),a((0,O.gD)())}finally{t(!1)}},x=e=>{a(a=>(0,r.A)((0,r.A)({},a),{},{[e]:!a[e]})),c(null)},b=O.LQ.filter(e=>"grid"===e.category),h=O.LQ.filter(e=>"standalone"===e.category);return s?(0,j.jsx)("div",{className:"bg-gray-900/80 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-800/50 p-6",children:(0,j.jsx)("div",{className:"text-center py-8",children:(0,j.jsx)("div",{className:"text-gray-400",children:"Carregando..."})})}):(0,j.jsxs)("div",{className:"bg-gray-900/80 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-800/50 p-6",children:[(0,j.jsxs)("div",{className:"mb-8",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("h3",{className:"text-xl font-semibold text-gray-200",children:"Visibilidade Global de Cards"}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("button",{onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),className:"text-gray-400 hover:text-gray-300 transition-colors","aria-label":"Informa\xe7\xf5es",children:(0,j.jsx)(F.A,{className:"w-4 h-4"})}),m&&(0,j.jsxs)("div",{className:"absolute left-0 top-6 w-80 bg-gray-800 border border-gray-700 rounded-lg p-4 shadow-xl z-50",children:[(0,j.jsxs)("p",{className:"text-sm text-gray-300 mb-2",children:[(0,j.jsx)("strong",{className:"text-gray-200",children:"Configura\xe7\xe3o Global:"})," Define o padr\xe3o para todas as escolas."]}),(0,j.jsxs)("p",{className:"text-sm text-gray-300 mb-2",children:[(0,j.jsx)("strong",{className:"text-gray-200",children:"Configura\xe7\xe3o Individual:"})," Cada escola pode ter suas pr\xf3prias configura\xe7\xf5es que sobrescrevem a global."]}),(0,j.jsxs)("p",{className:"text-sm text-gray-300",children:[(0,j.jsx)("strong",{className:"text-gray-200",children:"Prioridade:"})," Individual \u2192 Global \u2192 Padr\xe3o (todos vis\xedveis)"]})]})]})]}),(0,j.jsxs)("button",{onClick:async()=>{try{l(!0),c(null);const a=await U.B.saveGlobalCardsVisibility(e);a.success?(c({type:"success",message:"Configura\xe7\xe3o salva!"}),setTimeout(()=>c(null),3e3)):c({type:"error",message:a.error||"Erro ao salvar"})}catch(a){i.A.error("Erro ao salvar configura\xe7\xe3o global:",a),c({type:"error",message:"Erro ao salvar configura\xe7\xe3o"})}finally{l(!1)}},disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,j.jsx)(z.A,{className:"w-4 h-4"}),n?"Salvando...":"Salvar"]})]}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Define os cards vis\xedveis por padr\xe3o em todas as escolas."}),d&&(0,j.jsxs)("div",{className:"mt-4 p-3 rounded-lg border flex items-center gap-2 ".concat("success"===d.type?"bg-green-900/50 border-green-700/50 text-green-200":"bg-red-900/50 border-red-700/50 text-red-200"),children:["success"===d.type?(0,j.jsx)(_.A,{className:"w-4 h-4"}):(0,j.jsx)(C.A,{className:"w-4 h-4"}),(0,j.jsx)("span",{className:"text-sm",children:d.message})]})]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"border-b border-gray-700/50 pb-2 mb-4",children:(0,j.jsx)("h4",{className:"text-base font-medium text-gray-300",children:"Grid Principal"})}),(0,j.jsx)("div",{className:"space-y-3",children:b.map(a=>(0,j.jsx)(q,{card:a,isVisible:e[a.id],onToggle:()=>x(a.id)},a.id))})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"border-b border-gray-700/50 pb-2 mb-4",children:(0,j.jsx)("h4",{className:"text-base font-medium text-gray-300",children:"Se\xe7\xf5es Adicionais"})}),(0,j.jsx)("div",{className:"space-y-3",children:h.map(a=>(0,j.jsx)(q,{card:a,isVisible:e[a.id],onToggle:()=>x(a.id)},a.id))})]})]})]})};var R=s(49761),V=s(31184);const G="opin:metadataMemory",W=()=>{try{const e=localStorage.getItem(G);if(e)return JSON.parse(e)}catch(e){i.A.warn("Error reading metadata memory:",e)}return null},H=()=>{try{localStorage.removeItem(G)}catch(e){i.A.warn("Error clearing metadata memory:",e)}},Q=e=>{let{isOpen:a,onClose:s,onSave:t,escolaId:n,escolaNome:d,camposAlterados:c=[]}=e;const[m,u]=(0,o.useState)([]),[g,x]=(0,o.useState)(!0),[b,h]=(0,o.useState)(null),[p,f]=(0,o.useState)({fonte_id:"",observacoes:""}),[y,N]=(0,o.useState)(!1),[w,A]=(0,o.useState)(!1),[E,k]=(0,o.useState)(!1),[C,_]=(0,o.useState)(!1),L=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(a){(async()=>{x(!0);const e=await l.buscarFontesDados();e.success&&u(e.data),x(!1);const a=await l.obterAutorAtual();h(a);const s=W();if(s){k(!0);const e={fonte_id:s.fonte_id||"",observacoes:s.observacoes||""};(e.fonte_id||e.observacoes)&&(f(e),A(!0))}else k(!1),A(!1)})()}else f({fonte_id:"",observacoes:""}),A(!1)},[a]);const P=(e,a)=>{f(s=>(0,r.A)((0,r.A)({},s),{},{[e]:a}))};(0,o.useEffect)(()=>{L.current&&(L.current.style.height="auto",L.current.style.height="".concat(L.current.scrollHeight,"px"))},[p.observacoes]);const S=async()=>{N(!0);try{const e=[];for(const a of c){const s=await l.registrarVersaoDados({nomeTabela:"escolas_completa",chaveLinha:n.toString(),nomeCampo:a.campo,fonteId:null,autor:b,observacoes:null});e.push(s)}if(e.every(e=>e.success))t&&t(e),s();else{const a=e.filter(e=>!e.success).map(e=>e.error);i.A.error("Erro ao salvar alguns metadados:",a),alert("Alguns metadados n\xe3o puderam ser salvos. Verifique o console para mais detalhes.")}}catch(e){i.A.error("Erro ao salvar metadados:",e),alert("Erro ao salvar metadados: "+e.message)}finally{N(!1)}};return a?(0,j.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e=>e.target===e.currentTarget&&!y&&S(),children:(0,j.jsxs)("div",{className:"bg-gray-900/95 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-800/50 w-full max-w-lg transform transition-all duration-300 scale-100",onClick:e=>e.stopPropagation(),children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-800/50",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"p-2 bg-blue-500/20 text-blue-400 rounded-lg",children:(0,j.jsx)(F.A,{className:"w-5 h-5"})}),(0,j.jsx)("h2",{className:"text-lg font-semibold text-gray-100",children:"Registrar metadados da altera\xe7\xe3o"})]}),(0,j.jsx)("button",{onClick:S,disabled:y,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-800 rounded-lg transition-colors disabled:opacity-50","aria-label":"Fechar modal",children:(0,j.jsx)(v.A,{className:"w-5 h-5"})})]}),(0,j.jsxs)("div",{className:"p-4 max-h-[60vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-gray-800",children:[(0,j.jsxs)("div",{className:"mb-3",children:[(0,j.jsxs)("p",{className:"text-sm text-gray-300",children:["Metadados ajudam a registrar a origem e o contexto da altera\xe7\xe3o. Se preferir, voc\xea pode salvar sem preencher."," ",(0,j.jsxs)("button",{onClick:()=>_(!C),className:"text-blue-400 hover:text-blue-300 underline inline-flex items-center gap-1",children:["Saiba mais",(0,j.jsx)("svg",{className:"w-3 h-3 transition-transform ".concat(C?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),C&&(0,j.jsxs)("div",{className:"mt-2 p-3 bg-blue-900/20 border border-blue-700/30 rounded-md",children:[(0,j.jsx)("p",{className:"text-xs text-gray-300 leading-relaxed mb-2",children:"Metadados s\xe3o informa\xe7\xf5es que descrevem a origem e o contexto dos dados que voc\xea est\xe1 inserindo ou modificando."}),(0,j.jsx)("p",{className:"text-xs text-gray-300 leading-relaxed",children:"Eles ajudam a manter o site mais rigoroso, confi\xe1vel e \xfatil para quem for estud\xe1-lo no futuro."})]})]}),c.length>0&&(0,j.jsxs)("div",{className:"mb-3",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Campos alterados:"}),(0,j.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto border border-gray-800/50 rounded-md p-2 bg-gray-800/30 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-gray-800",children:c.map((e,a)=>(0,j.jsxs)("div",{className:"text-xs text-gray-300",children:[(0,j.jsxs)("span",{className:"font-medium",children:[e.label||e.campo,":"]})," ",(0,j.jsxs)("span",{className:"text-gray-400",children:[String(e.valorNovo).substring(0,60),String(e.valorNovo).length>60&&"..."]})]},a))})]}),w&&(0,j.jsxs)("div",{className:"mb-3 p-2 bg-green-900/30 border border-green-700/50 rounded-md flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(R.A,{className:"w-3.5 h-3.5 text-green-400"}),(0,j.jsx)("span",{className:"text-xs text-green-300",children:"Valores carregados da mem\xf3ria anterior"})]}),E&&(0,j.jsxs)("button",{onClick:()=>{window.confirm("Deseja limpar a mem\xf3ria de metadados? Os valores salvos anteriormente n\xe3o ser\xe3o mais carregados automaticamente.")&&(H(),k(!1),A(!1),f({fonte_id:"",observacoes:""}))},className:"text-xs text-gray-400 hover:text-gray-200 flex items-center gap-1 px-2 py-1 rounded hover:bg-gray-800/50 transition-colors",title:"Limpar mem\xf3ria",children:[(0,j.jsx)(V.A,{className:"w-3 h-3"}),"Limpar"]})]}),(0,j.jsxs)("div",{className:"mb-3",children:[(0,j.jsx)("label",{htmlFor:"fonte_id",className:"block text-sm font-medium text-gray-300 mb-1",children:"Fonte dos dados"}),(0,j.jsxs)("select",{id:"fonte_id",value:p.fonte_id,onChange:e=>{P("fonte_id",e.target.value),A(!1)},className:"w-full px-3 py-2 text-sm border border-gray-700/50 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-800/50 text-gray-200",disabled:y,children:[(0,j.jsx)("option",{value:"",className:"bg-gray-800 text-gray-200",children:"Selecione a fonte dos dados"}),g?(0,j.jsx)("option",{disabled:!0,className:"bg-gray-800 text-gray-200",children:"Carregando fontes..."}):m.map(e=>(0,j.jsxs)("option",{value:e.id,className:"bg-gray-800 text-gray-200",children:[e.nome," ",e.descricao?"- ".concat(e.descricao):""]},e.id))]})]}),(0,j.jsxs)("div",{className:"mb-3",children:[(0,j.jsx)("label",{htmlFor:"observacoes",className:"block text-sm font-medium text-gray-300 mb-1",children:"Observa\xe7\xf5es"}),(0,j.jsx)("textarea",{ref:L,id:"observacoes",value:p.observacoes,onChange:e=>{const a=e.target.value;a.length<=1e3&&(P("observacoes",a),A(!1))},rows:2,maxLength:1e3,placeholder:"Adicione observa\xe7\xf5es sobre esta altera\xe7\xe3o...",className:"w-full px-3 py-2 text-sm border border-gray-700/50 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-gray-800/50 text-gray-200 placeholder-gray-500 overflow-hidden",disabled:y,style:{minHeight:"2.5rem"}}),(0,j.jsx)("div",{className:"mt-1",children:(0,j.jsxs)("span",{className:"text-xs text-gray-400",children:[p.observacoes.length,"/1000 caracteres"]})})]})]}),(0,j.jsxs)("div",{className:"flex items-center justify-between gap-3 p-4 border-t border-gray-800/50 bg-gray-800/30 rounded-b-2xl",children:[(0,j.jsx)("button",{onClick:S,disabled:y,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-800/50 border border-gray-700/50 rounded-md hover:bg-gray-800 hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Salvar sem metadados"}),(0,j.jsx)("button",{onClick:async()=>{N(!0);try{const e=[];for(const a of c){const s=await l.registrarVersaoDados({nomeTabela:"escolas_completa",chaveLinha:n.toString(),nomeCampo:a.campo,fonteId:p.fonte_id||null,autor:b,observacoes:p.observacoes.trim()||null});e.push(s)}if(e.every(e=>e.success))(p.fonte_id||p.observacoes.trim())&&(e=>{try{const a=W()||{},s=(0,r.A)({},a);null!==e.fonte_id&&void 0!==e.fonte_id&&(s.fonte_id=e.fonte_id||null),null!==e.observacoes&&void 0!==e.observacoes&&(s.observacoes=e.observacoes||null),s.fonte_id||s.observacoes?localStorage.setItem(G,JSON.stringify(s)):H()}catch(a){i.A.warn("Error saving metadata memory:",a)}})({fonte_id:p.fonte_id||null,observacoes:p.observacoes.trim()||null}),t&&t(e),s();else{const a=e.filter(e=>!e.success).map(e=>e.error);i.A.error("Erro ao salvar alguns metadados:",a),alert("Alguns metadados n\xe3o puderam ser salvos. Verifique o console para mais detalhes.")}}catch(e){i.A.error("Erro ao salvar metadados:",e),alert("Erro ao salvar metadados: "+e.message)}finally{N(!1)}},disabled:y,className:"px-5 py-2 text-sm font-medium text-white bg-gradient-to-r from-green-600 to-green-700 rounded-md hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg",children:y?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Salvando..."]}):"Salvar e registrar metadados"})]})]})}):null};var Z=s(4008),J=s(12065),K=s(22623),X=s(98590),Y=s(26464),$=s(25827),ee=s(44768),ae=s(35349);const se=()=>{var e;const[a,n]=(0,o.useState)([]),[l,d]=(0,o.useState)(!0),[c,m]=(0,o.useState)(null),[u,g]=(0,o.useState)(null),[x,b]=(0,o.useState)([]),[h,p]=(0,o.useState)(!1),[f,v]=(0,o.useState)({}),[y,N]=(0,o.useState)(0),w=[{id:"escolas_completa",nome:"Escolas Completas",descricao:"Dados principais de todas as escolas ind\xedgenas",icone:Z.A,cor:"bg-blue-500",registros:0},{id:"historias_professor",nome:"Hist\xf3rias dos Professores",descricao:"Depoimentos e hist\xf3rias dos professores ind\xedgenas",icone:J.A,cor:"bg-green-500",registros:0},{id:"documentos_escola",nome:"Documentos das Escolas",descricao:"PDFs e documentos das escolas",icone:K.A,cor:"bg-purple-500",registros:0},{id:"titulos_videos",nome:"V\xeddeos das Escolas",descricao:"Links e t\xedtulos dos v\xeddeos das escolas",icone:X.A,cor:"bg-red-500",registros:0},{id:"legendas_fotos",nome:"Legendas das Fotos",descricao:"Legendas e descri\xe7\xf5es das imagens",icone:Y.A,cor:"bg-yellow-500",registros:0},{id:"imagens_professores",nome:"Imagens dos Professores",descricao:"Metadados das imagens dos professores",icone:J.A,cor:"bg-teal-500",registros:0},{id:"imagens_escola",nome:"Imagens das Escolas",descricao:"Metadados das imagens das escolas",icone:Y.A,cor:"bg-indigo-500",registros:0},{id:"fontes_dados",nome:"Fontes de Dados",descricao:"Fontes de dados utilizadas no sistema de versionamento",icone:K.A,cor:"bg-cyan-500",registros:0},{id:"versoes_dados",nome:"Vers\xf5es de Dados",descricao:"Hist\xf3rico de vers\xf5es e metadados das altera\xe7\xf5es",icone:$.A,cor:"bg-orange-500",registros:0}],A=[{id:"imagens-das-escolas",nome:"Imagens das Escolas",descricao:"Fotos das escolas ind\xedgenas",icone:Y.A,cor:"bg-indigo-500",arquivos:0},{id:"imagens-professores",nome:"Imagens dos Professores",descricao:"Fotos dos professores ind\xedgenas",icone:J.A,cor:"bg-teal-500",arquivos:0},{id:"pdfs",nome:"Documentos PDF",descricao:"Documentos das escolas em PDF",icone:K.A,cor:"bg-orange-500",arquivos:0},{id:"historias-professor",nome:"Hist\xf3rias dos Professores",descricao:"Imagens das hist\xf3rias dos professores",icone:J.A,cor:"bg-green-500",arquivos:0}];(0,o.useEffect)(()=>{n(w),d(!1)},[]);const E=async e=>{try{p(!0),m(null);const{data:a,error:s}=await t.N.from(e).select("*").order("id",{ascending:!0});if(s)throw s;b(a||[]),g(e)}catch(a){i.A.error("Erro ao carregar dados da tabela ".concat(e,":"),a),m("Erro ao carregar dados: ".concat(a.message))}finally{p(!1)}},L=async(e,a)=>{try{const s=await fetch(e),r=await s.blob(),o=window.URL.createObjectURL(r),t=document.createElement("a");t.href=o,t.download=a,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(o)}catch(c){i.A.error("Erro ao baixar ".concat(a,":"),c)}},P=async(e,a)=>{try{i.A.debug("Iniciando cria\xe7\xe3o do ZIP com",e.length,"arquivos");const r=new(0,(await s.e(159).then(s.t.bind(s,26159,23))).default);let o=0;for(const a of e)try{i.A.debug("Baixando arquivo: ".concat(a.name," de ").concat(a.url));const s=await fetch(a.url);if(!s.ok)throw new Error("HTTP ".concat(s.status,": ").concat(s.statusText));const t=await s.blob();i.A.debug("Arquivo ".concat(a.name," baixado, tamanho: ").concat(t.size," bytes")),r.file(a.name,t),o++;const n=o/e.length*100;N(n)}catch(c){i.A.error("Erro ao adicionar ".concat(a.name," ao ZIP:"),c)}if(0===o)throw new Error("Nenhum arquivo foi adicionado ao ZIP");i.A.debug("Gerando ZIP com ".concat(o," arquivos..."));const t=await r.generateAsync({type:"blob"});i.A.debug("ZIP gerado, tamanho: ".concat(t.size," bytes"));const n=window.URL.createObjectURL(t),l=document.createElement("a");l.href=n,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(n),i.A.debug("ZIP baixado com sucesso:",a)}catch(c){i.A.error("Erro ao criar ZIP:",c),i.A.debug("Tentando download individual dos arquivos...");for(const s of e)try{await L(s.url,s.name),await new Promise(e=>setTimeout(e,200))}catch(r){i.A.error("Erro ao baixar ".concat(s.name,":"),r)}}};return l?(0,j.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,j.jsx)("div",{className:"text-gray-400 text-lg",children:"Carregando tabelas..."})}):(0,j.jsxs)("div",{className:"space-y-8",children:[(0,j.jsxs)("div",{className:"bg-gray-800/30 rounded-xl p-6 border border-gray-700/30",children:[(0,j.jsxs)("h4",{className:"text-lg font-semibold text-gray-100 mb-6 flex items-center gap-2",children:[(0,j.jsx)($.A,{className:"w-5 h-5 text-blue-400"}),"Backup Completo do Sistema"]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,j.jsxs)("div",{className:"bg-gradient-to-br from-blue-600/20 to-blue-700/20 rounded-xl p-6 border border-blue-500/30 hover:border-blue-400/50 transition-all duration-200",children:[(0,j.jsxs)("div",{className:"flex items-center mb-4",children:[(0,j.jsx)("div",{className:"bg-blue-500 p-3 rounded-lg mr-3",children:(0,j.jsx)($.A,{className:"w-6 h-6 text-white"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h5",{className:"font-semibold text-gray-100",children:"Backup Completo"}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Sistema completo"})]})]}),(0,j.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:"Inclui todas as tabelas, imagens dos buckets e tabelas de metadados (fontes_dados e versoes_dados)"}),(0,j.jsxs)("button",{onClick:async()=>{try{v({status:"iniciando",message:"Iniciando backup completo..."}),N(0),v({status:"tabelas",message:"Fazendo backup das tabelas..."}),N(10);const a={};for(const r of w)try{const{data:e,error:s}=await t.N.from(r.id).select("*");if(s)throw s;a[r.id]=e||[]}catch(e){i.A.error("Erro ao fazer backup da tabela ".concat(r.id,":"),e)}N(25),v({status:"buckets",message:"Preparando download das imagens..."}),N(30);const s={},o=[];for(const u of A)try{i.A.debug("Listando arquivos do bucket: ".concat(u.id));const{data:a,error:n}=await t.N.storage.from(u.id).list("",{limit:1e3});if(n)throw n;i.A.debug("Bucket ".concat(u.id,": ").concat((null===a||void 0===a?void 0:a.length)||0," arquivos encontrados")),i.A.debug("Arquivos encontrados:",a);const l=[];for(const s of a)try{i.A.debug("Gerando URL para: ".concat(s.name));const{data:e}=await t.N.storage.from(u.id).createSignedUrl(s.name,3600);if(null!==e&&void 0!==e&&e.signedUrl){const a=(0,r.A)((0,r.A)({},s),{},{url:e.signedUrl,bucket:u.id,bucketNome:u.nome});l.push(a),o.push(a),i.A.debug("URL gerada para ".concat(s.name,": ").concat(e.signedUrl.substring(0,50),"..."))}else i.A.warn("URL n\xe3o gerada para ".concat(s.name))}catch(e){i.A.error("Erro ao gerar URL para ".concat(s.name,":"),e)}i.A.debug("Bucket ".concat(u.id,": ").concat(l.length," URLs geradas")),s[u.id]=l}catch(e){i.A.error("Erro ao fazer backup do bucket ".concat(u.id,":"),e)}N(75),v({status:"finalizando",message:"Criando arquivo de backup..."}),N(80);const n={metadata:{dataBackup:(new Date).toISOString(),versao:"1.0",descricao:"Backup completo do sistema OPIN - Observat\xf3rio dos Professores Ind\xedgenas",tabelas:w.map(e=>({id:e.id,nome:e.nome})),buckets:A.map(e=>({id:e.id,nome:e.nome})),totalRegistros:Object.values(a).reduce((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0),0),totalArquivos:Object.values(s).reduce((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0),0)},dados:a,arquivos:s};v({status:"download",message:"Preparando download..."}),N(90);const l=JSON.stringify(n,null,2),d=new Blob([l],{type:"application/json;charset=utf-8;"}),c=document.createElement("a"),m=URL.createObjectURL(d);c.setAttribute("href",m),c.setAttribute("download","backup_completo_opin_".concat((new Date).toISOString().split("T")[0],".json")),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),i.A.debug("Total de arquivos para download: ".concat(o.length)),i.A.debug("Arquivos para download:",o),o.length>0?(v({status:"imagens",message:"Baixando imagens..."}),N(95),await P(o,"imagens_opin_".concat((new Date).toISOString().split("T")[0],".zip"))):(i.A.warn("Nenhuma imagem encontrada para backup"),v({status:"erro",message:"Nenhuma imagem encontrada para backup. Verifique se h\xe1 arquivos nos buckets."})),N(100),v({status:"concluido",message:"Backup completo realizado com sucesso!",detalhes:{tabelas:Object.keys(a).length,registros:Object.values(a).reduce((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0),0),arquivos:Object.values(s).reduce((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0),0)}}),setTimeout(()=>{v({}),N(0)},5e3)}catch(e){i.A.error("Erro no backup completo:",e),v({status:"erro",message:"Erro no backup: ".concat(e.message)}),N(0)}},disabled:"iniciando"===f.status||"tabelas"===f.status||"buckets"===f.status||"finalizando"===f.status||"download"===f.status||"imagens"===f.status,className:"w-full px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl",children:[(0,j.jsx)($.A,{className:"w-4 h-4 inline mr-2"}),"Backup Completo"]})]}),(0,j.jsxs)("div",{className:"bg-gradient-to-br from-green-600/20 to-green-700/20 rounded-xl p-6 border border-green-500/30 hover:border-green-400/50 transition-all duration-200",children:[(0,j.jsxs)("div",{className:"flex items-center mb-4",children:[(0,j.jsx)("div",{className:"bg-green-500 p-3 rounded-lg mr-3",children:(0,j.jsx)(Z.A,{className:"w-6 h-6 text-white"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h5",{className:"font-semibold text-gray-100",children:"Backup das Tabelas"}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Apenas dados"})]})]}),(0,j.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:"Apenas os dados das tabelas em formato CSV"}),(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsxs)("button",{onClick:async()=>{try{v({status:"tabelas",message:"Fazendo backup das tabelas em CSV..."}),N(0);const a={};for(let s=0;s<w.length;s++){const r=w[s];try{const{data:e,error:o}=await t.N.from(r.id).select("*");if(o)throw o;a[r.id]=e||[],N((s+1)/w.length*100)}catch(e){i.A.error("Erro ao fazer backup da tabela ".concat(r.id,":"),e)}}const r=(new Date).toISOString().split("T")[0],o=new(0,(await s.e(159).then(s.t.bind(s,26159,23))).default);for(const[e,s]of Object.entries(a))if(s&&s.length>0){const a=Object.keys(s[0]),t=[a.join(","),...s.map(e=>a.map(a=>{const s=e[a];return"string"===typeof s&&(s.includes(",")||s.includes("\n")||s.includes('"'))?'"'.concat(s.replace(/"/g,'""'),'"'):s||""}).join(","))].join("\n");o.file("".concat(e,"_").concat(r,".csv"),t)}const n={dataBackup:(new Date).toISOString(),tipo:"backup_tabelas_csv",tabelas:Object.keys(a),totalRegistros:Object.values(a).reduce((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0),0),formato:"CSV",descricao:"Backup das tabelas do sistema OPIN em formato CSV"};o.file("metadata_".concat(r,".json"),JSON.stringify(n,null,2));const l=await o.generateAsync({type:"blob"}),d=window.URL.createObjectURL(l),c=document.createElement("a");c.href=d,c.download="backup_tabelas_csv_opin_".concat(r,".zip"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(d),v({status:"concluido",message:"Backup das tabelas em CSV realizado com sucesso!"}),setTimeout(()=>{v({}),N(0)},3e3)}catch(e){i.A.error("Erro no backup das tabelas:",e),v({status:"erro",message:"Erro no backup: ".concat(e.message)}),N(0)}},disabled:"tabelas"===f.status,className:"w-full px-4 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl hover:from-green-700 hover:to-green-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl",children:[(0,j.jsx)(Z.A,{className:"w-4 h-4 inline mr-2"}),"Backup Tabelas"]}),(0,j.jsx)("button",{onClick:async()=>{i.A.debug("Testando tabelas do Supabase..."),v({status:"testando",message:"Testando tabelas..."});const e=[];for(const o of w)try{i.A.debug("Testando tabela: ".concat(o.id));const{data:a,error:s}=await t.N.from(o.id).select("*").limit(5);s?(i.A.error("\u274c Erro na tabela ".concat(o.id,":"),s),e.push({tabela:o.id,status:"erro",mensagem:s.message})):(i.A.debug("\u2705 Tabela ".concat(o.id," OK - ").concat((null===a||void 0===a?void 0:a.length)||0," registros encontrados")),e.push({tabela:o.id,status:"ok",registros:(null===a||void 0===a?void 0:a.length)||0}))}catch(r){i.A.error("\u274c Exce\xe7\xe3o na tabela ".concat(o.id,":"),r),e.push({tabela:o.id,status:"excecao",mensagem:r.message})}i.A.debug("Resultados dos testes de tabelas:",e);const a=e.filter(e=>"ok"===e.status).length,s=e.filter(e=>"erro"===e.status||"excecao"===e.status).length;v(0===s?{status:"concluido",message:"\u2705 Todas as tabelas est\xe3o funcionando! ".concat(a," tabelas testadas.")}:{status:"erro",message:"\u26a0\ufe0f ".concat(s," tabela(s) com problema. Verifique o console para detalhes.")}),setTimeout(()=>{v({})},5e3)},className:"w-full px-3 py-2 bg-gray-700/50 text-gray-300 rounded-lg hover:bg-gray-600/50 transition-colors border border-gray-600/50 text-sm",children:"\ud83d\udd0d Testar Tabelas"})]})]}),(0,j.jsxs)("div",{className:"bg-gradient-to-br from-purple-600/20 to-purple-700/20 rounded-xl p-6 border border-purple-500/30 hover:border-purple-400/50 transition-all duration-200",children:[(0,j.jsxs)("div",{className:"flex items-center mb-4",children:[(0,j.jsx)("div",{className:"bg-purple-500 p-3 rounded-lg mr-3",children:(0,j.jsx)(ee.A,{className:"w-6 h-6 text-white"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h5",{className:"font-semibold text-gray-100",children:"Backup das Imagens"}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Apenas arquivos"})]})]}),(0,j.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:"Apenas as imagens dos buckets em arquivo ZIP"}),(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsxs)("button",{onClick:async()=>{try{i.A.debug("Iniciando backup das imagens..."),v({status:"imagens",message:"Preparando backup das imagens..."}),N(0);const a=[];for(let s=0;s<A.length;s++){const o=A[s];try{i.A.debug("Processando bucket: ".concat(o.id," (").concat(o.nome,")")),v({status:"imagens",message:"Processando bucket: ".concat(o.nome,"...")});const{data:n,error:l}=await t.N.storage.from(o.id).list("",{limit:1e3});if(l)throw i.A.error("Erro ao listar arquivos do bucket ".concat(o.id,":"),l),l;if(i.A.debug("Bucket ".concat(o.id," tem ").concat((null===n||void 0===n?void 0:n.length)||0," arquivos")),n&&n.length>0)for(const s of n)try{i.A.debug("Gerando URL para: ".concat(s.name));const{data:e,error:n}=await t.N.storage.from(o.id).createSignedUrl(s.name,3600);if(n){i.A.error("Erro ao gerar URL para ".concat(s.name,":"),n);continue}if(null!==e&&void 0!==e&&e.signedUrl){const t=(0,r.A)((0,r.A)({},s),{},{url:e.signedUrl,bucket:o.id,bucketNome:o.nome});a.push(t),i.A.debug("URL gerada para ".concat(s.name,": ").concat(e.signedUrl.substring(0,50),"..."))}else i.A.warn("URL n\xe3o gerada para ".concat(s.name))}catch(e){i.A.error("Erro ao gerar URL para ".concat(s.name,":"),e)}else i.A.debug("Bucket ".concat(o.id," est\xe1 vazio"));N((s+1)/A.length*100)}catch(e){i.A.error("Erro ao processar bucket ".concat(o.id,":"),e)}}i.A.debug("Total de arquivos encontrados: ".concat(a.length)),a.length>0?(v({status:"download",message:"Criando arquivo ZIP com ".concat(a.length," imagens...")}),await P(a,"imagens_opin_".concat((new Date).toISOString().split("T")[0],".zip")),v({status:"concluido",message:"Backup das imagens realizado com sucesso! ".concat(a.length," arquivos baixados.")})):v({status:"concluido",message:"Nenhuma imagem encontrada para backup."}),setTimeout(()=>{v({}),N(0)},3e3)}catch(e){i.A.error("Erro no backup das imagens:",e),v({status:"erro",message:"Erro no backup: ".concat(e.message)}),N(0)}},disabled:"imagens"===f.status||"download"===f.status,className:"w-full px-4 py-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-xl hover:from-purple-700 hover:to-purple-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl",children:[(0,j.jsx)(ee.A,{className:"w-4 h-4 inline mr-2"}),"Backup Imagens"]}),(0,j.jsx)("button",{onClick:async()=>{i.A.debug("Testando buckets do Supabase..."),v({status:"testando",message:"Testando buckets..."});const e=[];for(const n of A)try{i.A.debug("Testando bucket: ".concat(n.id));const{data:a,error:s}=await t.N.storage.from(n.id).list("",{limit:1e3});s?(i.A.error("\u274c Erro no bucket ".concat(n.id,":"),s),e.push({bucket:n.id,status:"erro",mensagem:s.message})):(i.A.debug("\u2705 Bucket ".concat(n.id," OK - ").concat((null===a||void 0===a?void 0:a.length)||0," arquivos encontrados")),a&&a.length>0&&i.A.debug("\ud83d\udcc1 Arquivos no bucket ".concat(n.id,":"),a.map(e=>e.name)),e.push({bucket:n.id,status:"ok",arquivos:(null===a||void 0===a?void 0:a.length)||0}))}catch(o){i.A.error("\u274c Exce\xe7\xe3o no bucket ".concat(n.id,":"),o),e.push({bucket:n.id,status:"excecao",mensagem:o.message})}i.A.debug("Resultados dos testes:",e);const a=e.filter(e=>"ok"===e.status).length,s=e.filter(e=>"erro"===e.status||"excecao"===e.status).length,r=e.reduce((e,a)=>e+(a.arquivos||0),0);v(0===s?{status:"concluido",message:"\u2705 Todos os buckets est\xe3o funcionando! ".concat(a," buckets testados, ").concat(r," arquivos encontrados.")}:{status:"erro",message:"\u26a0\ufe0f ".concat(s," bucket(s) com problema. Verifique o console para detalhes.")}),setTimeout(()=>{v({})},5e3)},className:"w-full px-3 py-2 bg-gray-700/50 text-gray-300 rounded-lg hover:bg-gray-600/50 transition-colors border border-gray-600/50 text-sm",children:"\ud83d\udd0d Testar Buckets"})]})]})]}),f.status&&(0,j.jsx)("div",{className:"p-6 rounded-xl border backdrop-blur-sm ".concat("concluido"===f.status?"bg-green-900/50 border-green-700/50 text-green-200":"erro"===f.status?"bg-red-900/50 border-red-700/50 text-red-200":"bg-blue-900/50 border-blue-700/50 text-blue-200"),children:(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:["concluido"===f.status?(0,j.jsx)(_.A,{className:"w-6 h-6 text-green-400"}):"erro"===f.status?(0,j.jsx)(C.A,{className:"w-6 h-6 text-red-400"}):(0,j.jsx)("div",{className:"w-6 h-6"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"font-semibold",children:f.message}),f.detalhes&&(0,j.jsxs)("p",{className:"text-sm mt-1 text-gray-300",children:["Tabelas: ",f.detalhes.tabelas," | Registros: ",f.detalhes.registros," | Arquivos: ",f.detalhes.arquivos]})]})]}),y>0&&y<100&&(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"w-32 bg-gray-700 rounded-full h-2",children:(0,j.jsx)("div",{className:"bg-green-400 h-2 rounded-full transition-all duration-300",style:{width:"".concat(y,"%")}})}),(0,j.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(y),"%"]})]})]})})]}),(0,j.jsxs)("div",{className:"bg-gray-800/30 rounded-xl p-6 border border-gray-700/30",children:[(0,j.jsxs)("h4",{className:"text-lg font-semibold text-gray-100 mb-6 flex items-center gap-2",children:[(0,j.jsx)(Z.A,{className:"w-5 h-5 text-gray-400"}),"Tabelas do Sistema"]}),(0,j.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>{const a=e.icone,s=u===e.id;return(0,j.jsx)("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-xl border-2 cursor-pointer transition-all duration-200 hover:shadow-lg ".concat(s?"border-green-500/50 bg-green-600/20":"border-gray-700/50 hover:border-gray-600/50 hover:bg-gray-700/30"),onClick:()=>E(e.id),children:(0,j.jsxs)("div",{className:"p-6",children:[(0,j.jsxs)("div",{className:"flex items-center mb-4",children:[(0,j.jsx)("div",{className:"".concat(e.cor," p-3 rounded-lg mr-3 shadow-lg"),children:(0,j.jsx)(a,{className:"w-6 h-6 text-white"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h4",{className:"font-semibold text-gray-100",children:e.nome}),(0,j.jsxs)("p",{className:"text-sm text-gray-400",children:[e.registros," registros"]})]})]}),(0,j.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:e.descricao}),(0,j.jsx)("div",{className:"flex space-x-2",children:(0,j.jsxs)("button",{className:"flex items-center px-3 py-2 text-xs bg-blue-600/20 text-blue-300 rounded-lg hover:bg-blue-600/30 transition-colors border border-blue-500/30",onClick:a=>{a.stopPropagation(),E(e.id)},children:[(0,j.jsx)(k.A,{className:"w-3 h-3 mr-1"}),"Visualizar"]})})]})},e.id)})})]}),u&&(0,j.jsxs)("div",{className:"bg-gray-800/30 rounded-xl p-6 border border-gray-700/30",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsxs)("h4",{className:"text-lg font-semibold text-gray-100",children:["Dados da Tabela: ",null===(e=a.find(e=>e.id===u))||void 0===e?void 0:e.nome]}),(0,j.jsxs)("p",{className:"text-sm text-gray-400",children:[x.length," registros encontrados"]})]}),(0,j.jsxs)("div",{className:"flex space-x-3",children:[(0,j.jsxs)("button",{onClick:()=>E(u),disabled:h,className:"flex items-center px-4 py-2 text-sm bg-gray-700/50 text-gray-200 rounded-lg hover:bg-gray-600/50 transition-colors disabled:opacity-50 border border-gray-600/50",children:[(0,j.jsx)(ae.A,{className:"w-4 h-4 mr-2"}),"Atualizar"]}),(0,j.jsxs)("button",{onClick:()=>((e,a)=>{if(!a||0===a.length)return void alert("Nenhum dado para baixar");const s=Object.keys(a[0]),r=[s.join(","),...a.map(e=>s.map(a=>{const s=e[a];return"string"===typeof s&&(s.includes(",")||s.includes("\n")||s.includes('"'))?'"'.concat(s.replace(/"/g,'""'),'"'):s||""}).join(","))].join("\n"),o=new Blob([r],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),n=URL.createObjectURL(o);t.setAttribute("href",n),t.setAttribute("download","".concat(e,"_").concat((new Date).toISOString().split("T")[0],".csv")),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)})(u,x),disabled:h||0===x.length,className:"flex items-center px-4 py-2 text-sm bg-green-600/20 text-green-300 rounded-lg hover:bg-green-600/30 transition-colors disabled:opacity-50 border border-green-500/30",children:[(0,j.jsx)(M.A,{className:"w-4 h-4 mr-2"}),"CSV"]}),(0,j.jsxs)("button",{onClick:()=>((e,a)=>{if(!a||0===a.length)return void alert("Nenhum dado para baixar");const s=JSON.stringify(a,null,2),r=new Blob([s],{type:"application/json;charset=utf-8;"}),o=document.createElement("a"),t=URL.createObjectURL(r);o.setAttribute("href",t),o.setAttribute("download","".concat(e,"_").concat((new Date).toISOString().split("T")[0],".json")),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)})(u,x),disabled:h||0===x.length,className:"flex items-center px-4 py-2 text-sm bg-purple-600/20 text-purple-300 rounded-lg hover:bg-purple-600/30 transition-colors disabled:opacity-50 border border-purple-500/30",children:[(0,j.jsx)(M.A,{className:"w-4 h-4 mr-2"}),"JSON"]})]})]}),c&&(0,j.jsx)("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-700/50 text-red-200 rounded-xl backdrop-blur-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)(C.A,{className:"w-5 h-5 text-red-400"}),(0,j.jsx)("span",{children:c})]})}),h?(0,j.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,j.jsx)("span",{className:"ml-3 text-gray-400",children:"Carregando dados..."})}):(0,j.jsxs)("div",{className:"overflow-x-auto",children:[x.length>0?(0,j.jsxs)("table",{className:"min-w-full divide-y divide-gray-700",children:[(0,j.jsx)("thead",{className:"bg-gray-700/30",children:(0,j.jsx)("tr",{children:Object.keys(x[0]).map(e=>(0,j.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:e},e))})}),(0,j.jsx)("tbody",{className:"bg-gray-800/20 divide-y divide-gray-700",children:x.slice(0,100).map((e,a)=>(0,j.jsx)("tr",{className:"hover:bg-gray-700/30 transition-colors",children:Object.values(e).map((e,a)=>(0,j.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-200 max-w-xs truncate",title:"string"===typeof e&&e.length>50?e:"",children:"string"===typeof e&&e.length>50?"".concat(e.substring(0,50),"..."):e||"-"},a))},a))})]}):(0,j.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,j.jsx)("div",{className:"w-16 h-16 bg-gray-700/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,j.jsx)(Z.A,{className:"w-8 h-8 text-gray-500"})}),(0,j.jsx)("p",{children:"Nenhum dado encontrado nesta tabela"})]}),x.length>100&&(0,j.jsxs)("div",{className:"mt-6 text-center text-sm text-gray-400 bg-gray-700/20 p-4 rounded-lg",children:["Mostrando os primeiros 100 registros de ",x.length," total. Use os bot\xf5es de download para acessar todos os dados."]})]})]})]})},re=e=>{let{isOpen:a,onClose:s}=e;return a?(0,j.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,j.jsxs)("div",{className:"bg-gray-900/95 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-800/50 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,j.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-800/50 flex-shrink-0",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"bg-blue-500 p-3 rounded-lg",children:(0,j.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-100",children:"Backup dos Dados do Site"}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Gerencie backups das tabelas e arquivos"})]})]}),(0,j.jsx)("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-800 rounded-lg transition-colors",children:(0,j.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,j.jsx)(se,{})})]})}):null},oe=e=>{let{isOpen:a,onClose:s,escolas:r,escolaToDelete:o,setEscolaToDelete:t,onConfirmDelete:n,isDeleting:i}=e;return a?(0,j.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,j.jsxs)("div",{className:"bg-gray-900/95 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-800/50 w-full max-w-md",children:[(0,j.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-800/50",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"bg-red-500 p-3 rounded-lg",children:(0,j.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-100",children:"Remover Escola"}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Selecione uma escola para remover"})]})]}),(0,j.jsx)("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-800 rounded-lg transition-colors",children:(0,j.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsx)("div",{className:"p-6",children:o?(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"bg-red-900/20 border border-red-700/50 rounded-xl p-4",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,j.jsx)("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,j.jsx)("h3",{className:"font-semibold text-red-200",children:"Confirmar Remo\xe7\xe3o"})]}),(0,j.jsxs)("p",{className:"text-red-300 text-sm",children:["Voc\xea est\xe1 prestes a remover a escola ",(0,j.jsxs)("strong",{children:['"',o.Escola,'"']})," de ",(0,j.jsxs)("strong",{children:['"',o["Munic\xedpio"],'"']}),"."]}),(0,j.jsx)("p",{className:"text-red-400 text-sm mt-2",children:"\u26a0\ufe0f Esta a\xe7\xe3o \xe9 irrevers\xedvel e remover\xe1 todos os dados da escola do sistema."})]}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:()=>t(null),className:"flex-1 px-4 py-3 bg-gray-700 text-gray-200 rounded-xl hover:bg-gray-600 transition-colors",children:"Cancelar"}),(0,j.jsx)("button",{onClick:n,disabled:i,className:"flex-1 px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:i?(0,j.jsx)("div",{className:"flex items-center gap-2 justify-center",children:"Removendo..."}):(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Confirmar Remo\xe7\xe3o"]})})]})]}):(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsx)("p",{className:"text-gray-300 mb-4",children:"Selecione uma escola da lista para remover:"}),(0,j.jsx)("div",{className:"max-h-64 overflow-y-auto space-y-2",children:r.map(e=>(0,j.jsx)("button",{onClick:()=>t(e),className:"w-full text-left p-4 rounded-xl hover:bg-gray-800/50 transition-all duration-200 border border-transparent hover:border-gray-700/50 text-gray-200 hover:text-white",children:(0,j.jsxs)("div",{className:"flex items-start justify-between",children:[(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsx)("h3",{className:"font-medium truncate text-gray-200",children:e.Escola}),e["Munic\xedpio"]&&(0,j.jsx)("p",{className:"text-sm text-gray-400 truncate mt-1",children:e["Munic\xedpio"]})]}),(0,j.jsx)("div",{className:"ml-2 flex-shrink-0",children:(0,j.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},e.id))})]})})]})}):null};var te=s(98137);const ne=e=>{let{cardId:a,editingLocation:s,setEditingLocation:t,label:n}=e;const{globalVisibility:i}=(0,te.V)(),[l,d]=(0,o.useState)(!1),c=(null===s||void 0===s?void 0:s.cards_visibilidade)||{},m=(0,O.Rf)(c,a,i),u=!(c&&c.hasOwnProperty(a))&&i,g=(null===n||void 0===n?void 0:n.replace("Visibilidade do Card: ",""))||"Card";return(0,j.jsx)("div",{className:"mb-4 p-3 bg-gray-800/30 rounded-lg border border-gray-700/30",children:(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,j.jsx)("span",{className:"text-sm font-medium text-gray-200",children:g}),u&&(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("button",{onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),className:"text-gray-500 hover:text-gray-400 transition-colors","aria-label":"Usando configura\xe7\xe3o global",children:(0,j.jsx)(F.A,{className:"w-3 h-3"})}),l&&(0,j.jsx)("div",{className:"absolute left-0 top-5 w-64 bg-gray-800 border border-gray-700 rounded-lg p-3 shadow-xl z-50",children:(0,j.jsx)("p",{className:"text-xs text-gray-300",children:"Usando configura\xe7\xe3o global. Alterar aqui criar\xe1 uma configura\xe7\xe3o individual para esta escola."})})]})]}),(0,j.jsx)("button",{onClick:()=>{const e=(null===s||void 0===s?void 0:s.cards_visibilidade)||{},o=(0,r.A)({},e);o[a]=(!u||!m)&&(!(!u||m)||!m),t((0,r.A)((0,r.A)({},s),{},{cards_visibilidade:o}))},className:"\n            relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900\n            ".concat(m?"bg-green-600":"bg-gray-600","\n          "),role:"switch","aria-checked":m,"aria-label":"".concat(m?"Ocultar":"Mostrar"," ").concat(g),children:(0,j.jsx)("span",{className:"\n              inline-block h-4 w-4 transform rounded-full bg-white transition-transform\n              ".concat(m?"translate-x-6":"translate-x-1","\n            ")})})]})})},ie=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-8",children:[(0,j.jsx)(ne,{cardId:"basicInfo",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Informa\xe7\xf5es B\xe1sicas"}),(0,j.jsxs)("div",{className:"bg-gray-800/30 rounded-xl p-6 border border-gray-700/30",children:[(0,j.jsxs)("h3",{className:"text-lg font-semibold text-gray-100 mb-6 flex items-center gap-2",children:[(0,j.jsx)("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Informa\xe7\xf5es Principais"]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,j.jsxs)("div",{className:"lg:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Nome da Escola *"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a.Escola||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{Escola:e.target.value})),placeholder:"Digite o nome da escola"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Munic\xedpio"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a["Munic\xedpio"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Munic\xedpio":e.target.value})),placeholder:"Digite o munic\xedpio"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Ano de Cria\xe7\xe3o da Escola"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a["Ano de cria\xe7\xe3o da escola"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Ano de cria\xe7\xe3o da escola":e.target.value})),placeholder:"Ex: 1995"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Terra Ind\xedgena (TI)"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a["Terra Indigena (TI)"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Terra Indigena (TI)":e.target.value})),placeholder:"Digite o nome da Terra Ind\xedgena"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Diretoria de Ensino"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a["Diretoria de Ensino"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Diretoria de Ensino":e.target.value})),placeholder:"Digite a diretoria de ensino"})]}),(0,j.jsxs)("div",{className:"lg:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Parcerias com o Munic\xedpio"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 h-32 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm resize-none",value:a["Parcerias com o munic\xedpio"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Parcerias com o munic\xedpio":e.target.value})),placeholder:"Descreva as parcerias com o munic\xedpio..."})]})]})]}),(0,j.jsxs)("div",{className:"bg-gray-800/30 rounded-xl p-6 border border-gray-700/30",children:[(0,j.jsxs)("h3",{className:"text-lg font-semibold text-gray-100 mb-6 flex items-center gap-2",children:[(0,j.jsxs)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Endere\xe7o Completo"]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Logradouro"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a.logradouro||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{logradouro:e.target.value})),placeholder:"Rua, Avenida, etc."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"N\xfamero"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a.numero||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{numero:e.target.value})),placeholder:"N\xfamero"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Complemento"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a.complemento||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{complemento:e.target.value})),placeholder:"Apto, Casa, etc."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Bairro"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a.bairro||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{bairro:e.target.value})),placeholder:"Nome do bairro"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"CEP"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm",value:a.cep||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{cep:e.target.value})),placeholder:"00000-000"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Estado"}),(0,j.jsxs)("select",{className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 transition-all duration-200 backdrop-blur-sm",value:a.estado||"SP",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{estado:e.target.value})),children:[(0,j.jsx)("option",{value:"SP",children:"S\xe3o Paulo"}),(0,j.jsx)("option",{value:"RJ",children:"Rio de Janeiro"}),(0,j.jsx)("option",{value:"MG",children:"Minas Gerais"}),(0,j.jsx)("option",{value:"ES",children:"Esp\xedrito Santo"})]})]})]})]}),(0,j.jsxs)("div",{className:"bg-gray-800/30 rounded-xl p-6 border border-gray-700/30",children:[(0,j.jsxs)("h3",{className:"text-lg font-semibold text-gray-100 mb-6 flex items-center gap-2",children:[(0,j.jsx)("svg",{className:"w-5 h-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Endere\xe7o (Campo Legado)"]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-3",children:"Endere\xe7o Completo"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800/50 rounded-xl px-4 py-3 h-24 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100 placeholder-gray-400 transition-all duration-200 backdrop-blur-sm resize-none",value:a["Endere\xe7o"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Endere\xe7o":e.target.value})),placeholder:"Endere\xe7o completo da escola..."}),(0,j.jsx)("p",{className:"text-gray-500 text-xs mt-2",children:"Este campo \xe9 mantido para compatibilidade com dados existentes"})]})]})]})},le=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Povos Ind\xedgenas"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Povos indigenas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Povos indigenas":e.target.value})),placeholder:"Descreva os povos ind\xedgenas atendidos pela escola..."}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Ex: Guarani, Kaingang, Terena, etc."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"L\xednguas Faladas"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Linguas faladas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Linguas faladas":e.target.value})),placeholder:"Descreva as l\xednguas faladas na comunidade escolar..."}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Ex: Portugu\xeas, Guarani, Kaingang, etc."})]})]})},de=e=>{let{editingLocation:a,setEditingLocation:s}=e;const{selectedModalidades:o,outroModalidade:t,handleModalidadeChange:n,handleOutroModalidadeChange:i,saveModalidades:l,getModalidadesPreview:d,hasSelectedModalidades:g}=u();return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"modalidades",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Modalidades de Ensino"}),(0,j.jsxs)("div",{className:"md:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-4 text-base",children:"Modalidades de Ensino"}),(0,j.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 max-h-96 overflow-y-auto",children:(0,j.jsxs)("div",{className:"space-y-4",children:[m.map(e=>(0,j.jsxs)("div",{children:[(0,j.jsx)("h4",{className:"text-sm font-semibold text-green-400 mb-2 border-b border-gray-600 pb-1",children:e.titulo}),(0,j.jsx)("div",{className:"space-y-2 ml-2",children:e.indices.map(e=>{const a=c[e];return(0,j.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[(0,j.jsx)("input",{type:"checkbox",className:"mt-1 h-4 w-4 text-green-600 bg-gray-700 border-gray-600 rounded focus:ring-green-500 focus:ring-2",checked:o.includes(a),onChange:()=>n(a)}),(0,j.jsx)("span",{className:"text-sm text-gray-200 leading-relaxed",children:a})]},e)})})]},e.id)),(0,j.jsx)("div",{className:"border-t border-gray-600 pt-3 mt-3",children:(0,j.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[(0,j.jsx)("input",{type:"checkbox",className:"mt-1 h-4 w-4 text-green-600 bg-gray-700 border-gray-600 rounded focus:ring-green-500 focus:ring-2",checked:o.some(e=>e.startsWith("Outro:"))||""!==t.trim(),onChange:e=>{e.target.checked&&!t.trim()?i("Modalidade espec\xedfica"):e.target.checked||i("")}}),(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsx)("span",{className:"text-sm text-gray-200",children:"Outro (especificar):"}),(0,j.jsx)("input",{type:"text",className:"mt-1 w-full px-3 py-2 border border-gray-600 rounded text-sm bg-gray-700 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Digite a modalidade espec\xedfica...",value:t,onChange:e=>i(e.target.value)})]})]})})]})})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"N\xfamero de Alunos"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Numero de alunos"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Numero de alunos":e.target.value}))})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Turnos de Funcionamento"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a.turnos_funcionamento||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{turnos_funcionamento:e.target.value})),placeholder:"Ex: Diurno, Noturno, Vespertino, etc."})]}),(0,j.jsx)("div",{className:"md:col-span-2",children:(0,j.jsx)("button",{type:"button",onClick:()=>{const e=l();s(a=>(0,r.A)((0,r.A)({},a),{},{"Modalidade de Ensino/turnos de funcionamento":e}))},className:"px-4 py-2 bg-green-700 text-white rounded-lg hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors",children:"Salvar Modalidades Selecionadas"})}),g()&&(0,j.jsxs)("div",{className:"md:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Preview do Texto Final"}),(0,j.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded px-3 py-2 text-gray-200 text-sm min-h-[60px]",children:d()})]})]})},ce=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"infraestrutura",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Infraestrutura"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Acesso \xe0 \xc1gua"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Acesso \xe0 \xe1gua"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Acesso \xe0 \xe1gua":e.target.value})),placeholder:"Descreva como \xe9 o acesso \xe0 \xe1gua na escola..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Coleta de Lixo"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Tem coleta de lixo?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Tem coleta de lixo?":e.target.value})),placeholder:"Descreva como \xe9 feita a coleta de lixo..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Acesso \xe0 Internet"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Acesso \xe0 internet"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Acesso \xe0 internet":e.target.value})),placeholder:"Descreva o acesso \xe0 internet na escola..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Equipamentos Tecnol\xf3gicos"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Equipamentos Tecs"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Equipamentos Tecs":e.target.value})),placeholder:"Descreva os equipamentos tecnol\xf3gicos dispon\xedveis..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Modo de Acesso \xe0 Escola"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Modo de acesso \xe0 escola"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Modo de acesso \xe0 escola":e.target.value})),placeholder:"Descreva como \xe9 o acesso \xe0 escola..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Cozinha"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.cozinha||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{cozinha:e.target.value})),placeholder:"Descreva a estrutura da cozinha..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Escolar"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.merenda_escolar||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{merenda_escolar:e.target.value})),placeholder:"Descreva como \xe9 fornecida a merenda escolar..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Diferenciada"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.diferenciada||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{diferenciada:e.target.value})),placeholder:"Descreva se h\xe1 merenda diferenciada (cultural, religiosa, etc.)..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Diferenciada (Detalhes)"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.merenda_diferenciada||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{merenda_diferenciada:e.target.value})),placeholder:"Descreva detalhes sobre a merenda diferenciada..."})]})]})},me=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"gestaoProfessores",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Gest\xe3o e Professores"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Gest\xe3o/Nome"}),(0,j.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Gest\xe3o/Nome"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Gest\xe3o/Nome":e.target.value})),placeholder:"Digite o nome do gestor/diretor"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores Ind\xedgenas"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Quantidade de professores ind\xedgenas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Quantidade de professores ind\xedgenas":e.target.value})),placeholder:"Descreva os professores ind\xedgenas..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores N\xe3o Ind\xedgenas"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Quantidade de professores n\xe3o ind\xedgenas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Quantidade de professores n\xe3o ind\xedgenas":e.target.value})),placeholder:"Descreva os professores n\xe3o ind\xedgenas..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores Falam L\xedngua Ind\xedgena?"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Professores falam a l\xedngua ind\xedgena?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Professores falam a l\xedngua ind\xedgena?":e.target.value})),placeholder:"Descreva se os professores falam a l\xedngua ind\xedgena..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Forma\xe7\xe3o dos Professores"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Forma\xe7\xe3o dos professores"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Forma\xe7\xe3o dos professores":e.target.value})),placeholder:"Descreva a forma\xe7\xe3o dos professores..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Forma\xe7\xe3o Continuada"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Forma\xe7\xe3o continuada oferecida"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Forma\xe7\xe3o continuada oferecida":e.target.value})),placeholder:"Descreva a forma\xe7\xe3o continuada oferecida aos professores..."})]})]})},ue=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"A escola possui PPP pr\xf3prio?"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["A escola possui PPP pr\xf3prio?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"A escola possui PPP pr\xf3prio?":e.target.value})),placeholder:"Descreva se a escola possui PPP pr\xf3prio..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"PPP elaborado com a comunidade?"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["PPP elaborado com a comunidade?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"PPP elaborado com a comunidade?":e.target.value})),placeholder:"Descreva se o PPP foi elaborado com a comunidade..."})]})]})},ge=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"projetosParcerias",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Projetos e Parcerias"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Projetos em Andamento"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Projetos em andamento"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Projetos em andamento":e.target.value})),placeholder:"Descreva os projetos em andamento na escola..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Parcerias com Universidades"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Parcerias com universidades?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Parcerias com universidades?":e.target.value})),placeholder:"Descreva as parcerias com universidades..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"A\xe7\xf5es com ONGs ou Coletivos"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["A\xe7\xf5es com ONGs ou coletivos?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"A\xe7\xf5es com ONGs ou coletivos?":e.target.value})),placeholder:"Descreva as a\xe7\xf5es com ONGs ou coletivos..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Desejos da Comunidade"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Desejos da comunidade para a escola"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Desejos da comunidade para a escola":e.target.value})),placeholder:"Descreva os desejos da comunidade para a escola..."})]})]})},xe=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Escola utiliza redes sociais?"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Escola utiliza redes sociais?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Escola utiliza redes sociais?":e.target.value})),placeholder:"Descreva se a escola utiliza redes sociais..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Links das Redes Sociais"}),(0,j.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Links das redes sociais"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Links das redes sociais":e.target.value})),placeholder:"Cole aqui os links das redes sociais da escola (Facebook, Instagram, YouTube, etc.)..."})]})]})};var be=s(85759),he=s(96637),pe=s(32481);const fe=e=>{let{escolaId:a}=e;const[s,t]=(0,o.useState)([]),[n,i]=(0,o.useState)(!0),[l,d]=(0,o.useState)(null),[c,m]=(0,o.useState)(""),[u,g]=(0,o.useState)(!1),[x,b]=(0,o.useState)(null),[h,p]=(0,o.useState)({titulo:"",video_url:"",descricao:"",plataforma:"youtube",categoria:"geral",ativo:!0}),f=(0,o.useCallback)(async()=>{try{i(!0),d(null);const e=await(0,be.Sv)(a);t(e)}catch(e){d(e.message)}finally{i(!1)}},[a]);(0,o.useEffect)(()=>{a&&f()},[a,f]);const v=()=>{p({titulo:"",video_url:"",descricao:"",plataforma:"youtube",categoria:"geral",ativo:!0}),b(null),g(!1)};return n?(0,j.jsx)("div",{className:"p-6 text-center",children:"Carregando v\xeddeos..."}):(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"V\xeddeos da Escola"}),(0,j.jsxs)("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,j.jsx)(he.A,{className:"w-5 h-5"}),"Novo V\xeddeo"]})]}),l&&(0,j.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-600",children:l}),c&&(0,j.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg text-green-600",children:c}),(0,j.jsx)("div",{className:"space-y-4",children:0===s.length?(0,j.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,j.jsx)("p",{className:"text-gray-500",children:"Nenhum v\xeddeo cadastrado."}),(0,j.jsx)("button",{onClick:()=>g(!0),className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Adicionar v\xeddeo"})]}):s.map(e=>(0,j.jsx)("div",{className:"p-6 bg-white rounded-lg border ".concat(e.ativo?"":"opacity-60"),children:(0,j.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,j.jsx)("h4",{className:"font-medium text-gray-900",children:e.titulo}),!e.ativo&&(0,j.jsx)("span",{className:"flex items-center gap-1 text-orange-600 text-sm",children:"Inativo"})]}),(0,j.jsx)("p",{className:"text-gray-700 text-sm mb-2",children:e.descricao}),(0,j.jsx)("div",{className:"mb-2",children:(0,j.jsx)("iframe",{src:e.video_url,title:e.titulo,className:"w-full aspect-video rounded-lg border",allowFullScreen:!0})}),(0,j.jsxs)("div",{className:"text-xs text-gray-500",children:["Plataforma: ",e.plataforma," | Categoria: ",e.categoria]})]}),(0,j.jsxs)("div",{className:"flex flex-col gap-2 ml-4",children:[(0,j.jsx)("button",{onClick:()=>(e=>{b(e),p({titulo:e.titulo||"",video_url:e.video_url||"",descricao:e.descricao||"",plataforma:e.plataforma||"youtube",categoria:e.categoria||"geral",ativo:e.ativo}),g(!0)})(e),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg",title:"Editar",children:(0,j.jsx)(pe.A,{className:"w-5 h-5"})}),(0,j.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este v\xeddeo?"))try{await(0,be.Y5)(e),m("V\xeddeo exclu\xeddo com sucesso!"),f()}catch(a){d(a.message)}})(e.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg",title:"Excluir",children:(0,j.jsx)(V.A,{className:"w-5 h-5"})})]})]})},e.id))}),u&&(0,j.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,j.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:x?"Editar V\xeddeo":"Novo V\xeddeo"}),(0,j.jsxs)("button",{onClick:v,className:"text-gray-400 hover:text-gray-600",children:[(0,j.jsx)("span",{className:"sr-only",children:"Fechar"}),"\xd7"]})]}),(0,j.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!h.titulo.trim()||!h.video_url.trim())return void d("T\xedtulo e URL do v\xeddeo s\xe3o obrigat\xf3rios.");const s=(0,r.A)((0,r.A)({escola_id:Number(a)},h),{},{ativo:Boolean(h.ativo)});try{d(""),m(""),x?(await(0,be.MK)(x.id,s),m("V\xeddeo atualizado com sucesso!")):(await(0,be.dq)(s),m("V\xeddeo criado com sucesso!")),v(),f()}catch(o){d(o.message)}},className:"space-y-4",children:[(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo *"}),(0,j.jsx)("input",{type:"text",value:h.titulo,onChange:e=>p((0,r.A)((0,r.A)({},h),{},{titulo:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"T\xedtulo do v\xeddeo",required:!0})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo *"}),(0,j.jsx)("input",{type:"url",value:h.video_url,onChange:e=>p((0,r.A)((0,r.A)({},h),{},{video_url:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"https://www.youtube.com/embed/...",required:!0})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,j.jsx)("textarea",{value:h.descricao,onChange:e=>p((0,r.A)((0,r.A)({},h),{},{descricao:e.target.value})),rows:3,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Descri\xe7\xe3o do v\xeddeo (opcional)"})]}),(0,j.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plataforma"}),(0,j.jsx)("input",{type:"text",value:h.plataforma,onChange:e=>p((0,r.A)((0,r.A)({},h),{},{plataforma:e.target.value})),className:"w-full border rounded-lg px-3 py-2",placeholder:"youtube, vimeo..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,j.jsx)("input",{type:"text",value:h.categoria,onChange:e=>p((0,r.A)((0,r.A)({},h),{},{categoria:e.target.value})),className:"w-full border rounded-lg px-3 py-2",placeholder:"geral, institucional..."})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2 mt-6",children:[(0,j.jsx)("input",{type:"checkbox",checked:h.ativo,onChange:e=>p((0,r.A)((0,r.A)({},h),{},{ativo:e.target.checked})),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,j.jsx)("span",{className:"text-sm text-gray-700",children:"Ativo"})]})]}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,j.jsx)(z.A,{className:"w-5 h-5"}),x?"Atualizar":"Criar"]}),(0,j.jsx)("button",{type:"button",onClick:v,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})]})},ve=e=>{let{editingLocation:a,setEditingLocation:s}=e;const r=(null===a||void 0===a?void 0:a.id)||(null===a||void 0===a?void 0:a.escola_id);return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"videos",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: V\xeddeos"}),(0,j.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4 border-b border-gray-600 pb-2",children:"Gerenciamento de V\xeddeos"}),(0,j.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Aqui voc\xea pode adicionar, editar e gerenciar v\xeddeos relacionados \xe0 escola. Os v\xeddeos podem ser do YouTube, Vimeo ou outras plataformas."})]}),r?(0,j.jsx)("div",{className:"bg-white rounded-lg shadow-sm",children:(0,j.jsx)(fe,{escolaId:r})}):(0,j.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6 text-center",children:(0,j.jsx)("p",{className:"text-gray-300",children:"Selecione uma escola para gerenciar os v\xeddeos."})}),(0,j.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4 border-b border-gray-600 pb-2",children:"Como Adicionar V\xeddeos"}),(0,j.jsxs)("div",{className:"space-y-3 text-sm text-gray-300",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{className:"text-amber-400",children:"YouTube:"}),(0,j.jsx)("p",{children:"Use o formato: https://www.youtube.com/embed/VIDEO_ID"}),(0,j.jsx)("p",{className:"text-xs text-gray-400",children:"Exemplo: https://www.youtube.com/embed/dQw4w9WgXcQ"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{className:"text-amber-400",children:"Vimeo:"}),(0,j.jsx)("p",{children:"Use o formato: https://player.vimeo.com/video/VIDEO_ID"}),(0,j.jsx)("p",{className:"text-xs text-gray-400",children:"Exemplo: https://player.vimeo.com/video/123456789"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{className:"text-amber-400",children:"Outras plataformas:"}),(0,j.jsx)("p",{children:"Use o URL de embed fornecido pela plataforma"})]})]})]})]})};var ye=s(92823),je=s.n(ye);s(25884);const Ne="pdfs",we="media",Ae={PDF:{MAX_SIZE:10485760,ALLOWED_TYPES:["application/pdf"],MAX_FILES:1/0},IMAGE:{MAX_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/png","image/jpg"],MAX_FILES:10},AUDIO:{MAX_SIZE:20971520,ALLOWED_TYPES:["audio/wav","audio/mpeg","audio/mp3"],MAX_FILES:1}},Ee={PDF:"documents",IMAGE:"images",AUDIO:"audio"},ke=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ne;try{const s=(e=>Ae.PDF.ALLOWED_TYPES.includes(e.type)?"PDF":Ae.IMAGE.ALLOWED_TYPES.includes(e.type)?"IMAGE":Ae.AUDIO.ALLOWED_TYPES.includes(e.type)?"AUDIO":null)(e);if(!s)throw new Error("Tipo de arquivo n\xe3o suportado");const r=((e,a)=>{const s=Ae[a];return s?s.ALLOWED_TYPES.includes(e.type)?e.size>s.MAX_SIZE?{isValid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(s.MAX_SIZE/1048576,"MB")}:{isValid:!0}:{isValid:!1,error:"Tipo de arquivo n\xe3o permitido. Use apenas ".concat("PDF"===a?"PDF":"IMAGE"===a?"JPG/PNG":"WAV/MP3")}:{isValid:!1,error:"Tipo de arquivo n\xe3o suportado"}})(e,s);if(!r.isValid)throw new Error(r.error);const o=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=Date.now(),r=Math.random().toString(36).substring(2,8),o=e.name.split(".").pop();return"".concat(a).concat(s,"_").concat(r,".").concat(o)}(e,"".concat(s.toLowerCase(),"_")),n="".concat(Ee[s],"/").concat(o),{error:i}=await t.N.storage.from(a).upload(n,e,{cacheControl:"3600",upsert:!1});if(i)throw i;const{data:{publicUrl:l}}=t.N.storage.from(a).getPublicUrl(n);return l}catch(s){throw i.A.error("Erro ao fazer upload:",s),s}},Ce=async e=>ke(e,Ne),_e=e=>{let{value:a,onChange:s,placeholder:t,label:n,style:i={}}=e;const l=(0,o.useRef)(null),[d,c]=o.useState(null),m=(0,o.useCallback)(async()=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=async()=>{const a=e.files[0];if(a&&d)try{const e=d.getSelection();d.insertEmbed(e.index,"image","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");const s=await(async e=>ke(e,we))(a);d.deleteText(e.index,1),d.insertEmbed(e.index,"image",s),d.setSelection(e.index+1)}catch(s){console.error("Erro ao fazer upload da imagem:",s),alert("Erro ao fazer upload da imagem. Tente novamente.")}}},[d]),u=o.useMemo(()=>({toolbar:{container:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link"],["image"],["clean"]],handlers:{image:m}}}),[m]),g=(0,o.useCallback)((e,a,r,o)=>{s&&s(e,a,r,o)},[s]),x=(0,o.useCallback)(e=>{c(e)},[]);return(0,j.jsxs)("div",{className:"rich-text-editor",children:[n&&(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:n}),(0,j.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:(0,j.jsx)(je(),{ref:l,theme:"snow",value:a||"",onChange:g,onEditorReady:x,modules:u,formats:["header","bold","italic","underline","strike","color","background","list","bullet","align","link","image"],placeholder:t,style:(0,r.A)({height:"300px",backgroundColor:"#1f2937",color:"#f3f4f6"},i)})})]})},Le=e=>{let{value:a,onChange:s,placeholder:r,label:o}=e;return(0,j.jsx)(_e,{value:a,onChange:s,placeholder:r,label:o})},Pe=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"historiaEscola",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Hist\xf3ria da Escola"}),(0,j.jsx)(Le,{label:"Hist\xf3ria da Escola",value:a.historia_da_escola||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{historia_da_escola:e})),placeholder:"Digite a hist\xf3ria da escola..."})]})};var Se=s(82006);const De=class{static async uploadFotoProfessor(e,a,s){try{if(!e)throw new Error("Arquivo n\xe3o fornecido");if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type))throw new Error("Tipo de arquivo n\xe3o permitido. Use JPEG, PNG ou WebP.");const r=5242880;if(e.size>r)throw new Error("Arquivo muito grande. Tamanho m\xe1ximo: 5MB");const o=Date.now(),n=e.name.split(".").pop().toLowerCase(),l=a.toLowerCase().replace(/[\xe1\xe0\xe2\xe3\xe4]/g,"a").replace(/[\xe9\xe8\xea\xeb]/g,"e").replace(/[\xed\xec\xee\xef]/g,"i").replace(/[\xf3\xf2\xf4\xf5\xf6]/g,"o").replace(/[\xfa\xf9\xfb\xfc]/g,"u").replace(/[\xe7]/g,"c").replace(/[\xf1]/g,"n").replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_").substring(0,50),d="".concat(l,"_").concat(o,".").concat(n),c="".concat(s,"/").concat(d);if(!d||0===d.length)throw new Error("Nome do arquivo inv\xe1lido gerado");i.A.debug("Upload da foto:",{nomeOriginal:e.name,nomeSanitizado:l,nomeArquivo:d,caminhoArquivo:c,escolaId:s,nomeProfessor:a});const{error:m}=await t.N.storage.from("avatar").upload(c,e,{cacheControl:"3600",upsert:!1});if(m)throw new Error("Erro no upload: ".concat(m.message));const{data:{publicUrl:u}}=t.N.storage.from("avatar").getPublicUrl(c);return{success:!0,url:u,caminho:c}}catch(r){return i.A.error("Erro no upload da foto:",r),{success:!1,error:r.message}}}static async atualizarFotoProfessor(e,a){try{const{error:s}=await t.N.from("historias_professor").update({foto_rosto:a}).eq("id",e);if(s)throw new Error("Erro ao atualizar foto: ".concat(s.message));return{success:!0}}catch(s){return i.A.error("Erro ao atualizar foto do professor:",s),{success:!1,error:s.message}}}static async removerFotoProfessor(e,a){try{const{error:s}=await t.N.storage.from("avatar").remove([e]);s&&i.A.warn("Erro ao remover arquivo do storage:",s);const{error:r}=await t.N.from("historias_professor").update({foto_rosto:null}).eq("id",a);if(r)throw new Error("Erro ao atualizar banco de dados: ".concat(r.message));return{success:!0}}catch(s){return i.A.error("Erro ao remover foto do professor:",s),{success:!1,error:s.message}}}static async buscarFotoProfessor(e){try{if(!e)return{success:!1,error:"URL da foto n\xe3o fornecida"};return e.startsWith("http")||e.startsWith("data:")?{success:!0,url:e}:{success:!1,error:"URL da foto inv\xe1lida"}}catch(a){return i.A.error("Erro ao buscar foto do professor:",a),{success:!1,error:a.message}}}static async listarFotosProfessores(e){try{const{data:a,error:s}=await t.N.storage.from("avatar").list("".concat(e,"/"));if(s)throw new Error("Erro ao listar fotos: ".concat(s.message));return{success:!0,fotos:a.map(a=>{var s;const{data:{publicUrl:r}}=t.N.storage.from("avatar").getPublicUrl("".concat(e,"/").concat(a.name));return{nome:a.name,url:r,tamanho:(null===(s=a.metadata)||void 0===s?void 0:s.size)||0,criadoEm:a.created_at}})}}catch(a){return i.A.error("Erro ao listar fotos dos professores:",a),{success:!1,error:a.message}}}static async validarImagem(e){return new Promise(a=>{if(!e)return void a(!1);const s=new Image;s.onload=()=>a(!0),s.onerror=()=>a(!1),s.src=e})}};var Ie=s(74562),Me=s(90256);const Te=e=>{let{editingLocation:a,setEditingLocation:s}=e;const[t,n]=(0,o.useState)([]),[l,d]=(0,o.useState)(!1),[c,m]=(0,o.useState)(null),[u,g]=(0,o.useState)(!1),[x,b]=(0,o.useState)(!1),[h,p]=(0,o.useState)(""),[f,y]=(0,o.useState)(""),N=(0,o.useCallback)(async()=>{if(null!==a&&void 0!==a&&a.id){d(!0);try{const e=await(0,Se.Y8)(a.id);n(e||[])}catch(e){i.A.error("Erro ao carregar hist\xf3rias:",e)}finally{d(!1)}}},[null===a||void 0===a?void 0:a.id]);(0,o.useEffect)(()=>{null!==a&&void 0!==a&&a.id&&N()},[null===a||void 0===a?void 0:a.id,N]);return l?(0,j.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,j.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando hist\xf3rias..."})}):(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"historiaProfessor",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Hist\xf3ria dos Professores"}),(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-200",children:"Depoimentos dos Professores"}),(0,j.jsx)("button",{onClick:()=>{m({nome_professor:"",historia:""}),g(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"+ Nova Hist\xf3ria"})]}),c&&(0,j.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[(0,j.jsx)("h4",{className:"text-md font-medium text-gray-200 mb-4",children:u?"Nova Hist\xf3ria do Professor":"Editar Hist\xf3ria do Professor"}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Nome do Professor"}),(0,j.jsx)("input",{type:"text",value:c.nome_professor||"",onChange:e=>m((0,r.A)((0,r.A)({},c),{},{nome_professor:e.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-gray-200 focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Nome do professor (opcional)"})]}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:["Foto de Rosto do Professor ",(0,j.jsx)("span",{className:"text-gray-400",children:"(opcional)"})]}),c.foto_rosto&&(0,j.jsx)("div",{className:"mb-4 p-4 border border-gray-600 rounded-lg bg-gray-700",children:(0,j.jsxs)("div",{className:"flex items-center gap-4",children:[(0,j.jsx)("img",{src:c.foto_rosto,alt:"Foto do professor",className:"w-20 h-20 object-cover rounded-full border-2 border-green-400 shadow-sm"}),(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsx)("p",{className:"text-sm text-gray-300 mb-1",children:"Foto de rosto atual:"}),(0,j.jsx)("p",{className:"text-xs text-gray-400 break-all",children:c.foto_rosto})]}),(0,j.jsx)("button",{type:"button",onClick:()=>{m((0,r.A)((0,r.A)({},c),{},{foto_rosto:""})),p(""),y("")},className:"px-3 py-1 text-sm text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded-md transition-colors",disabled:x,children:(0,j.jsx)(v.A,{className:"w-4 h-4"})})]})}),h&&(0,j.jsxs)("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-600 rounded-lg flex items-center gap-2",children:[(0,j.jsx)(C.A,{className:"w-4 h-4 text-red-400"}),(0,j.jsx)("span",{className:"text-sm text-red-400",children:h})]}),f&&(0,j.jsxs)("div",{className:"mb-4 p-3 bg-green-900/20 border border-green-600 rounded-lg flex items-center gap-2",children:[(0,j.jsx)(Ie.A,{className:"w-4 h-4 text-green-400"}),(0,j.jsx)("span",{className:"text-sm text-green-400",children:f})]}),(0,j.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(x?"border-blue-400 bg-blue-900/20":"border-gray-600 hover:border-green-400"),children:[(0,j.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:async e=>{const s=e.target.files[0];if(!s)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(s.type))return void p("Tipo de arquivo n\xe3o permitido. Use JPEG, PNG ou WebP.");if(s.size>5242880)p("Arquivo muito grande. Tamanho m\xe1ximo: 5MB");else try{b(!0),p(""),y(""),i.A.debug("=== HistoriaProfessoresTab.handlePhotoUpload ==="),i.A.debug("Arquivo:",s.name),i.A.debug("Nome Professor:",(null===c||void 0===c?void 0:c.nome_professor)||"professor"),i.A.debug("Escola ID:",a.id);const e=await De.uploadFotoProfessor(s,(null===c||void 0===c?void 0:c.nome_professor)||"professor",a.id);if(i.A.debug("Resultado do upload:",e),e.success){i.A.debug("Atualizando editingHistoria com URL:",e.url),i.A.debug("Estado atual editingHistoria:",c);const a=(0,r.A)((0,r.A)({},c),{},{foto_rosto:e.url});i.A.debug("Novo estado que ser\xe1 definido:",a),m(a),y("Foto carregada com sucesso!"),setTimeout(()=>{i.A.debug("Estado ap\xf3s atualiza\xe7\xe3o (deve mostrar foto_rosto):",c)},100),setTimeout(()=>y(""),3e3)}else p(e.error||"Erro ao fazer upload da foto")}catch(o){i.A.error("Erro no upload da foto:",o),p("Erro inesperado ao fazer upload da foto")}finally{b(!1)}},disabled:x,className:"hidden",id:"foto-rosto-input"}),(0,j.jsx)("label",{htmlFor:"foto-rosto-input",className:"cursor-pointer block ".concat(x?"cursor-not-allowed":""),children:(0,j.jsx)("div",{className:"flex flex-col items-center gap-2",children:x?(0,j.jsx)(j.Fragment,{children:(0,j.jsx)("span",{className:"text-sm text-blue-400",children:"Enviando foto..."})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Me.A,{className:"w-8 h-8 text-gray-400"}),(0,j.jsx)("span",{className:"text-sm text-gray-300",children:c.foto_rosto?"Alterar foto de rosto":"Adicionar foto de rosto"}),(0,j.jsx)("span",{className:"text-xs text-gray-500",children:"JPEG, PNG ou WebP (m\xe1x. 5MB)"})]})})})]}),(0,j.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,j.jsx)("p",{children:"\u2022 A foto de rosto ser\xe1 exibida junto com o depoimento do professor"}),(0,j.jsx)("p",{children:"\u2022 Recomendado: foto quadrada ou retrato, boa qualidade"}),(0,j.jsx)("p",{children:"\u2022 A foto ser\xe1 salva no bucket 'avatar' e vinculada ao depoimento"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Depoimento/Hist\xf3ria"}),(0,j.jsx)(Le,{value:c.historia||"",onChange:e=>m((0,r.A)((0,r.A)({},c),{},{historia:e})),placeholder:"Digite o depoimento ou hist\xf3ria do professor..."})]}),(0,j.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,j.jsx)("button",{onClick:()=>(async e=>{if(null!==a&&void 0!==a&&a.id)try{null!==c&&void 0!==c&&c.id?await(0,Se.e0)(c.id,e):await(0,Se.lz)((0,r.A)((0,r.A)({},e),{},{escola_id:a.id})),await N(),m(null),g(!1)}catch(s){i.A.error("Erro ao salvar hist\xf3ria:",s),alert("Erro ao salvar hist\xf3ria: "+s.message)}})(c),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:u?"Criar":"Salvar"}),(0,j.jsx)("button",{onClick:()=>{m(null),g(!1),p(""),y("")},className:"px-4 py-2 bg-gray-600 text-gray-200 rounded-lg hover:bg-gray-700 transition-colors",children:"Cancelar"})]})]})]}),t.length>0&&(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsx)("h4",{className:"text-md font-medium text-gray-200",children:"Hist\xf3rias Existentes"}),t.map(e=>(0,j.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:(0,j.jsxs)("div",{className:"flex items-start justify-between",children:[(0,j.jsxs)("div",{className:"flex-1",children:[e.nome_professor&&(0,j.jsx)("h5",{className:"font-medium text-green-400 mb-2",children:e.nome_professor}),(0,j.jsx)("div",{className:"text-gray-300 prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:e.historia}})]}),(0,j.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,j.jsx)("button",{onClick:()=>(e=>{m(e),g(!1)})(e),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"Editar"}),(0,j.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir esta hist\xf3ria?"))try{await(0,Se.g2)(e),await N()}catch(a){i.A.error("Erro ao deletar hist\xf3ria:",a),alert("Erro ao deletar hist\xf3ria: "+a.message)}})(e.id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Excluir"})]})]})},e.id))]}),0===t.length&&!c&&(0,j.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,j.jsx)("p",{children:"Nenhuma hist\xf3ria de professor cadastrada ainda."}),(0,j.jsx)("p",{className:"text-sm mt-2",children:'Clique em "Nova Hist\xf3ria" para come\xe7ar.'})]})]})};var Fe=s(1642),ze=s(75351),Oe=s(56528),Ue=s(35366),qe=s(20495),Be=s(99468),Re=s(62463),Ve=s(43241),Ge=s(63104),We=s(45921),He=s(85263);s(43976);const Qe="".concat("/opin","/map-marker.svg"),Ze=e=>{let{editingLocation:a,setEditingLocation:s}=e;const t=(0,o.useRef)(null),n=(0,o.useRef)(null),i=(0,o.useRef)(null),l=(e,a)=>{if(!n.current)return;const s=n.current.getView();if(e&&a&&!isNaN(e)&&!isNaN(a)){var r;const o=(0,Re.Rb)([parseFloat(a),parseFloat(e)]);s.setCenter(o),s.setZoom(15);const t=null===(r=n.current.getLayers().getArray().find(e=>e instanceof Ue.A))||void 0===r?void 0:r.getSource();if(t){i.current&&t.removeFeature(i.current);const e=new Ge.A({geometry:new Ve.A(o)});e.setStyle(new We.Ay({image:new He.A({src:Qe,scale:.6,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",color:"#fbbf24"})})),t.addFeature(e),i.current=e}}},d=(0,o.useCallback)(e=>{const o=(0,Re.WP)(e.coordinate),[t,n]=o;s((0,r.A)((0,r.A)({},a),{},{latitude:n.toFixed(6),longitude:t.toFixed(6)}))},[a]);return(0,o.useEffect)(()=>{if(!t.current)return;const e=new Fe.A({target:t.current,layers:[new Oe.A({source:new Be.A({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),new Ue.A({source:new qe.A})],view:new ze.Ay({center:(0,Re.Rb)([-46.6388,-23.5489]),zoom:8})});n.current=e,e.on("click",d);const s=a.Latitude,r=a.Longitude;return s&&r&&l(s,r),()=>{n.current&&n.current.setTarget(void 0)}},[d]),(0,o.useEffect)(()=>{const e=a.Latitude,s=a.Longitude;l(e,s)},[a.Latitude,a.Longitude]),(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Latitude"}),(0,j.jsx)("input",{type:"number",step:"any",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.Latitude||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{Latitude:e.target.value})),placeholder:"Ex: -23.5489"}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Valor entre -90 e 90 (ex: -23.5489 para S\xe3o Paulo)"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Longitude"}),(0,j.jsx)("input",{type:"number",step:"any",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.Longitude||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{Longitude:e.target.value})),placeholder:"Ex: -46.6388"}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Valor entre -180 e 180 (ex: -46.6388 para S\xe3o Paulo)"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Mapa - Clique para definir a localiza\xe7\xe3o"}),(0,j.jsx)("div",{ref:t,className:"w-full h-64 border border-gray-700 rounded-lg bg-gray-800",style:{minHeight:"256px"}}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Clique no mapa para definir as coordenadas automaticamente"})]}),(0,j.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4 border-b border-gray-600 pb-2",children:"Como Usar as Coordenadas"}),(0,j.jsxs)("div",{className:"space-y-3 text-sm text-gray-300",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{className:"text-amber-400",children:"M\xe9todo 1 - Digite manualmente:"}),(0,j.jsx)("p",{children:"Digite as coordenadas nos campos acima. Use ponto decimal (ex: -23.5489)."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{className:"text-amber-400",children:"M\xe9todo 2 - Clique no mapa:"}),(0,j.jsx)("p",{children:"Clique no mapa para definir automaticamente as coordenadas da localiza\xe7\xe3o."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{className:"text-amber-400",children:"Formato das coordenadas:"}),(0,j.jsx)("p",{children:"Latitude: -90 a +90 | Longitude: -180 a +180"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{className:"text-amber-400",children:"Exemplos para S\xe3o Paulo:"}),(0,j.jsx)("p",{children:"Latitude: -23.5489 | Longitude: -46.6388"})]})]})]})]})};var Je=s(193),Ke=s(85160);const Xe={BUCKET_NAME:"imagens-das-escolas",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:1/0,MIN_DIMENSIONS:{width:200,height:200}},Ye={BUCKET_NAME:"imagens-professores",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:1/0,MIN_DIMENSIONS:{width:200,height:200}},$e=(e,a)=>{if(!a.ALLOWED_TYPES.includes(e.type))return{isValid:!1,error:"Tipo de arquivo n\xe3o suportado. Use apenas: ".concat(a.ALLOWED_TYPES.map(e=>e.split("/")[1].toUpperCase()).join(", "))};if(e.size>a.MAX_FILE_SIZE)return{isValid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(a.MAX_FILE_SIZE/1048576,"MB")};const s=e.name.split(".").pop().toLowerCase(),r=a.ALLOWED_TYPES.map(e=>e.split("/")[1]);return r.includes(s)?{isValid:!0}:{isValid:!1,error:"Extens\xe3o n\xe3o permitida. Use apenas: ".concat(r.join(", "))}},ea=(e,a)=>{const s=Date.now(),r=Math.random().toString(36).substring(2,8),o=e.name.split(".").pop().toLowerCase();return"".concat(a,"_").concat(s,"_").concat(r,".").concat(o)},aa=(e,a,s)=>{const r=Date.now(),o=Math.random().toString(36).substring(2,8),t=e.name.split(".").pop().toLowerCase();return"".concat(s,"_").concat(a,"_").concat(r,"_").concat(o,".").concat(t)},sa=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const r=$e(e,Xe);if(!r.isValid)throw new Error(r.error);const o=ea(e,a),n="".concat(a,"/").concat(o),{error:i}=await t.N.storage.from(Xe.BUCKET_NAME).upload(n,e,{cacheControl:"3600",upsert:!1});if(i)throw new Error("Erro no upload: ".concat(i.message));const{data:{publicUrl:l}}=t.N.storage.from(Xe.BUCKET_NAME).getPublicUrl(n);return{id:Date.now(),url:n,publicUrl:l,descricao:s.trim()||"Imagem da escola ".concat(a),created_at:(new Date).toISOString()}}catch(r){throw i.A.error("Erro no upload da imagem da escola:",r),r}},ra=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"professor";try{const o=$e(e,Ye);if(!o.isValid)throw new Error(o.error);const n=aa(e,a,r),l="".concat(a,"/").concat(n),{error:d}=await t.N.storage.from(Ye.BUCKET_NAME).upload(l,e,{cacheControl:"3600",upsert:!1});if(d)throw i.A.error("Erro detalhado do upload:",d),new Error("Erro no upload: ".concat(d.message));const{data:{publicUrl:c}}=t.N.storage.from(Ye.BUCKET_NAME).getPublicUrl(l);return{id:Date.now(),url:l,publicUrl:c,descricao:s.trim()||"Imagem do ".concat(r," da escola ").concat(a),genero:r,created_at:(new Date).toISOString()}}catch(o){throw i.A.error("Erro no upload da imagem do professor:",o),o}},oa=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xe.BUCKET_NAME;try{const{data:s,error:r}=await t.N.storage.from(a).list("".concat(e,"/"));if(r)throw r;if(!s||0===s.length)return[];return s.map((s,r)=>{const o="".concat(e,"/").concat(s.name),{data:{publicUrl:n}}=t.N.storage.from(a).getPublicUrl(o);return{id:r+1,url:o,publicUrl:n,descricao:"Imagem ".concat(r+1),created_at:s.created_at||(new Date).toISOString()}})}catch(s){throw i.A.error("Erro ao buscar imagens da escola:",s),s}},ta=async(e,a,s)=>{try{const{error:e}=await t.N.storage.from(s).remove([a]);if(e)throw new Error("Erro ao deletar arquivo: ".concat(e.message));const r=a.includes("/")?a.split("/")[0]+"/":"",{data:o,error:n}=await t.N.storage.from(s).list(r);if(n)i.A.warn("Aviso: falha ao listar ap\xf3s dele\xe7\xe3o:",n);else if(o&&o.some(e=>"".concat(r).concat(e.name)===a))throw new Error("Arquivo ainda presente no bucket ap\xf3s tentativa de exclus\xe3o. Verifique permiss\xf5es do bucket.");return!0}catch(r){throw i.A.error("Erro ao deletar imagem:",r),r}},na=async function(e,a,s,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";try{const n=$e(e,r===Ye.BUCKET_NAME?Ye:Xe);if(!n.isValid)throw new Error(n.error);const l=r===Ye.BUCKET_NAME?aa(e,s,"professor"):ea(e,s),d="".concat(s,"/").concat(l),{error:c}=await t.N.storage.from(r).upload(d,e,{cacheControl:"3600",upsert:!1});if(c)throw new Error("Erro no upload da nova imagem: ".concat(c.message));const{data:{publicUrl:m}}=t.N.storage.from(r).getPublicUrl(d),{error:u}=await t.N.storage.from(r).remove([a]);return u&&i.A.warn("Erro ao deletar imagem antiga:",u),{id:Date.now(),url:d,publicUrl:m,descricao:o.trim()||"Imagem da escola ".concat(s),created_at:(new Date).toISOString()}}catch(n){throw i.A.error("Erro ao substituir imagem:",n),n}};var ia=s(40237);class la{static async getImagemHeader(e){try{const{data:a,error:s}=await t.N.from("escolas_completa").select("imagem_header").eq("id",e).single();if(s)throw s;return(null===a||void 0===a?void 0:a.imagem_header)||null}catch(a){throw i.A.error("Erro ao buscar imagem do header:",a),a}}static async setImagemHeader(e,a){try{const{error:s}=await t.N.from("escolas_completa").update({imagem_header:a}).eq("id",e);if(s)throw s}catch(s){throw i.A.error("Erro ao definir imagem do header:",s),s}}static async removeImagemHeader(e){try{const{error:a}=await t.N.from("escolas_completa").update({imagem_header:null}).eq("id",e);if(a)throw a}catch(a){throw i.A.error("Erro ao remover imagem do header:",a),a}}}const da=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[n,i]=(0,o.useState)([]),[l,d]=(0,o.useState)(!1),[c,m]=(0,o.useState)(0),[u,g]=(0,o.useState)(""),[x,b]=(0,o.useState)(""),[h,p]=(0,o.useState)([]),[f,y]=(0,o.useState)(!0),[N,w]=(0,o.useState)(null),[A,E]=(0,o.useState)(null),[k,_]=(0,o.useState)(null),[L,P]=(0,o.useState)(!1),[S,D]=(0,o.useState)(null),[I,M]=(0,o.useState)(null),T=(0,o.useCallback)(async()=>{if(a)try{const e=await la.getImagemHeader(a);_(e)}catch(e){console.error("Erro ao buscar imagem do header:",e)}},[a]),F=async()=>{if(a)try{P(!0),await la.removeImagemHeader(a),_(null),b("Imagem removida do header com sucesso!"),setTimeout(()=>b(""),3e3),s&&s()}catch(e){console.error("Erro ao remover imagem do header:",e),g("Erro ao remover imagem do header: "+e.message)}finally{P(!1)}},O=(0,o.useCallback)(async e=>{if(!a||!e||0===e.length)return e;try{const{data:s,error:r}=await t.N.from("legendas_fotos").select("imagem_url, ordem").eq("escola_id",a).eq("tipo_foto","escola").eq("ativo",!0);if(r)return console.warn("Erro ao buscar ordem das imagens:",r),e;if(!s||0===s.length)return e;const o=new Map;s.forEach(e=>{null!==e.ordem&&void 0!==e.ordem&&o.set(e.imagem_url,e.ordem)});return[...e].sort((e,a)=>(o.has(e.url)?o.get(e.url):1/0)-(o.has(a.url)?o.get(a.url):1/0))}catch(s){return console.warn("Erro ao carregar ordem das imagens:",s),e}},[a]),U=(0,o.useCallback)(async e=>{if(a&&e&&0!==e.length)try{const s=e.map((e,a)=>({imageUrl:e.url,ordem:a+1}));await(0,ia.s7)(s,a)}catch(s){console.error("Erro ao salvar ordem das imagens no banco:",s),g("Erro ao salvar ordem das imagens. Tente novamente.")}},[a]),q=(0,o.useCallback)(async()=>{if(a)try{y(!0);const e=await oa(a,"imagens-das-escolas"),s=await O(e);p(s)}catch(e){console.error("Erro ao buscar imagens:",e),g("Erro ao carregar imagens existentes")}finally{y(!1)}},[a,O]);(0,o.useEffect)(()=>{q(),T()},[q,T]),(0,o.useEffect)(()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos..."),(0,ia.iy)())},[a]),(0,o.useEffect)(()=>{(async()=>{if(!h.length||!a)return;console.log("Buscando legendas para",h.length,"imagens da escola",a);const e={};try{for(const s of h){console.log("Buscando legenda para imagem:",s.url);let r=await(0,ia.qP)(s.url,a,"escola");!r&&s.publicURL&&(console.log("Tentando buscar com URL p\xfablica:",s.publicURL),r=await(0,ia.qP)(s.publicURL,a,"escola")),console.log("Legenda encontrada:",r),e[s.url]=r}p(a=>a.map(a=>(0,r.A)((0,r.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}}))),console.log("Legendas carregadas com sucesso")}catch(u){console.error("Erro ao buscar legendas:",u),g("Erro ao carregar legendas: "+u.message)}})()},[h.length,a]),(0,o.useEffect)(()=>{if(u||x){const e=setTimeout(()=>{g(""),b("")},5e3);return()=>clearTimeout(e)}},[u,x]);const B=(0,o.useCallback)(e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;const s=a.filter(e=>e.type.startsWith("image/"));s.length>0&&(i(e=>[...e,...s]),g(""))},[]),R=(0,o.useCallback)(e=>{e.preventDefault()},[]),G=(e,a,s)=>{p(o=>o.map(o=>o.id===e?(0,r.A)((0,r.A)({},o),{},{legendaData:(0,r.A)((0,r.A)({},o.legendaData),{},{[a]:s})}):o))},W=()=>{M(null)},H=()=>{D(null),M(null)};return f?(0,j.jsx)("div",{className:"p-6 bg-gray-800/30 rounded-lg",children:(0,j.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,j.jsx)("span",{className:"ml-2 text-gray-400",children:"Carregando imagens..."})})}):(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(Y.A,{className:"w-5 h-5 text-blue-400"}),(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-100",children:"Imagens da Escola"})]}),(0,j.jsxs)("div",{className:"text-sm text-gray-400",children:[h.length," imagens"]})]}),u&&(0,j.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-900/50 border-red-700/50 rounded-xl",children:[(0,j.jsx)(C.A,{className:"w-5 h-5 text-red-400"}),(0,j.jsx)("span",{className:"text-red-300",children:u})]}),x&&(0,j.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-900/50 border-green-700/50 rounded-xl",children:[(0,j.jsx)(Je.A,{className:"w-5 h-5 text-green-400"}),(0,j.jsx)("span",{className:"text-green-300",children:x})]}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(l?"border-gray-600 bg-gray-800/50":"border-gray-600 bg-gray-800/50 hover:border-blue-400 hover:bg-gray-700/50"),onDrop:B,onDragOver:R,children:[(0,j.jsx)(Me.A,{className:"w-8 h-8 text-blue-400 mx-auto mb-2"}),(0,j.jsx)("p",{className:"text-gray-300 mb-2",children:"Arraste imagens aqui ou clique para selecionar"}),(0,j.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo"}),(0,j.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,j.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;const s=a.filter(e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||g('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||g('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s});s.length>0&&(i(e=>[...e,...s]),g(""))},className:"hidden",disabled:l}),"Selecionar Arquivos"]})]}),l&&(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsxs)("div",{className:"flex justify-between text-sm text-gray-400",children:[(0,j.jsx)("span",{children:"Fazendo upload..."}),(0,j.jsxs)("span",{children:[Math.round(c),"%"]})]}),(0,j.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,j.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(c,"%")}})})]}),n.length>0&&(0,j.jsxs)("div",{className:"space-y-3",children:[(0,j.jsxs)("h4",{className:"font-medium text-gray-100",children:["Arquivos selecionados (",n.length,")"]}),(0,j.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.map((e,a)=>(0,j.jsxs)("div",{className:"relative group",children:[(0,j.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,j.jsx)("button",{onClick:()=>(e=>{i(a=>a.filter((a,s)=>s!==e))})(a),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,j.jsx)(v.A,{className:"w-3 h-3"})}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-1 truncate",children:e.name})]},a))}),(0,j.jsx)("button",{onClick:async()=>{if(0!==n.length){d(!0),m(0),g("");try{const e=[];for(let s=0;s<n.length;s++){const r=n[s],o=(s+1)/n.length*100;m(o);const t=await sa(r,a);e.push(t)}const r=[...h,...e];p(r),await U(r),i([]),m(0),b("".concat(e.length," imagem(ns) carregada(s) com sucesso!")),s&&s()}catch(e){console.error("Erro no upload:",e),g("Erro ao fazer upload: ".concat(e.message))}finally{d(!1),m(0)}}},disabled:l,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Fazendo Upload...":"Fazer Upload"})]})]}),")}",h.length>0&&(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("h4",{className:"font-medium text-gray-100",children:["Imagens da Escola (",h.length,")"]}),(0,j.jsx)("p",{className:"text-sm text-gray-400",children:"Arraste as imagens para reordenar"})]}),(0,j.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map((e,o)=>{var t,n,i,l,d;return(0,j.jsxs)("div",{draggable:!0,onDragStart:e=>((e,a)=>{D(a),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target)})(e,o),onDragOver:e=>((e,a)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",M(a)})(e,o),onDragLeave:W,onDrop:e=>(async(e,a)=>{if(e.preventDefault(),e.stopPropagation(),null===S||S===a)return D(null),void M(null);const s=[...h],r=s[S];s.splice(S,1),s.splice(a,0,r),p(s),await U(s),D(null),M(null),b("Ordem das imagens atualizada!"),setTimeout(()=>b(""),3e3)})(e,o),onDragEnd:H,className:"bg-gray-800/50 border border-gray-700/50 rounded-lg overflow-hidden shadow-sm transition-all cursor-move ".concat(k===e.publicUrl?"ring-2 ring-blue-400":""," ").concat(S===o?"opacity-50 scale-95":""," ").concat(I===o?"ring-2 ring-blue-500 scale-105":""),children:[(0,j.jsx)("div",{className:"absolute top-2 right-2 z-10 bg-gray-900/80 p-1 rounded cursor-grab active:cursor-grabbing",children:(0,j.jsx)(Ke.A,{className:"w-4 h-4 text-gray-400"})}),(0,j.jsxs)("div",{className:"relative group",children:[(0,j.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem da escola",className:"w-full h-48 object-cover"}),k===e.publicUrl&&(0,j.jsxs)("div",{className:"absolute top-2 left-2 bg-blue-500 text-white px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,j.jsx)(Je.A,{className:"w-3 h-3"}),"Header"]}),(0,j.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,j.jsxs)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[k!==e.publicUrl&&(0,j.jsx)("button",{onClick:()=>(async e=>{if(a)try{P(!0),await la.setImagemHeader(a,e),_(e),b("Imagem definida como header com sucesso!"),setTimeout(()=>b(""),3e3),s&&s()}catch(r){console.error("Erro ao definir imagem do header:",r),g("Erro ao definir imagem do header: "+r.message)}finally{P(!1)}})(e.publicUrl),disabled:L,className:"p-2 bg-blue-500 text-white rounded-full hover:bg-blue-700 disabled:opacity-50",title:"Usar como imagem do header",children:(0,j.jsx)(Je.A,{className:"w-5 h-5"})}),k===e.publicUrl&&(0,j.jsx)("button",{onClick:F,disabled:L,className:"p-2 bg-yellow-500 text-white rounded-full hover:bg-yellow-700 disabled:opacity-50",title:"Remover do header",children:(0,j.jsx)(v.A,{className:"w-5 h-5"})}),(0,j.jsx)("button",{onClick:()=>{return a=e.id,w(a),void E(null);var a},className:"p-2 bg-orange-500 text-white rounded-full hover:bg-orange-700",title:"Trocar imagem",children:(0,j.jsx)(ae.A,{className:"w-5 h-5"})}),(0,j.jsx)("button",{onClick:()=>(async(e,a)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem?"))try{await ta(0,a,"imagens-das-escolas");const o=h.find(a=>a.id===e);if(o&&o.publicUrl&&o.publicUrl===k)try{await F()}catch(r){}await q();const t=h.filter(a=>a.id!==e);await U(t),b("Imagem exclu\xedda com sucesso!"),s&&s()}catch(o){console.error("Erro ao deletar imagem:",o),g("Erro ao excluir imagem: ".concat(o.message))}})(e.id,e.url),className:"p-2 bg-red-500 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,j.jsx)(V.A,{className:"w-5 h-5"})})]})})]}),(0,j.jsxs)("div",{className:"p-4 space-y-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Legenda"}),(0,j.jsx)("input",{type:"text",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-100",value:(null===(t=e.legendaData)||void 0===t?void 0:t.legenda)||"",onChange:a=>G(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,j.jsx)("textarea",{className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-100",value:(null===(n=e.legendaData)||void 0===n?void 0:n.descricao_detalhada)||"",onChange:a=>G(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Autor da Foto"}),(0,j.jsx)("input",{type:"text",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-100",value:(null===(i=e.legendaData)||void 0===i?void 0:i.autor_foto)||"",onChange:a=>G(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Data da Foto"}),(0,j.jsx)("input",{type:"date",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-100",value:(null===(l=e.legendaData)||void 0===l?void 0:l.data_foto)||"",onChange:a=>G(e.id,"data_foto",a.target.value)}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Categoria"}),(0,j.jsx)("input",{type:"text",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-100",value:(null===(d=e.legendaData)||void 0===d?void 0:d.categoria)||"",onChange:a=>G(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,j.jsx)("div",{className:"flex gap-2 pt-2",children:(0,j.jsxs)("button",{onClick:()=>(async e=>{console.log("=== DEBUG: Salvando legenda ==="),console.log("Imagem completa:",e);const o=e.url,t=e.legendaData;if(console.log("URL relativa:",o),console.log("Dados da legenda:",t),console.log("Escola ID:",a),!a)return void g("ID da escola n\xe3o encontrado");if(!o)return void g("URL da imagem n\xe3o encontrada");const n=(0,r.A)({},t);if(n.data_foto&&""!==n.data_foto.trim())try{const e=new Date(n.data_foto);isNaN(e.getTime())?delete n.data_foto:n.data_foto=e.toISOString().split("T")[0]}catch(i){delete n.data_foto}else delete n.data_foto;Object.keys(n).forEach(e=>{""!==n[e]&&null!==n[e]||delete n[e]}),console.log("Dados limpos da legenda:",n);try{console.log("Buscando legenda existente...");let e=await(0,ia.qP)(o,a,"escola");if(console.log("Legenda existente encontrada:",e),e){console.log("Atualizando legenda existente...");const a=(0,r.A)((0,r.A)({},n),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",a);const s=await(0,ia.w_)(e.id,a);console.log("Legenda atualizada com sucesso:",s)}else{console.log("Criando nova legenda...");const e=(0,r.A)((0,r.A)({escola_id:a,imagem_url:o},n),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"escola"});console.log("Dados para nova legenda:",e);const s=await(0,ia.eP)(e);console.log("Nova legenda criada:",s)}b("Legenda salva com sucesso!"),await q(),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(l){console.error("=== ERRO ao salvar legenda ==="),console.error("Erro completo:",l),console.error("Mensagem de erro:",l.message),console.error("Stack trace:",l.stack),console.error("Detalhes do erro:",l.details),console.error("Hint do erro:",l.hint);let e="Erro ao salvar legenda: "+l.message;l.details&&(e+=" - Detalhes: "+l.details),l.hint&&(e+=" - Dica: "+l.hint),g(e)}})(e),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",type:"button",children:[(0,j.jsx)(z.A,{className:"w-5 h-5"})," Salvar Legenda"]})})]})]},e.id)})})]}),N&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,j.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-100",children:"Trocar Imagem"}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Selecione a nova imagem"}),(0,j.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=e.target.files[0];a&&E(a)},className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-gray-100"})]}),A&&(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,j.jsx)("img",{src:URL.createObjectURL(A),alt:"Nova imagem",className:"w-full h-32 object-cover rounded-lg border border-gray-600"})]})]}),(0,j.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,j.jsx)("button",{onClick:()=>{w(null),E(null)},className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancelar"}),(0,j.jsx)("button",{onClick:()=>{var e;return(async(e,r)=>{if(A)try{var o;d(!0),g("");const t=await na(A,r,a,"imagens-das-escolas",(null===(o=h.find(a=>a.id===e))||void 0===o?void 0:o.descricao)||""),n=h.map(a=>a.id===e?t:a);p(n),await U(n),w(null),E(null),b("Imagem substitu\xedda com sucesso!"),s&&s()}catch(t){console.error("Erro ao substituir imagem:",t),g("Erro ao substituir imagem: ".concat(t.message))}finally{d(!1)}else g("Selecione uma nova imagem para substituir")})(N,null===(e=h.find(e=>e.id===N))||void 0===e?void 0:e.url)},disabled:!A||l,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Trocando...":"Trocar Imagem"})]})]})}),0===h.length&&!l&&(0,j.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,j.jsx)(Y.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-500"}),(0,j.jsx)("p",{children:"Nenhuma imagem adicionada ainda."}),(0,j.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar a escola."})]})]})},ca=e=>{let{editingLocation:a,setEditingLocation:s}=e;const r=null===a||void 0===a?void 0:a.id;return r?(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"imagensEscola",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Imagens da Escola"}),(0,j.jsx)(da,{escolaId:r,onImagesUpdate:()=>{i.A.debug("Imagens da escola atualizadas")}})]}):(0,j.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,j.jsx)("p",{children:"Selecione uma escola para gerenciar suas imagens"})})},ma=async e=>{const{data:a,error:s}=await t.N.from("imagens_professores").insert([e]).select().single();if(s)throw s;return a},ua=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[n,i]=(0,o.useState)([]),[l,d]=(0,o.useState)(!1),[c,m]=(0,o.useState)(0),[u,g]=(0,o.useState)(""),[x,b]=(0,o.useState)(""),[h,p]=(0,o.useState)([]),[f,y]=(0,o.useState)(!0),[N]=(0,o.useState)("professor"),[w]=(0,o.useState)(""),[A,E]=(0,o.useState)(null),[k,_]=(0,o.useState)(null),L=(0,o.useCallback)(async()=>{if(a)try{y(!0);const e=await oa(a,"imagens-professores");p(e)}catch(e){console.error("Erro ao buscar imagens dos professores:",e),g("Erro ao carregar imagens dos professores")}finally{y(!1)}},[a]);(0,o.useEffect)(()=>{L()},[L]),(0,o.useEffect)(()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos (professores)..."),(0,ia.iy)())},[a]),(0,o.useEffect)(()=>{(async()=>{if(!h.length)return;console.log("Buscando legendas para",h.length,"imagens de professores");const e={};for(const s of h){console.log("Buscando legenda para imagem de professor:",s.url);const r=await(0,ia.qP)(s.url,a,"professor");console.log("Legenda encontrada para professor:",r),e[s.url]=r}p(a=>a.map(a=>(0,r.A)((0,r.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))})()},[h.length,a]),(0,o.useEffect)(()=>{if(u||x){const e=setTimeout(()=>{g(""),b("")},5e3);return()=>clearTimeout(e)}},[u,x]);const P=(0,o.useCallback)(e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;const s=a.filter(e=>e.type.startsWith("image/"));s.length>0&&(i(e=>[...e,...s]),g(""))},[]),S=(0,o.useCallback)(e=>{e.preventDefault()},[]),D=(e,a,s)=>{p(o=>o.map(o=>o.id===e?(0,r.A)((0,r.A)({},o),{},{legendaData:(0,r.A)((0,r.A)({},o.legendaData),{},{[a]:s})}):o))},I=async e=>{console.log("=== DEBUG: Salvando legenda de professor ==="),console.log("Imagem completa:",e);const o=e.url,n=e.legendaData;console.log("URL relativa:",o),console.log("Dados da legenda:",n),console.log("Escola ID:",a);const i=(0,r.A)({},n);i.data_foto&&""!==i.data_foto.trim()||delete i.data_foto,Object.keys(i).forEach(e=>{""===i[e]&&delete i[e]}),console.log("Dados limpos da legenda:",i);try{console.log("Buscando legenda existente...");let n=await(0,ia.qP)(o,a,"professor");if(console.log("Legenda existente encontrada:",n),n){console.log("Atualizando legenda existente...");const e=(0,r.A)((0,r.A)({},i),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",e);const a=await(0,ia.w_)(n.id,e);console.log("Legenda de professor atualizada com sucesso:",a)}else{console.log("Criando nova legenda...");const e=(0,r.A)((0,r.A)({escola_id:a,imagem_url:o},i),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"professor"});console.log("Dados para nova legenda:",e);const s=await(0,ia.eP)(e);console.log("Nova legenda de professor criada:",s)}console.log("Atualizando metadados da imagem...");let l=await(async(e,a)=>{const{data:s,error:r}=await t.N.from("imagens_professores").select("*").eq("imagem_url",e).eq("escola_id",a).eq("ativo",!0).single();if(r&&"PGRST116"!==r.code)throw r;return s||null})(e.publicUrl,a);l?(console.log("Metadados encontrados:",l),await(async(e,a)=>{const{data:s,error:r}=await t.N.from("imagens_professores").update(a).eq("id",e).select().single();if(r)throw r;return s})(l.id,{autor:i.autor_foto,updated_at:(new Date).toISOString()}),console.log("Metadados atualizados com sucesso")):console.log("Nenhum metadado encontrado para atualizar"),b("Legenda salva com sucesso!"),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(l){console.error("=== ERRO ao salvar legenda de professor ==="),console.error("Erro completo:",l),console.error("Mensagem de erro:",l.message),console.error("Stack trace:",l.stack),g("Erro ao salvar legenda: "+l.message)}};return f?(0,j.jsx)("div",{className:"p-6 bg-gray-800/30 rounded-lg",children:(0,j.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,j.jsx)("span",{className:"ml-2 text-gray-400",children:"Carregando imagens dos professores..."})})}):(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(Ie.A,{className:"w-5 h-5 text-green-400"}),(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-100",children:"Imagens dos Professores"})]}),(0,j.jsxs)("div",{className:"text-sm text-gray-400",children:[h.length," imagens"]})]}),u&&(0,j.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-900/50 border-red-700/50 rounded-xl",children:[(0,j.jsx)(C.A,{className:"w-5 h-5 text-red-400"}),(0,j.jsx)("span",{className:"text-red-300",children:u})]}),x&&(0,j.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-900/50 border-green-700/50 rounded-xl",children:[(0,j.jsx)(Je.A,{className:"w-5 h-5 text-green-400"}),(0,j.jsx)("span",{className:"text-green-300",children:x})]}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(l?"border-gray-600 bg-gray-800/50":"border-gray-600 bg-gray-800/50 hover:border-green-400 hover:bg-gray-700/50"),onDrop:P,onDragOver:S,children:[(0,j.jsx)(Me.A,{className:"w-8 h-8 text-green-400 mx-auto mb-2"}),(0,j.jsx)("p",{className:"text-gray-300 mb-2",children:"Arraste imagens dos professores aqui ou clique para selecionar"}),(0,j.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo \u2022 M\xe1ximo 5 imagens"}),(0,j.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer transition-colors",children:[(0,j.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;const s=a.filter(e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||g('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||g('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s});s.length>0&&(i(e=>[...e,...s]),g(""))},className:"hidden",disabled:l}),"Selecionar Arquivos"]})]}),l&&(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsxs)("div",{className:"flex justify-between text-sm text-gray-400",children:[(0,j.jsx)("span",{children:"Fazendo upload das imagens dos professores..."}),(0,j.jsxs)("span",{children:[Math.round(c),"%"]})]}),(0,j.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,j.jsx)("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(c,"%")}})})]}),n.length>0&&(0,j.jsxs)("div",{className:"space-y-3",children:[(0,j.jsxs)("h4",{className:"font-medium text-gray-100",children:["Arquivos selecionados (",n.length,")"]}),(0,j.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.map((e,a)=>(0,j.jsxs)("div",{className:"relative group",children:[(0,j.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,j.jsx)("button",{onClick:()=>(e=>{i(a=>a.filter((a,s)=>s!==e))})(a),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,j.jsx)(v.A,{className:"w-3 h-3"})}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-1 truncate",children:e.name})]},a))}),(0,j.jsx)("button",{onClick:async()=>{if(0!==n.length){d(!0),m(0),g("");try{const e=[];for(let s=0;s<n.length;s++){const r=n[s],o=(s+1)/n.length*100;m(o);const t=await ra(r,a,"",N,w);e.push(t),await ma({escola_id:a,imagem_url:t.url,nome_arquivo:r.name,autor:"",ativo:!0})}p(a=>[...a,...e]),i([]),m(0),b("".concat(e.length," imagem(ns) do(s) professor(es) carregada(s) com sucesso!")),s&&s()}catch(e){console.error("Erro no upload:",e),g("Erro ao fazer upload: ".concat(e.message))}finally{d(!1),m(0)}}},disabled:l,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Fazendo Upload...":"Fazer Upload"})]})]}),")}",h.length>0&&(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("h4",{className:"font-medium text-gray-100",children:["Imagens dos Professores (",h.length,")"]}),(0,j.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(e=>{var a,r,o,t,n;return(0,j.jsxs)("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-lg overflow-hidden shadow-sm",children:[(0,j.jsxs)("div",{className:"relative group",children:[(0,j.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem do professor",className:"w-full h-48 object-cover"}),(0,j.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,j.jsxs)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,j.jsx)("button",{onClick:()=>{return a=e.id,E(a),void _(null);var a},className:"p-2 bg-orange-500 text-white rounded-full hover:bg-orange-700",title:"Trocar imagem",children:(0,j.jsx)(ae.A,{className:"w-5 h-5"})}),(0,j.jsx)("button",{onClick:()=>(async(e,a)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem do professor?"))try{await ta(0,a,"imagens-professores"),await L(),b("Imagem do professor exclu\xedda com sucesso!"),s&&s()}catch(r){console.error("Erro ao deletar imagem:",r),g("Erro ao excluir imagem: ".concat(r.message))}})(e.id,e.url),className:"p-2 bg-red-500 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,j.jsx)(V.A,{className:"w-5 h-5"})})]})})]}),(0,j.jsxs)("div",{className:"p-4 space-y-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Legenda"}),(0,j.jsx)("input",{type:"text",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100",value:(null===(a=e.legendaData)||void 0===a?void 0:a.legenda)||"",onChange:a=>D(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,j.jsx)("textarea",{className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100",value:(null===(r=e.legendaData)||void 0===r?void 0:r.descricao_detalhada)||"",onChange:a=>D(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Autor da Foto"}),(0,j.jsx)("input",{type:"text",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100",value:(null===(o=e.legendaData)||void 0===o?void 0:o.autor_foto)||"",onChange:a=>D(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Data da Foto"}),(0,j.jsx)("input",{type:"date",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100",value:(null===(t=e.legendaData)||void 0===t?void 0:t.data_foto)||"",onChange:a=>D(e.id,"data_foto",a.target.value)}),(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Categoria"}),(0,j.jsx)("input",{type:"text",className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100",value:(null===(n=e.legendaData)||void 0===n?void 0:n.categoria)||"",onChange:a=>D(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,j.jsx)("div",{className:"flex gap-2 pt-2",children:(0,j.jsxs)("button",{onClick:()=>I(e),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",type:"button",children:[(0,j.jsx)(z.A,{className:"w-5 h-5"})," Salvar Legenda"]})})]})]},e.id)})})]}),A&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,j.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-100",children:"Trocar Imagem do Professor"}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Selecione a nova imagem"}),(0,j.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=e.target.files[0];a&&_(a)},className:"w-full bg-gray-700 border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-400 focus:border-green-400 text-gray-100"})]}),k&&(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,j.jsx)("img",{src:URL.createObjectURL(k),alt:"Nova imagem",className:"w-full h-32 object-cover rounded-lg border border-gray-600"})]})]}),(0,j.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,j.jsx)("button",{onClick:()=>{E(null),_(null)},className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancelar"}),(0,j.jsx)("button",{onClick:()=>{var e;return(async(e,r)=>{if(k)try{var o;d(!0),g("");const t=await na(k,r,a,"imagens-professores",(null===(o=h.find(a=>a.id===e))||void 0===o?void 0:o.descricao)||"");p(a=>a.map(a=>a.id===e?t:a)),E(null),_(null),b("Imagem do professor substitu\xedda com sucesso!"),s&&s()}catch(t){console.error("Erro ao substituir imagem:",t),g("Erro ao substituir imagem: ".concat(t.message))}finally{d(!1)}else g("Selecione uma nova imagem para substituir")})(A,null===(e=h.find(e=>e.id===A))||void 0===e?void 0:e.url)},disabled:!k||l,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Trocando...":"Trocar Imagem"})]})]})}),0===h.length&&!l&&(0,j.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,j.jsx)(Ie.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-500"}),(0,j.jsx)("p",{children:"Nenhuma imagem dos professores adicionada ainda."}),(0,j.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar os professores da escola."})]})]})},ga=e=>{let{editingLocation:a,setEditingLocation:s}=e;const r=null===a||void 0===a?void 0:a.id;return r?(0,j.jsx)("div",{className:"space-y-6",children:(0,j.jsx)(ua,{escolaId:r,onImagesUpdate:()=>{i.A.debug("Imagens dos professores atualizadas")}})}):(0,j.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,j.jsx)("p",{children:"Selecione uma escola para gerenciar as imagens dos professores"})})};var xa=s(57991);const ba=e=>{let{onUploadComplete:a,onRemove:s,existingUrls:r=[]}=e;const[t,n]=(0,o.useState)(!1),[i,l]=(0,o.useState)(null),[d,c]=(0,o.useState)([]),[m,u]=(0,o.useState)(r);return(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("label",{className:"block font-medium text-gray-800",children:["Documentos PDF",(0,j.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:["(M\xe1x. ",Ae.PDF.MAX_SIZE/1048576,"MB cada arquivo)"]})]}),i&&(0,j.jsxs)("div",{className:"flex items-center text-red-500 text-sm",children:[(0,j.jsx)(C.A,{size:16,className:"mr-1"}),i]})]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,j.jsxs)("label",{className:"cursor-pointer",children:[(0,j.jsx)("input",{type:"file",accept:".pdf",multiple:!0,onChange:async e=>{const a=Array.from(e.target.files);if(0===a.length)return;const s=a.filter(e=>{const a=Ae.PDF.ALLOWED_TYPES.includes(e.type),s=e.size<=Ae.PDF.MAX_SIZE;return a&&s});s.length!==a.length&&l("Alguns arquivos foram ignorados. Use apenas PDFs at\xe9 10MB."),c(e=>[...e,...s])},className:"hidden",disabled:t}),(0,j.jsxs)("div",{className:"flex items-center justify-center gap-2 border-2 border-dashed rounded-lg p-4 \n            ".concat(t?"border-gray-300 bg-gray-50":"border-blue-300 hover:border-blue-400 bg-blue-50"),children:[(0,j.jsx)(Me.A,{size:20,className:t?"text-gray-400":"text-blue-500"}),(0,j.jsx)("span",{className:t?"text-gray-500":"text-blue-600",children:t?"Fazendo upload...":"Selecionar PDFs"})]})]}),d.length>0&&(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsx)("h4",{className:"font-medium text-sm text-gray-700",children:"Arquivos selecionados:"}),(0,j.jsx)("div",{className:"grid grid-cols-1 gap-2",children:d.map((e,a)=>(0,j.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(xa.A,{size:16,className:"text-gray-500"}),(0,j.jsx)("span",{className:"text-sm text-gray-700",children:e.name})]}),(0,j.jsx)("button",{type:"button",onClick:()=>c(e=>e.filter((e,s)=>s!==a)),className:"text-gray-500 hover:text-red-500",children:(0,j.jsx)(v.A,{size:16})})]},a))}),(0,j.jsx)("button",{type:"button",onClick:async()=>{if(0===d.length)return;n(!0),l(null);const e=[];try{for(const a of d){const s=await Ce(a);e.push(s)}const s=[...m,...e];u(s),a(s),c([])}catch(s){l("Erro ao fazer upload dos arquivos. Tente novamente."),console.error("Erro no upload:",s)}finally{n(!1)}},disabled:t,className:"w-full py-2 px-4 rounded-lg text-white font-medium\n                ".concat(t?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"),children:t?"Enviando...":"Fazer Upload"})]}),m.length>0&&(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsx)("h4",{className:"font-medium text-sm text-gray-700",children:"Documentos enviados:"}),(0,j.jsx)("div",{className:"grid grid-cols-1 gap-2",children:m.map((e,a)=>(0,j.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(xa.A,{size:16,className:"text-gray-500"}),(0,j.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:["Documento ",a+1]})]}),(0,j.jsx)("button",{type:"button",onClick:()=>(e=>{const a=m.filter((a,s)=>s!==e);u(a),s(a)})(a),className:"text-gray-500 hover:text-red-500",children:(0,j.jsx)(v.A,{size:16})})]},a))})]})]})]})},ha=e=>{let{editingLocation:a,setEditingLocation:s}=e;const r=null===a||void 0===a?void 0:a.id,[t,n]=(0,o.useState)((null===a||void 0===a?void 0:a.documentos)||[]);if(!r)return(0,j.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,j.jsx)("p",{children:"Selecione uma escola para gerenciar seus documentos"})});return(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsx)(ne,{cardId:"documentos",editingLocation:a,setEditingLocation:s,label:"Visibilidade do Card: Documentos"}),(0,j.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Documentos da Escola"}),(0,j.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Fa\xe7a upload de documentos da escola em formato PDF. N\xe3o h\xe1 limite no n\xfamero de documentos."}),(0,j.jsx)(ba,{onUploadComplete:e=>{n(e),i.A.debug("Documentos atualizados:",e)},onRemove:e=>{n(e),i.A.debug("Documentos ap\xf3s remo\xe7\xe3o:",e)},existingUrls:t})]})]})},pa=(e,a)=>{const s=(null===e||void 0===e?void 0:e.activeTab)||p;switch(s){case"dados-basicos":return(0,j.jsx)(ie,{editingLocation:e,setEditingLocation:a});case"povos-linguas":return(0,j.jsx)(le,{editingLocation:e,setEditingLocation:a});case"modalidades":return(0,j.jsx)(de,{editingLocation:e,setEditingLocation:a});case"infraestrutura":return(0,j.jsx)(ce,{editingLocation:e,setEditingLocation:a});case"gestao-professores":return(0,j.jsx)(me,{editingLocation:e,setEditingLocation:a});case"material-pedagogico":return(0,j.jsx)(ue,{editingLocation:e,setEditingLocation:a});case"projetos-parcerias":return(0,j.jsx)(ge,{editingLocation:e,setEditingLocation:a});case"redes-sociais":return(0,j.jsx)(xe,{editingLocation:e,setEditingLocation:a});case"video":return(0,j.jsx)(ve,{editingLocation:e,setEditingLocation:a});case"historias":return(0,j.jsx)(Pe,{editingLocation:e,setEditingLocation:a});case"historia-professores":return(0,j.jsx)(Te,{editingLocation:e,setEditingLocation:a});case"coordenadas":return(0,j.jsx)(Ze,{editingLocation:e,setEditingLocation:a});case"historias-professor":return(0,j.jsx)("div",{className:"text-center py-16",children:(0,j.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,j.jsx)("h3",{className:"text-xl font-semibold text-gray-200 mb-2",children:"Tabela de Hist\xf3rias dos Professores"}),(0,j.jsx)("p",{className:"text-gray-400 mb-8",children:"Funcionalidade em desenvolvimento..."})]})});case"documentos-escola":return(0,j.jsx)("div",{className:"text-center py-16",children:(0,j.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,j.jsx)("h3",{className:"text-xl font-semibold text-gray-200 mb-2",children:"Tabela de Documentos das Escolas"}),(0,j.jsx)("p",{className:"text-gray-400 mb-8",children:"Funcionalidade em desenvolvimento..."})]})});case"imagens-escola":return(0,j.jsx)(ca,{editingLocation:e,setEditingLocation:a});case"imagens-professores":return(0,j.jsx)(ga,{editingLocation:e,setEditingLocation:a});case"documentos":return(0,j.jsx)(ha,{editingLocation:e,setEditingLocation:a});default:return(0,j.jsxs)("div",{className:"text-gray-400 text-center py-8",children:['Aba "',s,'" em desenvolvimento...']})}},fa=e=>null===e||void 0===e?"":"string"===typeof e?e.trim():String(e),va=e=>({Escola:"Nome da Escola","Munic\xedpio":"Munic\xedpio","Endere\xe7o":"Endere\xe7o","Terra Indigena (TI)":"Terra Ind\xedgena","Escola Estadual ou Municipal":"Tipo de Escola","Parcerias com o munic\xedpio":"Parcerias com Munic\xedpio","Diretoria de Ensino":"Diretoria de Ensino","Ano de cria\xe7\xe3o da escola":"Ano de Cria\xe7\xe3o","Povos indigenas":"Povos Ind\xedgenas","Linguas faladas":"L\xednguas Faladas","Modalidade de Ensino/turnos de funcionamento":"Modalidade de Ensino","Numero de alunos":"N\xfamero de Alunos",turnos_funcionamento:"Turnos de Funcionamento","Espa\xe7o escolar e estrutura":"Espa\xe7o Escolar","Acesso \xe0 \xe1gua":"Acesso \xe0 \xc1gua","Tem coleta de lixo?":"Coleta de Lixo","Acesso \xe0 internet":"Acesso \xe0 Internet","Equipamentos Tecs":"Equipamentos T\xe9cnicos","Modo de acesso \xe0 escola":"Modo de Acesso","Gest\xe3o/Nome":"Gest\xe3o","Outros funcion\xe1rios":"Outros Funcion\xe1rios","Quantidade de professores ind\xedgenas":"Professores Ind\xedgenas","Quantidade de professores n\xe3o ind\xedgenas":"Professores N\xe3o Ind\xedgenas","Professores falam a l\xedngua ind\xedgena?":"Professores Falam L\xedngua Ind\xedgena","Forma\xe7\xe3o dos professores":"Forma\xe7\xe3o dos Professores","Forma\xe7\xe3o continuada oferecida":"Forma\xe7\xe3o Continuada","A escola possui PPP pr\xf3prio?":"PPP Pr\xf3prio","PPP elaborado com a comunidade?":"PPP com Comunidade","Material pedag\xf3gico n\xe3o ind\xedgena":"Material N\xe3o Ind\xedgena","Material pedag\xf3gico ind\xedgena":"Material Ind\xedgena","Pr\xe1ticas pedag\xf3gicas ind\xedgenas":"Pr\xe1ticas Pedag\xf3gicas Ind\xedgenas","Formas de avalia\xe7\xe3o":"Formas de Avalia\xe7\xe3o","Projetos em andamento":"Projetos em Andamento","Parcerias com universidades?":"Parcerias com Universidades","A\xe7\xf5es com ONGs ou coletivos?":"A\xe7\xf5es com ONGs","Desejos da comunidade para a escola":"Desejos da Comunidade","Escola utiliza redes sociais?":"Uso de Redes Sociais","Links das redes sociais":"Links Redes Sociais",historia_da_escola:"Hist\xf3ria da Escola",Latitude:"Latitude",Longitude:"Longitude",link_para_videos:"Links de V\xeddeos",logradouro:"Logradouro",numero:"N\xfamero",complemento:"Complemento",bairro:"Bairro",cep:"CEP",estado:"Estado",Cozinha:"Cozinha",Merenda_escolar:"Merenda Escolar",diferenciada:"Diferenciada"}[e]||e),ya=e=>{let{saveEscola:a,editingLocation:s,setEditingLocation:r,setEscolaSalvaId:t,setEscolaSalvaNome:n,setCamposAlterados:l,setShowMetadadosModal:d,dadosOriginais:c,setDadosOriginais:m}=e;const[u,g]=(0,o.useState)(!1),[x,b]=(0,o.useState)(null),[h,p]=(0,o.useState)(!1),f=(0,o.useCallback)(async()=>{if(s)try{g(!0),b(null),p(!1);let e=[];e=s.id&&c?((e,a)=>{if(!e||!a)return[];const s=[],r=new Set([...Object.keys(e),...Object.keys(a)]),o=["id","created_at","updated_at","activeTab","imagem_header"];return r.forEach(r=>{o.includes(r)||fa(e[r])!==fa(a[r])&&s.push({campo:r,valorAntigo:e[r]||"",valorNovo:a[r]||"",label:va(r)})}),s})(c,s):Object.keys(s).filter(e=>!["id","created_at","updated_at","activeTab","imagem_header"].includes(e)&&s[e]).map(e=>({campo:e,valorAntigo:"",valorNovo:s[e],label:e}));const o=await a(s,null);o.success?(p(!0),r(o.data),t(o.data.id),n(o.data.Escola||"Escola"),l(e),e.length>0&&d(!0),setTimeout(()=>{p(!1)},3e3)):b(o.error)}catch(e){i.A.error("Erro ao salvar escola:",e),b(e.message)}finally{g(!1)}},[s,c,a,r,t,n,l,d]);return{isSaving:u,saveError:x,saveSuccess:h,setSaveError:b,setSaveSuccess:p,handleSaveEscola:f}},ja=o.lazy(()=>s.e(650).then(s.bind(s,79650))),Na=()=>{const[e,a]=(0,o.useState)(null),[n,l]=(0,o.useState)(!1),[c,m]=(0,o.useState)(!1),[g,h]=(0,o.useState)(!1),[f,v]=(0,o.useState)(null),[y,A]=(0,o.useState)(!1),[E,k]=(0,o.useState)(!1),[C,_]=(0,o.useState)(!1),[L,P]=(0,o.useState)(!1),[S,D]=(0,o.useState)(null),[I,M]=(0,o.useState)(null),[F,z]=(0,o.useState)([]),[O,U]=(0,o.useState)(null),q="undefined"!==typeof window&&window.innerWidth<=b,{escolas:R,loading:V,error:G,searchTerm:W,setSearchTerm:H,selectedType:Z,setSelectedType:J,saveEscola:K,deleteEscola:X}=d(),{filteredEscolas:Y}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"todos";const r=(0,o.useMemo)(()=>{if(!e||0===e.length)return[];let s=[...e];if(a.trim()){const e=a.toLowerCase();s=s.filter(a=>{var s,r;return(null===(s=a.Escola)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(r=a["Munic\xedpio"])||void 0===r?void 0:r.toLowerCase().includes(e))})}return s},[e,a,s]),t=(0,o.useMemo)(()=>e.length,[e]),n=(0,o.useMemo)(()=>r.length,[r]),i=(0,o.useMemo)(()=>""!==a.trim()||s&&"todos"!==s,[a,s]);return{filteredEscolas:r,totalEscolas:t,totalFiltered:n,hasActiveFilters:i}}(R,W,Z),{loadExistingModalidades:$,clearModalidades:ee}=u(),{isSaving:ae,saveError:se,saveSuccess:te,handleSaveEscola:ne}=ya({saveEscola:K,editingLocation:e,setEditingLocation:a,setEscolaSalvaId:D,setEscolaSalvaNome:M,setCamposAlterados:z,setShowMetadadosModal:P,dadosOriginais:O,setDadosOriginais:U}),ie=()=>{a((ee(),{Escola:"","Munic\xedpio":"","Endere\xe7o":"","Terra Indigena (TI)":"","Parcerias com o munic\xedpio":"","Diretoria de Ensino":"","Ano de cria\xe7\xe3o da escola":null,"Povos indigenas":"","Linguas faladas":"","Modalidade de Ensino/turnos de funcionamento":"","Numero de alunos":null,turnos_funcionamento:"","Espa\xe7o escolar e estrutura":"","Acesso \xe0 \xe1gua":"","Tem coleta de lixo?":"","Acesso \xe0 internet":"","Equipamentos Tecs":"","Modo de acesso \xe0 escola":"","Gest\xe3o/Nome":"","Outros funcion\xe1rios":"","Quantidade de professores ind\xedgenas":null,"Quantidade de professores n\xe3o ind\xedgenas":null,"Professores falam a l\xedngua ind\xedgena?":"","Forma\xe7\xe3o dos professores":"","Forma\xe7\xe3o continuada oferecida":"","A escola possui PPP pr\xf3prio?":"","PPP elaborado com a comunidade?":"","Projetos em andamento":"","Parcerias com universidades?":"","A\xe7\xf5es com ONGs ou coletivos?":"","Desejos da comunidade para a escola":"","Escola utiliza redes sociais?":"","Links das redes sociais":"",historia_da_escola:"",Latitude:null,Longitude:null,links:"",link_para_videos:"",logradouro:"",numero:"",complemento:"",bairro:"",cep:"",estado:"SP",nome_professor:"",professores_indigenas:"",professores_nao_indigenas:"",professores_falam_lingua_indigena:"",formacao_professores:"",visitas_supervisores_formacao:"",outros_funcionarios:"",gestao:"",merenda_diferenciada:"",cozinha:"",merenda_escolar:"",diferenciada:"",activeTab:p}))};return(0,j.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-gray-950",children:[(0,j.jsx)(N,{isMobile:q,sidebarOpen:n,setSidebarOpen:l,editingLocation:e,onEscolaSelect:e=>{$(e["Modalidade de Ensino/turnos de funcionamento"]);const s={id:e.id,Escola:e.Escola,"Munic\xedpio":e["Munic\xedpio"],"Endere\xe7o":e["Endere\xe7o"],"Terra Indigena (TI)":e["Terra Indigena (TI)"],"Parcerias com o munic\xedpio":e["Parcerias com o munic\xedpio"],"Diretoria de Ensino":e["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":e["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":e["Povos indigenas"],"Linguas faladas":e["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":e["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":e["Numero de alunos"],turnos_funcionamento:e.turnos_funcionamento||"","Espa\xe7o escolar e estrutura":e["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":e["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":e["Tem coleta de lixo?"],"Acesso \xe0 internet":e["Acesso \xe0 internet"],"Equipamentos Tecs":e["Equipamentos Tecs"],"Modo de acesso \xe0 escola":e["Modo de acesso \xe0 escola"],"Gest\xe3o/Nome":e["Gest\xe3o/Nome"],"Outros funcion\xe1rios":e["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":e["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":e["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":e["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":e["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":e["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":e["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":e["PPP elaborado com a comunidade?"],"Projetos em andamento":e["Projetos em andamento"],"Parcerias com universidades?":e["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":e["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":e["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":e["Escola utiliza redes sociais?"],"Links das redes sociais":e["Links das redes sociais"],historia_da_escola:e.historia_da_escola,Latitude:e.Latitude,Longitude:e.Longitude,links:e.links,link_para_videos:e.link_para_videos,logradouro:e.logradouro,numero:e.numero,complemento:e.complemento,bairro:e.bairro,cep:e.cep,estado:e.estado,nome_professor:e.nome_professor,professores_indigenas:e.professores_indigenas,professores_nao_indigenas:e.professores_nao_indigenas,professores_falam_lingua_indigena:e.professores_falam_lingua_indigena,formacao_professores:e.formacao_professores,visitas_supervisores_formacao:e.visitas_supervisores_formacao,outros_funcionarios:e.outros_funcionarios,gestao:e.gestao,merenda_diferenciada:e.merenda_diferenciada,cozinha:e.cozinha,merenda_escolar:e.merenda_escolar,diferenciada:e.diferenciada,activeTab:p};U((0,r.A)({},s)),a(s)},searchTerm:W,setSearchTerm:H,filteredEscolas:Y}),(0,j.jsxs)("main",{className:"flex-1 p-4 lg:p-8 overflow-y-auto h-screen",children:[(0,j.jsx)("div",{className:"mb-8",children:(0,j.jsx)("h1",{className:"text-3xl lg:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-emerald-300 mb-2",children:"Painel de Administra\xe7\xe3o"})}),(0,j.jsx)(w,{searchTerm:W,setSearchTerm:H,selectedType:Z,setSelectedType:J,onNovaEscola:ie}),V&&(0,j.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,j.jsx)("div",{className:"text-center",children:(0,j.jsx)("div",{className:"text-gray-400 text-lg",children:"Carregando escolas..."})})}),G&&(0,j.jsx)("div",{className:"bg-red-900/50 border border-red-700/50 text-red-200 px-6 py-4 rounded-xl mb-6 backdrop-blur-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"font-semibold",children:"Erro ao carregar escolas"}),(0,j.jsx)("p",{className:"text-red-300",children:G})]})]})}),e&&"tabela-editavel"===e.activeTab&&(0,j.jsx)("div",{className:"fixed inset-0 bg-gray-900 z-40 overflow-hidden",style:{top:"72px"},children:(0,j.jsx)(T,{setEditingLocation:a,onShowMetadadosModal:(e,a,s)=>{D(e),M(a),z(s),P(!0)}})}),e&&"object"===typeof e&&void 0!==e.Escola&&"tabela-editavel"!==e.activeTab&&(0,j.jsxs)("div",{className:"bg-gray-900/80 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-800/50 p-6 flex flex-col",children:[(0,j.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-xl lg:text-2xl font-semibold text-gray-100 mb-1",children:e.id?"Editar Escola":"Nova Escola"}),e.Escola&&(0,j.jsx)("p",{className:"text-gray-400 text-sm",children:e.Escola})]}),(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("button",{onClick:ne,disabled:ae,className:"px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl",children:ae?(0,j.jsx)("div",{className:"flex items-center gap-2",children:"Salvando..."}):(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Salvar"]})}),(0,j.jsx)("button",{onClick:()=>a(null),className:"px-4 py-3 text-gray-400 hover:text-gray-200 hover:bg-gray-800 rounded-xl transition-colors",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),te&&(0,j.jsx)("div",{className:"mb-6 p-4 bg-green-900/50 border border-green-700/50 text-green-200 rounded-xl backdrop-blur-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("svg",{className:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,j.jsx)("span",{className:"font-semibold",children:"Escola salva com sucesso!"})]})}),se&&(0,j.jsx)("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-700/50 text-red-200 rounded-xl backdrop-blur-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("span",{className:"font-semibold",children:"Erro ao salvar:"}),(0,j.jsx)("p",{className:"text-red-300",children:se})]})]})}),(0,j.jsx)("div",{className:"border-b border-gray-800 mb-6 flex-shrink-0 bg-gray-800/50 rounded-t-xl relative",children:(0,j.jsx)("nav",{className:"-mb-px flex space-x-1 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800 tabs-container",children:x.map(s=>{const o=(e.activeTab||p)===s.id,t=(n=s.id,!!(i=e)&&({"dados-basicos":["Escola","Munic\xedpio","Endere\xe7o","Terra Indigena (TI)","Diretoria de Ensino"],"povos-linguas":["Povos indigenas","Linguas faladas"],modalidades:["Modalidade de Ensino/turnos de funcionamento","Numero de alunos"],infraestrutura:["Espa\xe7o escolar e estrutura","Acesso \xe0 \xe1gua","Acesso \xe0 internet"],"gestao-professores":["Gest\xe3o/Nome","Quantidade de professores ind\xedgenas","Quantidade de professores n\xe3o ind\xedgenas"],"material-pedagogico":["A escola possui PPP pr\xf3prio?","Material pedag\xf3gico ind\xedgena"],"projetos-parcerias":["Projetos em andamento","Parcerias com universidades?"],"redes-sociais":["Escola utiliza redes sociais?","Links das redes sociais"],video:["link_para_videos"],historias:["historia_da_escola"],"historia-professores":["nome_professor"],coordenadas:["Latitude","Longitude"],"imagens-escola":["imagem_header"],"imagens-professores":[],documentos:[]}[n]||[]).some(e=>{const a=i[e];return null===a||void 0===a||""===a||"null"===a}));var n,i;return(0,j.jsx)("button",{type:"button",onClick:()=>a((0,r.A)((0,r.A)({},e),{},{activeTab:s.id})),className:"whitespace-nowrap py-3 px-3 sm:px-4 border-b-2 font-medium text-xs sm:text-sm transition-all duration-200 rounded-t-lg flex-shrink-0 min-w-fit relative ".concat(o?"border-green-400 text-green-300 bg-gray-900 shadow-lg":t?"border-orange-400 text-orange-300 bg-orange-900/20 hover:text-orange-200 hover:bg-orange-800/30":"border-transparent text-gray-400 hover:text-green-200 hover:bg-gray-700/50"),children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[s.label,t&&!o&&(0,j.jsx)("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-pulse"})]})},s.id)})})}),(0,j.jsx)("div",{className:"scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-gray-800",children:pa(e,a)})]}),(0,j.jsx)(Q,{isOpen:L,onClose:()=>{P(!1),D(null),M(null),z([]),U(null)},onSave:e=>{i.A.debug("Metadados salvos com sucesso:",e)},escolaId:S,escolaNome:I,camposAlterados:F}),!e&&!V&&(0,j.jsxs)("div",{className:"space-y-8",children:[E&&(0,j.jsx)(o.Suspense,{fallback:(0,j.jsx)("div",{className:"flex items-center justify-center p-8 bg-gray-900/80 backdrop-blur-sm rounded-2xl",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),(0,j.jsx)("p",{className:"text-gray-300",children:"Carregando dashboard de completude..."})]})}),children:(0,j.jsx)(ja,{})}),C&&(0,j.jsx)(B,{}),(0,j.jsxs)("div",{className:"bg-gray-900/80 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-800/50 p-6",children:[(0,j.jsxs)("div",{className:"text-center mb-8",children:[(0,j.jsx)("img",{src:"".concat("/opin","/logo_index.png"),alt:"OPIN - Observat\xf3rio dos Professores Ind\xedgenas",className:"w-32 h-32 mx-auto mb-6 object-contain"}),(0,j.jsx)("h3",{className:"text-xl font-semibold text-gray-200 mb-2",children:"Painel de Administra\xe7\xe3o"}),(0,j.jsx)("p",{className:"text-gray-400 mb-8 max-w-xl mx-auto text-sm",children:"Gerencie escolas ind\xedgenas, dados e configura\xe7\xf5es do sistema."})]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,j.jsxs)("div",{className:"space-y-3",children:[(0,j.jsxs)("h4",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[(0,j.jsx)("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"A\xe7\xf5es Principais"]}),(0,j.jsx)("button",{onClick:ie,className:"w-full px-4 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 shadow-lg hover:shadow-xl text-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Criar Nova Escola"]})}),(0,j.jsx)("button",{onClick:()=>{a({id:"tabela-editavel",Escola:"Tabela Edit\xe1vel",activeTab:"tabela-editavel"})},className:"w-full px-4 py-3 bg-gray-800 text-gray-100 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 border border-gray-600 text-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Editar em Tabela"]})}),(0,j.jsx)("button",{onClick:()=>k(!E),className:"w-full px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 border text-sm ".concat(E?"bg-green-800 text-green-100 border-green-600 hover:bg-green-700":"bg-gray-800 text-gray-100 border-gray-600 hover:bg-gray-700"),children:(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Ver Dashboard"]})})]}),(0,j.jsxs)("div",{className:"space-y-3",children:[(0,j.jsxs)("h4",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[(0,j.jsx)("svg",{className:"w-4 h-4 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"M\xeddia e Backup"]}),(0,j.jsx)("button",{onClick:async()=>{try{const a=new(0,(await s.e(159).then(s.t.bind(s,26159,23))).default),{data:r,error:o}=await t.N.storage.from("imagens").list("",{limit:1e3,offset:0});if(o)return i.A.error("Erro ao buscar imagens:",o),void alert("Erro ao buscar imagens: "+o.message);if(!r||0===r.length)return void alert("Nenhuma imagem encontrada no bucket.");const n=document.createElement("div");n.innerHTML='\n        <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); \n                    background: rgba(0,0,0,0.8); color: white; padding: 20px; border-radius: 10px; \n                    z-index: 9999; text-align: center;">\n          <div style="margin-bottom: 10px;">Preparando download...</div>\n          <div style="font-size: 12px;">Encontradas '.concat(r.length," imagens</div>\n        </div>\n      "),document.body.appendChild(n);for(let s=0;s<r.length;s++){const o=r[s];try{const{data:e,error:l}=await t.N.storage.from("imagens").download(o.name);if(l){i.A.error("Erro ao baixar ".concat(o.name,":"),l);continue}a.file(o.name,e),n.innerHTML='\n            <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); \n                        background: rgba(0,0,0,0.8); color: white; padding: 20px; border-radius: 10px; \n                        z-index: 9999; text-align: center;">\n              <div style="margin-bottom: 10px;">Preparando download...</div>\n              <div style="font-size: 12px;">'.concat(s+1," de ").concat(r.length," imagens processadas</div>\n            </div>\n          ")}catch(e){i.A.error("Erro ao processar ".concat(o.name,":"),e)}}const l=await a.generateAsync({type:"blob"}),d=URL.createObjectURL(l),c=document.createElement("a");c.href=d,c.download="backup-imagens-escolas-".concat((new Date).toISOString().split("T")[0],".zip"),document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(d),document.body.removeChild(n),alert("Download conclu\xeddo! ".concat(r.length," imagens foram baixadas em um arquivo ZIP."))}catch(a){i.A.error("Erro ao fazer download das imagens:",a),alert("Erro ao fazer download das imagens: "+a.message)}},className:"w-full px-4 py-3 bg-gray-800 text-gray-100 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 border border-gray-600 text-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Download de Imagens"]})}),(0,j.jsx)("button",{onClick:()=>m(!0),className:"w-full px-4 py-3 bg-gray-800 text-gray-100 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 border border-gray-600 text-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Backup dos Dados"]})})]}),(0,j.jsxs)("div",{className:"space-y-3",children:[(0,j.jsxs)("h4",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[(0,j.jsxs)("svg",{className:"w-4 h-4 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Administra\xe7\xe3o"]}),(0,j.jsx)("button",{onClick:()=>_(!C),className:"w-full px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 border text-sm ".concat(C?"bg-blue-800 text-blue-100 border-blue-600 hover:bg-blue-700":"bg-gray-800 text-gray-100 border-gray-600 hover:bg-gray-700"),children:(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Visibilidade dos Cards"]})}),(0,j.jsx)("button",{onClick:()=>h(!0),className:"w-full px-4 py-3 bg-red-800 text-red-100 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 border border-red-600 text-sm",children:(0,j.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remover Escola"]})})]})]})]})]}),(0,j.jsx)(re,{isOpen:c,onClose:()=>m(!1)}),(0,j.jsx)(oe,{isOpen:g,onClose:()=>{h(!1),v(null)},escolas:Y,escolaToDelete:f,setEscolaToDelete:v,onConfirmDelete:async()=>{if(f){A(!0);try{const s=await X(f.id);s.success?(h(!1),v(null),(null===e||void 0===e?void 0:e.id)===f.id&&a(null)):i.A.error("Erro ao remover escola:",s.error)}catch(s){i.A.error("Erro ao remover escola:",s)}finally{A(!1)}}},isDeleting:y})]})]})},wa=()=>(0,j.jsx)(P,{children:(0,j.jsx)(Na,{})})}}]);
//# sourceMappingURL=423.c506e3b9.chunk.js.map