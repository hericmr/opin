{"version":3,"file":"static/js/510.8e3d73e9.chunk.js","mappings":"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","sources":["components/MinimalShareButtons.js","utils/openlayers/markerStyles.js","utils/mobileUtils.js","utils/openlayers/interactions.js","utils/openlayers/effects.js","utils/logger.js","components/OpenLayers/OpenLayersMarkers.js","utils/openlayers/layerStyles.js","utils/mapConfig.js","components/OpenLayers/OpenLayersTerrasIndigenas.js","components/OpenLayers/OpenLayersEstadoSP.js","components/OpenLayers/OpenLayersLayers.js","hooks/useMapControls.js","components/map/ResponsiveZoomControls.js","components/map/MapWrapper.jsx","components/OpenLayersMap.js","hooks/useGeoJSONCache.js","hooks/useResponsiveIcon.js","components/MapSelector.js","components/hooks/useDocumentosEscola.js","components/PainelInformacoes/components/InfoSection.js","components/PainelInformacoes/components/EscolaInfo/BasicInfo.js","components/PainelInformacoes/components/EscolaInfo/HistoriaEscolaContent.js","components/PainelInformacoes/components/EscolaInfo/HistoriaEscolaHeader.js","components/PainelInformacoes/components/EscolaInfo/HistoriaEscola.js","components/PainelInformacoes/components/BooleanValue.js","components/PainelInformacoes/components/EscolaInfo/Modalidades.js","components/PainelInformacoes/components/EscolaInfo/Infraestrutura.js","components/PainelInformacoes/components/EscolaInfo/GestaoProfessores.js","components/PainelInformacoes/components/EscolaInfo/ProjetosParcerias.js","components/ReusableImageZoom.js","components/shared/OptimizedImage.js","hooks/useImagePreloader.js","components/PainelInformacoes/components/ImagemHistoriadoProfessor.js","components/shared/Avatar.js","components/shared/AvatarThemes.js","components/PainelInformacoes/components/FotoProfessor.js","components/PainelInformacoes/components/EscolaInfo/HistoriadoProfessor.js","components/PainelInformacoes/components/ImagensdasEscolas.js","components/PainelInformacoes/components/EscolaInfo/index.js","components/PainelInformacoes/icons/HandFistIcon.js","components/PainelInformacoes/components/InfoItem.js","components/PainelInformacoes/TerraIndigenaInfo.js","components/PainelDescricao.js","components/PainelInformacoes/IntroPanel.js","utils/textFormatting.js","components/PainelHeader.js","components/PainelInformacoes/components/EscolaHeaderImage.js","components/PainelInformacoes/components/SidebarMediaViewer.js","components/hooks/usePainelVisibility.js","components/PainelInformacoes/components/PainelContainer.js","components/hooks/usePainelDimensions.js","components/PainelInformacoes/components/DocumentViewer.js","components/PainelInformacoes/components/VideoPlayer.js","components/PainelInformacoes/index.js","components/hooks/useShare.js","components/hooks/useClickOutside.js","components/hooks/useDynamicURL.js","components/MapaEscolasIndigenas.js","services/legendasService.js","services/historiaProfessorService.js"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  FacebookShareButton,\n  TwitterShareButton,\n  WhatsappShareButton,\n} from 'react-share';\nimport { Facebook, Twitter, MessageCircle, Link as LinkIcon, Check } from 'lucide-react';\n\nconst MinimalShareButtons = ({ url, title, description = '' }) => {\n  const [copied, setCopied] = useState(false);\n  const shareUrl = url || (typeof window !== 'undefined' ? window.location.href : '');\n  const shareText = title || 'OPIN - Observatrio Dos Professores Indgenas';\n\n  const handleCopyLink = async () => {\n    try {\n      await navigator.clipboard.writeText(shareUrl);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      // Fallback para navegadores mais antigos\n      const input = document.createElement('input');\n      input.value = shareUrl;\n      document.body.appendChild(input);\n      input.select();\n      document.execCommand('copy');\n      document.body.removeChild(input);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  return (\n    <span className=\"shareBtns flex items-center\">\n      <FacebookShareButton\n        url={shareUrl}\n        quote={shareText}\n        className=\"shareIcon blackHover\"\n        aria-label=\"Compartilhar no Facebook\"\n      >\n        <Facebook className=\"w-4 h-4\" />\n      </FacebookShareButton>\n      \n      <TwitterShareButton\n        url={shareUrl}\n        title={shareText}\n        className=\"shareIcon blackHover\"\n        aria-label=\"Compartilhar no Twitter\"\n      >\n        <Twitter className=\"w-4 h-4\" />\n      </TwitterShareButton>\n      \n      <WhatsappShareButton\n        url={shareUrl}\n        title={shareText}\n        className=\"shareIcon blackHover\"\n        aria-label=\"Compartilhar no WhatsApp\"\n      >\n        <MessageCircle className=\"w-4 h-4\" />\n      </WhatsappShareButton>\n      \n      <button\n        onClick={handleCopyLink}\n        className=\"shareIcon blackHover\"\n        aria-label={copied ? 'Link copiado' : 'Copiar link'}\n        title={copied ? 'Link copiado!' : 'Copiar link'}\n      >\n        {copied ? (\n          <Check className=\"w-4 h-4\" />\n        ) : (\n          <LinkIcon className=\"w-4 h-4\" />\n        )}\n      </button>\n    </span>\n  );\n};\n\nexport default MinimalShareButtons;\n\n","import { Style, Fill, Stroke, Text, Icon } from 'ol/style';\nimport { Point } from 'ol/geom';\n\n// Caminho para o marcador SVG\nconst MARKER_SVG_PATH = `${process.env.PUBLIC_URL || ''}/map-marker.svg`;\n\n// Configuraes de cores dos marcadores\nexport const MARKER_COLORS = {\n  individual: '#3B82F6',\n  individualBorder: '#1E40AF',\n  cluster: {\n    small: '#60A5FA',\n    medium: '#3B82F6',\n    large: '#2563EB',\n    xlarge: '#1E40AF'\n  },\n  nearbyPair: '#FF6B6B'\n};\n\n// Configuraes de tamanhos dos clusters\nexport const CLUSTER_SIZES = {\n  small: { min: 2, max: 10, size: 50 },\n  medium: { min: 11, max: 20, size: 52 },\n  large: { min: 21, max: 50, size: 56 },\n  xlarge: { min: 51, max: 100, size: 64 },\n  xxlarge: { min: 101, size: 72 }\n};\n\n// Configuraes de fontes para clusters\nexport const CLUSTER_FONTS = {\n  small: 'bold 14px Arial',\n  medium: 'bold 15px Arial',\n  large: 'bold 16px Arial',\n  xlarge: 'bold 18px Arial'\n};\n\n/**\n * Cria estilo para marcador individual\n * @param {Object} feature - Feature do OpenLayers\n * @param {boolean} showNames - Se deve mostrar nomes das escolas\n * @returns {Style} Estilo do marcador\n */\nexport const createMarkerStyle = (feature, showNames = false) => {\n  const markerData = feature.get('markerData') || feature.get('schoolData'); // Suporta ambos\n  const isNearbyPair = feature.get('isNearbyPair');\n  \n  if (!markerData) return null;\n\n  // const baseColor = isNearbyPair ? MARKER_COLORS.nearbyPair : MARKER_COLORS.individual; // Removido - no utilizado\n  // const borderColor = isNearbyPair ? '#DC2626' : MARKER_COLORS.individualBorder; // Removido - no utilizado\n\n  // Estilo base do marcador (cone SVG)\n  const markerStyle = new Style({\n    image: new Icon({\n      src: MARKER_SVG_PATH,\n      scale: isNearbyPair ? 1.2 : 1.0,\n      anchor: [0.5, 0.5],\n      anchorXUnits: 'fraction',\n      anchorYUnits: 'fraction'\n    }),\n    geometry: feature.getGeometry()\n  });\n\n  // Se deve mostrar nomes, adicionar texto\n  if (showNames && markerData.titulo) {\n    const textStyle = new Style({\n      text: new Text({\n        text: markerData.titulo,\n        font: '12px Arial',\n        fill: new Fill({\n          color: '#1F2937'\n        }),\n        stroke: new Stroke({\n          color: '#FFFFFF',\n          width: 2\n        }),\n        offsetY: -15,\n        textAlign: 'center'\n      }),\n      geometry: feature.getGeometry()\n    });\n    \n    return [markerStyle, textStyle];\n  }\n\n  return markerStyle;\n};\n\n/**\n * Cria estilo para cluster de marcadores\n * @param {Object} feature - Feature do cluster\n * @param {Function} markerStyleFunction - Funo para estilizar marcadores individuais\n * @returns {Style} Estilo do cluster\n */\nexport const createClusterStyle = (feature, markerStyleFunction) => {\n  const features = feature.get('features');\n  \n  if (!features || features.length === 0) {\n    return markerStyleFunction(feature);\n  }\n\n  // Se for apenas um marcador, usar estilo de marcador individual\n  if (features.length === 1) {\n    return markerStyleFunction(features[0]);\n  }\n\n  // Determinar tamanho e cor do cluster baseado na quantidade\n  let clusterSize; // clusterColor removido - no utilizado\n  const count = features.length;\n\n  if (count <= CLUSTER_SIZES.small.max) {\n    clusterSize = CLUSTER_SIZES.small.size;\n    // clusterColor = MARKER_COLORS.cluster.small; // Removido - no utilizado\n  } else if (count <= CLUSTER_SIZES.medium.max) {\n    clusterSize = CLUSTER_SIZES.medium.size;\n    // clusterColor = MARKER_COLORS.cluster.medium; // Removido - no utilizado\n  } else if (count <= CLUSTER_SIZES.large.max) {\n    clusterSize = CLUSTER_SIZES.large.size;\n    // clusterColor = MARKER_COLORS.cluster.large; // Removido - no utilizado\n  } else if (count <= CLUSTER_SIZES.xlarge.max) {\n    clusterSize = CLUSTER_SIZES.xlarge.size;\n    // clusterColor = MARKER_COLORS.cluster.xlarge; // Removido - no utilizado\n  } else {\n    clusterSize = CLUSTER_SIZES.xxlarge.size;\n    // clusterColor = MARKER_COLORS.cluster.xlarge; // Removido - no utilizado\n  }\n\n  // Determinar fonte baseada no tamanho\n  let font;\n  if (count <= CLUSTER_SIZES.small.max) {\n    font = CLUSTER_FONTS.small;\n  } else if (count <= CLUSTER_SIZES.medium.max) {\n    font = CLUSTER_FONTS.medium;\n  } else if (count <= CLUSTER_SIZES.large.max) {\n    font = CLUSTER_FONTS.large;\n  } else {\n    font = CLUSTER_FONTS.xlarge;\n  }\n\n  return new Style({\n    image: new Icon({\n      src: MARKER_SVG_PATH,\n      scale: Math.max(0.8, clusterSize / 80),\n      anchor: [0.5, 0.5],\n      anchorXUnits: 'fraction',\n      anchorYUnits: 'fraction'\n    }),\n    text: new Text({\n      text: count.toString(),\n      font: font,\n      fill: new Fill({\n        color: '#FFFFFF'\n      }),\n      stroke: new Stroke({\n        color: '#1F2937',\n        width: 1\n      })\n    })\n  });\n};\n\n/**\n * Cria estilo para marcador com indicador de par prximo\n * @param {Object} feature - Feature do marcador\n * @returns {Style} Estilo do marcador com indicador\n */\nexport const createNearbyPairStyle = (feature) => {\n  const baseStyle = createMarkerStyle(feature, false);\n  \n  if (!baseStyle || !Array.isArray(baseStyle)) {\n    return baseStyle;\n  }\n\n  // Adicionar indicador de par prximo\n  const indicatorStyle = new Style({\n    image: new Icon({\n      src: MARKER_SVG_PATH,\n      scale: 0.5,\n      anchor: [0.5, 0.5],\n      anchorXUnits: 'fraction',\n      anchorYUnits: 'fraction'\n    }),\n    geometry: feature.getGeometry()\n  });\n\n  // Posicionar indicador no canto superior direito\n  const geometry = feature.getGeometry();\n  const coordinates = geometry.getCoordinates();\n  const offsetX = 0.0001; // Ajustar conforme necessrio\n  const offsetY = 0.0001;\n  \n  const indicatorGeometry = new Point([\n    coordinates[0] + offsetX,\n    coordinates[1] + offsetY\n  ]);\n  \n  indicatorStyle.setGeometry(indicatorGeometry);\n  \n  return [...baseStyle, indicatorStyle];\n};\n\n/**\n * Cria estilo para marcador com tooltip\n * @param {Object} feature - Feature do marcador\n * @param {string} tooltipText - Texto do tooltip\n * @returns {Style} Estilo do marcador com tooltip\n */\nexport const createMarkerWithTooltipStyle = (feature, tooltipText) => {\n  const baseStyle = createMarkerStyle(feature, false);\n  \n  if (!baseStyle) return null;\n\n  // Adicionar tooltip como texto\n  const tooltipStyle = new Style({\n    text: new Text({\n      text: tooltipText,\n      font: '11px Arial',\n      fill: new Fill({\n        color: '#1F2937'\n      }),\n      stroke: new Stroke({\n        color: '#FFFFFF',\n        width: 2\n      }),\n      offsetY: -25,\n      textAlign: 'center',\n      backgroundFill: new Fill({\n        color: 'rgba(255, 255, 255, 0.9)'\n      }),\n      backgroundStroke: new Stroke({\n        color: '#E5E7EB',\n        width: 1\n      }),\n      padding: [4, 8]\n    }),\n    geometry: feature.getGeometry()\n  });\n\n  return Array.isArray(baseStyle) ? [...baseStyle, tooltipStyle] : [baseStyle, tooltipStyle];\n};\n\n/**\n * Aplica estilo de hover ao marcador\n * @param {Object} feature - Feature do marcador\n * @param {Style} baseStyle - Estilo base do marcador\n * @returns {Style} Estilo com efeito hover\n */\nexport const applyHoverStyle = (feature, baseStyle) => {\n  if (!baseStyle) return null;\n\n  const hoverStyle = new Style({\n    image: new Icon({\n      src: MARKER_SVG_PATH,\n      scale: 1.3,\n      anchor: [0.5, 0.5],\n      anchorXUnits: 'fraction',\n      anchorYUnits: 'fraction'\n    }),\n    geometry: feature.getGeometry()\n  });\n\n  return Array.isArray(baseStyle) ? [...baseStyle, hoverStyle] : [baseStyle, hoverStyle];\n};\n\n/**\n * Cria estilo para marcador selecionado\n * @param {Object} feature - Feature do marcador\n * @param {Style} baseStyle - Estilo base do marcador\n * @returns {Style} Estilo com efeito de seleo\n */\nexport const applySelectionStyle = (feature, baseStyle) => {\n  if (!baseStyle) return null;\n\n  const selectionStyle = new Style({\n    image: new Icon({\n      src: MARKER_SVG_PATH,\n      scale: 1.5,\n      anchor: [0.5, 0.5],\n      anchorXUnits: 'fraction',\n      anchorYUnits: 'fraction'\n    }),\n    geometry: feature.getGeometry()\n  });\n\n  return Array.isArray(baseStyle) ? [...baseStyle, selectionStyle] : [baseStyle, selectionStyle];\n};\n","// Utility functions for mobile detection and interaction\n\n/**\n * Detecta se  um dispositivo mobile baseado em mltiplos critrios\n * Prioriza a largura da tela como critrio principal\n */\nexport const isMobile = () => {\n  // PRIORIDADE: Largura da tela  o critrio principal\n  // Se a largura for maior que 768px, NUNCA  mobile (mesmo com touch)\n  const width = window.innerWidth;\n  if (width > 768) {\n    return false; // Desktop - nunca mobile, mesmo com touch\n  }\n  \n  // Para telas menores ou igual a 768px, verificar outros critrios\n  const isMobileWidth = width <= 768;\n  \n  // Verificar se  um dispositivo mvel baseado no user agent\n  const isMobileUserAgent = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n  \n  // Verificar orientao (mobile geralmente tem orientao varivel)\n  const isMobileOrientation = window.orientation !== undefined;\n  \n  // Verificar se tem capacidades de toque (menos confivel em desktop touch)\n  const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n  \n  // Se a largura  mobile E tem user agent mobile OU orientao mobile,  mobile\n  // Touch sozinho no  suficiente (desktops tambm podem ter touch)\n  if (isMobileWidth && (isMobileUserAgent || isMobileOrientation)) {\n    return true;\n  }\n  \n  // Se largura  mobile mas no tem user agent nem orientao, \n  // verificar se  realmente mobile (pode ser janela pequena no desktop)\n  // Nesse caso, usar apenas a largura como critrio\n  return isMobileWidth;\n};\n\n/**\n * Detecta se  mobile em orientao paisagem\n */\nexport const isMobileLandscape = () => {\n  return isMobile() && window.innerWidth > window.innerHeight;\n};\n\n/**\n * Detecta especificamente se o dispositivo tem capacidades de toque\n */\nexport const hasTouchCapabilities = () => {\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n};\n\n/**\n * Detecta se o evento atual  um evento de toque\n */\nexport const isTouchEvent = (event) => {\n  return event.type && event.type.startsWith('touch');\n}; ","import { isMobile, hasTouchCapabilities } from '../mobileUtils';\n\n/**\n * Classe para gerenciar interaes e eventos do OpenLayers\n */\nexport class OpenLayersInteractions {\n  constructor(map, options = {}) {\n    this.map = map;\n    this.options = {\n      enableHover: options.enableHover !== false,\n      enableClick: options.enableClick !== false,\n      enableDoubleClick: options.enableDoubleClick !== false,\n      enableTouch: options.enableTouch !== false,\n      hoverDelay: options.hoverDelay || 200,\n      clickDelay: options.clickDelay || 300,\n      ...options\n    };\n\n    this.eventHandlers = new Map();\n    this.hoveredFeature = null;\n    this.clickedFeature = null;\n    this.clickTimeout = null;\n    this.hoverTimeout = null;\n    this.tooltipElement = null;\n    console.log('[OpenLayersInteractions] Interaes inicializadas');\n\n    this.initializeInteractions();\n  }\n\n  /**\n   * Verifica se  dispositivo mobile (dinmico e robusto)\n   */\n  isMobile() {\n    const mobile = isMobile();\n    const hasTouch = hasTouchCapabilities();\n    \n    console.log('[OpenLayersInteractions] Deteco de mobile:', {\n      mobile,\n      hasTouch,\n      windowWidth: window.innerWidth,\n      userAgent: navigator.userAgent\n    });\n    \n    return mobile || hasTouch;\n  }\n\n  /**\n   * Inicializa todas as interaes\n   */\n  initializeInteractions() {\n    if (this.options.enableHover) {\n      this.setupHoverInteraction();\n    }\n\n    if (this.options.enableClick) {\n      this.setupClickInteraction();\n    }\n\n    if (this.options.enableDoubleClick) {\n      this.setupDoubleClickInteraction();\n    }\n\n    if (this.options.enableTouch && this.isMobile()) {\n      this.setupTouchInteraction();\n    }\n  }\n\n  /**\n   * Configura interao de hover\n   */\n  setupHoverInteraction() {\n    this.map.on('pointermove', (event) => {\n      this.handlePointerMove(event);\n    });\n\n    this.map.on('pointerleave', () => {\n      this.handlePointerLeave();\n    });\n  }\n\n  /**\n   * Configura interao de clique\n   */\n  setupClickInteraction() {\n    this.map.on('click', (event) => {\n      this.handleClick(event);\n    });\n  }\n\n  /**\n   * Configura interao de duplo clique\n   */\n  setupDoubleClickInteraction() {\n    this.map.on('dblclick', (event) => {\n      this.handleDoubleClick(event);\n    });\n  }\n\n  /**\n   * Configura interao touch para mobile\n   */\n  setupTouchInteraction() {\n    // Em mobile, usar o sistema de clique com tooltip\n    // O handleClick j trata mobile vs desktop\n    console.log('[OpenLayersInteractions] Touch interaction configurada para mobile');\n  }\n\n  /**\n   * Handler para movimento do ponteiro (hover)\n   * @param {Object} event - Evento do OpenLayers\n   */\n  handlePointerMove(event) {\n    if (this.isMobile()) return; // Desabilitar hover em mobile\n\n    const feature = this.map.forEachFeatureAtPixel(event.pixel, (feature) => feature);\n    \n    // Debug: verificar se est detectando features\n    if (feature && !this.hoveredFeature) {\n      console.log('[OpenLayersInteractions] Feature detectado:', {\n        type: feature.get('type'),\n        schoolData: feature.get('schoolData'),\n        terraIndigenaInfo: feature.get('terraIndigenaInfo')\n      });\n    }\n    \n    if (feature !== this.hoveredFeature) {\n      // Limpar hover anterior\n      if (this.hoveredFeature) {\n        this.clearHover();\n      }\n\n      // Aplicar novo hover\n      if (feature) {\n        this.applyHover(feature, event);\n      }\n    }\n  }\n\n  /**\n   * Handler para sada do ponteiro\n   */\n  handlePointerLeave() {\n    this.clearHover();\n  }\n\n  /**\n   * Handler para clique\n   * @param {Object} event - Evento do OpenLayers\n   */\n  handleClick(event) {\n    const feature = this.map.forEachFeatureAtPixel(event.pixel, (feature) => feature);\n    \n    if (!feature) return;\n\n    // Em mobile, primeiro clique mostra tooltip, segundo abre painel\n    if (this.isMobile()) {\n      this.handleMobileClick(feature, event);\n      return;\n    }\n\n    // Verificar se  o mesmo feature clicado anteriormente\n    if (this.clickedFeature === feature) {\n      // Segundo clique no mesmo feature\n      this.handleDoubleClick(event);\n      return;\n    }\n\n    // Primeiro clique\n    this.clickedFeature = feature;\n    \n    // Configurar timeout para resetar o clique\n    if (this.clickTimeout) {\n      clearTimeout(this.clickTimeout);\n    }\n    \n    this.clickTimeout = setTimeout(() => {\n      this.clickedFeature = null;\n    }, this.options.clickDelay);\n\n    // Executar handler de clique nico\n    this.executeClickHandler(feature, event);\n  }\n\n  /**\n   * Handler para duplo clique\n   * @param {Object} event - Evento do OpenLayers\n   */\n  handleDoubleClick(event) {\n    const feature = this.map.forEachFeatureAtPixel(event.pixel, (feature) => feature);\n    \n    if (!feature) return;\n\n    // Limpar timeout de clique nico\n    if (this.clickTimeout) {\n      clearTimeout(this.clickTimeout);\n      this.clickTimeout = null;\n    }\n\n    // Resetar feature clicado\n    this.clickedFeature = null;\n\n    // Executar handler de duplo clique\n    this.executeDoubleClickHandler(feature, event);\n  }\n\n  /**\n   * Handler para fim de toque (mobile)\n   * @param {Object} event - Evento do OpenLayers\n   */\n  handleTouchEnd(event) {\n    const feature = this.map.forEachFeatureAtPixel(event.pixel, (feature) => feature);\n    \n    if (!feature) return;\n\n    // Em mobile, toque nico executa ao de clique\n    this.executeClickHandler(feature, event);\n  }\n\n  /**\n   * Handler para clique em mobile (primeiro mostra tooltip, segundo abre painel)\n   * @param {Object} feature - Feature clicado\n   * @param {Object} event - Evento do OpenLayers\n   */\n  handleMobileClick(feature, event) {\n    // Verificar se  o mesmo feature clicado anteriormente\n    if (this.clickedFeature === feature) {\n      // Segundo clique: abrir painel\n      console.log('[OpenLayersInteractions] Segundo clique em mobile - abrindo painel');\n      this.forceHideTooltip(); // Esconder tooltip e resetar estado\n      this.executeClickHandler(feature, event); // Abrir painel\n      return;\n    }\n\n    // Primeiro clique: mostrar tooltip\n    console.log('[OpenLayersInteractions] Primeiro clique em mobile - mostrando tooltip');\n    this.clickedFeature = feature;\n    \n    // Mostrar tooltip\n    if (this.options.showTooltip) {\n      this.showTooltip(feature, event);\n    }\n\n    // Configurar timeout para esconder tooltip e resetar clique\n    if (this.clickTimeout) {\n      clearTimeout(this.clickTimeout);\n    }\n    \n    this.clickTimeout = setTimeout(() => {\n      console.log('[OpenLayersInteractions] Timeout mobile - escondendo tooltip e resetando');\n      this.forceHideTooltip();\n    }, 3000); // 3 segundos de timeout\n\n    // Executar handler de hover para aplicar estilo visual\n    this.executeHoverHandler(feature, event);\n  }\n\n  /**\n   * Aplica efeito de hover a um feature\n   * @param {Object} feature - Feature do OpenLayers\n   * @param {Object} event - Evento do OpenLayers\n   */\n  applyHover(feature, event) {\n    this.hoveredFeature = feature;\n    \n    // Aplicar estilo de hover\n    this.applyHoverStyle(feature);\n    \n    // Mostrar tooltip se configurado (apenas em desktop)\n    if (this.options.showTooltip && !this.isMobile()) {\n      this.showTooltip(feature, event);\n    }\n\n    // Executar handler de hover\n    this.executeHoverHandler(feature, event);\n  }\n\n  /**\n   * Remove efeito de hover\n   */\n  clearHover() {\n    if (this.hoveredFeature) {\n      // Remover estilo de hover\n      this.clearHoverStyle(this.hoveredFeature);\n      \n      // Em mobile, no esconder tooltip automaticamente\n      // O tooltip  controlado pelo sistema de clique\n      if (!this.isMobile()) {\n        this.hideTooltip();\n      }\n      \n      // Executar handler de hover out\n      this.executeHoverOutHandler(this.hoveredFeature);\n      \n      this.hoveredFeature = null;\n    }\n  }\n\n  /**\n   * Aplica estilo de hover a um feature\n   * @param {Object} feature - Feature do OpenLayers\n   */\n  applyHoverStyle(feature) {\n    // Implementar lgica de estilo de hover\n    // Esta funo deve ser sobrescrita ou configurada\n    if (this.options.hoverStyleFunction) {\n      this.options.hoverStyleFunction(feature, true);\n    }\n  }\n\n  /**\n   * Remove estilo de hover de um feature\n   * @param {Object} feature - Feature do OpenLayers\n   */\n  clearHoverStyle(feature) {\n    // Implementar lgica de remoo de estilo de hover\n    if (this.options.hoverStyleFunction) {\n      this.options.hoverStyleFunction(feature, false);\n    }\n  }\n\n  /**\n   * Mostra tooltip para um feature\n   * @param {Object} feature - Feature do OpenLayers\n   * @param {Object} event - Evento do OpenLayers\n   */\n  showTooltip(feature, event) {\n    if (this.tooltipElement) {\n      this.hideTooltip();\n    }\n\n    const tooltipContent = this.getTooltipContent(feature);\n    console.log('[OpenLayersInteractions] Contedo do tooltip:', tooltipContent);\n    \n    if (!tooltipContent) {\n      console.log('[OpenLayersInteractions] Sem contedo para tooltip');\n      return;\n    }\n\n    this.tooltipElement = this.createTooltipElement(tooltipContent, event);\n    this.map.getTargetElement().appendChild(this.tooltipElement);\n    console.log('[OpenLayersInteractions] Tooltip criado e adicionado ao DOM');\n  }\n\n  /**\n   * Esconde tooltip\n   */\n  hideTooltip() {\n    if (this.tooltipElement) {\n      this.tooltipElement.remove();\n      this.tooltipElement = null;\n      console.log('[OpenLayersInteractions] Tooltip escondido');\n    }\n  }\n\n  /**\n   * Fora limpeza do tooltip (til para mobile)\n   */\n  forceHideTooltip() {\n    this.hideTooltip();\n    if (this.clickTimeout) {\n      clearTimeout(this.clickTimeout);\n      this.clickTimeout = null;\n    }\n    this.clickedFeature = null;\n    console.log('[OpenLayersInteractions] Tooltip foradamente escondido e estado resetado');\n  }\n\n  /**\n   * Cria elemento de tooltip\n   * @param {string} content - Contedo do tooltip\n   * @param {Object} event - Evento do OpenLayers\n   * @returns {HTMLElement} Elemento do tooltip\n   */\n  createTooltipElement(content, event) {\n    const element = document.createElement('div');\n    element.className = 'ol-tooltip';\n    \n    // Detectar se  terra indgena baseado no contedo\n    const isTerraIndigena = content.includes('Terra Indgena');\n    \n    // Em mobile, tornar o nome clicvel\n    if (this.isMobile()) {\n      // Criar tooltip clicvel para mobile\n      const clickableContent = `<span class=\"tooltip-clickable\">${content}</span>`;\n      element.innerHTML = clickableContent;\n      \n      // Configurar estilos para mobile\n      const tooltipStyles = isTerraIndigena ? {\n        backgroundColor: '#fef2f2', // Fundo vermelho claro\n        borderColor: 'rgba(239, 68, 68, 0.3)' // Borda vermelha\n      } : {\n        backgroundColor: '#bbf7d0', // Fundo verde\n        borderColor: 'rgba(34, 197, 94, 0.3)' // Borda verde\n      };\n      \n      Object.assign(element.style, {\n        position: 'absolute',\n        padding: '8px 12px',\n        borderRadius: '8px',\n        fontSize: '14px',\n        fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\n        fontWeight: '700',\n        color: '#000000',\n        pointerEvents: 'auto', // IMPORTANTE: Permitir eventos de clique no mobile\n        zIndex: '1000',\n        maxWidth: '250px',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',\n        border: `2px solid ${tooltipStyles.borderColor}`,\n        cursor: 'default',\n        ...tooltipStyles\n      });\n      \n      // Configurar o span clicvel\n      const clickableSpan = element.querySelector('.tooltip-clickable');\n      if (clickableSpan) {\n        Object.assign(clickableSpan.style, {\n          cursor: 'pointer',\n          textDecoration: 'underline',\n          textDecorationColor: '#3B82F6',\n          textDecorationThickness: '2px',\n          transition: 'all 0.2s ease',\n          display: 'inline-block',\n          padding: '2px 4px',\n          borderRadius: '4px',\n          fontWeight: '800'\n        });\n        \n        // Adicionar evento de clique para abrir o painel\n        clickableSpan.addEventListener('click', () => {\n          console.log('[OpenLayersInteractions] Nome clicado no tooltip mobile');\n          // Emitir evento para abrir o painel\n          const feature = this.map.forEachFeatureAtPixel(event.pixel, (feature) => feature);\n          if (feature) {\n            this.executeClickHandler(feature, event);\n          }\n        });\n        \n        // Adicionar efeitos de hover\n        clickableSpan.addEventListener('mouseenter', () => {\n          clickableSpan.style.backgroundColor = 'rgba(59, 130, 246, 0.1)';\n          clickableSpan.style.textDecorationColor = '#1D4ED8';\n          clickableSpan.style.transform = 'scale(1.05)';\n        });\n        \n        clickableSpan.addEventListener('mouseleave', () => {\n          clickableSpan.style.backgroundColor = 'transparent';\n          clickableSpan.style.textDecorationColor = '#3B82F6';\n          clickableSpan.style.transform = 'scale(1)';\n        });\n      }\n    } else {\n      // Desktop: tooltip normal (no clicvel)\n      element.innerHTML = content;\n      \n      // Estilos do tooltip para desktop\n      const tooltipStyles = isTerraIndigena ? {\n        backgroundColor: '#fef2f2' // Fundo vermelho claro\n      } : {\n        backgroundColor: '#bbf7d0' // Fundo verde\n      };\n      \n      Object.assign(element.style, {\n        position: 'absolute',\n        padding: '6px 10px',\n        borderRadius: '6px',\n        fontSize: '12px',\n        fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\n        fontWeight: '700',\n        color: '#000000',\n        pointerEvents: 'none',\n        zIndex: '1000',\n        maxWidth: '200px',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)',\n        ...tooltipStyles\n      });\n    }\n\n    // Posicionar tooltip\n    const coordinate = event.coordinate;\n    const pixel = this.map.getPixelFromCoordinate(coordinate);\n    \n    element.style.left = (pixel[0] + 10) + 'px';\n    element.style.top = (pixel[1] - 10) + 'px';\n\n    return element;\n  }\n\n  /**\n   * Obtm contedo do tooltip para um feature\n   * @param {Object} feature - Feature do OpenLayers\n   * @returns {string} Contedo do tooltip\n   */\n  getTooltipContent(feature) {\n    console.log('[OpenLayersInteractions] Obtendo contedo do tooltip para feature:', {\n      type: feature.get('type'),\n      schoolData: feature.get('schoolData'),\n      terraIndigenaInfo: feature.get('terraIndigenaInfo')\n    });\n\n    // Implementar lgica para obter contedo do tooltip\n    // Esta funo deve ser sobrescrita ou configurada\n    if (this.options.tooltipContentFunction) {\n      const content = this.options.tooltipContentFunction(feature);\n      console.log('[OpenLayersInteractions] Contedo do tooltip (funo customizada):', content);\n      return content;\n    }\n\n    // Contedo padro baseado no tipo de feature\n    const schoolData = feature.get('schoolData');\n    if (schoolData) {\n      // FORAR apenas o ttulo da escola, SEM municpio ou outras informaes\n      const titulo = schoolData.titulo || 'Escola Indgena';\n      console.log('[OpenLayersInteractions] Ttulo extrado (padro):', titulo);\n      console.log('[OpenLayersInteractions] Contedo do tooltip (padro escola - FORADO apenas ttulo):', titulo);\n      return titulo; // Retorna APENAS o ttulo\n    }\n\n    const terraIndigenaInfo = feature.get('terraIndigenaInfo');\n    if (terraIndigenaInfo) {\n      const content = `Terra Indgena ${terraIndigenaInfo.titulo || 'Indgena'}`;\n      console.log('[OpenLayersInteractions] Contedo do tooltip (padro terra indgena):', content);\n      return content;\n    }\n\n    console.log('[OpenLayersInteractions] Nenhum contedo encontrado para tooltip');\n    return null;\n  }\n\n  /**\n   * Executa handler de clique\n   * @param {Object} feature - Feature clicado\n   * @param {Object} event - Evento do OpenLayers\n   */\n  executeClickHandler(feature, event) {\n    const handler = this.eventHandlers.get('click');\n    if (handler && typeof handler === 'function') {\n      handler(feature, event);\n    }\n  }\n\n  /**\n   * Executa handler de duplo clique\n   * @param {Object} feature - Feature clicado\n   * @param {Object} event - Evento do OpenLayers\n   */\n  executeDoubleClickHandler(feature, event) {\n    const handler = this.eventHandlers.get('doubleClick');\n    if (handler && typeof handler === 'function') {\n      handler(feature, event);\n    }\n  }\n\n  /**\n   * Executa handler de hover\n   * @param {Object} feature - Feature em hover\n   * @param {Object} event - Evento do OpenLayers\n   */\n  executeHoverHandler(feature, event) {\n    const handler = this.eventHandlers.get('hover');\n    if (handler && typeof handler === 'function') {\n      handler(feature, event);\n    }\n  }\n\n  /**\n   * Executa handler de hover out\n   * @param {Object} feature - Feature que saiu do hover\n   */\n  executeHoverOutHandler(feature) {\n    const handler = this.eventHandlers.get('hoverOut');\n    if (handler && typeof handler === 'function') {\n      handler(feature);\n    }\n  }\n\n  /**\n   * Registra handler para um tipo de evento\n   * @param {string} eventType - Tipo do evento\n   * @param {Function} handler - Funo handler\n   */\n  on(eventType, handler) {\n    this.eventHandlers.set(eventType, handler);\n  }\n\n  /**\n   * Remove handler para um tipo de evento\n   * @param {string} eventType - Tipo do evento\n   */\n  off(eventType) {\n    this.eventHandlers.delete(eventType);\n  }\n\n  /**\n   * Remove todos os handlers\n   */\n  clearHandlers() {\n    this.eventHandlers.clear();\n  }\n\n  /**\n   * Atualiza opes de interao\n   * @param {Object} newOptions - Novas opes\n   */\n  updateOptions(newOptions) {\n    this.options = { ...this.options, ...newOptions };\n    \n    // Reconfigurar interaes se necessrio\n    if (newOptions.enableHover !== undefined) {\n      // Implementar lgica para habilitar/desabilitar hover\n    }\n    \n    if (newOptions.enableClick !== undefined) {\n      // Implementar lgica para habilitar/desabilitar clique\n    }\n  }\n\n  /**\n   * Limpa todas as interaes e handlers\n   */\n  destroy() {\n    // Limpar timeouts\n    if (this.clickTimeout) {\n      clearTimeout(this.clickTimeout);\n    }\n    if (this.hoverTimeout) {\n      clearTimeout(this.hoverTimeout);\n    }\n\n    // Esconder tooltip\n    this.hideTooltip();\n\n    // Limpar hover\n    this.clearHover();\n\n    // Limpar handlers\n    this.clearHandlers();\n\n    // Remover event listeners do mapa\n    // Nota: OpenLayers no tem mtodo un() para remover listeners especficos\n    // Seria necessrio recriar o mapa ou implementar controle manual\n  }\n}\n\n/**\n * Funo utilitria para criar interaes padro\n * @param {Object} map - Mapa OpenLayers\n * @param {Object} options - Opes de configurao\n * @returns {OpenLayersInteractions} Instncia de interaes\n */\nexport function createDefaultInteractions(map, options = {}) {\n  const defaultOptions = {\n    enableHover: true,\n    enableClick: true,\n    enableDoubleClick: true,\n    enableTouch: true,\n    showTooltip: true,\n    hoverDelay: 200,\n    clickDelay: 300\n  };\n\n  return new OpenLayersInteractions(map, { ...defaultOptions, ...options });\n}\n\n/**\n * Funo utilitria para configurar interaes especficas para marcadores\n * @param {Object} map - Mapa OpenLayers\n * @param {Function} onMarkerClick - Handler para clique em marcador (opcional)\n * @param {Function} onMarkerHover - Handler para hover em marcador\n * @returns {OpenLayersInteractions} Instncia de interaes configurada\n */\nexport function createMarkerInteractions(map, onMarkerClick, onMarkerHover) {\n  console.log('[createMarkerInteractions] Criando interaes para marcadores...');\n  \n  const interactions = createDefaultInteractions(map, {\n    showTooltip: true,\n    tooltipContentFunction: (feature) => {\n      console.log('[createMarkerInteractions] Funo de contedo do tooltip chamada para:', feature);\n      const schoolData = feature.get('schoolData');\n      if (schoolData) {\n        // FORAR apenas o ttulo da escola, SEM municpio\n        const titulo = schoolData.titulo || 'Escola Indgena';\n        console.log('[createMarkerInteractions] Ttulo extrado:', titulo);\n        console.log('[createMarkerInteractions] Contedo do tooltip gerado (FORADO apenas ttulo):', titulo);\n        return titulo; // Retorna APENAS o ttulo\n      }\n      console.log('[createMarkerInteractions] Sem dados de escola para tooltip');\n      return null;\n    }\n  });\n\n  // Configurar handler de clique se fornecido\n  if (onMarkerClick) {\n    console.log('[createMarkerInteractions] Configurando handler de clique personalizado');\n    interactions.on('click', onMarkerClick);\n  }\n\n  if (onMarkerHover) {\n    interactions.on('hover', onMarkerHover);\n  }\n\n  console.log('[createMarkerInteractions] Interaes criadas com sucesso');\n  return interactions;\n}\n\n/**\n * Funo utilitria para configurar interaes especficas para camadas GeoJSON\n * @param {Object} map - Mapa OpenLayers\n * @param {Function} onFeatureClick - Handler para clique em feature\n * @param {Function} onFeatureHover - Handler para hover em feature\n * @returns {OpenLayersInteractions} Instncia de interaes configurada\n */\nexport function createGeoJSONInteractions(map, onFeatureClick, onFeatureHover) {\n  const interactions = createDefaultInteractions(map, {\n    showTooltip: true,\n    tooltipContentFunction: (feature) => {\n      const terraIndigenaInfo = feature.get('terraIndigenaInfo');\n      if (terraIndigenaInfo) {\n        return `Terra Indgena ${terraIndigenaInfo.titulo || 'Indgena'}`;\n      }\n      return null;\n    }\n  });\n\n  if (onFeatureClick) {\n    interactions.on('click', onFeatureClick);\n  }\n\n  if (onFeatureHover) {\n    interactions.on('hover', onFeatureHover);\n  }\n\n  return interactions;\n}\n","import Overlay from 'ol/Overlay';\n\n/**\n * Mostra um pulso visual no mapa na coordenada clicada.\n * @param {import('ol/Map').default} map - Instncia do mapa OpenLayers\n * @param {number[]} coordinate - Coordenada no projection do mapa (geralmente EPSG:3857)\n * @param {object} options - Opes (radiusPx, durationMs)\n */\nexport function showClickPulse(map, coordinate, options = {}) {\n  if (!map || !coordinate) return;\n\n  const radiusPx = options.radiusPx ?? 18;\n  const durationMs = options.durationMs ?? 900;\n\n  const element = document.createElement('div');\n  element.className = 'ol-click-pulse';\n  element.style.width = `${radiusPx * 2}px`;\n  element.style.height = `${radiusPx * 2}px`;\n  element.style.marginLeft = `${-radiusPx}px`;\n  element.style.marginTop = `${-radiusPx}px`;\n\n  const overlay = new Overlay({\n    element,\n    positioning: 'center-center',\n    stopEvent: false,\n  });\n\n  map.addOverlay(overlay);\n  overlay.setPosition(coordinate);\n\n  // Remover aps animao\n  const cleanup = () => {\n    try {\n      map.removeOverlay(overlay);\n    } catch {}\n  };\n\n  element.addEventListener('animationend', cleanup, { once: true });\n  // Fallback por segurana\n  setTimeout(cleanup, durationMs + 100);\n}\n\n/**\n * Anima suavemente a view at a coordenada (flyTo).\n * Mantm o zoom atual por padro.\n * @param {import('ol/Map').default} map\n * @param {number[]} coordinate - Coordenada no projection do mapa (EPSG:3857)\n * @param {{ durationMs?: number, zoom?: number }} options\n */\nexport function flyTo(map, coordinate, options = {}) {\n  if (!map || !coordinate) return;\n  const durationMs = options.durationMs ?? 350;\n  const view = map.getView();\n  const animateParams = { center: coordinate, duration: durationMs };\n  if (typeof options.zoom === 'number') {\n    animateParams.zoom = options.zoom;\n  }\n  view.animate(animateParams);\n}\n\n/**\n * FlyTo que centraliza o ponto na rea visvel quando h um painel lateral.\n * Por padro, considera um painel  direita com seletor '.mj-panel'.\n */\nexport function flyToConsideringPanel(map, coordinate, options = {}) {\n  if (!map || !coordinate) return;\n  const durationMs = options.durationMs ?? 350;\n  const zoom = options.zoom;\n  const side = options.panelSide ?? 'right';\n  const panelSelector = options.panelSelector ?? '.mj-panel';\n  const fractionWithinVisible = typeof options.fractionWithinVisible === 'number' ? options.fractionWithinVisible : 0.25; // 25% = metade da primeira metade\n\n  const mapSize = map.getSize();\n  if (!mapSize) return flyTo(map, coordinate, { durationMs, zoom });\n\n  const [mapWidth, mapHeight] = mapSize;\n  let panelWidth = 0;\n  const panelEl = typeof document !== 'undefined' ? document.querySelector(panelSelector) : null;\n  if (panelEl) {\n    const rect = panelEl.getBoundingClientRect();\n    // Considerar apenas se o painel estiver visvel (largura relevante)\n    if (rect.width > 0 && rect.height > 0) {\n      panelWidth = Math.min(rect.width, mapWidth * 0.95);\n    }\n  }\n\n  // Se no h painel, usa flyTo normal\n  if (panelWidth <= 0) {\n    return flyTo(map, coordinate, { durationMs, zoom });\n  }\n\n  // Posio alvo do ponto dentro da rea visvel\n  const visibleWidth = Math.max(1, mapWidth - panelWidth);\n  const desiredX = side === 'right'\n    ? visibleWidth * fractionWithinVisible\n    : panelWidth + visibleWidth * fractionWithinVisible; // painel  esquerda\n\n  const pointPx = map.getPixelFromCoordinate(coordinate);\n  if (!pointPx) {\n    return flyTo(map, coordinate, { durationMs, zoom });\n  }\n\n  // Centro atual em pixel\n  const currentCenterPx = [mapWidth / 2, mapHeight / 2];\n  // Novo centro em pixel que posiciona o ponto em desiredX\n  const newCenterPx = [\n    pointPx[0] - desiredX + (mapWidth / 2),\n    currentCenterPx[1]\n  ];\n\n  const newCenterCoord = map.getCoordinateFromPixel(newCenterPx);\n  if (!newCenterCoord) {\n    return flyTo(map, coordinate, { durationMs, zoom });\n  }\n\n  const view = map.getView();\n  const animateParams = { center: newCenterCoord, duration: durationMs };\n  if (typeof zoom === 'number') animateParams.zoom = zoom;\n  view.animate(animateParams);\n}\n\n/**\n * FlyTo posicionando o ponto em uma frao fixa da largura do mapa (0..1).\n * Ex.: fractionX=0.25 posiciona o ponto a 25% da largura (metade da primeira metade).\n */\nexport function flyToAtFractionX(map, coordinate, options = {}) {\n  if (!map || !coordinate) return;\n  const durationMs = options.durationMs ?? 350;\n  const zoom = options.zoom;\n  const fractionX = typeof options.fractionX === 'number' ? options.fractionX : 0.25;\n  const fractionY = typeof options.fractionY === 'number' ? options.fractionY : 0.5; // centralizado no eixo Y\n\n  const mapSize = map.getSize();\n  if (!mapSize) return flyTo(map, coordinate, { durationMs, zoom });\n\n  const [mapWidth, mapHeight] = mapSize;\n  const clampedFx = Math.max(0, Math.min(1, fractionX));\n  const clampedFy = Math.max(0, Math.min(1, fractionY));\n  const desiredX = clampedFx * mapWidth;\n  const desiredY = clampedFy * mapHeight;\n\n  const pointPx = map.getPixelFromCoordinate(coordinate);\n  if (!pointPx) return flyTo(map, coordinate, { durationMs, zoom });\n\n  const newCenterPx = [\n    pointPx[0] - desiredX + (mapWidth / 2),\n    pointPx[1] - desiredY + (mapHeight / 2)\n  ];\n\n  const newCenterCoord = map.getCoordinateFromPixel(newCenterPx);\n  if (!newCenterCoord) return flyTo(map, coordinate, { durationMs, zoom });\n\n  const view = map.getView();\n  const animateParams = { center: newCenterCoord, duration: durationMs };\n  if (typeof zoom === 'number') animateParams.zoom = zoom;\n  view.animate(animateParams);\n}\n\n\n","/**\n * Utilitrio de logging para o projeto OPIN\n * \n * Fornece uma API consistente para logging que pode ser desabilitada em produo.\n * Substitui console.log direto por uma soluo mais controlada.\n * \n * @module utils/logger\n */\n\nconst isDevelopment = process.env.NODE_ENV === 'development';\n\n/**\n * Nveis de log disponveis\n */\nconst LogLevel = {\n  DEBUG: 0,\n  INFO: 1,\n  WARN: 2,\n  ERROR: 3,\n};\n\n/**\n * Configurao de logging\n * Pode ser alterada para controlar quais logs so exibidos\n */\nconst LOG_LEVEL = isDevelopment ? LogLevel.DEBUG : LogLevel.ERROR;\n\n/**\n * Logger principal do sistema\n * \n * @example\n * import logger from '../utils/logger';\n * \n * logger.debug('Informao de debug');\n * logger.info('Informao geral');\n * logger.warn('Aviso');\n * logger.error('Erro crtico');\n */\nexport const logger = {\n  /**\n   * Log de debug - apenas em desenvolvimento\n   * @param {...any} args - Argumentos a serem logados\n   */\n  debug: (...args) => {\n    if (LOG_LEVEL <= LogLevel.DEBUG) {\n      console.log('[DEBUG]', ...args);\n    }\n  },\n\n  /**\n   * Log de informao - apenas em desenvolvimento\n   * @param {...any} args - Argumentos a serem logados\n   */\n  info: (...args) => {\n    if (LOG_LEVEL <= LogLevel.INFO) {\n      console.info('[INFO]', ...args);\n    }\n  },\n\n  /**\n   * Log de aviso - sempre exibido (mas pode ser filtrado)\n   * @param {...any} args - Argumentos a serem logados\n   */\n  warn: (...args) => {\n    if (LOG_LEVEL <= LogLevel.WARN) {\n      console.warn('[WARN]', ...args);\n    }\n  },\n\n  /**\n   * Log de erro - sempre exibido\n   * @param {...any} args - Argumentos a serem logados\n   */\n  error: (...args) => {\n    if (LOG_LEVEL <= LogLevel.ERROR) {\n      console.error('[ERROR]', ...args);\n    }\n  },\n\n  /**\n   * Grupo de logs - til para organizar logs relacionados\n   * @param {string} label - Label do grupo\n   */\n  group: (label) => {\n    if (LOG_LEVEL <= LogLevel.DEBUG) {\n      console.group(label);\n    }\n  },\n\n  /**\n   * Fecha um grupo de logs\n   */\n  groupEnd: () => {\n    if (LOG_LEVEL <= LogLevel.DEBUG) {\n      console.groupEnd();\n    }\n  },\n};\n\nexport default logger;\n\n\n\n\n\n","import React, { useEffect, useRef, useCallback } from 'react';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport { Feature } from 'ol';\nimport { Point } from 'ol/geom';\nimport { fromLonLat } from 'ol/proj';\nimport { \n  createMarkerStyle, \n  applyHoverStyle\n} from '../../utils/openlayers/markerStyles';\nimport { createMarkerInteractions } from '../../utils/openlayers/interactions';\nimport { flyToAtFractionX, showClickPulse } from '../../utils/openlayers/effects';\nimport logger from '../../utils/logger';\n\n/**\n * Componente OpenLayersMarkers - Substitui completamente o Marcadores.js do Leaflet\n * IMPLEMENTAO SIMPLIFICADA: Mostra todos os marcadores individuais sem clustering\n */\nconst OpenLayersMarkers = ({ \n  dataPoints = [], \n  onPainelOpen,\n  showMarcadores = true,\n  showNomesEscolas = false,\n  map,\n  className = \"h-full w-full\"\n}) => {\n  // Refs para controle das camadas e fontes\n  const vectorSourceRef = useRef(null);\n  const vectorLayerRef = useRef(null);\n  \n  // Estados para controle de interaes\n  const [, setHoveredMarker] = React.useState(null);\n  // const [selectedMarker, setSelectedMarker] = React.useState(null); // Removido - no utilizado\n\n  // Verificar se  mobile - REMOVIDO: no utilizado\n  // const isMobileDevice = useMemo(() => isMobile(), []);\n\n  /**\n   * Inicializa a camada de marcadores (SEM clustering)\n   */\n  const initializeMarkers = useCallback(() => {\n    if (!map) return;\n\n    logger.debug('[OpenLayersMarkers] Inicializando marcadores individuais...');\n\n    // Criar fonte vetorial para marcadores\n    vectorSourceRef.current = new VectorSource();\n    \n    // Criar camada vetorial para marcadores INDIVIDUAIS (sem clustering)\n    vectorLayerRef.current = new VectorLayer({\n      source: vectorSourceRef.current,\n      style: (feature) => createMarkerStyle(feature, showNomesEscolas),\n      zIndex: 100\n    });\n\n    // Adicionar camada ao mapa\n    map.addLayer(vectorLayerRef.current);\n\n    // Configurar interaes\n    setupInteractions();\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [map, showNomesEscolas]);\n\n  /**\n   * Configura as interaes dos marcadores\n   */\n  const setupInteractions = useCallback(() => {\n    if (!map || !vectorLayerRef.current) return;\n\n    logger.debug('[OpenLayersMarkers] Configurando interaes com tooltips...');\n\n    // Criar interaes especficas para marcadores com tooltips\n    const interactions = createMarkerInteractions(\n      map,\n      handleMarkerClick,\n      handleMarkerHover\n    );\n\n    // Configurar handlers especficos\n    interactions.on('click', handleMarkerClick);\n    interactions.on('hover', handleMarkerHover);\n    interactions.on('hoverOut', handleMarkerHoverOut);\n\n    logger.debug('[OpenLayersMarkers] Interaes configuradas e integradas com o mapa');\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [map]);\n\n  /**\n   * Handler para clique em marcador\n   */\n  const handleMarkerClick = useCallback((feature, event) => {\n    // Usar schoolData em vez de markerData para consistncia com o sistema de interaes\n    const schoolData = feature.get('schoolData');\n    if (schoolData && onPainelOpen) {\n      const coord = feature.getGeometry()?.getCoordinates();\n      if (map && coord) {\n        // Posicionar o ponto a 25% da largura do mapa (metade da primeira metade)\n        flyToAtFractionX(map, coord, { durationMs: 550, fractionX: 0.25 });\n        showClickPulse(map, coord);\n      }\n      logger.debug('[OpenLayersMarkers] Marcador clicado:', schoolData.titulo);\n      onPainelOpen(schoolData);\n    }\n  }, [onPainelOpen, map]);\n\n  /**\n   * Handler para hover em marcador\n   */\n  const handleMarkerHover = useCallback((feature, event) => {\n    // IMPORTANTE: No desabilitar hover em mobile\n    // O sistema de interaes precisa do hover para funcionar corretamente\n    // O hover  usado para mostrar tooltips e aplicar estilos visuais\n    \n    setHoveredMarker(feature);\n    \n    // Aplicar estilo de hover\n    if (vectorLayerRef.current) {\n      vectorLayerRef.current.setStyle((f) => {\n        if (f === feature) {\n          return applyHoverStyle(f, createMarkerStyle(f, showNomesEscolas));\n        }\n        return createMarkerStyle(f, showNomesEscolas);\n      });\n      vectorLayerRef.current.changed();\n    }\n  }, [showNomesEscolas]);\n\n  /**\n   * Handler para sada do hover\n   */\n  const handleMarkerHoverOut = useCallback(() => {\n    setHoveredMarker(null);\n    \n    // Remover estilo de hover\n    if (vectorLayerRef.current) {\n      vectorLayerRef.current.setStyle((f) => createMarkerStyle(f, showNomesEscolas));\n      vectorLayerRef.current.changed();\n    }\n  }, [showNomesEscolas]);\n\n  /**\n   * Atualiza marcadores quando dataPoints mudar\n   */\n  const updateMarkers = useCallback(() => {\n    if (!vectorSourceRef.current || !dataPoints) return;\n\n    logger.debug('[OpenLayersMarkers] Atualizando marcadores...', dataPoints.length, 'showMarcadores:', showMarcadores);\n\n    // Limpar marcadores existentes\n    vectorSourceRef.current.clear();\n    \n    // Se showMarcadores for false, no adicionar marcadores\n    if (!showMarcadores) {\n      logger.debug('[OpenLayersMarkers] Marcadores desabilitados, removendo todos');\n      return;\n    }\n    \n    // Filtrar pontos vlidos\n    const pontosValidos = dataPoints.filter(point => {\n      if (!point.latitude || !point.longitude) return false;\n      const lat = parseFloat(point.latitude);\n      const lng = parseFloat(point.longitude);\n      return !isNaN(lat) && !isNaN(lng) && \n             lat >= -90 && lat <= 90 && \n             lng >= -180 && lng <= 180;\n    });\n\n    logger.debug('[OpenLayersMarkers] Pontos vlidos:', pontosValidos.length);\n\n    // Adicionar novos marcadores INDIVIDUAIS\n    pontosValidos.forEach((point, index) => {\n      if (point.latitude && point.longitude) {\n        const feature = new Feature({\n          geometry: new Point(fromLonLat([point.longitude, point.latitude]))\n        });\n        \n        feature.set('markerData', point);\n        feature.set('schoolData', point); // Dados para tooltips\n        feature.set('markerId', `marker_${index}`);\n        feature.set('type', 'marker');\n        \n        vectorSourceRef.current.addFeature(feature);\n      }\n    });\n\n    logger.debug(`[OpenLayersMarkers] ${pontosValidos.length} marcadores individuais adicionados`);\n\n  }, [dataPoints, showMarcadores]);\n\n  /**\n   * Atualiza estilo dos marcadores quando showNomesEscolas mudar\n   */\n  const updateMarkerStyles = useCallback(() => {\n    if (!vectorLayerRef.current) return;\n\n    vectorLayerRef.current.setStyle((feature) => createMarkerStyle(feature, showNomesEscolas));\n    vectorLayerRef.current.changed();\n  }, [showNomesEscolas]);\n\n  // Inicializar marcadores quando componente montar\n  useEffect(() => {\n    if (map) {\n      initializeMarkers();\n    }\n\n    return () => {\n      // Cleanup\n      if (vectorLayerRef.current && map) {\n        map.removeLayer(vectorLayerRef.current);\n      }\n    };\n  }, [map, initializeMarkers]);\n\n  // Atualizar marcadores quando dataPoints mudar\n  useEffect(() => {\n    updateMarkers();\n  }, [updateMarkers]);\n\n  // Atualizar estilos quando showNomesEscolas mudar\n  useEffect(() => {\n    updateMarkerStyles();\n  }, [updateMarkerStyles]);\n\n  // Sempre renderizar o componente para manter a camada ativa\n  return (\n    <div className={className}>\n      {/* Este componente no renderiza elementos visuais diretamente,\n          apenas gerencia as camadas do OpenLayers */}\n    </div>\n  );\n};\n\nexport default OpenLayersMarkers;\n","import { Style, Fill, Stroke, Text } from 'ol/style';\n\n// Configuraes de cores para camadas GeoJSON\nexport const LAYER_COLORS = {\n  terrasIndigenas: {\n    regularizada: {\n      fill: 'rgba(220, 20, 60, 0.3)',\n      stroke: '#B22222',\n      hover: {\n        fill: 'rgba(220, 20, 60, 0.45)',\n        stroke: '#FF0000'\n      }\n    },\n    declarada: {\n      fill: 'rgba(139, 0, 0, 0.25)',\n      stroke: '#B22222',\n      hover: {\n        fill: 'rgba(139, 0, 0, 0.4)',\n        stroke: '#FF0000'\n      }\n    }\n  },\n  estadoSP: {\n    fill: 'rgba(0, 0, 0, 0.3)',\n    stroke: '#000000',\n    hover: {\n      fill: 'rgba(0, 0, 0, 0.4)',\n      stroke: '#333333'\n    }\n  }\n};\n\n/**\n * Cria estilo para terras indgenas baseado no status\n * @param {Object} feature - Feature do GeoJSON\n * @param {boolean} isHovered - Se est em estado hover\n * @returns {Style} Estilo da terra indgena\n */\nexport const createTerrasIndigenasStyle = (feature, isHovered = false) => {\n  if (!feature || !feature.properties) {\n    return new Style({\n      fill: new Fill({\n        color: LAYER_COLORS.terrasIndigenas.regularizada.fill\n      }),\n      stroke: new Stroke({\n        color: LAYER_COLORS.terrasIndigenas.regularizada.stroke,\n        width: 2\n      })\n    });\n  }\n\n  const isRegularizada = feature.properties.fase_ti === 'Regularizada';\n  const colorConfig = isRegularizada \n    ? LAYER_COLORS.terrasIndigenas.regularizada \n    : LAYER_COLORS.terrasIndigenas.declarada;\n\n  const colors = isHovered ? colorConfig.hover : colorConfig;\n\n  return new Style({\n    fill: new Fill({\n      color: colors.fill\n    }),\n    stroke: new Stroke({\n      color: colors.stroke,\n      width: isHovered ? 3 : 2,\n      lineDash: isHovered ? [] : [3, 3]\n    })\n  });\n};\n\n/**\n * Cria estilo para estado de So Paulo\n * @param {Object} feature - Feature do GeoJSON\n * @param {boolean} isHovered - Se est em estado hover\n * @returns {Style} Estilo do estado\n */\nexport const createEstadoSPStyle = (feature, isHovered = false) => {\n  const colors = isHovered ? LAYER_COLORS.estadoSP.hover : LAYER_COLORS.estadoSP;\n\n  return new Style({\n    fill: new Fill({\n      color: colors.fill\n    }),\n    stroke: new Stroke({\n      color: colors.stroke,\n      width: isHovered ? 2 : 1\n    })\n  });\n};\n\n/**\n * Cria estilo para feature com label\n * @param {Object} feature - Feature do GeoJSON\n * @param {string} labelProperty - Propriedade para usar como label\n * @param {Object} styleOptions - Opes de estilo\n * @returns {Style} Estilo com label\n */\nexport const createLabeledFeatureStyle = (feature, labelProperty, styleOptions = {}) => {\n  const {\n    fillColor = 'rgba(0, 0, 0, 0.1)',\n    strokeColor = '#000000',\n    strokeWidth = 1,\n    labelColor = '#000000',\n    labelSize = '12px',\n    labelFont = 'Arial'\n  } = styleOptions;\n\n  const labelText = feature.properties?.[labelProperty] || '';\n\n  const styles = [\n    new Style({\n      fill: new Fill({\n        color: fillColor\n      }),\n      stroke: new Stroke({\n        color: strokeColor,\n        width: strokeWidth\n      })\n    })\n  ];\n\n  // Adicionar label se houver texto\n  if (labelText) {\n    styles.push(new Style({\n      text: new Text({\n        text: labelText,\n        font: `${labelSize} ${labelFont}`,\n        fill: new Fill({\n          color: labelColor\n        }),\n        stroke: new Stroke({\n          color: '#FFFFFF',\n          width: 2\n        }),\n        offsetY: 0,\n        textAlign: 'center'\n      })\n    }));\n  }\n\n  return styles;\n};\n\n/**\n * Cria estilo para feature com tooltip\n * @param {Object} feature - Feature do GeoJSON\n * @param {string} tooltipText - Texto do tooltip\n * @param {Object} styleOptions - Opes de estilo\n * @returns {Style} Estilo com tooltip\n */\nexport const createFeatureWithTooltipStyle = (feature, tooltipText, styleOptions = {}) => {\n  const {\n    fillColor = 'rgba(0, 0, 0, 0.1)',\n    strokeColor = '#000000',\n    strokeWidth = 1,\n    tooltipColor = '#1F2937',\n    tooltipBackground = 'rgba(255, 255, 255, 0.95)',\n    tooltipBorder = '#E5E7EB'\n  } = styleOptions;\n\n  const styles = [\n    new Style({\n      fill: new Fill({\n        color: fillColor\n      }),\n      stroke: new Stroke({\n        color: strokeColor,\n        width: strokeWidth\n      })\n    })\n  ];\n\n  // Adicionar tooltip como texto\n  if (tooltipText) {\n    styles.push(new Style({\n      text: new Text({\n        text: tooltipText,\n        font: '11px Arial',\n        fill: new Fill({\n          color: tooltipColor\n        }),\n        stroke: new Stroke({\n          color: '#FFFFFF',\n          width: 2\n        }),\n        offsetY: -15,\n        textAlign: 'center',\n        backgroundFill: new Fill({\n          color: tooltipBackground\n        }),\n        backgroundStroke: new Stroke({\n          color: tooltipBorder,\n          width: 1\n        }),\n        padding: [4, 8]\n      })\n    }));\n  }\n\n  return styles;\n};\n\n/**\n * Cria estilo para feature selecionada\n * @param {Object} feature - Feature do GeoJSON\n * @param {Style} baseStyle - Estilo base\n * @param {Object} selectionOptions - Opes de seleo\n * @returns {Style} Estilo com efeito de seleo\n */\nexport const applySelectionStyle = (feature, baseStyle, selectionOptions = {}) => {\n  const {\n    fillColor = 'rgba(59, 130, 246, 0.3)',\n    strokeColor = '#1E40AF',\n    strokeWidth = 3,\n    lineDash = [5, 5]\n  } = selectionOptions;\n\n  const selectionStyle = new Style({\n    fill: new Fill({\n      color: fillColor\n    }),\n    stroke: new Stroke({\n      color: strokeColor,\n      width: strokeWidth,\n      lineDash: lineDash\n    })\n  });\n\n  return Array.isArray(baseStyle) ? [...baseStyle, selectionStyle] : [baseStyle, selectionStyle];\n};\n\n/**\n * Cria estilo para feature com indicador de status\n * @param {Object} feature - Feature do GeoJSON\n * @param {string} statusProperty - Propriedade que indica o status\n * @param {Object} statusConfig - Configurao dos status\n * @returns {Style} Estilo com indicador de status\n */\nexport const createStatusFeatureStyle = (feature, statusProperty, statusConfig) => {\n  if (!feature || !feature.properties) {\n    return new Style({\n      fill: new Fill({\n        color: 'rgba(0, 0, 0, 0.1)'\n      }),\n      stroke: new Stroke({\n        color: '#000000',\n        width: 1\n      })\n    });\n  }\n\n  const status = feature.properties[statusProperty];\n  const config = statusConfig[status] || statusConfig.default || {\n    fill: 'rgba(0, 0, 0, 0.1)',\n    stroke: '#000000'\n  };\n\n  return new Style({\n    fill: new Fill({\n      color: config.fill\n    }),\n    stroke: new Stroke({\n      color: config.stroke,\n      width: config.strokeWidth || 1\n    })\n  });\n};\n\n/**\n * Cria estilo para feature com gradiente baseado em valor numrico\n * @param {Object} feature - Feature do GeoJSON\n * @param {string} valueProperty - Propriedade com valor numrico\n * @param {Object} gradientConfig - Configurao do gradiente\n * @returns {Style} Estilo com gradiente\n */\nexport const createGradientFeatureStyle = (feature, valueProperty, gradientConfig) => {\n  if (!feature || !feature.properties) {\n    return new Style({\n      fill: new Fill({\n        color: gradientConfig.defaultColor || 'rgba(0, 0, 0, 0.1)'\n      }),\n      stroke: new Stroke({\n        color: gradientConfig.strokeColor || '#000000',\n        width: gradientConfig.strokeWidth || 1\n      })\n    });\n  }\n\n  const value = parseFloat(feature.properties[valueProperty]) || 0;\n  const { min, max, colors } = gradientConfig;\n\n  // Calcular cor baseada no valor\n  let color;\n  if (value <= min) {\n    color = colors.min;\n  } else if (value >= max) {\n    color = colors.max;\n  } else {\n    // Interpolao linear entre cores\n    const ratio = (value - min) / (max - min);\n    color = interpolateColor(colors.min, colors.max, ratio);\n  }\n\n  return new Style({\n    fill: new Fill({\n      color: color\n    }),\n    stroke: new Stroke({\n      color: gradientConfig.strokeColor || '#000000',\n      width: gradientConfig.strokeWidth || 1\n    })\n  });\n};\n\n/**\n * Interpola entre duas cores\n * @param {string} color1 - Primeira cor (hex)\n * @param {string} color2 - Segunda cor (hex)\n * @param {number} ratio - Razo de interpolao (0-1)\n * @returns {string} Cor interpolada\n */\nfunction interpolateColor(color1, color2, ratio) {\n  const hex1 = color1.replace('#', '');\n  const hex2 = color2.replace('#', '');\n  \n  const r1 = parseInt(hex1.substr(0, 2), 16);\n  const g1 = parseInt(hex1.substr(2, 2), 16);\n  const b1 = parseInt(hex1.substr(4, 2), 16);\n  \n  const r2 = parseInt(hex2.substr(0, 2), 16);\n  const g2 = parseInt(hex2.substr(2, 2), 16);\n  const b2 = parseInt(hex2.substr(4, 2), 16);\n  \n  const r = Math.round(r1 + (r2 - r1) * ratio);\n  const g = Math.round(g1 + (g2 - g1) * ratio);\n  const b = Math.round(b1 + (b2 - b1) * ratio);\n  \n  return `rgb(${r}, ${g}, ${b})`;\n}\n","// Configuraes centralizadas do mapa OpenLayers\n\nexport const MAP_CONFIG = {\n  // Configuraes iniciais\n  center: [-48.4129, -22.3794], // longitude, latitude\n  zoom: 7.63,\n  maxZoom: 18,\n  minZoom: 4,\n  \n  // Configuraes especficas para mobile\n  mobile: {\n    center: [-48.5935, -21.9212], // longitude, latitude - Coordenadas especificadas\n    zoom: 5.70 // Zoom ajustado para 5.70 conforme solicitado\n  },\n  \n  // Configuraes de clusterizao - Ajustadas para mostrar mais marcadores individuais\n  clusterDistance: 15, // Reduzido para mostrar mais marcadores individuais\n  clusterMinDistance: 3, // Reduzido para permitir marcadores mais prximos\n  clusterAnimationDuration: 300,\n  \n  // Configuraes de proximidade para pares prximos\n  proximityThreshold: 0.00005,\n  \n  // Configuraes de zoom para clusters\n  disableClusteringAtZoom: 12,\n  \n  // Configuraes de tooltip\n  tooltipOffset: 10,\n  tooltipDelay: 200,\n  \n  // Configuraes de interao\n  interaction: {\n    enableHover: true,\n    enableClick: true,\n    enableDoubleClick: true,\n    enableTouch: true,\n    clickDelay: 300,\n    hoverDelay: 200\n  },\n  \n  // Configuraes de performance\n  performance: {\n    enableLazyLoading: true,\n    maxFeaturesPerTile: 1000,\n    enableFeatureCulling: true,\n    enableTileCaching: true\n  },\n\n  // Configuraes de animao\n  ANIMATION_CONFIG: {\n    duration: {\n      marker: 300,\n      cluster: 500,\n      zoom: 800,\n      pan: 600\n    },\n    easing: {\n      marker: 'ease-out',\n      cluster: 'ease-in-out',\n      zoom: 'ease-out',\n      pan: 'ease-out'\n    }\n  }\n};\n\n// Configuraes de cores dos marcadores\nexport const MARKER_COLORS = {\n  individual: '#3B82F6',\n  individualBorder: '#1E40AF',\n  cluster: {\n    small: '#60A5FA',\n    medium: '#3B82F6',\n    large: '#2563EB',\n    xlarge: '#1E40AF'\n  },\n  nearbyPair: '#FF6B6B',\n  selected: '#10B981',\n  hover: '#F59E0B'\n};\n\n// Configuraes de tamanhos dos clusters\nexport const CLUSTER_SIZES = {\n  small: { min: 2, max: 10, size: 50 },\n  medium: { min: 11, max: 20, size: 52 },\n  large: { min: 21, max: 50, size: 56 },\n  xlarge: { min: 51, max: 100, size: 64 },\n  xxlarge: { min: 101, size: 72 }\n};\n\n// Configuraes de fontes para clusters\nexport const CLUSTER_FONTS = {\n  small: 'bold 14px Arial',\n  medium: 'bold 15px Arial',\n  large: 'bold 16px Arial',\n  xlarge: 'bold 18px Arial'\n};\n\n// Configuraes das camadas GeoJSON\nexport const GEOJSON_CONFIG = {\n  terrasIndigenas: {\n    regularizada: {\n      fill: 'rgba(220, 20, 60, 0.3)',\n      stroke: '#B22222',\n      hover: {\n        fill: 'rgba(220, 20, 60, 0.45)',\n        stroke: '#FF0000'\n      }\n    },\n    declarada: {\n      fill: 'rgba(139, 0, 0, 0.25)',\n      stroke: '#B22222',\n      hover: {\n        fill: 'rgba(139, 0, 0, 0.4)',\n        stroke: '#FF0000'\n      }\n    }\n  },\n  estadoSP: {\n    fill: 'rgba(0, 0, 0, 0.3)',\n    stroke: '#000000',\n    hover: {\n      fill: 'rgba(0, 0, 0, 0.4)',\n      stroke: '#333333'\n    }\n  }\n};\n\n// Configuraes de projeo\nexport const PROJECTION_CONFIG = {\n  dataProjection: 'EPSG:4326',\n  featureProjection: 'EPSG:3857',\n  // Projeo SIRGAS 2000 (EPSG:4674) usada nos dados GeoJSON\n  sirgas2000: 'EPSG:4674'\n};\n\n// Configuraes de camadas base\nexport const BASE_LAYER_CONFIG = {\n  satellite: {\n    url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n    attributions: ' <a href=\"https://www.esri.com/\">Esri</a>',\n    maxZoom: 19,\n    wrapX: false,\n    tilePixelRatio: 1,\n    tileSize: 256\n  },\n  osm: {\n    url: 'https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n    attributions: ' <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n    maxZoom: 19\n  },\n  terrain: {\n    url: 'https://{a-d}.tile.opentopomap.org/{z}/{x}/{y}.png',\n    attributions: ' <a href=\"https://opentopomap.org/\">OpenTopoMap</a> contributors',\n    maxZoom: 17\n  }\n};\n\n// Configuraes de estilos para diferentes tipos de marcadores\nexport const MARKER_STYLE_CONFIG = {\n  escola: {\n    default: {\n      radius: 6,\n      fillColor: MARKER_COLORS.individual,\n      strokeColor: MARKER_COLORS.individualBorder,\n      strokeWidth: 2\n    },\n    hover: {\n      radius: 8,\n      fillColor: MARKER_COLORS.hover,\n      strokeColor: '#D97706',\n      strokeWidth: 3\n    },\n    selected: {\n      radius: 10,\n      fillColor: MARKER_COLORS.selected,\n      strokeColor: '#059669',\n      strokeWidth: 3,\n      lineDash: [5, 5]\n    },\n    nearbyPair: {\n      radius: 8,\n      fillColor: MARKER_COLORS.nearbyPair,\n      strokeColor: '#DC2626',\n      strokeWidth: 2\n    }\n  },\n  cluster: {\n    small: {\n      radius: CLUSTER_SIZES.small.size / 2,\n      fillColor: MARKER_COLORS.cluster.small,\n      strokeColor: '#FFFFFF',\n      strokeWidth: 3\n    },\n    medium: {\n      radius: CLUSTER_SIZES.medium.size / 2,\n      fillColor: MARKER_COLORS.cluster.medium,\n      strokeColor: '#FFFFFF',\n      strokeWidth: 3\n    },\n    large: {\n      radius: CLUSTER_SIZES.large.size / 2,\n      fillColor: MARKER_COLORS.cluster.large,\n      strokeColor: '#FFFFFF',\n      strokeWidth: 3\n    },\n    xlarge: {\n      radius: CLUSTER_SIZES.xlarge.size / 2,\n      fillColor: MARKER_COLORS.cluster.xlarge,\n      strokeColor: '#FFFFFF',\n      strokeWidth: 3\n    }\n  }\n};\n\n// Configuraes de animaes\nexport const ANIMATION_CONFIG = {\n  duration: {\n    marker: 300,\n    cluster: 500,\n    zoom: 800,\n    pan: 600\n  },\n  easing: {\n    marker: 'ease-out',\n    cluster: 'ease-in-out',\n    zoom: 'ease-out',\n    pan: 'ease-out'\n  }\n};\n\n// Configuraes de responsividade\nexport const RESPONSIVE_CONFIG = {\n  breakpoints: {\n    mobile: 768,\n    tablet: 1024,\n    desktop: 1200\n  },\n  mobile: {\n    clusterDistance: 12, // Reduzido para mobile\n    tooltipOffset: 8,\n    markerRadius: 5\n  },\n  tablet: {\n    clusterDistance: 15, // Reduzido para tablet\n    tooltipOffset: 10,\n    markerRadius: 6\n  },\n  desktop: {\n    clusterDistance: 15, // Reduzido para desktop\n    tooltipOffset: 10,\n    markerRadius: 6\n  }\n};\n\n// Configuraes de cache\nexport const CACHE_CONFIG = {\n  markers: {\n    maxSize: 1000,\n    ttl: 300000, // 5 minutos\n    enableCompression: true\n  },\n  tiles: {\n    maxSize: 100,\n    ttl: 600000, // 10 minutos\n    enableCompression: true\n  },\n  geojson: {\n    maxSize: 50,\n    ttl: 1800000, // 30 minutos\n    enableCompression: true\n  }\n};\n\n// Configuraes de debug\nexport const DEBUG_CONFIG = {\n  enableLogging: process.env.NODE_ENV === 'development',\n  enablePerformanceMonitoring: process.env.NODE_ENV === 'development',\n  enableFeatureCount: process.env.NODE_ENV === 'development',\n  logLevel: process.env.NODE_ENV === 'development' ? 'debug' : 'error'\n}; ","import React, { useEffect, useRef, useCallback, useMemo, forwardRef } from 'react';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport { GeoJSON } from 'ol/format';\nimport { \n  createTerrasIndigenasStyle,\n  applySelectionStyle \n} from '../../utils/openlayers/layerStyles';\nimport { createGeoJSONInteractions } from '../../utils/openlayers/interactions';\nimport { MAP_CONFIG, PROJECTION_CONFIG } from '../../utils/mapConfig';\nimport { isMobile } from '../../utils/mobileUtils';\n\n/**\n * Componente OpenLayersTerrasIndigenas - Substitui completamente o TerrasIndigenas.js do Leaflet\n * Implementa camada GeoJSON de terras indgenas com estilos dinmicos e interaes\n */\nconst OpenLayersTerrasIndigenas = forwardRef(({ \n  data,\n  onPainelOpen,\n  showTerrasIndigenas = true,\n  map,\n  className = \"h-full w-full\"\n}, ref) => {\n  // Refs para controle da camada\n  const vectorSourceRef = useRef(null);\n  const vectorLayerRef = useRef(null);\n  const interactionsRef = useRef(null);\n  \n  // Estados para controle de interaes\n  const [, setHoveredFeature] = React.useState(null);\n  const [selectedFeature, setSelectedFeature] = React.useState(null);\n  // const [features, setFeatures] = React.useState([]); // Removido - no utilizado\n\n  // Verificar se  mobile\n  const isMobileDevice = useMemo(() => isMobile(), []);\n\n  /**\n   * Inicializa a camada de terras indgenas\n   */\n  const initializeLayer = useCallback(() => {\n    if (!map || !data) return;\n\n    // Verificar se os dados tm a estrutura correta\n    if (!data.features || !Array.isArray(data.features) || data.features.length === 0) {\n      console.warn('[OpenLayersTerrasIndigenas] Dados invlidos ou vazios:', data);\n      return;\n    }\n\n    try {\n      // Criar formato GeoJSON com projees corretas\n      const geoJSONFormat = new GeoJSON({\n        dataProjection: PROJECTION_CONFIG.sirgas2000 || PROJECTION_CONFIG.dataProjection,\n        featureProjection: PROJECTION_CONFIG.featureProjection\n      });\n\n      // Ler features do GeoJSON\n      const geoJSONFeatures = geoJSONFormat.readFeatures(data);\n      // setFeatures(geoJSONFeatures); // Removido - no utilizado\n\n      // Criar fonte vetorial\n      vectorSourceRef.current = new VectorSource({\n        features: geoJSONFeatures\n      });\n\n      // Criar camada vetorial\n      vectorLayerRef.current = new VectorLayer({\n        source: vectorSourceRef.current,\n        style: (feature) => createTerrasIndigenasStyle(feature, false),\n        zIndex: 10\n      });\n\n      // Adicionar dados de terra indgena a cada feature\n      geoJSONFeatures.forEach(feature => {\n        const properties = feature.getProperties();\n        feature.set('terraIndigenaInfo', {\n          titulo: properties.terrai_nom,\n          tipo: 'terra_indigena',\n          etnia: properties.etnia_nome,\n          municipio: properties.municipio_,\n          uf: properties.uf_sigla,\n          superficie: properties.superficie,\n          fase: properties.fase_ti,\n          modalidade: properties.modalidade,\n          reestudo: properties.reestudo_t,\n          cr: properties.cr,\n          faixa_fron: properties.faixa_fron,\n          undadm_nom: properties.undadm_nom,\n          undadm_sig: properties.undadm_sig,\n          dominio_un: properties.dominio_un,\n          data_atual: properties.data_atual,\n          terrai_cod: properties.terrai_cod,\n          undadm_cod: properties.undadm_cod\n        });\n      });\n\n      // Adicionar camada ao mapa\n      map.addLayer(vectorLayerRef.current);\n\n      // Configurar interaes\n      setupInteractions();\n\n      console.log(`[OpenLayersTerrasIndigenas] Camada criada com ${geoJSONFeatures.length} features`);\n\n    } catch (error) {\n      console.error('[OpenLayersTerrasIndigenas] Erro ao criar camada:', error);\n    }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [map, data]);\n\n  /**\n   * Configura as interaes da camada\n   */\n  const setupInteractions = useCallback(() => {\n    if (!map || !vectorLayerRef.current) return;\n\n    // Criar interaes especficas para camadas GeoJSON\n    interactionsRef.current = createGeoJSONInteractions(\n      map,\n      handleFeatureClick,\n      handleFeatureHover\n    );\n\n    // Configurar handlers especficos\n    interactionsRef.current.on('click', handleFeatureClick);\n    interactionsRef.current.on('hover', handleFeatureHover);\n    interactionsRef.current.on('hoverOut', handleFeatureHoverOut);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [map]);\n\n  /**\n   * Handler para clique em feature\n   */\n  const handleFeatureClick = useCallback((feature, event) => {\n    if (!feature) return;\n\n    const terraIndigenaInfo = feature.get('terraIndigenaInfo');\n    if (!terraIndigenaInfo) return;\n\n    if (isMobileDevice) {\n      // No mobile: clique nico abre o painel diretamente\n      if (onPainelOpen) {\n        onPainelOpen(terraIndigenaInfo);\n      }\n    } else {\n      // No desktop: primeiro clique faz zoom, segundo abre painel\n      if (selectedFeature === feature) {\n        // Segundo clique: abrir painel\n        if (onPainelOpen) {\n          onPainelOpen(terraIndigenaInfo);\n        }\n        setSelectedFeature(null);\n      } else {\n        // Primeiro clique: fazer zoom\n        setSelectedFeature(feature);\n        \n        const geometry = feature.getGeometry();\n        if (geometry) {\n          const extent = geometry.getExtent();\n          map.getView().fit(extent, {\n            duration: MAP_CONFIG.ANIMATION_CONFIG.duration.zoom,\n            padding: [50, 50, 50, 50],\n            maxZoom: 15\n          });\n        }\n      }\n    }\n  }, [isMobileDevice, onPainelOpen, selectedFeature, map]);\n\n  /**\n   * Handler para hover em feature\n   */\n  const handleFeatureHover = useCallback((feature, event) => {\n    if (isMobileDevice) return; // Desabilitar hover em mobile\n    \n    setHoveredFeature(feature);\n    \n    // Aplicar estilo de hover\n    if (vectorLayerRef.current) {\n      vectorLayerRef.current.setStyle((f) => {\n        if (f === feature) {\n          return createTerrasIndigenasStyle(f, true); // true = hover\n        }\n        return createTerrasIndigenasStyle(f, false);\n      });\n      vectorLayerRef.current.changed();\n    }\n  }, [isMobileDevice]);\n\n  /**\n   * Handler para sada do hover\n   */\n  const handleFeatureHoverOut = useCallback((feature) => {\n    setHoveredFeature(null);\n    \n    // Remover estilo de hover\n    if (vectorLayerRef.current) {\n      vectorLayerRef.current.setStyle((f) => createTerrasIndigenasStyle(f, false));\n      vectorLayerRef.current.changed();\n    }\n  }, []);\n\n  /**\n   * Aplica estilo de seleo a um feature\n   */\n  const applySelectionStyleToFeature = useCallback((feature) => {\n    if (!vectorLayerRef.current) return;\n\n    vectorLayerRef.current.setStyle((f) => {\n      if (f === feature) {\n        const baseStyle = createTerrasIndigenasStyle(f, false);\n        return applySelectionStyle(f, baseStyle);\n      }\n      return createTerrasIndigenasStyle(f, false);\n    });\n    vectorLayerRef.current.changed();\n  }, []);\n\n  /**\n   * Remove estilo de seleo de um feature\n   */\n  const removeSelectionStyleFromFeature = useCallback((feature) => {\n    if (!vectorLayerRef.current) return;\n\n    vectorLayerRef.current.setStyle((f) => createTerrasIndigenasStyle(f, false));\n    vectorLayerRef.current.changed();\n  }, []);\n\n  // Inicializar camada quando componente montar\n  useEffect(() => {\n    if (map && data && showTerrasIndigenas) {\n      initializeLayer();\n    }\n\n    return () => {\n      // Cleanup\n      if (interactionsRef.current) {\n        interactionsRef.current.destroy();\n      }\n      if (vectorLayerRef.current && map) {\n        map.removeLayer(vectorLayerRef.current);\n      }\n    };\n  }, [map, data, showTerrasIndigenas, initializeLayer]);\n\n  // Aplicar/remover estilo de seleo quando selectedFeature mudar\n  useEffect(() => {\n    if (selectedFeature) {\n      applySelectionStyleToFeature(selectedFeature);\n    } else if (vectorLayerRef.current) {\n      // Remover seleo de todos os features\n      removeSelectionStyleFromFeature();\n    }\n  }, [selectedFeature, applySelectionStyleToFeature, removeSelectionStyleFromFeature]);\n\n  // Limpar seleo aps timeout (para comportamento de clique duplo)\n  useEffect(() => {\n    if (selectedFeature) {\n      const timeout = setTimeout(() => {\n        setSelectedFeature(null);\n      }, MAP_CONFIG.interaction.clickDelay);\n\n      return () => clearTimeout(timeout);\n    }\n  }, [selectedFeature]);\n\n  // Se no deve mostrar terras indgenas, no renderizar nada\n  if (!showTerrasIndigenas || !data) {\n    return null;\n  }\n\n  return (\n    <div className={className}>\n      {/* Este componente no renderiza elementos visuais diretamente,\n          apenas gerencia a camada GeoJSON do OpenLayers */}\n    </div>\n  );\n});\n\nexport default OpenLayersTerrasIndigenas;\n","import React, { useEffect, useRef, useCallback, forwardRef } from 'react';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport { GeoJSON } from 'ol/format';\nimport { createEstadoSPStyle } from '../../utils/openlayers/layerStyles';\nimport { PROJECTION_CONFIG } from '../../utils/mapConfig';\n\n/**\n * Componente OpenLayersEstadoSP - Substitui completamente o EstadoSP.js do Leaflet\n * Implementa camada GeoJSON de fundo do estado de So Paulo (no-interativa)\n */\nconst OpenLayersEstadoSP = forwardRef(({ \n  data,\n  showEstadoSP = true,\n  map,\n  className = \"h-full w-full\"\n}, ref) => {\n  // Refs para controle da camada\n  const vectorSourceRef = useRef(null);\n  const vectorLayerRef = useRef(null);\n\n  /**\n   * Inicializa a camada do estado de So Paulo\n   */\n  const initializeLayer = useCallback(() => {\n    if (!map || !data) return;\n\n    // Verificar se os dados tm a estrutura correta\n    if (!data.features || !Array.isArray(data.features) || data.features.length === 0) {\n      console.warn('[OpenLayersEstadoSP] Dados invlidos ou vazios:', data);\n      return;\n    }\n\n    try {\n      // Criar formato GeoJSON com projees corretas\n      const geoJSONFormat = new GeoJSON({\n        dataProjection: PROJECTION_CONFIG.sirgas2000 || PROJECTION_CONFIG.dataProjection,\n        featureProjection: PROJECTION_CONFIG.featureProjection\n      });\n\n      // Ler features do GeoJSON\n      const geoJSONFeatures = geoJSONFormat.readFeatures(data);\n\n      // Criar fonte vetorial\n      vectorSourceRef.current = new VectorSource({\n        features: geoJSONFeatures\n      });\n\n      // Criar camada vetorial (no-interativa, apenas visual)\n      vectorLayerRef.current = new VectorLayer({\n        source: vectorSourceRef.current,\n        style: (feature) => createEstadoSPStyle(feature, false),\n        zIndex: 5, // Camada de fundo com zIndex baixo\n        interactive: false // Desabilitar interaes\n      });\n\n      // Adicionar camada ao mapa\n      map.addLayer(vectorLayerRef.current);\n\n      console.log(`[OpenLayersEstadoSP] Camada criada com ${geoJSONFeatures.length} features`);\n\n    } catch (error) {\n      console.error('[OpenLayersEstadoSP] Erro ao criar camada:', error);\n    }\n\n  }, [map, data]);\n\n  // Inicializar camada quando componente montar\n  useEffect(() => {\n    if (map && data && showEstadoSP) {\n      initializeLayer();\n    }\n\n    return () => {\n      // Cleanup\n      if (vectorLayerRef.current && map) {\n        map.removeLayer(vectorLayerRef.current);\n      }\n    };\n  }, [map, data, showEstadoSP, initializeLayer]);\n\n  // Se no deve mostrar estado SP, no renderizar nada\n  if (!showEstadoSP || !data) {\n    return null;\n  }\n\n  return (\n    <div className={className}>\n      {/* Este componente no renderiza elementos visuais diretamente,\n          apenas gerencia a camada GeoJSON de fundo do OpenLayers */}\n    </div>\n  );\n});\n\nexport default OpenLayersEstadoSP;","import React, { useEffect, useRef, useCallback, useMemo } from 'react';\nimport OpenLayersTerrasIndigenas from './OpenLayersTerrasIndigenas';\nimport OpenLayersEstadoSP from './OpenLayersEstadoSP';\n\n/**\n * Componente OpenLayersLayers - Gerenciador unificado de todas as camadas GeoJSON\n * Centraliza o controle das camadas de terras indgenas e estado SP\n */\nconst OpenLayersLayers = ({ \n  terrasIndigenasData,\n  estadoSPData,\n  showTerrasIndigenas = true,\n  showEstadoSP = true,\n  onPainelOpen,\n  map,\n  className = \"h-full w-full\"\n}) => {\n  // Refs para controle das camadas\n  const terrasIndigenasRef = useRef(null);\n  const estadoSPRef = useRef(null);\n  \n  // Estados para controle das camadas\n  const [layersStatus, setLayersStatus] = React.useState({\n    terrasIndigenas: {\n      visible: showTerrasIndigenas,\n      loaded: false,\n      error: null\n    },\n    estadoSP: {\n      visible: showEstadoSP,\n      loaded: false,\n      error: null\n    }\n  });\n\n  // Verificar se h dados vlidos\n  const hasValidData = useMemo(() => {\n    return {\n      terrasIndigenas: terrasIndigenasData && terrasIndigenasData.features && terrasIndigenasData.features.length > 0,\n      estadoSP: estadoSPData && estadoSPData.features && estadoSPData.features.length > 0\n    };\n  }, [terrasIndigenasData, estadoSPData]);\n\n  /**\n   * Atualiza status de uma camada\n   */\n  const updateLayerStatus = useCallback((layerName, updates) => {\n    setLayersStatus(prev => ({\n      ...prev,\n      [layerName]: {\n        ...prev[layerName],\n        ...updates\n      }\n    }));\n  }, []);\n\n  /**\n   * Handler para mudanas na visibilidade das camadas - REMOVIDO: no utilizado\n   */\n  // const handleLayerVisibilityChange = useCallback((layerName, visible) => {\n  //   updateLayerStatus(layerName, { visible });\n  // }, [updateLayerStatus]);\n\n  /**\n   * Handler para erros nas camadas\n   */\n  const handleLayerError = useCallback((layerName, error) => {\n    console.error(`[OpenLayersLayers] Erro na camada ${layerName}:`, error);\n    updateLayerStatus(layerName, { error: error.message });\n  }, [updateLayerStatus]);\n\n  /**\n   * Handler para sucesso no carregamento das camadas\n   */\n  const handleLayerSuccess = useCallback((layerName) => {\n    updateLayerStatus(layerName, { loaded: true, error: null });\n  }, [updateLayerStatus]);\n\n  /**\n   * Obtm estatsticas das camadas\n   */\n  const getLayersStats = useCallback(() => {\n    const stats = {\n      total: 0,\n      visible: 0,\n      loaded: 0,\n      errors: 0\n    };\n\n    Object.values(layersStatus).forEach(layer => {\n      stats.total++;\n      if (layer.visible) stats.visible++;\n      if (layer.loaded) stats.loaded++;\n      if (layer.error) stats.errors++;\n    });\n\n    return stats;\n  }, [layersStatus]);\n\n  /**\n   * Obtm informaes detalhadas das camadas\n   */\n  const getLayersInfo = useCallback(() => {\n    return {\n      terrasIndigenas: {\n        ...layersStatus.terrasIndigenas,\n        hasData: hasValidData.terrasIndigenas,\n        featureCount: hasValidData.terrasIndigenas ? terrasIndigenasData.features.length : 0\n      },\n      estadoSP: {\n        ...layersStatus.estadoSP,\n        hasData: hasValidData.estadoSP,\n        featureCount: hasValidData.estadoSP ? estadoSPData.features.length : 0\n      }\n    };\n  }, [layersStatus, hasValidData, terrasIndigenasData, estadoSPData]);\n\n  // Log de status das camadas\n  useEffect(() => {\n    const stats = getLayersStats();\n    const info = getLayersInfo();\n    \n    console.log('[OpenLayersLayers] Status das camadas:', {\n      stats,\n      info,\n      hasValidData\n    });\n  }, [layersStatus, getLayersStats, getLayersInfo, hasValidData]);\n\n  // Atualizar status quando props mudarem\n  useEffect(() => {\n    setLayersStatus(prev => ({\n      terrasIndigenas: {\n        ...prev.terrasIndigenas,\n        visible: showTerrasIndigenas\n      },\n      estadoSP: {\n        ...prev.estadoSP,\n        visible: showEstadoSP\n      }\n    }));\n  }, [showTerrasIndigenas, showEstadoSP]);\n\n  // Se no h dados vlidos, no renderizar nada\n  if (!hasValidData.terrasIndigenas && !hasValidData.estadoSP) {\n    return (\n      <div className={className}>\n        <div className=\"text-center text-gray-500 p-4\">\n          Nenhuma camada GeoJSON disponvel\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={className}>\n      {/* Camada Terras Indgenas */}\n      {hasValidData.terrasIndigenas && (\n        <OpenLayersTerrasIndigenas\n          ref={terrasIndigenasRef}\n          data={terrasIndigenasData}\n          onPainelOpen={onPainelOpen}\n          showTerrasIndigenas={showTerrasIndigenas}\n          map={map}\n          onLoad={() => handleLayerSuccess('terrasIndigenas')}\n          onError={(error) => handleLayerError('terrasIndigenas', error)}\n        />\n      )}\n\n      {/* Camada Estado SP */}\n      {hasValidData.estadoSP && (\n        <OpenLayersEstadoSP\n          ref={estadoSPRef}\n          data={estadoSPData}\n          showEstadoSP={showEstadoSP}\n          map={map}\n          onLoad={() => handleLayerSuccess('estadoSP')}\n          onError={(error) => handleLayerError('estadoSP', error)}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default OpenLayersLayers;\n","import { useState, useEffect } from 'react';\n\n/**\n * Hook para gerenciar controles de mapa responsivos\n * \n * @returns {Object} Configuraes de controles baseadas no tamanho da tela\n */\nexport const useMapControls = () => {\n  const [screenSize, setScreenSize] = useState({\n    width: typeof window !== 'undefined' ? window.innerWidth : 1024,\n    height: typeof window !== 'undefined' ? window.innerHeight : 768,\n  });\n\n  const [isMobile, setIsMobile] = useState(false);\n  const [isTablet, setIsTablet] = useState(false);\n  const [isDesktop, setIsDesktop] = useState(false);\n\n  useEffect(() => {\n    const handleResize = () => {\n      const width = window.innerWidth;\n      const height = window.innerHeight;\n      \n      setScreenSize({ width, height });\n      \n      // Definir breakpoints\n      setIsMobile(width <= 767);\n      setIsTablet(width >= 768 && width <= 1023);\n      setIsDesktop(width >= 1024);\n    };\n\n    // Configurar listener\n    window.addEventListener('resize', handleResize);\n    \n    // Configurar estado inicial\n    handleResize();\n\n    // Cleanup\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  /**\n   * Configuraes de zoom baseadas no dispositivo\n   */\n  const getZoomConfig = () => {\n    if (isMobile) {\n      return {\n        bottom: 120, // Aumentado para evitar sobreposio com menu de camadas\n        buttonSize: 44,\n        spacing: 8,\n        left: 0.25,\n      };\n    }\n    \n    if (isTablet) {\n      return {\n        bottom: 40,\n        buttonSize: 40,\n        spacing: 6,\n        left: 0.5,\n      };\n    }\n    \n    // Desktop\n    return {\n      bottom: 60,\n      buttonSize: 36,\n      spacing: 6,\n      left: 0.5,\n    };\n  };\n\n  /**\n   * Configuraes de acessibilidade\n   */\n  const getAccessibilityConfig = () => {\n    return {\n      prefersReducedMotion: window.matchMedia('(prefers-reduced-motion: reduce)').matches,\n      prefersHighContrast: window.matchMedia('(prefers-contrast: high)').matches,\n      isLandscape: screenSize.width > screenSize.height,\n    };\n  };\n\n  return {\n    screenSize,\n    isMobile,\n    isTablet,\n    isDesktop,\n    zoomConfig: getZoomConfig(),\n    accessibility: getAccessibilityConfig(),\n  };\n};\n\nexport default useMapControls;","import React, { useEffect, useRef } from 'react';\nimport { useMapControls } from '../../hooks/useMapControls';\n\n/**\n * Componente wrapper para controles de zoom responsivos\n * \n * Este componente aplica estilos dinmicos baseados no tamanho da tela\n * e preferncias de acessibilidade do usurio.\n */\nconst ResponsiveZoomControls = ({ mapRef }) => {\n  const { zoomConfig, accessibility, isMobile, isTablet } = useMapControls();\n  const controlsRef = useRef(null);\n\n  useEffect(() => {\n    if (!controlsRef.current || !mapRef?.current) return;\n\n    const map = mapRef.current;\n    const controls = map.getControls().getArray();\n    \n    // Encontrar controles de zoom\n    const zoomControl = controls.find(control => \n      control.getClassName && control.getClassName().includes('ol-zoom')\n    );\n\n    if (zoomControl) {\n      const element = zoomControl.element;\n      \n      // Aplicar estilos dinmicos\n      element.style.bottom = `${zoomConfig.bottom}px`;\n      element.style.left = `${zoomConfig.left}em`;\n      \n      // Configurar botes\n      const buttons = element.querySelectorAll('.ol-zoom-in, .ol-zoom-out');\n      buttons.forEach(button => {\n        button.style.minHeight = `${zoomConfig.buttonSize}px`;\n        button.style.minWidth = `${zoomConfig.buttonSize}px`;\n        button.style.marginBottom = `${zoomConfig.spacing}px`;\n        \n        // Aplicar configuraes de acessibilidade\n        if (accessibility.prefersReducedMotion) {\n          button.style.transition = 'none';\n        }\n        \n        if (accessibility.prefersHighContrast) {\n          button.style.backgroundColor = 'white';\n          button.style.border = '2px solid black';\n          button.style.color = 'black';\n        }\n      });\n    }\n  }, [zoomConfig, accessibility, mapRef]);\n\n  // Em mobile, adicionar classe CSS especfica para otimizaes\n  useEffect(() => {\n    if (!controlsRef.current) return;\n\n    const element = controlsRef.current;\n    \n    // Limpar classes anteriores\n    element.classList.remove('mobile-optimized', 'tablet-optimized', 'desktop-optimized');\n    \n    // Adicionar classe baseada no dispositivo\n    if (isMobile) {\n      element.classList.add('mobile-optimized');\n    } else if (isTablet) {\n      element.classList.add('tablet-optimized');\n    } else {\n      element.classList.add('desktop-optimized');\n    }\n  }, [isMobile, isTablet]);\n\n  return (\n    <div \n      ref={controlsRef}\n      className=\"responsive-zoom-controls\"\n      data-device={isMobile ? 'mobile' : isTablet ? 'tablet' : 'desktop'}\n      data-accessibility={JSON.stringify(accessibility)}\n    />\n  );\n};\n\nexport default ResponsiveZoomControls;","import React from 'react';\n\nconst MapWrapper = React.forwardRef((props, ref) => {\n  return <div id=\"map\" className=\"w-full h-full\" ref={ref} {...props} />;\n});\n\nexport default MapWrapper; ","import React, { useEffect, useRef, useState, useCallback, useMemo } from 'react';\nimport Map from 'ol/Map';\nimport View from 'ol/View';\nimport TileLayer from 'ol/layer/Tile';\nimport XYZ from 'ol/source/XYZ';\nimport { fromLonLat, toLonLat } from 'ol/proj';\nimport { defaults as defaultControls } from 'ol/control';\n// Remover import das interaes padro para evitar conflitos\n// import { defaults as defaultInteractions } from 'ol/interaction';\nimport { register } from 'ol/proj/proj4';\nimport proj4 from 'proj4';\nimport 'ol/ol.css';\n\n// Componentes OpenLayers\nimport OpenLayersMarkers from './OpenLayers/OpenLayersMarkers';\nimport OpenLayersLayers from './OpenLayers/OpenLayersLayers';\n\n// Componentes responsivos\nimport ResponsiveZoomControls from './map/ResponsiveZoomControls';\n\n// Configuraes e utilitrios\nimport { MAP_CONFIG, BASE_LAYER_CONFIG } from '../utils/mapConfig';\nimport { isMobile } from '../utils/mobileUtils';\nimport MapWrapper from './map/MapWrapper';\n\n// Registrar projeo SIRGAS 2000 (EPSG:4674) usada nos dados GeoJSON\nproj4.defs('EPSG:4674', '+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs');\nregister(proj4);\n\nconst OpenLayersMap = ({ \n  dataPoints = [], \n  onPainelOpen,\n  center = MAP_CONFIG.center,\n  zoom = MAP_CONFIG.zoom,\n  className = \"h-screen w-full\",\n  // Props para camadas GeoJSON\n  terrasIndigenasData = null,\n  estadoSPData = null,\n  showTerrasIndigenas = true,\n  showEstadoSP = true,\n  // Props para marcadores\n  showMarcadores = true,\n  showNomesEscolas = false\n}) => {\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n  const baseLayer = useRef(null);\n  const [, setMapInfo] = useState({\n    lng: center[0],\n    lat: center[1],\n    zoom: zoom\n  });\n\n  // Verificar se  mobile e ajustar configuraes\n  const isMobileDevice = useMemo(() => isMobile(), []);\n  const initialCenter = isMobileDevice ? MAP_CONFIG.mobile.center : center;\n  const initialZoom = isMobileDevice ? MAP_CONFIG.mobile.zoom : zoom;\n\n  /**\n   * Cria camadas base do mapa\n   */\n  const createBaseLayers = useCallback(() => {\n    const satelliteLayer = new TileLayer({\n      source: new XYZ({\n        url: BASE_LAYER_CONFIG.satellite.url,\n        attributions: BASE_LAYER_CONFIG.satellite.attributions,\n        maxZoom: BASE_LAYER_CONFIG.satellite.maxZoom,\n        wrapX: BASE_LAYER_CONFIG.satellite.wrapX,\n        tilePixelRatio: BASE_LAYER_CONFIG.satellite.tilePixelRatio,\n        tileSize: BASE_LAYER_CONFIG.satellite.tileSize\n      }),\n      preload: 1,\n      useInterimTilesOnError: false\n    });\n\n    return { satelliteLayer };\n  }, []);\n\n  /**\n   * Inicializa o mapa OpenLayers\n   */\n  const initializeMap = useCallback(() => {\n    if (map.current) return;\n\n    // Criar camadas base\n    const { satelliteLayer } = createBaseLayers();\n    baseLayer.current = satelliteLayer;\n\n    // Criar mapa com configuraes ajustadas para mobile\n    map.current = new Map({\n      target: mapContainer.current,\n      layers: [baseLayer.current],\n      view: new View({\n        center: fromLonLat(initialCenter),\n        zoom: initialZoom,\n        maxZoom: MAP_CONFIG.maxZoom,\n        minZoom: MAP_CONFIG.minZoom,\n        enableRotation: false // Desabilitar rotao\n      }),\n      controls: defaultControls(),\n      // Remover interaes padro para evitar conflitos\n      // interactions: defaultInteractions({\n      //   dragRotate: false, // Desabilitar rotao com arraste\n      //   pinchRotate: false // Desabilitar rotao com pinch (dois dedos)\n      // })\n    });\n\n    // Event listeners para mudanas de view\n    map.current.on('moveend', () => {\n      const view = map.current.getView();\n      const center = toLonLat(view.getCenter());\n      const newView = {\n        lng: center[0].toFixed(4),\n        lat: center[1].toFixed(4),\n        zoom: view.getZoom().toFixed(2)\n      };\n      \n      setMapInfo(newView);\n    });\n\n    console.log('[OpenLayersMap] Mapa inicializado com sucesso');\n\n  }, [initialCenter, initialZoom, createBaseLayers]);\n\n  /**\n   * Atualiza configuraes do mapa quando props mudarem\n   */\n  const updateMapConfig = useCallback(() => {\n    if (!map.current) return;\n\n    const isMobileDevice = isMobile();\n    const newCenter = isMobileDevice ? MAP_CONFIG.mobile.center : center;\n    const newZoom = isMobileDevice ? MAP_CONFIG.mobile.zoom : zoom;\n\n    const view = map.current.getView();\n    const currentCenter = toLonLat(view.getCenter());\n    const currentZoom = view.getZoom();\n\n    // S atualizar se as configuraes realmente mudaram\n    if (currentCenter[0] !== newCenter[0] || currentCenter[1] !== newCenter[1] || currentZoom !== newZoom) {\n      view.setCenter(fromLonLat(newCenter));\n      view.setZoom(newZoom);\n    }\n  }, [center, zoom]);\n\n  // Inicializar mapa quando componente montar\n  useEffect(() => {\n    initializeMap();\n\n    return () => {\n      if (map.current) {\n        map.current.setTarget(undefined);\n        map.current = null;\n      }\n    };\n  }, [initializeMap]);\n\n  // Atualizar configuraes quando props mudarem\n  useEffect(() => {\n    updateMapConfig();\n  }, [updateMapConfig]);\n\n  return (\n    <MapWrapper ref={mapContainer}>\n      {/* Mapa base OpenLayers */}\n      {map.current && (\n        <>\n          {/* Componente de marcadores */}\n          <OpenLayersMarkers\n            dataPoints={dataPoints}\n            onPainelOpen={onPainelOpen}\n            showMarcadores={showMarcadores}\n            showNomesEscolas={showNomesEscolas}\n            map={map.current}\n          />\n\n          {/* Componente de camadas GeoJSON */}\n          <OpenLayersLayers\n            terrasIndigenasData={terrasIndigenasData}\n            estadoSPData={estadoSPData}\n            showTerrasIndigenas={showTerrasIndigenas}\n            showEstadoSP={showEstadoSP}\n            onPainelOpen={onPainelOpen}\n            map={map.current}\n          />\n\n          {/* Controles de zoom responsivos */}\n          <ResponsiveZoomControls mapRef={map} />\n        </>\n      )}\n    </MapWrapper>\n  );\n};\n\nexport default OpenLayersMap; ","import { useState, useEffect } from 'react';\nimport logger from '../utils/logger';\n\n// Um objeto simples para armazenar os dados GeoJSON em memria.\nconst cache = {};\n\n/**\n * Hook para carregar e cachear dados GeoJSON\n * \n * @param {string} key - Chave do arquivo GeoJSON (sem extenso)\n * @returns {Object} Objeto com data, loading e error\n */\nexport const useGeoJSONCache = (key) => {\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (!key) return;\n\n    const fetchGeoJSON = async () => {\n      if (cache[key]) {\n         logger.debug(`useGeoJSONCache: Dados de ${key} encontrados no cache`);\n         setData(cache[key]);\n         return;\n      }\n      setLoading(true);\n      try {\n         const url = `${process.env.PUBLIC_URL}/${key}.geojson`;\n         logger.debug(`useGeoJSONCache: Carregando ${key} de:`, url);\n         const response = await fetch(url);\n         if (!response.ok) throw new Error(`Erro ao buscar GeoJSON (${response.status})`);\n         const geoJSON = await response.json();\n         logger.debug(`useGeoJSONCache: ${key} carregado com sucesso:`, {\n           type: geoJSON.type,\n           features: geoJSON.features?.length || 0,\n         });\n         cache[key] = geoJSON;\n         setData(geoJSON);\n      } catch (err) {\n         logger.error(`useGeoJSONCache: Erro ao carregar ${key}:`, err);\n         setError(err);\n      } finally {\n         setLoading(false);\n      }\n    };\n\n    fetchGeoJSON();\n  }, [key]);\n\n  return { data, loading, error };\n}; ","import { useMemo } from 'react';\n\n/**\n * Hook para gerenciar cones responsivos baseados no comportamento do dispositivo\n * \n * @param {boolean} isMobile - Se est em mobile\n * @param {boolean} isMinimized - Estado atual (minimizado/expandido)\n * @returns {Object} Configuraes do cone\n */\nexport const useResponsiveIcon = (isMobile, isMinimized) => {\n  return useMemo(() => {\n    if (isMobile) {\n      // Mobile: comportamento invertido\n      // Quando minimizado: seta para cima (indicando que pode expandir)\n      // Quando expandido: seta para baixo (indicando que pode minimizar)\n      return {\n        minimized: {\n          path: \"M5 15l7-7 7 7\",\n          ariaLabel: \"Expandir menu\"\n        },\n        expanded: {\n          path: \"M19 9l-7 7-7-7\",\n          ariaLabel: \"Minimizar menu\"\n        }\n      };\n    } else {\n      // Desktop: comportamento padro (mantido como estava)\n      // Quando minimizado: seta para baixo (indicando que pode expandir)\n      // Quando expandido: seta para cima (indicando que pode minimizar)\n      return {\n        minimized: {\n          path: \"M19 9l-7 7-7-7\",\n          ariaLabel: \"Expandir menu\"\n        },\n        expanded: {\n          path: \"M5 15l7-7 7 7\",\n          ariaLabel: \"Minimizar menu\"\n        }\n      };\n    }\n  }, [isMobile]);\n};\n\n/**\n * Componente de cone SVG responsivo\n */\nexport const ResponsiveIcon = ({ isMobile, isMinimized, className = \"w-4 h-4\" }) => {\n  const iconConfig = useResponsiveIcon(isMobile, isMinimized);\n  const currentConfig = isMinimized ? iconConfig.minimized : iconConfig.expanded;\n\n  return (\n    <svg \n      className={className} \n      fill=\"none\" \n      stroke=\"currentColor\" \n      viewBox=\"0 0 24 24\"\n      aria-label={currentConfig.ariaLabel}\n    >\n      <path \n        strokeLinecap=\"round\" \n        strokeLinejoin=\"round\" \n        strokeWidth={2} \n        d={currentConfig.path} \n      />\n    </svg>\n  );\n};\n\nexport default useResponsiveIcon;","import React, { useState, useEffect, useCallback } from 'react';\nimport OpenLayersMap from './OpenLayersMap';\nimport { useGeoJSONCache } from '../hooks/useGeoJSONCache';\nimport { MAP_CONFIG } from '../utils/mapConfig';\nimport { ResponsiveIcon } from '../hooks/useResponsiveIcon';\nimport { useBreakpoint } from '../hooks/responsive/useBreakpoint';\nimport logger from '../utils/logger';\n\nconst MapSelector = ({ \n  dataPoints, \n  onPainelOpen, \n  painelAberto = false,\n  className = \"h-screen w-full\",\n  isMainLoading = false\n}) => {\n  // Carregar dados GeoJSON\n  const { data: terrasIndigenasData, loading: terrasLoading, error: terrasError } = useGeoJSONCache('terras_indigenas');\n  const { data: estadoSPData, loading: estadoLoading, error: estadoError } = useGeoJSONCache('SP');\n\n  // Estados para controlar visibilidade das camadas\n  const [showTerrasIndigenas, setShowTerrasIndigenas] = useState(true);\n  const [showEstadoSP, setShowEstadoSP] = useState(true);\n\n  // Estado para controlar visibilidade dos marcadores\n  const [showMarcadores, setShowMarcadores] = useState(true);\n\n  // Estados para responsividade - usando hook centralizado\n  const { isMobile } = useBreakpoint();\n  const [isMinimized, setIsMinimized] = useState(false);\n\n  // Handler para minimizar/expandir\n  const handleMinimize = useCallback(() => setIsMinimized(prev => !prev), []);\n\n  // Controle global de tamanho do texto (mover do Navbar para o menu de camadas)\n  const [textScale, setTextScale] = useState(() => {\n    const stored = typeof window !== 'undefined' ? localStorage.getItem('opin:textScale') : null;\n    return stored ? parseFloat(stored) : 1;\n  });\n\n  useEffect(() => {\n    const clamped = Math.min(1.3, Math.max(0.9, textScale));\n    if (clamped !== textScale) {\n      setTextScale(clamped);\n      return;\n    }\n    const base = 16;\n    document.documentElement.style.fontSize = `${base * clamped}px`;\n    try {\n      localStorage.setItem('opin:textScale', String(clamped));\n    } catch {}\n  }, [textScale]);\n\n  const decreaseText = () => setTextScale((v) => Math.max(0.9, Math.round((v - 0.1) * 10) / 10));\n  const increaseText = () => setTextScale((v) => Math.min(1.3, Math.round((v + 0.1) * 10) / 10));\n\n  // Log de status das camadas (apenas em desenvolvimento)\n  useEffect(() => {\n    logger.debug('MapSelector: Status das camadas GeoJSON:', {\n      terrasIndigenas: {\n        loading: terrasLoading,\n        error: terrasError,\n        hasData: !!terrasIndigenasData,\n        features: terrasIndigenasData?.features?.length || 0,\n      },\n      estadoSP: {\n        loading: estadoLoading,\n        error: estadoError,\n        hasData: !!estadoSPData,\n        features: estadoSPData?.features?.length || 0,\n      }\n    });\n  }, [terrasIndigenasData, estadoSPData, terrasLoading, estadoLoading, terrasError, estadoError]);\n\n  // Reativar marcadores quando painel fecha em mobile\n  useEffect(() => {\n    if (!painelAberto && isMobile) {\n      logger.debug('MapSelector: Painel fechado em mobile, reativando marcadores');\n      setShowMarcadores(true);\n    }\n  }, [painelAberto, isMobile]);\n\n    // Componente para o cabealho do menu\n  const CabecalhoMenu = ({ onMinimize, isMobile, isMinimized }) => (\n    <div className=\"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-green-900/80 to-green-800/80 text-white\">\n      <div className=\"flex items-center gap-2\">\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3\" />\n        </svg>\n        <h3 className=\"text-sm font-semibold tracking-wide\">Camadas do Mapa</h3>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <button\n          onClick={onMinimize}\n          className=\"text-white hover:bg-white/10 transition-all duration-200 p-1.5 rounded-md\"\n          aria-label={isMinimized ? \"Expandir\" : \"Minimizar\"}\n          type=\"button\"\n        >\n          <ResponsiveIcon \n            isMobile={isMobile} \n            isMinimized={isMinimized} \n            className=\"w-4 h-4\" \n          />\n        </button>\n      </div>\n    </div>\n  );\n\n  // Componente para boto de camada\n  const BotaoCamada = ({ id, label, checked, onChange, disabled = false, loading = false, error = false }) => (\n    <button\n      type=\"button\"\n      onClick={onChange}\n      disabled={disabled}\n      className={`group w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 focus:outline-none focus:ring-0 ${\n        checked \n          ? 'bg-white/10' \n          : 'bg-white/5 hover:bg-white/10'\n      } ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}`}\n    >\n      {/* Contedo principal */}\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center gap-2\">\n          <span className={`text-sm font-medium ${\n            checked ? 'text-white' : 'text-white/90'\n          }`}>\n            {label}\n          </span>\n        </div>\n        \n        {/* Status indicators */}\n        <div className=\"flex items-center gap-2 mt-1\">\n          {loading && !isMainLoading && (\n            <div className=\"flex items-center gap-1 text-white/80\">\n              <span className=\"text-xs\">Carregando...</span>\n            </div>\n          )}\n          \n          {error && (\n            <div className=\"flex items-center gap-1 text-red-300\">\n              <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n              <span className=\"text-xs\">Erro</span>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      {/* Switch estilo Native Land */}\n      <div className=\"flex-shrink-0 ml-2\" role=\"switch\" aria-checked={checked} aria-label={label}>\n        <div className={`relative inline-flex h-5 w-10 items-center rounded-full transition-colors duration-200 ${checked ? 'bg-green-500/70' : 'bg-gray-300'}`}>\n          <span className={`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${checked ? 'translate-x-5' : 'translate-x-1'}`}></span>\n        </div>\n      </div>\n    </button>\n  );\n\n  // Definir center/zoom iniciais conforme dispositivo\n  const mapCenter = isMobile ? MAP_CONFIG.mobile.center : MAP_CONFIG.center;\n  const mapZoom = isMobile ? MAP_CONFIG.mobile.zoom : MAP_CONFIG.zoom;\n\n  logger.debug('MapSelector - Configurao do mapa:', {\n    isMobile,\n    zoom: mapZoom,\n    center: mapCenter\n  });\n\n  return (\n    <div className={className} style={{ position: 'relative' }}>\n      {/* Controles de camadas responsivos */}\n      {isMobile ? (\n        // Menu mobile - fixo na parte inferior\n        <div className=\"fixed bottom-0 left-0 right-0 z-20\">\n          <div className=\"bg-green-900/30 backdrop-blur-md shadow-2xl rounded-t-2xl text-white\">\n            <CabecalhoMenu\n              onMinimize={handleMinimize}\n              isMobile={true}\n              isMinimized={isMinimized}\n            />\n            {!isMinimized && (\n              <div className=\"p-4 flex flex-col gap-3 max-h-80 overflow-y-auto\">\n                <BotaoCamada\n                  id=\"estado-sp\"\n                  label=\"Estado de So Paulo\"\n                  checked={showEstadoSP}\n                  onChange={() => setShowEstadoSP(!showEstadoSP)}\n                  loading={estadoLoading}\n                  error={estadoError}\n                />\n                <BotaoCamada\n                  id=\"marcadores\"\n                  label=\"Escolas Indgenas\"\n                  checked={showMarcadores}\n                  onChange={() => setShowMarcadores(!showMarcadores)}\n                \n                />\n                <BotaoCamada\n                  id=\"terras-indigenas\"\n                  label=\"Terras Indgenas\"\n                  checked={showTerrasIndigenas}\n                  onChange={() => setShowTerrasIndigenas(!showTerrasIndigenas)}\n                  loading={terrasLoading}\n                  error={terrasError}\n                \n                />\n              </div>\n            )}\n          </div>\n        </div>\n      ) : (\n        // Menu desktop - fixo no topo esquerdo\n        <div className=\"fixed top-16 left-4 w-72 bg-green-900/30 backdrop-blur-md rounded-2xl shadow-2xl z-20 overflow-hidden text-white\">\n          <CabecalhoMenu\n            onMinimize={handleMinimize}\n            isMobile={false}\n            isMinimized={isMinimized}\n          />\n          {!isMinimized && (\n            <div className=\"p-4 flex flex-col gap-3 max-h-96 overflow-y-auto\">\n              <BotaoCamada\n                id=\"estado-sp\"\n                label=\"Estado de So Paulo\"\n                checked={showEstadoSP}\n                onChange={() => setShowEstadoSP(!showEstadoSP)}\n                loading={estadoLoading}\n                error={estadoError}\n              />\n              <BotaoCamada\n                id=\"marcadores\"\n                label=\"Escolas Indgenas\"\n                checked={showMarcadores}\n                onChange={() => setShowMarcadores(!showMarcadores)}\n                \n              />\n              <BotaoCamada\n                id=\"terras-indigenas\"\n                label=\"Terras Indgenas\"\n                checked={showTerrasIndigenas}\n                onChange={() => setShowTerrasIndigenas(!showTerrasIndigenas)}\n                loading={terrasLoading}\n                error={terrasError}\n                \n              />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Boto flutuante de tamanho do texto (fora do menu, estilo Native Land) */}\n      {isMobile ? (\n        <button\n          type=\"button\"\n          onClick={() => setTextScale((v) => (v >= 1.3 ? 1.0 : Math.round((v + 0.15) * 100) / 100))}\n          className=\"fixed top-[calc(50%-5rem)] left-4 z-30 rounded-xl bg-green-900/90 hover:bg-green-800 p-2.5 flex items-center cursor-pointer pointer-events-auto transition-all duration-200\"\n          aria-label=\"Ajustar tamanho do texto\"\n          title={`Tamanho do texto: ${Math.round(textScale * 100)}% (toque para alterar)`}\n        >\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\">\n            <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M6.6117 5.00684C6.86862 5.02589 7.11696 5.11134 7.3324 5.25488C7.57862 5.41908 7.77125 5.65263 7.88514 5.92578L11.9232 15.6162C12.1352 16.1258 11.8947 16.7115 11.3851 16.9238C10.8755 17.1362 10.2901 16.8942 10.0775 16.3848L9.08338 14H3.91736L2.92322 16.3857C2.71049 16.8948 2.12502 17.1359 1.6156 16.9238C1.10605 16.7114 0.865522 16.1258 1.07752 15.6162L5.11658 5.92578L5.16248 5.8252C5.27895 5.59518 5.45376 5.39859 5.66932 5.25488L5.76307 5.19727C5.98766 5.07035 6.24213 5.00195 6.50135 5.00195L6.6117 5.00684ZM4.75135 12H8.25037L6.50037 7.80176L4.75135 12Z\" fill=\"#CDE8CF\"></path>\n            <path d=\"M18.0209 6.00098C18.0385 6.00133 18.0561 6.00165 18.0736 6.00293C18.0913 6.00421 18.1089 6.00562 18.1263 6.00781C18.1434 6.00996 18.1602 6.01358 18.1771 6.0166C18.1869 6.01835 18.1968 6.01946 18.2064 6.02148C18.234 6.02726 18.2614 6.03388 18.2885 6.04199C18.2921 6.04309 18.2956 6.04476 18.2992 6.0459C18.317 6.05145 18.3344 6.05789 18.3519 6.06445C18.368 6.07049 18.3841 6.07618 18.3998 6.08301C18.5114 6.13159 18.6161 6.20168 18.7074 6.29297L22.7074 10.293C23.0977 10.6835 23.0979 11.3166 22.7074 11.707C22.3169 12.0975 21.6839 12.0973 21.2933 11.707L19.0004 9.41406V16C19.0004 16.5522 18.5526 16.9999 18.0004 17C17.4481 17 17.0004 16.5523 17.0004 16V9.41406L14.7074 11.707C14.3169 12.0975 13.6839 12.0973 13.2933 11.707C12.9028 11.3165 12.9028 10.6835 13.2933 10.293L17.2933 6.29297C17.3386 6.2477 17.3876 6.20587 17.4408 6.16992C17.4934 6.13439 17.5488 6.10452 17.6058 6.08008C17.6512 6.06059 17.6989 6.04587 17.7474 6.0332C17.7614 6.02955 17.7753 6.0255 17.7894 6.02246C17.8033 6.01948 17.8173 6.01704 17.8314 6.01465C17.847 6.01199 17.8626 6.00973 17.8783 6.00781C17.8961 6.00565 17.914 6.00415 17.932 6.00293C17.948 6.00184 17.9639 6.00131 17.9799 6.00098C17.9866 6.00084 17.9936 6 18.0004 6C18.0072 6 18.0141 6.00084 18.0209 6.00098Z\" fill=\"#CDE8CF\"></path>\n          </svg>\n          <div className=\"hidden lg:block ml-2 text-green-100 text-sm\">Tamanho do texto</div>\n        </button>\n      ) : (\n        <button\n          type=\"button\"\n          onClick={() => setTextScale((v) => (v >= 1.3 ? 1.0 : Math.round((v + 0.15) * 100) / 100))}\n          className=\"fixed top-[calc(50%-5rem)] left-4 z-30 rounded-xl bg-green-900/90 hover:bg-green-800 p-2.5 flex items-center cursor-pointer pointer-events-auto transition-all duration-200\"\n          aria-label=\"Ajustar tamanho do texto\"\n          title={`Tamanho do texto: ${Math.round(textScale * 100)}% (clique para alterar)`}\n        >\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\">\n            <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M6.6117 5.00684C6.86862 5.02589 7.11696 5.11134 7.3324 5.25488C7.57862 5.41908 7.77125 5.65263 7.88514 5.92578L11.9232 15.6162C12.1352 16.1258 11.8947 16.7115 11.3851 16.9238C10.8755 17.1362 10.2901 16.8942 10.0775 16.3848L9.08338 14H3.91736L2.92322 16.3857C2.71049 16.8948 2.12502 17.1359 1.6156 16.9238C1.10605 16.7114 0.865522 16.1258 1.07752 15.6162L5.11658 5.92578L5.16248 5.8252C5.27895 5.59518 5.45376 5.39859 5.66932 5.25488L5.76307 5.19727C5.98766 5.07035 6.24213 5.00195 6.50135 5.00195L6.6117 5.00684ZM4.75135 12H8.25037L6.50037 7.80176L4.75135 12Z\" fill=\"#CDE8CF\"></path>\n            <path d=\"M18.0209 6.00098C18.0385 6.00133 18.0561 6.00165 18.0736 6.00293C18.0913 6.00421 18.1089 6.00562 18.1263 6.00781C18.1434 6.00996 18.1602 6.01358 18.1771 6.0166C18.1869 6.01835 18.1968 6.01946 18.2064 6.02148C18.234 6.02726 18.2614 6.03388 18.2885 6.04199C18.2921 6.04309 18.2956 6.04476 18.2992 6.0459C18.317 6.05145 18.3344 6.05789 18.3519 6.06445C18.368 6.07049 18.3841 6.07618 18.3998 6.08301C18.5114 6.13159 18.6161 6.20168 18.7074 6.29297L22.7074 10.293C23.0977 10.6835 23.0979 11.3166 22.7074 11.707C22.3169 12.0975 21.6839 12.0973 21.2933 11.707L19.0004 9.41406V16C19.0004 16.5522 18.5526 16.9999 18.0004 17C17.4481 17 17.0004 16.5523 17.0004 16V9.41406L14.7074 11.707C14.3169 12.0975 13.6839 12.0973 13.2933 11.707C12.9028 11.3165 12.9028 10.6835 13.2933 10.293L17.2933 6.29297C17.3386 6.2477 17.3876 6.20587 17.4408 6.16992C17.4934 6.13439 17.5488 6.10452 17.6058 6.08008C17.6512 6.06059 17.6989 6.04587 17.7474 6.0332C17.7614 6.02955 17.7753 6.0255 17.7894 6.02246C17.8033 6.01948 17.8173 6.01704 17.8314 6.01465C17.847 6.01199 17.8626 6.00973 17.8783 6.00781C17.8961 6.00565 17.914 6.00415 17.932 6.00293C17.948 6.00184 17.9639 6.00131 17.9799 6.00098C17.9866 6.00084 17.9936 6 18.0004 6C18.0072 6 18.0141 6.00084 18.0209 6.00098Z\" fill=\"#CDE8CF\"></path>\n          </svg>\n          <div className=\"hidden lg:block ml-2 text-green-100 text-sm\">Tamanho do texto</div>\n        </button>\n      )}\n      {/* Mapa OpenLayers unificado */}\n      <OpenLayersMap\n        dataPoints={showMarcadores ? dataPoints : []}\n        onPainelOpen={onPainelOpen}\n        className=\"h-full w-full\"\n        center={mapCenter}\n        zoom={mapZoom}\n        // Props para camadas GeoJSON\n        terrasIndigenasData={terrasIndigenasData}\n        estadoSPData={estadoSPData}\n        showTerrasIndigenas={showTerrasIndigenas}\n        showEstadoSP={showEstadoSP}\n        // Props para marcadores\n        showMarcadores={showMarcadores}\n      />\n    </div>\n  );\n};\n\nexport default React.memo(MapSelector); ","import { useState, useEffect } from 'react';\nimport { supabase } from '../../supabaseClient';\n\nconst useDocumentosEscola = (escolaId) => {\n  const [documentos, setDocumentos] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchDocumentos = async () => {\n      console.log(' Iniciando busca de documentos para escola:', escolaId, 'tipo:', typeof escolaId);\n      \n      if (!escolaId) {\n        console.log(' Nenhum ID de escola fornecido, retornando array vazio');\n        setDocumentos([]);\n        setIsLoading(false);\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n        console.log(' Consultando tabela documentos_escola...');\n        \n        // Verificar conexo com Supabase\n        const { data: authData, error: authError } = await supabase.auth.getSession();\n        console.log(' Estado da autenticao:', {\n          temSessao: !!authData?.session,\n          error: authError\n        });\n\n        // Verificar permisses da tabela\n        const { error: rlsError } = await supabase\n          .from('documentos_escola')\n          .select('count')\n          .limit(1);\n\n        console.log(' Verificao de permisses:', {\n          podeAcessar: !rlsError,\n          error: rlsError ? {\n            code: rlsError.code,\n            message: rlsError.message,\n            details: rlsError.details,\n            hint: rlsError.hint\n          } : null\n        });\n\n        // Primeiro, vamos verificar todos os documentos para debug\n        const { data: allDocs, error: allDocsError } = await supabase\n          .from('documentos_escola')\n          .select('*');\n\n        if (allDocsError) {\n          console.error(' Erro ao buscar todos os documentos:', {\n            code: allDocsError.code,\n            message: allDocsError.message,\n            details: allDocsError.details,\n            hint: allDocsError.hint\n          });\n        } else {\n          console.log(' Todos os documentos na tabela:', allDocs);\n          if (allDocs && allDocs.length > 0) {\n            console.log(' Exemplo de documento:', allDocs[0]);\n            console.log(' Tipos de escola_id encontrados:', allDocs.map(doc => ({\n              id: doc.id,\n              escola_id: doc.escola_id,\n              tipo_escola_id: typeof doc.escola_id,\n              valor_escola_id: doc.escola_id\n            })));\n          } else {\n            console.log(' Tabela est vazia ou no temos permisso para ver os dados');\n          }\n        }\n        \n        // Agora vamos buscar os documentos especficos\n        console.log(' Buscando documentos para escola_id:', escolaId);\n        const { data, error } = await supabase\n          .from('documentos_escola')\n          .select('*')\n          .eq('escola_id', escolaId.toString()) // Convertendo para string para garantir\n          .order('created_at', { ascending: false });\n\n        if (error) {\n          console.error(' Erro na consulta Supabase:', {\n            code: error.code,\n            message: error.message,\n            details: error.details,\n            hint: error.hint\n          });\n          throw error;\n        }\n\n        console.log(' Documentos encontrados:', data?.length || 0);\n        if (data?.length === 0) {\n          console.log(' Nenhum documento encontrado para a escola ID:', escolaId);\n          console.log(' Tentando buscar com diferentes formatos de escola_id...');\n          \n          // Tentando diferentes formatos do ID\n          const { data: dataAsNumber, error: errorAsNumber } = await supabase\n            .from('documentos_escola')\n            .select('*')\n            .eq('escola_id', Number(escolaId));\n            \n          const { data: dataAsString, error: errorAsString } = await supabase\n            .from('documentos_escola')\n            .select('*')\n            .eq('escola_id', String(escolaId));\n            \n          console.log('Resultados com escola_id como nmero:', {\n            count: dataAsNumber?.length || 0,\n            error: errorAsNumber\n          });\n          console.log('Resultados com escola_id como string:', {\n            count: dataAsString?.length || 0,\n            error: errorAsString\n          });\n        } else {\n          console.log(' Dados dos documentos:', data);\n        }\n        \n        setDocumentos(data || []);\n      } catch (err) {\n        console.error(' Erro ao buscar documentos:', err);\n        setError(err.message);\n      } finally {\n        setIsLoading(false);\n        // console.log removido para evitar dependncias desnecessrias\n      }\n    };\n\n    fetchDocumentos();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [escolaId]);\n\n  return { documentos, isLoading, error };\n};\n\nexport default useDocumentosEscola; ","import React, { memo, useState } from 'react';\n\n// Componente InfoCard para informaes individuais\nconst InfoCard = memo(({ label, value, icon: Icon, type = 'text', className = '' }) => {\n  if (!value && value !== 0) return null;\n\n  const renderValue = () => {\n    switch (type) {\n      case 'number':\n        return (\n          <div className=\"text-center\">\n            <div className=\"text-3xl font-medium text-green-800 mb-1\">\n              {value.toLocaleString('pt-BR')}\n            </div>\n          </div>\n        );\n      case 'boolean':\n        return (\n          <div className={`px-3 py-1 rounded-full text-xs font-medium ${\n            value ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'\n          }`}>\n            {value ? 'Sim' : 'No'}\n          </div>\n        );\n      case 'badge':\n        return (\n          <div className=\"flex flex-wrap gap-1\">\n            {Array.isArray(value) ? value.map((item, index) => (\n              <span key={index} className=\"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full\">\n                {item}\n              </span>\n            )) : (\n              <span className=\"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full\">\n                {value}\n              </span>\n            )}\n          </div>\n        );\n      case 'link':\n        return (\n          <a \n            href={value} \n            target=\"_blank\" \n            rel=\"noopener noreferrer\"\n            className=\"text-green-700 hover:text-green-800 underline text-sm\"\n          >\n            {value}\n          </a>\n        );\n      default:\n        return (\n          <div className=\"text-sm text-gray-700 leading-relaxed\">\n            {value}\n          </div>\n        );\n    }\n  };\n\n  return (\n    <div className={`rounded-lg p-4 transition-all duration-200 ${className}`}>\n      <div className=\"flex items-center gap-2 mb-2\">\n        {Icon && <Icon className=\"w-5 h-5 text-gray-700\" />}\n        <span className=\"text-xs font-medium text-gray-600 uppercase tracking-wide\">\n          {label}\n        </span>\n      </div>\n      {renderValue()}\n    </div>\n  );\n});\n\n// Componente InfoGrid para layout em grid\nconst InfoGrid = memo(({ children, columns = 'auto-fit', gap = 4, className = '' }) => {\n  const gridClasses = {\n    'auto-fit': 'grid-cols-2 lg:grid-cols-3',\n    '2': 'grid-cols-2',\n    '3': 'grid-cols-2 lg:grid-cols-3',\n    '4': 'grid-cols-2 lg:grid-cols-4'\n  };\n\n  return (\n    <div className={`grid ${gridClasses[columns]} gap-${gap} ${className} [&>*]:bg-green-100`}>\n      {children}\n    </div>\n  );\n});\n\n// Componente InfoTable para dados tabulares\nconst InfoTable = memo(({ data, className = '' }) => {\n  if (!data || data.length === 0) return null;\n\n  return (\n    <div className={`bg-green-100 rounded-lg overflow-hidden ${className}`}>\n      <table className=\"w-full\">\n        <tbody>\n          {data.map((row, index) => (\n            <tr key={index} className={index % 2 === 0 ? 'bg-white' : 'bg-green-50'}>\n              <td className=\"px-4 py-3 text-sm font-medium text-gray-700 border-r border-green-200\">\n                {row.label}\n              </td>\n              <td className=\"px-4 py-3 text-sm text-gray-600\">\n                {row.value}\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n});\n\n// Componente InfoStats para estatsticas com cones\nconst InfoStats = memo(({ stats, className = '' }) => {\n  if (!stats || stats.length === 0) return null;\n\n  return (\n    <div className={`grid grid-cols-2 sm:grid-cols-4 gap-4 ${className} [&>*]:border-b [&>*]:border-gray-200 [&>*]:pb-2 [&>*]:mb-2`}>\n      {stats.map((stat, index) => (\n        <div key={index} className=\"text-center rounded-lg p-4\">\n          <div className=\"flex justify-center mb-2\">\n            {stat.icon && <stat.icon className=\"w-6 h-6 text-gray-700\" />}\n          </div>\n          <div className=\"text-3xl font-medium text-green-800 mb-1\">\n            {stat.value}\n          </div>\n          <div className=\"text-xs text-gray-600 mt-1\">\n            {stat.label}\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n});\n\n// Componente InfoSection refatorado\nconst InfoSection = memo(({ \n  title, \n  icon: Icon, \n  children, \n  description,\n  defaultCollapsed = false,\n  className = '',\n  layout = 'default', // 'default', 'grid', 'table', 'stats'\n  layoutProps = {}\n}) => {\n  const [isCollapsed, setIsCollapsed] = useState(defaultCollapsed);\n\n  const renderContent = () => {\n    if (!children) return null;\n\n    switch (layout) {\n      case 'grid':\n        return (\n          <InfoGrid {...layoutProps}>\n            {children}\n          </InfoGrid>\n        );\n      case 'table':\n        return (\n          <InfoTable data={layoutProps.data} className={layoutProps.className} />\n        );\n      case 'stats':\n        return (\n          <InfoStats stats={layoutProps.stats} className={layoutProps.className} />\n        );\n      default:\n        return (\n          <div className=\"space-y-4\">\n            {children}\n          </div>\n        );\n    }\n  };\n\n  return (\n    <section \n      className={`\n        bg-white rounded-2xl p-5 \n        shadow-sm transition-all duration-200\n        ${className}\n      `}\n    >\n      <button\n        onClick={() => setIsCollapsed(!isCollapsed)}\n        className=\"\n          w-full flex items-center justify-between \n          text-base font-semibold\n          mb-4 text-gray-900 hover:text-gray-800 \n          transition-colors focus:outline-none\n        \"\n        aria-expanded={!isCollapsed}\n        aria-controls={`${title}-content`}\n      >\n        <div className=\"flex items-center gap-2\">\n          {Icon && <Icon className=\"w-5 h-5 text-gray-700\" />}\n          <span className=\"tracking-wide\">{title}</span>\n        </div>\n      </button>\n      \n      {!isCollapsed && (\n        <div \n          id={`${title}-content`}\n          className=\"space-y-4\"\n          role=\"region\"\n          aria-labelledby={`${title}-button`}\n        >\n          {description && (\n            <div className=\"bg-green-100 rounded-lg p-4\">\n              <p className=\"text-gray-700 text-sm leading-relaxed\">\n                {description}\n              </p>\n            </div>\n          )}\n          {renderContent()}\n        </div>\n      )}\n    </section>\n  );\n});\n\n// Exportar todos os componentes\nexport { InfoCard, InfoGrid, InfoTable, InfoStats };\nexport default InfoSection; ","import React, { memo, useState } from 'react';\nimport {\n  MapPin,\n  Globe,\n  Calendar,\n  Building,\n  Link as LinkIcon,\n  ExternalLink,\n  ChevronRight,\n  Check,\n  X,\n  Navigation,\n} from 'lucide-react';\nimport InfoSection from '../InfoSection';\n\nconst capitalize = (str) => {\n  if (!str) return '';\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n};\n\nconst CompactCard = ({ icon: Icon, label, value, type = 'text' }) => {\n  const renderValue = () => {\n    switch (type) {\n      case 'boolean':\n        return value ? (\n          <span className=\"flex items-center gap-1 text-green-600 text-sm\">\n            <Check className=\"w-4 h-4 flex-shrink-0\" />\n            Sim\n          </span>\n        ) : (\n          <span className=\"flex items-center gap-1 text-red-500 text-sm\">\n            <X className=\"w-4 h-4 flex-shrink-0\" />\n            No\n          </span>\n        );\n      case 'number':\n        return (\n          <div className=\"text-center w-full flex items-center justify-center h-full\">\n            <div className=\"text-3xl font-medium text-green-800\" style={{fontSize: '1.875rem', fontWeight: '500', color: '#166534'}}>\n              {value || '0'}\n            </div>\n          </div>\n        );\n      default:\n        return <span className=\"text-sm text-gray-800 break-words text-center w-full\">{value}</span>;\n    }\n  };\n\n  return (\n    <div className=\"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col\">\n      {/* Header com cone e label */}\n      <div className=\"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]\">\n        <Icon className=\"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0\" />\n        <span className=\"text-xs text-gray-600 font-medium leading-tight\">{label}</span>\n      </div>\n      {/* Contedo do valor */}\n      <div className=\"flex-1 flex items-center justify-center\">\n        {renderValue()}\n      </div>\n    </div>\n  );\n};\n\n// const InfoBlock = ({ icon: Icon, label, value }) => ( // Removido - no utilizado\n//   <div className=\"flex items-center gap-2 bg-green-100 p-1.5 rounded-md text-xs\">\n//     <Icon className=\"w-5 h-5 text-green-600\" />\n//     <span className=\"text-gray-700 font-medium\">{label}:</span>\n//     <span className=\"font-semibold text-green-800\">{capitalize(value)}</span>\n//   </div>\n// );\n\nconst AddressDetails = ({ escola }) => {\n  const hasDetailedAddress = escola.logradouro || escola.numero || escola.bairro || escola.cep;\n  \n  if (!hasDetailedAddress) {\n    return (\n      <div className=\"mt-2 p-2 bg-green-100 rounded-md\">\n        <p className=\"text-xs text-gray-700 leading-snug\">\n          {capitalize(escola.endereco)}\n        </p>\n      </div>\n    );\n  }\n\n  const addressFields = [\n    { field: 'logradouro', label: 'Logradouro' },\n    { field: 'numero', label: 'Nmero' },\n    { field: 'complemento', label: 'Complemento' },\n    { field: 'bairro', label: 'Bairro' },\n  ];\n\n  return (\n    <div className=\"mt-2 space-y-1\">\n      {addressFields.map(({ field, label }) => \n        escola[field] && (\n          <div key={field} className=\"flex items-start gap-2 p-1.5 bg-green-100 rounded-md\">\n            <MapPin className=\"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0\" />\n            <div className=\"flex-1\">\n              <div className=\"text-xs font-medium text-gray-700 mb-0.5\">{label}</div>\n              <div className=\"text-xs text-gray-800 leading-snug\">{escola[field]}</div>\n            </div>\n          </div>\n        )\n      )}\n      \n      {(escola.cep || escola.estado) && (\n        <div className=\"flex items-start gap-2 p-1.5 bg-green-100 rounded-md\">\n          <MapPin className=\"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0\" />\n          <div className=\"flex-1\">\n            <div className=\"text-xs font-medium text-gray-700 mb-0.5\">Localizao</div>\n            <div className=\"text-xs text-gray-800 leading-snug\">\n              {[escola.municipio, escola.estado, escola.cep].filter(Boolean).join(', ')}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst MapButton = ({ escola }) => {\n  const hasCoordinates = escola.Latitude && escola.Longitude;\n  \n  if (!hasCoordinates) return null;\n\n  const openMap = () => {\n    window.open(`https://www.google.com/maps?q=${escola.Latitude},${escola.Longitude}`, '_blank');\n  };\n\n  return (\n    <button\n      onClick={openMap}\n      className=\"mt-2 w-full flex items-center justify-center gap-2 p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors text-xs font-medium\"\n    >\n      <Navigation className=\"w-5 h-5\" />\n      Ver no Google Maps\n    </button>\n  );\n};\n\nconst SocialLinks = ({ links, expanded, onToggle }) => {\n  const socialLinks = (links || '').split(',').map(url => url.trim()).filter(Boolean);\n  \n  if (socialLinks.length === 0) return null;\n\n  return (\n    <div className=\"bg-green-100 rounded-md\">\n      <button\n        onClick={() => onToggle('social')}\n        className=\"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs\"\n        aria-expanded={expanded.social}\n      >\n        <span className=\"flex items-center gap-2 text-gray-700 font-medium\">\n          <Globe className=\"w-5 h-5 text-blue-600\" />\n          Redes sociais ({socialLinks.length})\n        </span>\n        <ChevronRight\n          className={`w-5 h-5 text-gray-400 transition-transform ${\n            expanded.social ? 'rotate-90' : ''\n          }`}\n        />\n      </button>\n      \n      {expanded.social && (\n        <div className=\"px-2 pb-2 border-t border-green-200 bg-white\">\n          <div className=\"mt-1 space-y-1\">\n            {socialLinks.map((link, index) => (\n              <a\n                key={index}\n                href={link}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"flex items-center gap-1.5 p-1.5 bg-green-100 rounded-md hover:bg-green-200 group text-xs\"\n              >\n                <LinkIcon className=\"w-5 h-5 text-blue-600\" />\n                <span className=\"truncate flex-1 text-gray-700\">{link}</span>\n                <ExternalLink className=\"w-5 h-5 text-gray-400 group-hover:text-blue-600\" />\n              </a>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst BasicInfo = memo(({ escola }) => {\n  const [expanded, setExpanded] = useState({});\n\n  if (!escola) return null;\n\n  const toggle = (key) => {\n    setExpanded(prev => ({ ...prev, [key]: !prev[key] }));\n  };\n\n  const basicInfoCards = [\n    {\n      icon: Building,\n      label: 'Municpio',\n      value: capitalize(escola.municipio),\n    },\n    {\n      icon: Calendar,\n      label: 'Fundao',\n      value: escola.ano_criacao,\n      type: 'number',\n    },\n    {\n      icon: Globe,\n      label: 'Redes sociais',\n      value: escola.usa_redes_sociais,\n      type: 'boolean',\n    },\n  ].filter(item => item.value);\n\n  return (\n    <>\n      {/* Povos Indgenas em destaque antes de tudo */}\n      {escola.povos_indigenas && (\n        <div className=\"mb-4\">\n          <div className=\"text-lg sm:text-xl font-bold text-green-800\">\n            Povos Indgenas: <span className=\"font-semibold text-black\">{escola.povos_indigenas}</span>\n          </div>\n        </div>\n      )}\n      <InfoSection title=\"Localizao\" icon={MapPin}>\n        {/* Cards informativos bsicos - Layout otimizado */}\n        <div className=\"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 mb-4 items-stretch\">\n          {basicInfoCards.map((item, index) => (\n            <CompactCard key={index} {...item} />\n          ))}\n          {/* Diretoria de ensino como card */}\n          {escola.diretoria_ensino && (\n            <CompactCard \n              icon={Building}\n              label=\"Diretoria de ensino\"\n              value={escola.diretoria_ensino}\n            />\n          )}\n        </div>\n\n        <div className=\"space-y-1.5\">\n\n          {/* Gaveta do endereo */}\n          {escola.endereco && (\n            <div className=\"bg-green-100 rounded-md\">\n              <button\n                onClick={() => toggle('endereco')}\n                className=\"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs\"\n                aria-expanded={expanded.endereco}\n              >\n                <span className=\"flex items-center gap-2 text-gray-700 font-medium\">\n                  <Building className=\"w-5 h-5\" />\n                  Endereo\n                </span>\n                <ChevronRight\n                  className={`w-5 h-5 text-gray-400 transition-transform ${\n                    expanded.endereco ? 'rotate-90' : ''\n                  }`}\n                />\n              </button>\n              {expanded.endereco && (\n                <div className=\"px-2 pb-2 border-t border-green-200 bg-white\">\n                  <AddressDetails escola={escola} />\n                  <MapButton escola={escola} />\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Redes sociais */}\n          <SocialLinks \n            links={escola.links_redes_sociais}\n            expanded={expanded}\n            onToggle={toggle}\n          />\n        </div>\n      </InfoSection>\n    </>\n  );\n});\n\nexport default BasicInfo;","import React from 'react';\n\nconst HistoriaEscolaContent = ({ htmlContent }) => (\n  <div\n    className=\"historia-escola-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none\n      prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify\n      prose-img:rounded-xl prose-img:shadow-lg\n      prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600\n      prose-strong:text-green-800 prose-em:text-green-700\n      prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg\n      prose-ul:text-black prose-ol:text-black prose-li:text-black\n      prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm\"\n    dangerouslySetInnerHTML={{ __html: htmlContent }}\n  />\n);\n\nexport default HistoriaEscolaContent;\n","import React from 'react';\n\nconst HistoriaEscolaHeader = () => (\n  <div className=\"flex items-center justify-between mb-3 sm:mb-4\">\n    <div className=\"flex items-center gap-3\">\n      <span className=\"bg-green-200 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28\">\n        <img \n          src={`${process.env.PUBLIC_URL}/onca.svg`} \n          alt=\"cone de ona\" \n          className=\"w-18 h-18 sm:w-36 sm:h-36\" \n          style={{ \n            filter: 'none', \n            borderRadius: '0', \n            boxShadow: 'none', \n            margin: '0',\n            padding: '0',\n            border: 'none',\n            outline: 'none',\n            transform: 'translateY(17px)'\n          }}\n          aria-hidden=\"true\"\n        />\n      </span>\n      <h2 className=\"text-xl sm:text-2xl font-bold text-black m-0\">\n        Histria da Escola\n      </h2>\n    </div>\n  </div>\n);\n\nexport default HistoriaEscolaHeader;\n","import React, { memo } from 'react';\nimport HistoriaEscolaContent from './HistoriaEscolaContent';\nimport HistoriaEscolaHeader from './HistoriaEscolaHeader';\nimport './HistoriaEscola.css';\n\nconst HistoriaEscola = memo(({ escola, refreshKey = 0, isMaximized = false }) => {\n  if (!escola?.historia_da_escola) return null;\n\n  // Usar o HTML diretamente, igual  histria dos professores\n  const htmlContent = escola.historia_da_escola;\n\n  return (\n    <div className=\"mt-8 mb-12 flex flex-col items-center w-full\">\n      {/* Header externo ao card - mantm largura mxima sempre */}\n      <header className=\"historia-escola-header mb-6 sm:mb-8 w-full max-w-4xl mx-auto\">\n        <HistoriaEscolaHeader />\n        <div className=\"h-1 w-20 sm:w-24 bg-green-300 rounded-full\" />\n      </header>\n\n      {/* Card com contedo - mantm largura mxima sempre */}\n      <article\n        className=\"\n          px-4 sm:px-6 md:px-8 py-6\n          bg-white rounded-2xl shadow-lg\n          prose prose-sm sm:prose-base md:prose-lg lg:prose-xl\n          prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify\n          prose-img:rounded-xl prose-img:shadow-lg\n          prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600\n          max-w-4xl mx-auto w-full\n        \"\n      >\n        <HistoriaEscolaContent htmlContent={htmlContent} />\n      </article>\n    </div>\n  );\n});\n\nexport default HistoriaEscola; ","import React, { memo } from 'react';\n\nconst BooleanValue = memo(({ value }) => {\n  if (value === undefined || value === null) return null;\n\n  return (\n    <span className={`font-medium text-center w-full block ${value ? 'text-green-600' : 'text-neutral-400'}`}>\n      {value ? 'Sim' : 'No'}\n    </span>\n  );\n});\n\nexport default BooleanValue; ","import React, { memo } from 'react';\nimport { Sparkles, BookOpen, Users, MessageCircle, Clock } from 'lucide-react';\nimport InfoSection from '../InfoSection';\nimport BooleanValue from '../../components/BooleanValue';\n\n// Funo utilitria para transformar o texto em lista\nfunction parseModalidadeEnsino(text) {\n  if (!text || typeof text !== 'string') return [];\n  // Divide pelo trao longo (, U+2013) e remove espaos extras\n  return text\n    .split('')\n    .map(item => item.trim())\n    .filter(Boolean);\n}\n\n// Componente de lista expansvel\nconst ExpandableList = ({ items, maxVisible = 3 }) => {\n  if (!items || items.length === 0) return null;\n\n  return (\n    <div className=\"-mt-1\">\n      <ul className=\"list-none text-gray-800 text-xs pl-0 ml-0\">\n        {items.map((item, idx) => (\n          <li key={idx} className=\"leading-tight m-0 p-0 pl-0 ml-0 flex items-start\">\n            <span className=\"mr-1 text-green-700 select-none\" style={{minWidth: '1em', display: 'inline-block'}}></span>\n            <span>{item}</span>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\n// MiniCard padronizado\nconst MiniCard = ({ icon: Icon, label, value, type = 'text' }) => {\n  const renderValue = () => {\n    if (type === 'number') {\n      return (\n        <div className=\"text-center w-full flex items-center justify-center h-full\">\n          <div className=\"text-3xl font-medium text-green-800\" style={{fontSize: '1.875rem', fontWeight: '500', color: '#166534'}}>\n            {value || '0'}\n          </div>\n        </div>\n      );\n    }\n    return (\n      <div className=\"text-sm text-gray-800 font-medium break-words text-center w-full\">{value}</div>\n    );\n  };\n\n  return (\n    <div className=\"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col\">\n      {/* Header com cone e label */}\n      <div className=\"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]\">\n        <Icon className=\"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0\" />\n        <span className=\"text-xs text-gray-600 font-medium leading-tight\">{label}</span>\n      </div>\n      {/* Contedo do valor */}\n      <div className=\"flex-1 flex items-center justify-center\">\n        {renderValue()}\n      </div>\n    </div>\n  );\n};\n\nconst Modalidades = memo(({ escola }) => {\n  if (!escola) return null;\n\n  // Cards principais de Modalidades\n  const turnosValue = escola.turnos_funcionamento || escola['turnos_funcionamento'] || '';\n  const modalidadeList = parseModalidadeEnsino(escola.modalidade_ensino);\n  \n\n  // Outros cards para o grid\n  const gridItems = [\n    turnosValue && {\n      icon: Clock,\n      label: 'Turnos de Funcionamento',\n      value: turnosValue,\n    },\n    {\n      icon: Users,\n      label: 'Nmero de Alunos',\n      value: escola.numero_alunos || '0',\n      type: 'number',\n    },\n    {\n      icon: MessageCircle,\n      label: 'Lnguas Faladas',\n      value: escola.linguas_faladas,\n    },\n  ].filter(Boolean);\n\n  // Cards de Materiais Pedaggicos\n  const materiaisItems = [\n    {\n      icon: BookOpen,\n      label: 'Material Pedaggico No Indgena',\n      value: <BooleanValue value={escola.material_nao_indigena} />,\n    },\n    {\n      icon: BookOpen,\n      label: 'Material Pedaggico Indgena',\n      value: <BooleanValue value={escola.material_indigena} />,\n    },\n    {\n      icon: BookOpen,\n      label: 'PPP Prprio',\n      value: <BooleanValue value={escola.ppp_proprio} />,\n    },\n    {\n      icon: BookOpen,\n      label: 'PPP com Comunidade',\n      value: <BooleanValue value={escola.ppp_comunidade} />,\n    },\n  ];\n\n  return (\n    <>\n      <InfoSection>\n        {/* Modalidade de Ensino em linha inteira */}\n        <div className=\"mb-4 bg-green-50 rounded-lg p-4\">\n          <div className=\"flex items-start gap-3 mb-2\">\n            <Sparkles className=\"w-5 h-5 text-gray-700 mt-0.5 flex-shrink-0\" />\n            <span className=\"text-sm font-medium text-gray-700\">Modalidade de Ensino</span>\n          </div>\n          <div className=\"ml-8\">\n            <ExpandableList items={modalidadeList} maxVisible={3} />\n          </div>\n        </div>\n        \n        {/* Grid com os outros cards */}\n        <div className=\"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 mt-1 items-stretch\">\n          {gridItems.map((item, idx) => (\n            <MiniCard key={idx} icon={item.icon} label={item.label} value={item.value} type={item.type} />\n          ))}\n        </div>\n      </InfoSection>\n      \n      <InfoSection \n        title=\"Materiais Pedaggicos\" \n        icon={BookOpen}\n        description=\"Diferenciados e no diferenciados, produzidos dentro e fora da comunidade.\"\n      >\n        {/* Primeiro card em linha inteira */}\n        <div className=\"mb-3\">\n          <MiniCard \n            icon={materiaisItems[0].icon} \n            label={materiaisItems[0].label} \n            value={materiaisItems[0].value} \n          />\n        </div>\n        \n        {/* Cards restantes - agrupados por mltiplos de 3 */}\n        {materiaisItems.length > 1 && (\n          <div className=\"space-y-3\">\n            {(() => {\n              const remainingCards = materiaisItems.slice(1);\n              const groups = [];\n              \n              // Agrupar em mltiplos de 3\n              for (let i = 0; i < remainingCards.length; i += 3) {\n                groups.push(remainingCards.slice(i, i + 3));\n              }\n              \n              return groups.map((group, groupIdx) => (\n                <div \n                  key={groupIdx}\n                  className={`grid gap-0.5 sm:gap-1 items-stretch ${\n                    group.length === 3 \n                      ? 'grid-cols-3' \n                      : group.length === 2 \n                        ? 'grid-cols-2' \n                        : 'grid-cols-1'\n                  }`}\n                >\n                  {group.map((item, idx) => (\n                    <MiniCard \n                      key={`${groupIdx}-${idx}`} \n                      icon={item.icon} \n                      label={item.label} \n                      value={item.value} \n                    />\n                  ))}\n                </div>\n              ));\n            })()}\n          </div>\n        )}\n      </InfoSection>\n    </>\n  );\n});\n\nexport default Modalidades; ","import React, { memo } from 'react';\nimport {\n  Home,\n  Droplet,\n  Trash2,\n  Wifi,\n  Monitor,\n  MapPin,\n  Utensils,\n  Apple,\n  ChefHat,\n} from 'lucide-react';\nimport InfoSection from '../InfoSection';\nimport BooleanValue from '../BooleanValue';\n\nconst MiniCard = ({ icon: Icon, label, value }) => (\n  <div className=\"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col\">\n    {/* Header com cone e label */}\n    <div className=\"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]\">\n      <Icon className=\"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0\" />\n      <span className=\"text-xs text-gray-600 font-medium leading-tight\">{label}</span>\n    </div>\n    {/* Contedo do valor */}\n    <div className=\"flex-1 flex items-center justify-center\">\n      <div className=\"text-sm text-gray-800 font-medium break-words text-center w-full\">{value}</div>\n    </div>\n  </div>\n);\n\nconst Infraestrutura = memo(({ escola }) => {\n  if (!escola) return null;\n\n  const items = [\n    {\n      icon: Droplet,\n      label: 'Acesso  gua',\n      value: escola.acesso_agua,\n    },\n    {\n      icon: Trash2,\n      label: 'Coleta de Lixo',\n      value: escola.coleta_lixo,\n    },\n    {\n      icon: Wifi,\n      label: 'Acesso  Internet',\n      value: <BooleanValue value={escola.acesso_internet} />,\n    },\n    {\n      icon: Monitor,\n      label: 'Equipamentos Tecnolgicos',\n      value: escola.equipamentos,\n    },\n    {\n      icon: MapPin,\n      label: 'Modo de Acesso  Escola',\n      value: escola.modo_acesso,\n    },\n    {\n      icon: Utensils,\n      label: 'Cozinha',\n      value: <BooleanValue value={escola.cozinha} />,\n    },\n    {\n      icon: Apple,\n      label: 'Merenda Escolar',\n      value: <BooleanValue value={escola.merenda_escolar} />,\n    },\n    {\n      icon: ChefHat,\n      label: 'Merenda Diferenciada',\n      value: <BooleanValue value={escola.diferenciada} />,\n    },\n  ];\n\n  return (\n    <InfoSection title=\"Infraestrutura\" icon={Home}>\n      {escola.espaco_escolar && (\n        <div className=\"p-2 text-sm text-gray-800 border-b border-gray-200 whitespace-pre-wrap\">\n          {escola.espaco_escolar}\n        </div>\n      )}\n      <div className=\"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 mt-3 items-stretch\">\n        {items.map((item, idx) => (\n          <MiniCard\n            key={idx}\n            icon={item.icon}\n            label={item.label}\n            value={item.value}\n          />\n        ))}\n      </div>\n    </InfoSection>\n  );\n});\n\nexport default Infraestrutura;\n","import React, { memo } from 'react';\nimport {\n  UsersRound,\n  Star,\n  User,\n  UserCheck,\n  UserMinus,\n  MessageCircle,\n  NotebookPen,\n  Check,\n  X,\n} from 'lucide-react';\nimport InfoSection from '../InfoSection';\n\nconst MiniCard = ({ icon: Icon, label, value, description, type = 'text' }) => {\n  const renderValue = () => {\n    if (type === 'number') {\n      return (\n        <div className=\"text-center w-full flex items-center justify-center h-full\">\n          <div className=\"text-3xl font-medium text-green-800\" style={{fontSize: '1.875rem', fontWeight: '500', color: '#166534'}}>\n            {value || '0'}\n          </div>\n        </div>\n      );\n    }\n    return (\n      <div className=\"text-sm text-gray-800 font-medium mb-2 break-words text-center w-full\">{value}</div>\n    );\n  };\n\n  return (\n    <div className=\"bg-green-50 hover:bg-green-100 rounded-lg p-2 sm:p-3 transition-all duration-200 hover:shadow-sm h-[120px] flex flex-col\">\n      {/* Header com cone e label */}\n      <div className=\"flex items-center justify-center gap-1 sm:gap-2 mb-2 sm:mb-3 flex-shrink-0 h-[40px]\">\n        <Icon className=\"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 flex-shrink-0\" />\n        <span className=\"text-xs text-gray-600 font-medium leading-tight\">{label}</span>\n      </div>\n      {/* Contedo do valor */}\n      <div className=\"flex-1 flex items-center justify-center\">\n        {renderValue()}\n      </div>\n      {description && (\n        <div className=\"text-xs text-gray-600 whitespace-pre-line leading-relaxed break-words mt-2\">\n          {description}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// const formatarNomeProfessor = (nome) => { // Removido - no utilizado\n//   if (!nome) return nome;\n\n//   const padroesIndigenas = [\n//     /^([A-Z][a-z]+)\\s+([A-Z][a-z]+)\\s+\\(([^)]+)\\)/,\n//     /^([A-Z][a-z]+)\\s+([A-Z][a-z]+)\\s+-\\s+([^)]+)/,\n//     /^([A-Z][a-z]+)\\s+([A-Z][a-z]+)\\s+ou\\s+([^)]+)/,\n//   ];\n\n//   for (const padrao of padroesIndigenas) {\n//     const match = nome.match(padrao);\n//     if (match) {\n//       const nomeIndigena = `${match[1]} ${match[2]}`;\n//       const nomePortugues = match[3];\n//       return `${nomeIndigena} (${nomePortugues})`;\n//     }\n//   }\n\n//   return nome.includes('(') && nome.includes(')') ? nome : nome;\n// };\n\nconst formatarFormacaoProfessores = (formacao) => {\n  if (!formacao) return null;\n\n  const [status, ...resto] = formacao.split('/');\n  const descricao = resto.join('/').trim();\n\n  return {\n    status: status.trim().toLowerCase() === 'sim' ? 'Sim' : status.trim(),\n    descricao: descricao || null,\n  };\n};\n\nconst formatarFormacaoContinuada = (valor) => {\n  if (!valor) return null;\n\n  const [status, ...resto] = valor.split('/');\n  const descricao = resto.join('/').trim();\n\n  return {\n    status: status.trim().toLowerCase() === 'sim' ? 'Sim' : status.trim(),\n    descricao: descricao || null,\n  };\n};\n\nconst renderBooleanStatus = (valor) => {\n  const normalizado = String(valor).trim().toLowerCase();\n  if (normalizado === 'sim') {\n    return (\n      <div className=\"flex items-center gap-1 text-green-700\">\n        <Check className=\"w-5 h-5\" />\n        Sim\n      </div>\n    );\n  } else if (normalizado === 'no' || normalizado === 'nao') {\n    return (\n      <div className=\"flex items-center gap-1 text-gray-500\">\n        <X className=\"w-5 h-5\" />\n        No\n      </div>\n    );\n  }\n  return valor;\n};\n\nconst GestaoProfessores = memo(({ escola }) => {\n  if (!escola) return null;\n\n  const formacao = formatarFormacaoProfessores(escola.formacao_professores);\n  const continuada = formatarFormacaoContinuada(escola.formacao_continuada);\n\n  return (\n    <InfoSection title=\"Gestores\" icon={UsersRound}>\n      <div className=\"space-y-4 mt-1\">\n        {/* Cards em grid de 2 colunas em mobile, 3 em desktop */}\n        <div className=\"grid grid-cols-3 lg:grid-cols-3 gap-0.5 sm:gap-1 items-stretch\">\n          <MiniCard\n            icon={UserCheck}\n            label=\"Professores Indgenas\"\n            value={escola.professores_indigenas}\n            type=\"number\"\n          />\n          <MiniCard\n            icon={UserMinus}\n            label=\"Professores No Indgenas\"\n            value={escola.professores_nao_indigenas}\n            type=\"number\"\n          />\n          <MiniCard\n            icon={MessageCircle}\n            label=\"Professores que falam lngua indgena\"\n            value={renderBooleanStatus(escola.professores_falam_lingua)}\n          />\n        </div>\n        \n        {/* Card de Formao em linha inteira */}\n        {formacao?.status && (\n          <MiniCard\n            icon={Star}\n            label=\"Formao dos Professores\"\n            value={renderBooleanStatus(formacao.status)}\n            description={formacao.descricao}\n          />\n        )}\n      </div>\n\n      <div className=\"space-y-4 mt-4\">\n        <MiniCard\n          icon={User}\n          label=\"Gesto/Nome\"\n          value={escola.gestao}\n        />\n        <MiniCard\n          icon={UsersRound}\n          label=\"Outros Funcionrios\"\n          value={escola.outros_funcionarios}\n        />\n        {continuada?.status && (\n          <MiniCard\n            icon={NotebookPen}\n            label=\"Visitas de Supervisores e Formao Continuada\"\n            value={renderBooleanStatus(continuada.status)}\n            description={continuada.descricao}\n          />\n        )}\n      </div>\n    </InfoSection>\n  );\n});\n\nexport default GestaoProfessores;\n","import React, { memo } from 'react';\nimport {\n  Target,\n  BookOpen,\n  GraduationCap,\n  Users,\n  Heart,\n  X,\n} from 'lucide-react';\nimport InfoSection from '../InfoSection';\n\nconst ProjectCard = ({ icon: Icon, label, value }) => {\n  const isNegative = value?.trim().toLowerCase() === 'no';\n\n  return (\n    <div className=\"bg-green-50 hover:bg-green-100 rounded-lg p-5 transition-all duration-200 hover:shadow-sm min-h-[120px] flex flex-col\">\n      <div className=\"flex items-start gap-4 flex-1\">\n        <Icon className=\"w-5 h-5 text-gray-700 mt-0.5 flex-shrink-0\" />\n        <div className=\"flex-1 min-w-0 flex flex-col space-y-4\">\n          <div className=\"text-sm font-medium text-gray-700 flex-shrink-0\">{label}</div>\n          <div className=\"flex-1 flex items-start\">\n            {isNegative ? (\n              <div className=\"text-sm text-gray-500 flex items-center gap-1\">\n                <X className=\"w-4 h-4 text-gray-400 flex-shrink-0\" />\n                No\n              </div>\n            ) : (\n              <div className=\"text-sm text-gray-800 leading-relaxed break-words\">\n                {value}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst ProjetosParcerias = memo(({ escola }) => {\n  if (!escola) return null;\n\n  const projectsData = [\n    {\n      field: 'projetos_andamento',\n      icon: BookOpen,\n      label: 'Projetos em andamento',\n    },\n    {\n      field: 'parcerias_universidades',\n      icon: GraduationCap,\n      label: 'Parcerias com universidades',\n    },\n    {\n      field: 'acoes_ongs',\n      icon: Users,\n      label: 'Aes com ONGs ou coletivos',\n    },\n    {\n      field: 'desejos_comunidade',\n      icon: Heart,\n      label: 'Desejos da comunidade para a escola',\n    },\n    {\n      field: 'parcerias_municipio',\n      icon: Target,\n      label: 'Parcerias com o municpio',\n    },\n  ];\n\n  const availableProjects = projectsData.filter(\n    project => escola[project.field] && escola[project.field].trim()\n  );\n\n  if (availableProjects.length === 0) return null;\n\n  return (\n    <InfoSection title=\"Projetos e Parcerias\" icon={Target}>\n      <div className=\"grid grid-cols-1 gap-6 items-stretch\">\n        {availableProjects.map((project) => (\n          <ProjectCard\n            key={project.field}\n            icon={project.icon}\n            label={project.label}\n            value={escola[project.field]}\n          />\n        ))}\n      </div>\n    </InfoSection>\n  );\n});\n\nexport default ProjetosParcerias;\n","import React, { useState, useEffect, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { X, ZoomIn, ZoomOut, RotateCw, ChevronLeft, ChevronRight } from 'lucide-react';\n\nconst ReusableImageZoom = ({ \n  images = [], \n  currentImageIndex = 0, \n  isOpen = false, \n  onClose,\n  onImageChange,\n  showNavigation = true,\n  showControls = true,\n  showCounter = true,\n  showCaption = true\n}) => {\n  const [zoomLevel, setZoomLevel] = useState(1);\n  const [rotation, setRotation] = useState(0);\n  const [currentIndex, setCurrentIndex] = useState(currentImageIndex);\n\n  // Reset zoom e rotao quando a imagem muda\n  useEffect(() => {\n    setZoomLevel(1);\n    setRotation(0);\n    setCurrentIndex(currentImageIndex);\n  }, [currentImageIndex, isOpen]);\n\n  const currentImage = images[currentIndex];\n\n  const fecharZoom = useCallback(() => {\n    setZoomLevel(1);\n    setRotation(0);\n    onClose();\n  }, [onClose]);\n\n  const resetImage = () => {\n    setZoomLevel(1);\n    setRotation(0);\n  };\n\n  const nextImage = useCallback(() => {\n    if (currentIndex < images.length - 1) {\n      const newIndex = currentIndex + 1;\n      setCurrentIndex(newIndex);\n      if (onImageChange) onImageChange(newIndex);\n    }\n  }, [currentIndex, images.length, onImageChange]);\n\n  const prevImage = useCallback(() => {\n    if (currentIndex > 0) {\n      const newIndex = currentIndex - 1;\n      setCurrentIndex(newIndex);\n      if (onImageChange) onImageChange(newIndex);\n    }\n  }, [currentIndex, onImageChange]);\n\n  // Fecha modal com tecla ESC\n  useEffect(() => {\n    const handleEsc = (e) => {\n      if (e.key === 'Escape') fecharZoom();\n    };\n    \n    if (isOpen) {\n      window.addEventListener('keydown', handleEsc);\n      return () => window.removeEventListener('keydown', handleEsc);\n    }\n  }, [isOpen, fecharZoom]);\n\n  // Navegao com teclado\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (!isOpen) return;\n      \n      switch (e.key) {\n        case 'ArrowLeft':\n          e.preventDefault();\n          prevImage();\n          break;\n        case 'ArrowRight':\n          e.preventDefault();\n          nextImage();\n          break;\n        case 'r':\n        case 'R':\n          e.preventDefault();\n          setRotation(prev => (prev + 90) % 360);\n          break;\n        case '+':\n        case '=':\n          e.preventDefault();\n          setZoomLevel(prev => Math.min(prev + 0.25, 3));\n          break;\n        case '-':\n          e.preventDefault();\n          setZoomLevel(prev => Math.max(prev - 0.25, 0.5));\n          break;\n        case '0':\n          e.preventDefault();\n          resetImage();\n          break;\n        default:\n          break;\n      }\n    };\n\n    if (isOpen) {\n      window.addEventListener('keydown', handleKeyDown);\n      return () => window.removeEventListener('keydown', handleKeyDown);\n    }\n  }, [isOpen, currentIndex, images.length, nextImage, prevImage]);\n\n  if (!isOpen || !currentImage) return null;\n\n  return (\n    <div\n      className=\"image-zoom-modal\"\n      onClick={fecharZoom}\n    >\n      {/* Boto Fechar */}\n      <button\n        onClick={fecharZoom}\n        className=\"image-zoom-close\"\n        aria-label=\"Fechar\"\n      >\n        <X size={24} />\n      </button>\n\n      {/* Controles de Zoom */}\n      {showControls && (\n        <div className=\"image-zoom-controls\">\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              setZoomLevel(prev => Math.min(prev + 0.25, 3));\n            }}\n            className=\"image-zoom-control-button\"\n            aria-label=\"Aumentar zoom\"\n          >\n            <ZoomIn size={20} />\n          </button>\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              setZoomLevel(prev => Math.max(prev - 0.25, 0.5));\n            }}\n            className=\"image-zoom-control-button\"\n            aria-label=\"Diminuir zoom\"\n          >\n            <ZoomOut size={20} />\n          </button>\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              setRotation(prev => (prev + 90) % 360);\n            }}\n            className=\"image-zoom-control-button\"\n            aria-label=\"Rotacionar\"\n          >\n            <RotateCw size={20} />\n          </button>\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              resetImage();\n            }}\n            className=\"image-zoom-control-button text-xs px-3\"\n            aria-label=\"Resetar\"\n          >\n            Reset\n          </button>\n        </div>\n      )}\n\n      {/* Navegao entre imagens */}\n      {showNavigation && images.length > 1 && (\n        <>\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              prevImage();\n            }}\n            className=\"image-zoom-navigation prev\"\n            disabled={currentIndex === 0}\n            aria-label=\"Imagem anterior\"\n          >\n            <ChevronLeft size={24} />\n          </button>\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              nextImage();\n            }}\n            className=\"image-zoom-navigation next\"\n            disabled={currentIndex === images.length - 1}\n            aria-label=\"Prxima imagem\"\n          >\n            <ChevronRight size={24} />\n          </button>\n        </>\n      )}\n\n      {/* Contador de imagens */}\n      {showCounter && images.length > 1 && (\n        <div className=\"image-zoom-counter\">\n          {currentIndex + 1} / {images.length}\n        </div>\n      )}\n\n      {/* Container da imagem */}\n      <div className=\"image-zoom-container\">\n        <div className=\"image-zoom-image-wrapper\">\n          <img\n            src={currentImage.url || currentImage.publicURL || currentImage.imagem_public_url}\n            alt={currentImage.descricao || currentImage.descricao_imagem || 'Imagem'}\n            className=\"image-zoom-image\"\n            style={{\n              transform: `scale(${zoomLevel}) rotate(${rotation}deg)`,\n              cursor: 'grab'\n            }}\n            onClick={(e) => e.stopPropagation()}\n            onMouseDown={(e) => {\n              e.preventDefault();\n              // Implementar drag se necessrio\n            }}\n          />\n        </div>\n\n        {/* Legenda */}\n        {showCaption && (currentImage.descricao || currentImage.descricao_imagem) && (\n          <div className=\"image-zoom-caption\">\n            <h3 className=\"font-semibold text-gray-900 mb-2\">\n              {currentImage.descricao || currentImage.descricao_imagem}\n            </h3>\n            \n            {/* Informaes adicionais */}\n            <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-2\">\n              {currentImage.categoria && (\n                <span className=\"capitalize bg-gray-100 px-2 py-1 rounded text-gray-800\">\n                  {currentImage.categoria}\n                </span>\n              )}\n              {currentImage.autor && (\n                <span>Fotgrafo: {currentImage.autor}</span>\n              )}\n              {currentImage.dataFoto && (\n                <span>Data: {new Date(currentImage.dataFoto).toLocaleDateString('pt-BR')}</span>\n              )}\n            </div>\n            \n            {/* Descrio detalhada */}\n            {currentImage.descricaoDetalhada && (\n              <p className=\"text-gray-600 leading-relaxed\">\n                {currentImage.descricaoDetalhada}\n              </p>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Instrues de teclado */}\n      <div className=\"image-zoom-instructions\">\n        <div className=\"text-xs text-gray-400 space-y-1\">\n          <div>ESC: Fechar |  : Navegar | R: Rotacionar</div>\n          <div>+ -: Zoom | 0: Reset</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nReusableImageZoom.propTypes = {\n  images: PropTypes.arrayOf(PropTypes.shape({\n    url: PropTypes.string,\n    publicURL: PropTypes.string,\n    imagem_public_url: PropTypes.string,\n    descricao: PropTypes.string,\n    descricao_imagem: PropTypes.string,\n    categoria: PropTypes.string,\n    autor: PropTypes.string,\n    dataFoto: PropTypes.string,\n    descricaoDetalhada: PropTypes.string\n  })).isRequired,\n  currentImageIndex: PropTypes.number,\n  isOpen: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onImageChange: PropTypes.func,\n  showNavigation: PropTypes.bool,\n  showControls: PropTypes.bool,\n  showCounter: PropTypes.bool,\n  showCaption: PropTypes.bool\n};\n\nexport default ReusableImageZoom;\n","import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Componente de imagem otimizada com preload\n * Mostra placeholder enquanto carrega e transio suave quando pronta\n */\nconst OptimizedImage = ({ \n  src, \n  alt, \n  className = '', \n  isPreloaded = false,\n  placeholder = null,\n  onLoad,\n  onError,\n  ...props \n}) => {\n  const [imageLoaded, setImageLoaded] = useState(false);\n  const [imageError, setImageError] = useState(false);\n  const [showImage, setShowImage] = useState(false);\n\n  useEffect(() => {\n    // Se a imagem foi preloadada, mostrar imediatamente\n    if (isPreloaded) {\n      setImageLoaded(true);\n      setShowImage(true);\n    }\n  }, [isPreloaded]);\n\n  const handleImageLoad = () => {\n    setImageLoaded(true);\n    setImageError(false);\n    setShowImage(true);\n    if (onLoad) onLoad();\n  };\n\n  const handleImageError = () => {\n    setImageError(true);\n    setImageLoaded(false);\n    if (onError) onError();\n  };\n\n  // Se houve erro, mostrar placeholder ou nada\n  if (imageError) {\n    return placeholder || null;\n  }\n\n  return (\n    <div className={`relative overflow-hidden ${className}`}>\n      {/* Placeholder/Loading */}\n      {!imageLoaded && (\n        <div className=\"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center\">\n        <div className=\"flex flex-col items-center space-y-2\">\n          <div className=\"text-xs text-gray-500\">Carregando...</div>\n        </div>\n        </div>\n      )}\n\n      {/* Imagem */}\n      <img\n        src={src}\n        alt={alt}\n        className={`w-full h-full object-cover transition-all duration-500 ease-out ${\n          showImage \n            ? 'opacity-100 scale-100' \n            : 'opacity-0 scale-105'\n        }`}\n        onLoad={handleImageLoad}\n        onError={handleImageError}\n        {...props}\n      />\n    </div>\n  );\n};\n\nOptimizedImage.propTypes = {\n  src: PropTypes.string.isRequired,\n  alt: PropTypes.string.isRequired,\n  className: PropTypes.string,\n  isPreloaded: PropTypes.bool,\n  placeholder: PropTypes.node,\n  onLoad: PropTypes.func,\n  onError: PropTypes.func,\n};\n\nexport default OptimizedImage;","import { useEffect, useRef, useState } from 'react';\nimport { supabase } from '../supabaseClient';\n\n/**\n * Hook para preload de imagens antecipado\n * Carrega imagens antes que o usurio role at elas\n */\nconst useImagePreloader = (escolaId, enabled = true) => {\n  const [preloadedImages, setPreloadedImages] = useState(new Map());\n  const [isPreloading, setIsPreloading] = useState(false);\n  const preloadTimeoutRef = useRef(null);\n\n  // Funo para preload de uma imagem especfica\n  const preloadImage = (url) => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.onload = () => resolve(url);\n      img.onerror = () => reject(new Error(`Failed to load image: ${url}`));\n      img.src = url;\n    });\n  };\n\n  // Funo para preload de mltiplas imagens\n  const preloadImages = async (urls) => {\n    const promises = urls.map(url => \n      preloadImage(url).catch(error => {\n        console.warn('Erro ao preload da imagem:', url, error);\n        return null; // Continua mesmo se uma imagem falhar\n      })\n    );\n    \n    const results = await Promise.all(promises);\n    return results.filter(Boolean); // Remove URLs que falharam\n  };\n\n  // Funo principal de preload\n  const startPreload = async () => {\n    if (!escolaId || !enabled) return;\n\n    setIsPreloading(true);\n    console.log(' Iniciando preload de imagens para escola:', escolaId);\n\n    try {\n      // Preload de imagens da escola\n      const { data: escolaFiles } = await supabase.storage\n        .from('imagens-das-escolas')\n        .list(`${escolaId}/`);\n\n      // Preload de imagens dos professores\n      const { data: professorFiles } = await supabase.storage\n        .from('imagens-professores')\n        .list(`${escolaId}/`);\n\n      const urlsToPreload = [];\n\n      // Adicionar URLs das imagens da escola\n      if (escolaFiles && escolaFiles.length > 0) {\n        escolaFiles.forEach(file => {\n          const { data: { publicUrl } } = supabase.storage\n            .from('imagens-das-escolas')\n            .getPublicUrl(`${escolaId}/${file.name}`);\n          urlsToPreload.push(publicUrl);\n        });\n      }\n\n      // Adicionar URLs das imagens dos professores\n      if (professorFiles && professorFiles.length > 0) {\n        professorFiles.forEach(file => {\n          const { data: { publicUrl } } = supabase.storage\n            .from('imagens-professores')\n            .getPublicUrl(`${escolaId}/${file.name}`);\n          urlsToPreload.push(publicUrl);\n        });\n      }\n\n      console.log(` Preload: ${urlsToPreload.length} imagens encontradas`);\n\n      if (urlsToPreload.length > 0) {\n        // Preload em lotes para no sobrecarregar\n        const batchSize = 5;\n        const batches = [];\n        \n        for (let i = 0; i < urlsToPreload.length; i += batchSize) {\n          batches.push(urlsToPreload.slice(i, i + batchSize));\n        }\n\n        // Processar lotes com delay entre eles\n        for (let i = 0; i < batches.length; i++) {\n          const batch = batches[i];\n          console.log(` Preload lote ${i + 1}/${batches.length}: ${batch.length} imagens`);\n          \n          await preloadImages(batch);\n          \n          // Delay entre lotes para no sobrecarregar\n          if (i < batches.length - 1) {\n            await new Promise(resolve => setTimeout(resolve, 200));\n          }\n        }\n\n        // Atualizar estado com imagens preloadadas\n        const preloadedMap = new Map();\n        urlsToPreload.forEach(url => {\n          preloadedMap.set(url, true);\n        });\n        setPreloadedImages(preloadedMap);\n\n        console.log(' Preload concludo:', urlsToPreload.length, 'imagens');\n      }\n\n    } catch (error) {\n      console.error(' Erro durante preload:', error);\n    } finally {\n      setIsPreloading(false);\n    }\n  };\n\n  // Iniciar preload quando escolaId mudar\n  useEffect(() => {\n    if (!escolaId || !enabled) return;\n\n    // Limpar timeout anterior se existir\n    if (preloadTimeoutRef.current) {\n      clearTimeout(preloadTimeoutRef.current);\n    }\n\n    // Delay inicial para no bloquear a UI\n    preloadTimeoutRef.current = setTimeout(() => {\n      startPreload();\n    }, 500); // 500ms de delay inicial\n\n    return () => {\n      if (preloadTimeoutRef.current) {\n        clearTimeout(preloadTimeoutRef.current);\n      }\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [escolaId, enabled]);\n\n  // Verificar se uma imagem especfica foi preloadada\n  const isImagePreloaded = (url) => {\n    return preloadedImages.has(url);\n  };\n\n  return {\n    isPreloading,\n    preloadedImages,\n    isImagePreloaded,\n    startPreload\n  };\n};\n\nexport default useImagePreloader;","import React, { useEffect, useState, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { supabase } from '../../../supabaseClient';\nimport { getLegendaByImageUrlFlexivel } from '../../../services/legendasService';\nimport ReusableImageZoom from '../../ReusableImageZoom';\nimport OptimizedImage from '../../shared/OptimizedImage';\nimport useImagePreloader from '../../../hooks/useImagePreloader';\nimport '../../ReusableImageZoom.css';\n\nconst ImagemHistoriadoProfessor = ({ escola_id, refreshKey = 0, isMaximized = false }) => {\n  const [imagens, setImagens] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [imagemZoom, setImagemZoom] = useState(null);\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n\n  // Hook de preload de imagens\n  const { isImagePreloaded } = useImagePreloader(escola_id, true);\n\n  const fecharZoom = useCallback(() => {\n    setImagemZoom(null);\n    setCurrentImageIndex(0);\n  }, []);\n\n\n\n  // Forar recarga quando refreshKey mudar\n  useEffect(() => {\n    if (refreshKey > 0) {\n      console.log('ImagemHistoriadoProfessor: refreshKey mudou, forando recarga');\n      setImagens([]);\n      setLoading(true);\n      setError(null);\n    }\n  }, [refreshKey]);\n\n  useEffect(() => {\n    if (!escola_id) return;\n\n    setLoading(true);\n    setError(null);\n\n    // Busca arquivos do bucket diretamente\n    supabase\n      .storage\n      .from('imagens-professores')\n      .list(`${escola_id}/`)\n      .then(async ({ data, error }) => {\n        if (error) {\n          setError(error.message);\n          setLoading(false);\n          return;\n        }\n\n        if (data && data.length > 0) {\n          console.log('Arquivos de professores encontrados:', data.length);\n          const imagensComUrl = await Promise.all(data.map(async (file, idx) => {\n            const { data: { publicUrl } } = supabase\n              .storage\n              .from('imagens-professores')\n              .getPublicUrl(`${escola_id}/${file.name}`);\n            \n            // Extrair gnero do nome do arquivo\n            let genero = 'professor';\n            if (file.name.startsWith('professora_')) {\n              genero = 'professora';\n            } else if (file.name.startsWith('professor_')) {\n              genero = 'professor';\n            }\n\n            // Buscar legenda da nova tabela\n            let legenda = null;\n            try {\n              const caminhoRelativo = `${escola_id}/${file.name}`;\n              console.log('Buscando legenda para professor:', caminhoRelativo);\n              legenda = await getLegendaByImageUrlFlexivel(caminhoRelativo, escola_id, {\n                categoria: 'professor',\n                tipo_foto: 'professor'\n              });\n              console.log('Legenda encontrada:', legenda);\n            } catch (error) {\n              console.warn('Erro ao buscar legenda:', error);\n            }\n\n            return {\n              id: idx + 1,\n              publicURL: publicUrl,\n              genero,\n              nome: file.name,\n              created_at: file.created_at || '',\n              legenda: legenda?.legenda || `Imagem do ${genero}`,\n              descricaoDetalhada: legenda?.descricao_detalhada,\n              autor: legenda?.autor_foto,\n              dataFoto: legenda?.data_foto,\n              categoria: legenda?.categoria,\n            };\n          }));\n\n          setImagens(imagensComUrl);\n        } else {\n          setImagens([]);\n        }\n        setLoading(false);\n      })\n      .catch(err => {\n        setError(`Erro inesperado: ${err.message}`);\n        setLoading(false);\n      });\n  }, [escola_id]);\n\n\n  if (loading) {\n    return <div className=\"text-gray-500\">Carregando imagens do professor...</div>;\n  }\n\n  if (error) {\n    return <div className=\"text-red-600\">Erro ao carregar imagens: {error}</div>;\n  }\n\n  if (!imagens.length) {\n    return null;\n  }\n\n  // Don't show thumbnails when maximized (images are shown in sidebar)\n  if (isMaximized) {\n    return null;\n  }\n\n  return (\n    <section className=\"my-6\">\n      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n        {imagens.map((img, index) => (\n          <figure\n            key={img.id}\n            className=\"rounded-lg overflow-hidden bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md\"\n            onClick={() => {\n              if (img.publicURL) {\n                setCurrentImageIndex(index);\n                setImagemZoom(img);\n              }\n            }}\n          >\n            <div className=\"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center\">\n              <OptimizedImage\n                src={img.publicURL}\n                alt={img.legenda}\n                className=\"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105\"\n                isPreloaded={isImagePreloaded(img.publicURL)}\n                style={{ maxHeight: '350px' }}\n              />\n            </div>\n            \n            {/* Legenda da imagem */}\n            {img.legenda && (\n              <figcaption className=\"p-3 bg-white\">\n                <h4 className=\"font-medium text-gray-900 text-sm mb-1\">\n                  {img.legenda}\n                </h4>\n                \n                {/* Informaes adicionais */}\n                <div className=\"flex items-center gap-4 text-xs text-gray-500\">\n                  {img.categoria && (\n                    <span className=\"capitalize bg-gray-100 px-2 py-1 rounded\">\n                      {img.categoria}\n                    </span>\n                  )}\n                  {img.autor && (\n                    <span>Por: {img.autor}</span>\n                  )}\n                  {img.dataFoto && (\n                    <span>{new Date(img.dataFoto).toLocaleDateString('pt-BR')}</span>\n                  )}\n                </div>\n                \n                {/* Descrio detalhada */}\n                {img.descricaoDetalhada && (\n                  <p className=\"text-xs text-gray-600 mt-2 line-clamp-2\">\n                    {img.descricaoDetalhada}\n                  </p>\n                )}\n              </figcaption>\n            )}\n          </figure>\n        ))}\n      </div>\n\n      {/* Modal de Zoom Reutilizvel */}\n      <ReusableImageZoom\n        images={imagens}\n        currentImageIndex={currentImageIndex}\n        isOpen={!!imagemZoom}\n        onClose={fecharZoom}\n        onImageChange={setCurrentImageIndex}\n        showNavigation={true}\n        showControls={true}\n        showCounter={true}\n        showCaption={true}\n      />\n    </section>\n  );\n};\n\nImagemHistoriadoProfessor.propTypes = {\n  escola_id: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  refreshKey: PropTypes.number,\n};\n\nexport default React.memo(ImagemHistoriadoProfessor);\n","import React, { useState, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { User, AlertCircle, Loader2 } from 'lucide-react';\n\n/**\n * Componente Avatar modular e expansvel\n * Suporta diferentes tamanhos, formas, temas e funcionalidades avanadas\n */\nconst Avatar = ({\n  // Props bsicas\n  src,\n  alt,\n  name,\n  \n  // Tamanhos\n  size = 'medium',\n  customSize,\n  \n  // Forma e estilo\n  shape = 'circle',\n  variant = 'default',\n  \n  // Estados e interaes\n  loading = false,\n  error = false,\n  clickable = false,\n  \n  // Customizao visual\n  className = '',\n  borderColor = 'border-green-200',\n  backgroundColor = 'bg-gray-100',\n  textColor = 'text-gray-600',\n  \n  // Funcionalidades avanadas\n  badge,\n  badgePosition = 'bottom-right',\n  badgeColor = 'bg-green-500',\n  badgeSize = 'small',\n  \n  // Callbacks\n  onClick,\n  onError,\n  onLoad,\n  \n  // Configuraes de fallback\n  fallbackIcon = 'user',\n  showInitials = true,\n  maxInitials = 2,\n  \n  // Configuraes de imagem\n  lazy = true,\n  priority = false,\n  \n  // Props adicionais\n  ...props\n}) => {\n  const [imageError, setImageError] = useState(false);\n  const [imageLoading, setImageLoading] = useState(!!src);\n\n  // Configuraes de tamanho\n  const sizeConfig = useMemo(() => {\n    if (customSize) {\n      return {\n        container: 'w-full h-full',\n        text: 'text-sm',\n        icon: 'w-6 h-6',\n        badge: 'w-3 h-3',\n        customSize: customSize\n      };\n    }\n\n    const sizes = {\n      xs: {\n        container: 'w-6 h-6',\n        text: 'text-xs',\n        icon: 'w-3 h-3',\n        badge: 'w-2 h-2'\n      },\n      small: {\n        container: 'w-8 h-8',\n        text: 'text-xs',\n        icon: 'w-4 h-4',\n        badge: 'w-2 h-2'\n      },\n      medium: {\n        container: 'w-12 h-12 sm:w-16 sm:h-16',\n        text: 'text-sm sm:text-base',\n        icon: 'w-6 h-6 sm:w-8 sm:h-8',\n        badge: 'w-3 h-3'\n      },\n      large: {\n        container: 'w-16 h-16 sm:w-20 sm:h-20',\n        text: 'text-base sm:text-lg',\n        icon: 'w-8 h-8 sm:w-10 sm:h-10',\n        badge: 'w-4 h-4'\n      },\n      xlarge: {\n        container: 'w-20 h-20 sm:w-24 sm:h-24',\n        text: 'text-lg sm:text-xl',\n        icon: 'w-10 h-10 sm:w-12 sm:h-12',\n        badge: 'w-5 h-5'\n      },\n      xxlarge: {\n        container: 'w-24 h-24 sm:w-32 sm:h-32',\n        text: 'text-xl sm:text-2xl',\n        icon: 'w-12 h-12 sm:w-16 sm:h-16',\n        badge: 'w-6 h-6'\n      }\n    };\n\n    return sizes[size] || sizes.medium;\n  }, [size, customSize]);\n\n  // Configuraes de forma\n  const shapeConfig = useMemo(() => {\n    const shapes = {\n      circle: 'rounded-full',\n      square: 'rounded-lg',\n      rounded: 'rounded-xl',\n      none: 'rounded-none'\n    };\n    return shapes[shape] || shapes.circle;\n  }, [shape]);\n\n  // Configuraes de variante\n  const variantConfig = useMemo(() => {\n    const variants = {\n      default: {\n        border: 'border-2',\n        shadow: 'shadow-md',\n        hover: 'hover:shadow-lg'\n      },\n      minimal: {\n        border: 'border',\n        shadow: 'shadow-sm',\n        hover: 'hover:shadow-md'\n      },\n      flat: {\n        border: 'border-2',\n        shadow: 'shadow-none',\n        hover: 'hover:shadow-sm'\n      },\n      elevated: {\n        border: 'border-2',\n        shadow: 'shadow-lg',\n        hover: 'hover:shadow-xl'\n      }\n    };\n    return variants[variant] || variants.default;\n  }, [variant]);\n\n  // Configuraes de badge\n  const badgeConfig = useMemo(() => {\n    const positions = {\n      'top-left': 'top-0 left-0',\n      'top-right': 'top-0 right-0',\n      'bottom-left': 'bottom-0 left-0',\n      'bottom-right': 'bottom-0 right-0',\n      'center': 'top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2'\n    };\n\n    const badgeSizes = {\n      small: 'w-3 h-3',\n      medium: 'w-4 h-4',\n      large: 'w-5 h-5'\n    };\n\n    return {\n      position: positions[badgePosition] || positions['bottom-right'],\n      size: badgeSizes[badgeSize] || badgeSizes.small\n    };\n  }, [badgePosition, badgeSize]);\n\n  // Gerar iniciais do nome\n  const initials = useMemo(() => {\n    if (!name || !showInitials) return '';\n    \n    const words = name.trim().split(' ');\n    const initialsArray = words\n      .slice(0, maxInitials)\n      .map(word => word.charAt(0).toUpperCase())\n      .filter(char => char.match(/[A-Z]/));\n    \n    return initialsArray.join('');\n  }, [name, showInitials, maxInitials]);\n\n  // Determinar cone de fallback\n  const FallbackIcon = useMemo(() => {\n    const icons = {\n      user: User,\n      alert: AlertCircle,\n      loading: Loader2\n    };\n    return icons[fallbackIcon] || icons.user;\n  }, [fallbackIcon]);\n\n  // Handlers\n  const handleImageLoad = () => {\n    setImageLoading(false);\n    setImageError(false);\n    onLoad?.();\n  };\n\n  const handleImageError = () => {\n    setImageLoading(false);\n    setImageError(true);\n    onError?.();\n  };\n\n  const handleClick = (e) => {\n    if (clickable || onClick) {\n      onClick?.(e);\n    }\n  };\n\n  // Determinar contedo a ser exibido\n  const shouldShowImage = src && !imageError && !loading;\n  const shouldShowInitials = !shouldShowImage && initials && !error;\n  const shouldShowIcon = !shouldShowImage && !shouldShowInitials && !error;\n\n  // Classes base\n  const baseClasses = `\n    ${sizeConfig.container}\n    ${shapeConfig}\n    ${variantConfig.border}\n    ${borderColor}\n    ${variantConfig.shadow}\n    ${clickable || onClick ? 'cursor-pointer' : ''}\n    ${variantConfig.hover}\n    transition-all duration-200\n    relative overflow-hidden\n    flex items-center justify-center\n    ${className}\n  `.trim().replace(/\\s+/g, ' ');\n\n  return (\n    <div \n      className={baseClasses}\n      style={customSize ? { width: customSize, height: customSize } : undefined}\n      onClick={handleClick}\n      role={clickable || onClick ? 'button' : undefined}\n      tabIndex={clickable || onClick ? 0 : undefined}\n      {...props}\n    >\n      {/* Estado de loading */}\n      {loading && (\n        <div className={`absolute inset-0 ${backgroundColor} flex items-center justify-center`}>\n          <span className=\"text-xs text-green-600\">Carregando...</span>\n        </div>\n      )}\n\n      {/* Imagem */}\n      {shouldShowImage && (\n        <img\n          src={src}\n          alt={alt || `Avatar de ${name}` || 'Avatar'}\n          className={`w-full h-full object-cover ${imageLoading ? 'opacity-0' : 'opacity-100'} transition-opacity duration-200`}\n          onLoad={handleImageLoad}\n          onError={handleImageError}\n          loading={lazy ? 'lazy' : 'eager'}\n          {...(priority && { fetchPriority: 'high' })}\n        />\n      )}\n\n      {/* Estado de loading da imagem */}\n      {imageLoading && shouldShowImage && (\n        <div className={`absolute inset-0 ${backgroundColor} flex items-center justify-center`}>\n          <span className=\"text-xs text-green-600\">Carregando...</span>\n        </div>\n      )}\n\n      {/* Iniciais */}\n      {shouldShowInitials && (\n        <span className={`${sizeConfig.text} font-semibold ${textColor}`}>\n          {initials}\n        </span>\n      )}\n\n      {/* cone de fallback */}\n      {shouldShowIcon && (\n        <FallbackIcon className={`${sizeConfig.icon} ${textColor}`} />\n      )}\n\n      {/* Estado de erro */}\n      {error && (\n        <div className={`absolute inset-0 ${backgroundColor} flex items-center justify-center`}>\n          <AlertCircle className={`${sizeConfig.icon} text-red-500`} />\n        </div>\n      )}\n\n      {/* Badge */}\n      {badge && (\n        <div className={`absolute ${badgeConfig.position} ${badgeConfig.size} ${badgeColor} rounded-full border-2 border-white`}>\n          {typeof badge === 'string' ? (\n            <span className=\"text-xs text-white font-bold flex items-center justify-center h-full\">\n              {badge}\n            </span>\n          ) : (\n            badge\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nAvatar.propTypes = {\n  // Props bsicas\n  src: PropTypes.string,\n  alt: PropTypes.string,\n  name: PropTypes.string,\n  \n  // Tamanhos\n  size: PropTypes.oneOf(['xs', 'small', 'medium', 'large', 'xlarge', 'xxlarge']),\n  customSize: PropTypes.string,\n  \n  // Forma e estilo\n  shape: PropTypes.oneOf(['circle', 'square', 'rounded', 'none']),\n  variant: PropTypes.oneOf(['default', 'minimal', 'flat', 'elevated']),\n  \n  // Estados e interaes\n  loading: PropTypes.bool,\n  error: PropTypes.bool,\n  clickable: PropTypes.bool,\n  \n  // Customizao visual\n  className: PropTypes.string,\n  borderColor: PropTypes.string,\n  backgroundColor: PropTypes.string,\n  textColor: PropTypes.string,\n  \n  // Funcionalidades avanadas\n  badge: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n  badgePosition: PropTypes.oneOf(['top-left', 'top-right', 'bottom-left', 'bottom-right', 'center']),\n  badgeColor: PropTypes.string,\n  badgeSize: PropTypes.oneOf(['small', 'medium', 'large']),\n  \n  // Callbacks\n  onClick: PropTypes.func,\n  onError: PropTypes.func,\n  onLoad: PropTypes.func,\n  \n  // Configuraes de fallback\n  fallbackIcon: PropTypes.oneOf(['user', 'alert', 'loading']),\n  showInitials: PropTypes.bool,\n  maxInitials: PropTypes.number,\n  \n  // Configuraes de imagem\n  lazy: PropTypes.bool,\n  priority: PropTypes.bool\n};\n\nexport default Avatar;\n","/**\n * Configuraes de temas para o componente Avatar\n * Facilita a customizao visual e mantm consistncia\n */\n\nexport const avatarThemes = {\n  // Tema padro (verde)\n  default: {\n    borderColor: 'border-green-200',\n    backgroundColor: 'bg-green-50',\n    textColor: 'text-green-700',\n    badgeColor: 'bg-green-500',\n    hoverBorderColor: 'hover:border-green-300'\n  },\n\n  // Tema professor (azul)\n  professor: {\n    borderColor: 'border-blue-200',\n    backgroundColor: 'bg-blue-50',\n    textColor: 'text-blue-700',\n    badgeColor: 'bg-blue-500',\n    hoverBorderColor: 'hover:border-blue-300'\n  },\n\n  // Tema escola (laranja)\n  escola: {\n    borderColor: 'border-orange-200',\n    backgroundColor: 'bg-orange-50',\n    textColor: 'text-orange-700',\n    badgeColor: 'bg-orange-500',\n    hoverBorderColor: 'hover:border-orange-300'\n  },\n\n  // Tema neutro (cinza)\n  neutral: {\n    borderColor: 'border-gray-200',\n    backgroundColor: 'bg-gray-50',\n    textColor: 'text-gray-700',\n    badgeColor: 'bg-gray-500',\n    hoverBorderColor: 'hover:border-gray-300'\n  },\n\n  // Tema indgena (marrom/terra)\n  indigena: {\n    borderColor: 'border-amber-200',\n    backgroundColor: 'bg-amber-50',\n    textColor: 'text-amber-800',\n    badgeColor: 'bg-amber-600',\n    hoverBorderColor: 'hover:border-amber-300'\n  },\n\n  // Tema sucesso (verde escuro)\n  success: {\n    borderColor: 'border-emerald-200',\n    backgroundColor: 'bg-emerald-50',\n    textColor: 'text-emerald-700',\n    badgeColor: 'bg-emerald-500',\n    hoverBorderColor: 'hover:border-emerald-300'\n  },\n\n  // Tema aviso (amarelo)\n  warning: {\n    borderColor: 'border-yellow-200',\n    backgroundColor: 'bg-yellow-50',\n    textColor: 'text-yellow-800',\n    badgeColor: 'bg-yellow-500',\n    hoverBorderColor: 'hover:border-yellow-300'\n  },\n\n  // Tema erro (vermelho)\n  error: {\n    borderColor: 'border-red-200',\n    backgroundColor: 'bg-red-50',\n    textColor: 'text-red-700',\n    badgeColor: 'bg-red-500',\n    hoverBorderColor: 'hover:border-red-300'\n  }\n};\n\n/**\n * Configuraes de tamanhos predefinidos\n */\nexport const avatarSizes = {\n  xs: 'w-6 h-6',\n  small: 'w-8 h-8',\n  medium: 'w-12 h-12 sm:w-16 sm:h-16',\n  large: 'w-16 h-16 sm:w-20 sm:h-20',\n  xlarge: 'w-20 h-20 sm:w-24 sm:h-24',\n  xxlarge: 'w-24 h-24 sm:w-32 sm:h-32'\n};\n\n/**\n * Configuraes de formas\n */\nexport const avatarShapes = {\n  circle: 'rounded-full',\n  square: 'rounded-lg',\n  rounded: 'rounded-xl',\n  none: 'rounded-none'\n};\n\n/**\n * Configuraes de variantes de estilo\n */\nexport const avatarVariants = {\n  default: {\n    border: 'border-2',\n    shadow: 'shadow-md',\n    hover: 'hover:shadow-lg'\n  },\n  minimal: {\n    border: 'border',\n    shadow: 'shadow-sm',\n    hover: 'hover:shadow-md'\n  },\n  flat: {\n    border: 'border-2',\n    shadow: 'shadow-none',\n    hover: 'hover:shadow-sm'\n  },\n  elevated: {\n    border: 'border-2',\n    shadow: 'shadow-lg',\n    hover: 'hover:shadow-xl'\n  }\n};\n\n/**\n * Configuraes de badges\n */\nexport const badgePositions = {\n  'top-left': 'top-0 left-0',\n  'top-right': 'top-0 right-0',\n  'bottom-left': 'bottom-0 left-0',\n  'bottom-right': 'bottom-0 right-0',\n  'center': 'top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2'\n};\n\nexport const badgeSizes = {\n  small: 'w-3 h-3',\n  medium: 'w-4 h-4',\n  large: 'w-5 h-5'\n};\n\n/**\n * Funo helper para aplicar tema\n */\nexport const applyTheme = (themeName, customTheme = {}) => {\n  const baseTheme = avatarThemes[themeName] || avatarThemes.default;\n  return { ...baseTheme, ...customTheme };\n};\n\n/**\n * Funo helper para gerar classes CSS do tema\n */\nexport const getThemeClasses = (theme) => {\n  return {\n    container: `${theme.borderColor} ${theme.backgroundColor} ${theme.hoverBorderColor}`,\n    text: theme.textColor,\n    badge: theme.badgeColor\n  };\n};\n\nconst AvatarThemeConfig = {\n  themes: avatarThemes,\n  sizes: avatarSizes,\n  shapes: avatarShapes,\n  variants: avatarVariants,\n  badgePositions,\n  badgeSizes,\n  applyTheme,\n  getThemeClasses\n};\n\nexport default AvatarThemeConfig;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Avatar from '../../shared/Avatar';\nimport { avatarThemes } from '../../shared/AvatarThemes';\nimport useImagePreloader from '../../../hooks/useImagePreloader';\n\nconst FotoProfessor = ({ \n  fotoUrl, \n  nomeProfessor, \n  tamanho = 'medium',\n  className = '',\n  showFallback = true,\n  // Novas props para customizao avanada\n  theme = 'professor',\n  variant = 'default',\n  shape = 'circle',\n  clickable = false,\n  badge,\n  badgePosition = 'bottom-right',\n  onClick,\n  onError,\n  onLoad,\n  // Props para compatibilidade com tamanhos antigos\n  size,\n  customSize,\n  // Props para preload\n  escolaId\n}) => {\n  // Mapear tamanhos antigos para novos\n  const sizeMapping = {\n    small: 'medium',\n    medium: 'large', \n    large: 'xlarge',\n    xlarge: 'xxlarge'\n  };\n\n  const mappedSize = size || sizeMapping[tamanho] || 'large';\n  \n  // Hook de preload de imagens\n  const { isImagePreloaded } = useImagePreloader(escolaId, !!escolaId);\n  \n  // Aplicar tema\n  const themeConfig = avatarThemes[theme] || avatarThemes.professor;\n  \n  // Se no h URL da foto e no deve mostrar fallback, no renderiza nada\n  if (!fotoUrl && !showFallback) {\n    return null;\n  }\n\n  return (\n    <Avatar\n      src={fotoUrl}\n      name={nomeProfessor}\n      alt={nomeProfessor ? `Foto de ${nomeProfessor}` : 'Foto do professor'}\n      size={customSize ? undefined : mappedSize}\n      customSize={customSize}\n      shape={shape}\n      variant={variant}\n      theme={theme}\n      clickable={clickable}\n      badge={badge}\n      badgePosition={badgePosition}\n      className={className}\n      onClick={onClick}\n      onError={onError}\n      onLoad={onLoad}\n      showInitials={true}\n      maxInitials={2}\n      fallbackIcon=\"user\"\n      lazy={!isImagePreloaded(fotoUrl)}\n      // Aplicar tema customizado\n      borderColor={themeConfig.borderColor}\n      backgroundColor={themeConfig.backgroundColor}\n      textColor={themeConfig.textColor}\n      badgeColor={themeConfig.badgeColor}\n    />\n  );\n};\n\nFotoProfessor.propTypes = {\n  // Props bsicas (compatibilidade)\n  fotoUrl: PropTypes.string,\n  nomeProfessor: PropTypes.string,\n  tamanho: PropTypes.oneOf(['small', 'medium', 'large', 'xlarge']),\n  className: PropTypes.string,\n  showFallback: PropTypes.bool,\n  \n  // Novas props para customizao avanada\n  theme: PropTypes.oneOf(['default', 'professor', 'escola', 'neutral', 'indigena', 'success', 'warning', 'error']),\n  variant: PropTypes.oneOf(['default', 'minimal', 'flat', 'elevated']),\n  shape: PropTypes.oneOf(['circle', 'square', 'rounded', 'none']),\n  clickable: PropTypes.bool,\n  badge: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n  badgePosition: PropTypes.oneOf(['top-left', 'top-right', 'bottom-left', 'bottom-right', 'center']),\n  onClick: PropTypes.func,\n  onError: PropTypes.func,\n  onLoad: PropTypes.func,\n  size: PropTypes.oneOf(['xs', 'small', 'medium', 'large', 'xlarge', 'xxlarge']),\n  escolaId: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n};\n\nexport default FotoProfessor;\n","import React, { memo, useEffect, useState, useCallback } from 'react';\nimport { ChevronLeft, ChevronRight, X } from 'lucide-react';\nimport { getHistoriasProfessor } from '../../../../services/historiaProfessorService';\nimport ImagemHistoriadoProfessor from '../ImagemHistoriadoProfessor';\nimport FotoProfessor from '../FotoProfessor';\nimport './HistoriadoProfessor.css';\n\nconst HistoriadoProfessor = memo(({ escola, refreshKey = 0, isMaximized = false }) => {\n  const [historias, setHistorias] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [currentHistoriaIndex, setCurrentHistoriaIndex] = useState(0);\n  const [imagemZoom, setImagemZoom] = useState(null);\n\n  const fecharZoom = useCallback(() => setImagemZoom(null), []);\n\n  // Fecha modal com tecla ESC\n  useEffect(() => {\n    const handleEsc = (e) => {\n      if (e.key === 'Escape') {\n        fecharZoom();\n      }\n    };\n    window.addEventListener('keydown', handleEsc);\n    return () => window.removeEventListener('keydown', handleEsc);\n  }, [fecharZoom]);\n\n  // Carregar histrias do professor\n  useEffect(() => {\n    if (!escola?.id) {\n      setLoading(false);\n      return;\n    }\n    const carregarHistorias = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        const data = await getHistoriasProfessor(escola.id);\n        setHistorias(data || []);\n        setCurrentHistoriaIndex(0);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    carregarHistorias();\n  }, [escola?.id, refreshKey]);\n\n  // Navegao entre histrias\n  const nextHistoria = useCallback(() => {\n    setCurrentHistoriaIndex(prev =>\n      prev < historias.length - 1 ? prev + 1 : 0\n    );\n  }, [historias.length]);\n\n  const prevHistoria = useCallback(() => {\n    setCurrentHistoriaIndex(prev =>\n      prev > 0 ? prev - 1 : historias.length - 1\n    );\n  }, [historias.length]);\n\n  // (sem dots laterais aqui; manter navegao simples local)\n\n  // Navegao com teclado\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (historias.length <= 1) return;\n      if (e.key === 'ArrowRight') {\n        nextHistoria();\n      } else if (e.key === 'ArrowLeft') {\n        prevHistoria();\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [historias.length, nextHistoria, prevHistoria]);\n\n  if (loading) {\n    return (\n      <div className=\"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-green-100/50\">\n        <div className=\"flex items-center justify-center py-8\">\n          <span className=\"ml-2 text-gray-600\">Carregando histrias do professor...</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-red-100/50\">\n        <div className=\"text-center py-8\">\n          <p className=\"text-red-600\">Erro ao carregar histrias do professor: {error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!historias.length) {\n    return null;\n  }\n\n  const currentHistoria = historias[currentHistoriaIndex];\n  const hasMultipleHistorias = historias.length > 1;\n\n  return (\n    <div className=\"mt-8 mb-12 flex flex-col items-center w-full\">\n      {/* Header externo ao card - mantm largura mxima sempre */}\n      <header className=\"historia-professor-header mb-6 sm:mb-8 w-full max-w-4xl mx-auto\">\n        <div className=\"flex items-center justify-between mb-3 sm:mb-4\">\n          <div className=\"flex items-center gap-3\">\n            <span className=\"bg-green-200 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28\">\n              <img \n                src={`${process.env.PUBLIC_URL}/passaro.svg`} \n                alt=\"cone de pssaro\" \n                className=\"w-12 h-12 sm:w-24 sm:h-24\" \n                style={{ \n                  filter: 'none', \n                  borderRadius: '0', \n                  boxShadow: 'none', \n                  margin: '0',\n                  padding: '0',\n                  border: 'none',\n                  outline: 'none'\n                }}\n                aria-hidden=\"true\"\n              />\n            </span>\n            <h2 className=\"text-xl sm:text-2xl font-bold text-black m-0\">\n              Depoimento dos Professores\n            </h2>\n          </div>\n          {hasMultipleHistorias && (\n            <div className=\"flex items-center gap-2 text-sm text-gray-600\">\n              <span>{currentHistoriaIndex + 1} de {historias.length}</span>\n            </div>\n          )}\n        </div>\n        <div className=\"h-1 w-20 sm:w-24 bg-green-300 rounded-full\" />\n      </header>\n\n      {/* Card com contedo - mantm largura mxima sempre */}\n      <article\n        className=\"\n          px-4 sm:px-6 md:px-8 py-6\n          bg-white rounded-2xl shadow-lg\n          prose prose-sm sm:prose-base md:prose-lg lg:prose-xl\n          prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify\n          prose-img:rounded-xl prose-img:shadow-lg\n          prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600\n          max-w-4xl mx-auto w-full\n        \"\n      >\n\n      {/* Contedo da histria atual */}\n      <section className=\"text-base sm:text-lg leading-relaxed text-neutral-800\">\n        {currentHistoria.nome_professor && (\n          <div className=\"flex flex-col items-center mb-6\">\n            <div className=\"flex-shrink-0\">\n              <FotoProfessor \n                fotoUrl={currentHistoria.foto_rosto}\n                nomeProfessor={currentHistoria.nome_professor}\n                customSize=\"200px\"\n                className=\"shadow-lg\"\n                escolaId={escola.id}\n              />\n            </div>\n            <div className=\"w-full text-center\">\n              <h3 className=\"text-xl sm:text-2xl font-bold text-green-800 mb-4 m-0\">\n                {currentHistoria.nome_professor}\n              </h3>\n              <div \n                className=\"historia-professor-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none\n                  prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify\n                  prose-img:rounded-xl prose-img:shadow-lg\n                  prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600\n                  prose-strong:text-green-800 prose-em:text-green-700\n                  prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg\n                  prose-ul:text-black prose-ol:text-black prose-li:text-black\n                  prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm\"\n                dangerouslySetInnerHTML={{ __html: currentHistoria.historia }}\n              />\n            </div>\n          </div>\n        )}\n        {!currentHistoria.nome_professor && (\n          <div \n            className=\"historia-professor-content prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none\n              prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify\n              prose-img:rounded-xl prose-img:shadow-lg\n              prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600\n              prose-strong:text-green-800 prose-em:text-green-700\n              prose-blockquote:border-l-green-300 prose-blockquote:bg-green-50 prose-blockquote:pl-4 prose-blockquote:py-2 prose-blockquote:rounded-r-lg\n              prose-ul:text-black prose-ol:text-black prose-li:text-black\n              prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm\"\n            dangerouslySetInnerHTML={{ __html: currentHistoria.historia }}\n          />\n        )}\n        {currentHistoria.imagem_public_url && (\n          <figure className=\"my-6\">\n            <div className=\"relative\">\n              <img\n                src={currentHistoria.imagem_public_url}\n                alt={currentHistoria.descricao_imagem || 'Imagem da histria do professor'}\n                className=\"w-full max-w-2xl mx-auto rounded-xl shadow-lg cursor-pointer transition-transform duration-200 hover:scale-105\"\n                onClick={() => setImagemZoom(currentHistoria)}\n                loading=\"lazy\"\n              />\n              {currentHistoria.descricao_imagem && (\n                <figcaption className=\"text-center text-sm text-gray-600 mt-2\">\n                  {currentHistoria.descricao_imagem}\n                </figcaption>\n              )}\n            </div>\n          </figure>\n        )}\n      </section>\n\n      {/* Navegao entre histrias */}\n      {hasMultipleHistorias && (\n        <div className=\"flex items-center justify-between mt-8 pt-6 border-t border-gray-200\">\n          <button\n            onClick={prevHistoria}\n            className=\"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors\"\n            aria-label=\"Histria anterior\"\n          >\n            <ChevronLeft className=\"w-5 h-5\" />\n            <span className=\"hidden sm:inline\">Anterior</span>\n          </button>\n          <div className=\"flex gap-2\">\n            {historias.map((_, index) => (\n              <button\n                key={index}\n                onClick={() => setCurrentHistoriaIndex(index)}\n                className={`w-3 h-3 rounded-full border-2 ${index === currentHistoriaIndex ? 'bg-green-600 border-green-600' : 'bg-white border-gray-300'} transition-colors`}\n                aria-label={`Ir para histria ${index + 1}`}\n              />\n            ))}\n          </div>\n          <button\n            onClick={nextHistoria}\n            className=\"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors\"\n            aria-label=\"Prxima histria\"\n          >\n            <span className=\"hidden sm:inline\">Prxima</span>\n            <ChevronRight className=\"w-5 h-5\" />\n          </button>\n        </div>\n      )}\n\n      {/* Modal de zoom da imagem */}\n      {imagemZoom && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90\" onClick={fecharZoom}>\n          <div className=\"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center p-4\" onClick={e => e.stopPropagation()}>\n            <button\n              className=\"absolute top-4 right-4 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-80 z-10\"\n              onClick={fecharZoom}\n              aria-label=\"Fechar zoom\"\n            >\n              <X className=\"w-6 h-6\" />\n            </button>\n            <img\n              src={imagemZoom.imagem_public_url}\n              alt={imagemZoom.descricao_imagem || 'Imagem da histria do professor'}\n              className=\"max-w-full max-h-full object-contain rounded-xl shadow-2xl border-4 border-white\"\n            />\n            {imagemZoom.descricao_imagem && (\n              <figcaption className=\"absolute bottom-4 left-1/2 -translate-x-1/2 text-center text-sm text-white bg-black bg-opacity-50 rounded-lg px-3 py-1.5 max-w-2xl\">\n                {imagemZoom.descricao_imagem}\n              </figcaption>\n            )}\n          </div>\n        </div>\n      )}\n\n        <ImagemHistoriadoProfessor escola_id={escola.id} refreshKey={refreshKey} isMaximized={isMaximized} />\n      </article>\n    </div>\n  );\n});\n\nexport default HistoriadoProfessor;\n","import React, { useEffect, useState, useRef, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { RefreshCw } from 'lucide-react';\nimport { getLegendaByImageUrlFlexivel } from '../../../services/legendasService';\nimport { supabase } from '../../../supabaseClient';\nimport ReusableImageZoom from '../../ReusableImageZoom';\nimport OptimizedImage from '../../shared/OptimizedImage';\nimport useImagePreloader from '../../../hooks/useImagePreloader';\nimport '../../ReusableImageZoom.css';\n\nconst ImagensdasEscolas = ({ escola_id, refreshKey = 0, isMaximized = false }) => {\n  const [imagens, setImagens] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [imagemZoom, setImagemZoom] = useState(null);\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n  const [error, setError] = useState('');\n  const cacheRef = useRef({});\n  const [cacheVersion, setCacheVersion] = useState(0); // Para forar recarga\n\n  // Hook de preload de imagens\n  const { isImagePreloaded } = useImagePreloader(escola_id, true);\n\n  // Funo para limpar cache e recarregar\n  const limparCacheERecarregar = useCallback(() => {\n    console.log('Limpando cache e recarregando imagens...');\n    cacheRef.current = {};\n    setCacheVersion(prev => prev + 1);\n  }, []);\n\n  // Forar recarga quando refreshKey mudar\n  useEffect(() => {\n    if (refreshKey > 0) {\n      console.log('ImagensdasEscolas: refreshKey mudou, forando recarga');\n      limparCacheERecarregar();\n    }\n  }, [refreshKey, limparCacheERecarregar]);\n\n  const fecharZoom = useCallback(() => {\n    setImagemZoom(null);\n    setCurrentImageIndex(0);\n    document.body.style.overflow = 'auto';\n  }, []);\n\n  // ESC para fechar\n  useEffect(() => {\n    const handleEsc = (e) => {\n      if (e.key === 'Escape') fecharZoom();\n    };\n    window.addEventListener('keydown', handleEsc);\n    return () => window.removeEventListener('keydown', handleEsc);\n  }, [fecharZoom]);\n\n\n  useEffect(() => {\n    if (!escola_id) {\n      setLoading(false);\n      return;\n    }\n\n    // Verificar se h cache vlido (com verso)\n    const cacheKey = `${escola_id}_v${cacheVersion}`;\n    if (cacheRef.current[cacheKey]) {\n      console.log('Usando cache para escola', escola_id);\n      setImagens(cacheRef.current[cacheKey]);\n      setLoading(false);\n      return;\n    }\n\n    const buscarImagens = async () => {\n      console.log('Buscando imagens para escola', escola_id);\n      \n      try {\n        // Usar a mesma abordagem do painel de edio: listar arquivos do bucket\n        const { data: files, error } = await supabase.storage\n          .from('imagens-das-escolas')\n          .list(`${escola_id}/`);\n\n        if (error) {\n          throw error;\n        }\n\n        if (!files || files.length === 0) {\n          console.log('Nenhum arquivo encontrado para escola', escola_id);\n          setImagens([]);\n          setLoading(false);\n          return;\n        }\n\n        console.log('Arquivos encontrados:', files.length);\n\n        // Processar cada arquivo encontrado\n        const imagensEncontradas = await Promise.all(\n          files.map(async (file, index) => {\n            const filePath = `${escola_id}/${file.name}`;\n            const { data: { publicUrl } } = supabase.storage\n              .from('imagens-das-escolas')\n              .getPublicUrl(filePath);\n\n            // Buscar legenda da nova tabela (busca flexvel)\n            let legenda = null;\n            try {\n              console.log('Buscando legenda para:', filePath);\n              legenda = await getLegendaByImageUrlFlexivel(filePath, escola_id, {\n                categoria: 'escola',\n                tipo_foto: 'escola'\n              });\n              console.log('Legenda encontrada:', legenda);\n            } catch (error) {\n              console.warn('Erro ao buscar legenda para', filePath, ':', error);\n            }\n\n            return {\n              id: `${escola_id}-${file.name}`,\n              publicURL: publicUrl,\n              descricao: legenda?.legenda || `Imagem ${index + 1}`,\n              descricaoDetalhada: legenda?.descricao_detalhada,\n              autor: legenda?.autor_foto,\n              dataFoto: legenda?.data_foto,\n              categoria: legenda?.categoria,\n              urlError: null,\n            };\n          })\n        );\n\n        console.log('Imagens processadas:', imagensEncontradas.length);\n        \n        // Salvar no cache com verso\n        cacheRef.current[cacheKey] = imagensEncontradas;\n        setImagens(imagensEncontradas);\n        \n        if (imagensEncontradas.length === 0) {\n          setError('Nenhuma imagem encontrada para esta escola.');\n        }\n      } catch (error) {\n        console.error('Erro ao processar imagens:', error);\n        setError('Erro ao carregar imagens da escola.');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    buscarImagens();\n  }, [escola_id, cacheVersion]);\n\n  if (loading) {\n    return (\n      <div className=\"text-gray-500 flex items-center gap-2\">\n        Carregando imagens da escola...\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-red-600 flex items-center gap-2\">\n        <span>{error}</span>\n        <button \n          onClick={limparCacheERecarregar}\n          className=\"text-blue-600 hover:text-blue-800\"\n          title=\"Tentar novamente\"\n        >\n          <RefreshCw className=\"w-5 h-5\" />\n        </button>\n      </div>\n    );\n  }\n\n  if (!imagens.length) {\n    return (\n      <div className=\"text-yellow-700 flex items-center gap-2\">\n        <span>Nenhuma imagem encontrada para esta escola.</span>\n        <button \n          onClick={limparCacheERecarregar}\n          className=\"text-blue-600 hover:text-blue-800\"\n          title=\"Tentar novamente\"\n        >\n          <RefreshCw className=\"w-5 h-5\" />\n        </button>\n      </div>\n    );\n  }\n\n  // Don't show thumbnails when maximized (images are shown in sidebar)\n  if (isMaximized) {\n    return null;\n  }\n\n  return (\n    <section className=\"my-6\">\n      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n        {imagens.map((img) => (\n          <figure\n            key={img.id}\n            className=\"rounded-lg overflow-hidden bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md\"\n            onClick={() => {\n              if (img.publicURL) {\n                const index = imagens.findIndex(i => i.publicURL === img.publicURL);\n                setCurrentImageIndex(index);\n                setImagemZoom(img);\n              }\n            }}\n          >\n            <div className=\"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center\">\n              <OptimizedImage\n                src={img.publicURL}\n                alt={img.descricao}\n                className=\"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105\"\n                isPreloaded={isImagePreloaded(img.publicURL)}\n                style={{ maxHeight: '350px' }}\n              />\n            </div>\n            \n            {/* Legenda da imagem */}\n            {img.descricao && (\n              <figcaption className=\"p-3 bg-white\">\n                <h4 className=\"font-medium text-gray-900 text-sm mb-1\">\n                  {img.descricao}\n                </h4>\n                \n                {/* Informaes adicionais */}\n                <div className=\"flex items-center gap-4 text-xs text-gray-500\">\n                  {img.categoria && (\n                    <span className=\"capitalize bg-gray-100 px-2 py-1 rounded\">\n                      {img.categoria}\n                    </span>\n                  )}\n                  {img.autor && (\n                    <span>Por: {img.autor}</span>\n                  )}\n                  {img.dataFoto && (\n                    <span>{new Date(img.dataFoto).toLocaleDateString('pt-BR')}</span>\n                  )}\n                </div>\n                \n                {/* Descrio detalhada */}\n                {img.descricaoDetalhada && (\n                  <p className=\"text-xs text-gray-600 mt-2 line-clamp-2\">\n                    {img.descricaoDetalhada}\n                  </p>\n                )}\n              </figcaption>\n            )}\n          </figure>\n        ))}\n      </div>\n\n      {/* Modal de Zoom Reutilizvel */}\n      <ReusableImageZoom\n        images={imagens}\n        currentImageIndex={currentImageIndex}\n        isOpen={!!imagemZoom}\n        onClose={fecharZoom}\n        onImageChange={setCurrentImageIndex}\n        showNavigation={true}\n        showControls={true}\n        showCounter={true}\n        showCaption={true}\n      />\n    </section>\n  );\n};\n\nImagensdasEscolas.propTypes = {\n  escola_id: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  refreshKey: PropTypes.number,\n};\n\nexport default React.memo(ImagensdasEscolas);\n","import React, { memo } from 'react';\n\n// Import all section components\nimport BasicInfo from './BasicInfo';\nimport HistoriaEscola from './HistoriaEscola';\n// import PovosLinguas from './PovosLinguas';\nimport Modalidades from './Modalidades';\nimport Infraestrutura from './Infraestrutura';\nimport GestaoProfessores from './GestaoProfessores';\nimport ProjetosParcerias from './ProjetosParcerias';\n// import ImagemHistoriadoProfessor from '../ImagemHistoriadoProfessor';\nimport HistoriadoProfessor from './HistoriadoProfessor';\nimport ImagensdasEscolas from '../ImagensdasEscolas';\n\n// CSS para layout Masonry real usando CSS columns\nconst masonryStyles = `\n  .masonry-grid {\n    column-count: 1;\n    column-gap: 1.5rem;\n    column-fill: balance;\n  }\n  \n  .masonry-grid > * {\n    display: block;\n    break-inside: avoid;\n    page-break-inside: avoid;\n    margin-bottom: 1.5rem;\n  }\n  \n  /* Mobile: 1 coluna */\n  @media (max-width: 767px) {\n    .masonry-grid {\n      column-count: 1;\n    }\n  }\n  \n  /* Tablet e Desktop: 2 colunas */\n  @media (min-width: 768px) {\n    .masonry-grid {\n      column-count: 2;\n    }\n  }\n`;\n\n// Componente wrapper para o grid\nconst GridLayoutWrapper = memo(({ children, shouldUseGrid }) => {\n  const containerClasses = shouldUseGrid\n    ? 'masonry-grid'\n    : 'space-y-4';\n\n  return (\n    <>\n      <style>{masonryStyles}</style>\n      <div className={`${containerClasses} transition-all duration-300 ease-in-out`}>\n        {children}\n      </div>\n    </>\n  );\n});\n\nconst EscolaInfo = memo(({ escola, shouldUseGrid = false, refreshKey = 0, sectionRefs, isMaximized = false }) => {\n  console.log(\"EscolaInfo recebeu:\", escola);\n  \n  if (!escola) {\n    console.log(\"EscolaInfo: escola  null ou undefined\");\n    return null;\n  }\n\n  // Componentes que sero renderizados no grid\n  const gridSections = [\n    { Component: BasicInfo, props: { escola } },\n    // { Component: PovosLinguas, props: { escola } },\n    { Component: Modalidades, props: { escola } },\n    { Component: Infraestrutura, props: { escola } },\n    { Component: GestaoProfessores, props: { escola } },\n    { Component: ProjetosParcerias, props: { escola } }\n  ];\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Grid de cards */}\n      <div ref={(el) => sectionRefs && (sectionRefs.dados = el)}>\n        <GridLayoutWrapper shouldUseGrid={shouldUseGrid}>\n          {gridSections.map(({ Component, props }, index) => (\n            <Component key={index} {...props} />\n          ))}\n        </GridLayoutWrapper>\n      </div>\n\n      {/* Histria da Escola em destaque */}\n      <div ref={(el) => sectionRefs && (sectionRefs.historia = el)}>\n        <HistoriaEscola escola={escola} refreshKey={refreshKey} isMaximized={isMaximized} />\n      </div>\n      \n      {/* Imagens da escola, agora renderizadas independentemente da histria */}\n      <ImagensdasEscolas escola_id={escola.id} refreshKey={refreshKey} isMaximized={isMaximized} />\n\n      <div ref={(el) => sectionRefs && (sectionRefs.depoimentos = el)}>\n        <HistoriadoProfessor escola={escola} refreshKey={refreshKey} isMaximized={isMaximized} />\n      </div>\n    </div>\n  );\n});\n\nexport default EscolaInfo; ","import React from 'react';\n\nconst HandFistIcon = ({ className = 'w-5 h-5', ...props }) => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 256 256\"\n    fill=\"currentColor\"\n    className={className}\n    {...props}\n  >\n    <path d=\"M200,80H184V64a32,32,0,0,0-56-21.13A32,32,0,0,0,72.21,60.42,32,32,0,0,0,24,88v40a104,104,0,0,0,208,0V112A32,32,0,0,0,200,80ZM152,48a16,16,0,0,1,16,16V80H136V64A16,16,0,0,1,152,48ZM88,64a16,16,0,0,1,32,0v40a16,16,0,0,1-32,0ZM40,88a16,16,0,0,1,32,0v16a16,16,0,0,1-32,0Zm176,40a88,88,0,0,1-175.92,3.75A31.93,31.93,0,0,0,80,125.13a31.93,31.93,0,0,0,44.58,3.35,32.21,32.21,0,0,0,11.8,11.44A47.88,47.88,0,0,0,120,176a8,8,0,0,0,16,0,32,32,0,0,1,32-32,8,8,0,0,0,0-16H152a16,16,0,0,1-16-16V96h64a16,16,0,0,1,16,16Z\" />\n  </svg>\n);\n\nexport default HandFistIcon; ","import React, { memo } from 'react';\n\nconst InfoItem = memo(({ label, value, className = '', isTextArea = false }) => {\n  if (!value) return null;\n\n  const isFlexLayout = className.includes('flex flex-col');\n  const baseClasses = isFlexLayout \n    ? 'flex flex-col gap-1 text-sm py-0.5'\n    : 'grid grid-cols-[auto,1fr] gap-x-2 text-sm py-0.5';\n\n  return (\n    <div className={`${baseClasses} ${className}`}>\n      <span className=\"font-medium text-neutral-800\">{label}:</span>\n      {isTextArea ? (\n        <div className=\"text-neutral-600\">\n          <div className=\"whitespace-pre-wrap break-words text-sm leading-relaxed\">\n            {value}\n          </div>\n        </div>\n      ) : (\n        <span className=\"text-neutral-600 break-words\">{value}</span>\n      )}\n    </div>\n  );\n});\n\nexport default InfoItem; ","import React, { memo } from 'react';\nimport HandFistIcon from './icons/HandFistIcon';\nimport InfoSection from './components/InfoSection';\nimport InfoItem from './components/InfoItem';\n\n// Wrapper para passar className maior ao cone\nconst LargeHandFistIcon = (props) => <HandFistIcon className=\"w-8 h-8\" {...props} />;\n\nconst TerraIndigenaInfo = memo(({ terraIndigena }) => {\n  if (!terraIndigena) {\n    console.log(\"TerraIndigenaInfo: terraIndigena  null ou undefined\");\n    return null;\n  }\n\n  const formatarSuperficie = () => {\n    return terraIndigena.superficie ? \n      `Superfcie: ${parseFloat(terraIndigena.superficie).toFixed(2)} ha` : null;\n  };\n\n  const formatarLocalizacao = () => {\n    return `${terraIndigena.municipio || ''}, ${terraIndigena.uf || ''}`.trim();\n  };\n\n  return (\n    <InfoSection title=\"Informaes da Terra Indgena\" icon={LargeHandFistIcon}>\n      <InfoItem label=\"Povos Indgenas\" value={terraIndigena.etnia} />\n      <InfoItem label=\"Localizao\" value={formatarLocalizacao()} />\n      <InfoItem label=\"Superfcie\" value={formatarSuperficie()} />\n      <InfoItem label=\"Fase\" value={terraIndigena.fase} />\n      <InfoItem label=\"Modalidade\" value={terraIndigena.modalidade} />\n      <InfoItem label=\"Reestudo\" value={terraIndigena.reestudo} />\n      <InfoItem label=\"Coordenao Regional\" value={terraIndigena.cr} />\n      <InfoItem label=\"Faixa de Fronteira\" value={terraIndigena.faixa_fron} />\n      <InfoItem label=\"Unidade Administrativa\" value={terraIndigena.undadm_nom} />\n      <InfoItem label=\"Sigla Unidade\" value={terraIndigena.undadm_sig} />\n      <InfoItem label=\"Domnio\" value={terraIndigena.dominio_un} />\n      <InfoItem label=\"Data de Atualizao\" value={terraIndigena.data_atual} />\n      <InfoItem label=\"Cdigo Terra Indgena\" value={terraIndigena.terrai_cod} />\n      <InfoItem label=\"Cdigo Unidade Administrativa\" value={terraIndigena.undadm_cod} />\n    </InfoSection>\n  );\n});\n\nexport default TerraIndigenaInfo; ","import React, { useMemo } from \"react\";\nimport DOMPurify from \"dompurify\";\n\n/**\n * Componente PainelDescricao - Exibe contedo formatado com sanitizao HTML\n * \n * @param {Object} props - Propriedades do componente\n * @param {string} props.descricao - Texto HTML ou texto puro a ser exibido\n * @param {string} props.className - Classes CSS adicionais (opcional)\n * @returns {React.ReactElement|null} - Componente renderizado ou null\n */\nconst PainelDescricao = ({ descricao, className = \"\" }) => {\n  // Funo para formatar o texto com quebras de linha\n  const formatText = (text) => {\n    if (!text) return \"\";\n    \n    // Preserva pargrafos convertendo linhas duplas em tags <p>\n    let formattedText = text.replace(/\\n\\n+/g, \"</p><p>\");\n    \n    // Substitui quebras de linha simples por <br>\n    formattedText = formattedText.replace(/\\n/g, \"<br>\");\n    \n    // Adiciona tags <p> no incio e fim se no existirem\n    if (!formattedText.startsWith(\"<p>\")) {\n      formattedText = \"<p>\" + formattedText;\n    }\n    if (!formattedText.endsWith(\"</p>\")) {\n      formattedText = formattedText + \"</p>\";\n    }\n    \n    // Remove espaos extras entre tags HTML\n    formattedText = formattedText.replace(/>\\s+</g, \"><\");\n    \n    return formattedText;\n  };\n\n  // Usa useMemo para evitar sanitizao redundante em re-renders\n  const sanitizedHTML = useMemo(() => {\n    if (!descricao) return \"\";\n    \n    return DOMPurify.sanitize(formatText(descricao), {\n      ALLOWED_TAGS: [\n        'b', 'i', 'em', 'strong', 'a', 'p', 'br', 'ul', 'ol', 'li',\n        'div', 'span', 'img', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6',\n        'center', 'blockquote', 'code', 'pre', 'hr', 'table', 'thead', \n        'tbody', 'tr', 'th', 'td'\n      ],\n      ALLOWED_ATTR: [\n        'href', 'target', 'rel', 'class', 'style', 'src', 'alt',\n        'width', 'height', 'id', 'title', 'aria-label', 'aria-describedby'\n      ],\n      ADD_TAGS: ['center', 'blockquote'],\n      ADD_ATTR: ['target', 'className', 'title'],\n      KEEP_CONTENT: true,\n      ALLOW_DATA_ATTR: false\n    });\n  }, [descricao]);\n\n  if (!descricao) return null;\n\n  return (\n    <div className={`mb-6 ${className}`}>\n      <div\n        className=\"prose prose-lg lg:prose-xl max-w-none px-1\"\n        style={{\n          '--tw-prose-body': '#1f2937',\n          '--tw-prose-headings': '#111827',\n          '--tw-prose-links': '#059669',\n          '--tw-prose-bold': '#111827',\n          '--tw-prose-counters': '#1f2937',\n          '--tw-prose-bullets': '#4b5563',\n          '--tw-prose-hr': '#e5e7eb',\n          '--tw-prose-quotes': '#111827',\n          '--tw-prose-quote-borders': '#10b981',\n          '--tw-prose-captions': '#6b7280',\n          '--tw-prose-code': '#111827',\n          '--tw-prose-pre-code': '#e5e7eb',\n          '--tw-prose-pre-bg': '#1f2937',\n          '--tw-prose-th-borders': '#d1d5db',\n          '--tw-prose-td-borders': '#e5e7eb',\n          lineHeight: '1.8',\n          fontSize: '1.125rem',\n          fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\n          letterSpacing: '0.015em',\n        }}\n        dangerouslySetInnerHTML={{ __html: sanitizedHTML }}\n        aria-live=\"polite\"\n      />\n    </div>\n  );\n};\n\nexport default React.memo(PainelDescricao);","import React, { memo } from 'react';\nimport PainelDescricao from '../PainelDescricao';\n\nconst IntroPanel = memo(({ painelInfo }) => (\n  <div className=\"space-y-6\">\n    <div className=\"prose prose-lg lg:prose-xl max-w-none\">\n      <div className=\"bg-green-100 rounded-lg p-6\">\n        <PainelDescricao descricao={painelInfo.descricao_detalhada} />\n      </div>\n    </div>\n    {painelInfo.audioUrl && (\n      <div className=\"mt-6\">\n        <audio controls className=\"w-full\">\n          <source src={painelInfo.audioUrl} type=\"audio/mpeg\" />\n          Seu navegador no suporta o elemento de udio.\n        </audio>\n      </div>\n    )}\n  </div>\n));\n\nexport default IntroPanel; ","/**\n * Utility functions for text formatting\n */\n\n/**\n * Lista de siglas que devem permanecer em maisculas\n */\nconst SIGLAS_MAIUSCULAS = ['EE', 'EEI'];\n\n/**\n * Capitalizes the first letter of each word in a string, keeping specific acronyms in uppercase\n * @param {string} str - The string to capitalize\n * @returns {string} The capitalized string\n */\nexport const capitalizeWords = (str) => {\n  if (!str || typeof str !== 'string') return '';\n  \n  // Primeiro, divide a string em palavras\n  const words = str.split(/\\s+/);\n  \n  // Processa cada palavra\n  const processedWords = words.map(word => {\n    // Verifica se a palavra  uma sigla que deve permanecer em maisculas\n    if (SIGLAS_MAIUSCULAS.includes(word.toUpperCase())) {\n      return word.toUpperCase();\n    }\n    \n    // Para outras palavras, aplica a capitalizao normal\n    return word.charAt(0).toUpperCase() + word.substr(1).toLowerCase();\n  });\n  \n  // Junta as palavras de volta em uma string\n  return processedWords.join(' ');\n}; \n\n/**\n * Normalizes an address string by capitalizing words and handling common address abbreviations\n * @param {string} address - The address string to normalize\n * @returns {string} The normalized address string\n */\nexport const normalizeAddress = (address) => {\n  if (!address || typeof address !== 'string') return '';\n\n  // Lista de abreviaes comuns em endereos\n  const abbreviations = {\n    'r.': 'Rua',\n    'av.': 'Avenida',\n    'al.': 'Alameda',\n    'pr.': 'Praa',\n    'tr.': 'Travessa',\n    'rod.': 'Rodovia',\n    'est.': 'Estrada',\n    'n.': 'Nmero',\n    'n': 'Nmero',\n    'apt.': 'Apartamento',\n    'bl.': 'Bloco',\n    'qd.': 'Quadra',\n    'lt.': 'Lote',\n    'km': 'KM',\n    's/n': 'S/N'\n  };\n\n  // Primeiro, substitui as abreviaes\n  let normalized = address.toLowerCase();\n  Object.entries(abbreviations).forEach(([abbr, full]) => {\n    normalized = normalized.replace(new RegExp(`\\\\b${abbr}\\\\b`, 'g'), full);\n  });\n\n  // Depois aplica a capitalizao de palavras\n  return capitalizeWords(normalized);\n}; ","import React from \"react\";\nimport { X, Maximize2, Minimize2, MapPin } from \"lucide-react\";\nimport { capitalizeWords } from \"../utils/textFormatting\";\nimport MinimalShareButtons from \"./MinimalShareButtons\";\n\n// Funo para formatar o ttulo da escola\nconst formatarTituloEscola = (titulo) => {\n  if (!titulo) return '';\n  \n  // Converter para minsculas para facilitar a busca\n  const tituloLower = titulo.toLowerCase();\n  \n  // Verificar se contm \"escola estadual\" e \"aldeia\"\n  if (tituloLower.includes('escola estadual') && tituloLower.includes('aldeia')) {\n    // Extrair o nome da aldeia (parte aps \"aldeia\")\n    const partes = titulo.split(' ');\n    const indiceAldeia = partes.findIndex(parte => \n      parte.toLowerCase().includes('aldeia')\n    );\n    \n    if (indiceAldeia !== -1 && indiceAldeia < partes.length - 1) {\n      // Pegar a parte da aldeia (pode ter mais de uma palavra)\n      const nomeAldeia = partes.slice(indiceAldeia + 1).join(' ');\n      return `E.E.I ${capitalizeWords(nomeAldeia)}`;\n    }\n  }\n  \n  // Se no conseguir formatar, retorna o ttulo original capitalizado\n  return capitalizeWords(titulo);\n};\n\nconst PainelHeader = ({ titulo, closePainel, toggleMaximize, isMaximized, imagemHeader, shareUrl, shareTitle }) => {\n  const isMobile = window.innerWidth <= 768;\n  const isMobileLandscape = isMobile && window.innerWidth > window.innerHeight;\n  const isVerySmallLandscape = isMobileLandscape && window.innerWidth <= 850;\n\n  const headerHalfClass = (!isMobile && isMaximized) ? 'mj-header-half-right' : '';\n\n  return (\n    <header className={`relative border-b border-green-100 ${isMobileLandscape ? 'min-h-[60px]' : ''}`}>\n      <div className={`px-3 sm:px-4 md:px-6 lg:px-8 py-2 sm:py-2 md:py-3 ${headerHalfClass}`}>\n        <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between pr-12\">\n          {/* School title - occupies only right half when maximized */}\n          <div className=\"space-y-1\">\n            <h2 \n              id=\"painel-titulo\"\n              className={`font-bold text-gray-900 leading-tight tracking-tight break-words ${\n                isVerySmallLandscape\n                  ? 'text-lg' // Aumentado de text-base\n                  : isMobileLandscape \n                    ? 'text-xl sm:text-2xl' // Aumentado de text-lg sm:text-xl\n                    : 'text-2xl sm:text-3xl md:text-4xl' // Aumentado de text-xl sm:text-2xl md:text-3xl\n              }`}\n              style={isVerySmallLandscape ? { fontSize: 'clamp(1.125rem, 4.5vw, 1.5rem)' } : {}}\n            >\n              {formatarTituloEscola(titulo)}\n            </h2>\n            \n            {/* Subttulo decorativo */}\n            <div className=\"flex items-center space-x-2 text-gray-600\">\n              <MapPin className=\"w-3 h-3\" /> {/* Diminudo de w-4 h-4 */}\n              <span className=\"text-xs sm:text-sm font-medium\"> {/* Diminudo de text-sm sm:text-base */}\n                Escola Estadual Indgena\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"absolute top-2 sm:top-4 right-2 sm:right-4 flex items-center gap-3\">\n        {/* Sharing buttons - ArcGIS style */}\n        {shareUrl && (\n          <div className=\"linkSocialContainer\">\n            <MinimalShareButtons url={shareUrl} title={shareTitle || titulo} />\n          </div>\n        )}\n        \n        {!isMobile && (\n          <button\n            onClick={toggleMaximize}\n            className=\"p-2 text-green-700 hover:text-green-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2\"\n            aria-label={isMaximized ? \"Restaurar painel\" : \"Maximizar painel\"}\n            title={isMaximized ? \"Restaurar\" : \"Maximizar\"}\n          >\n            {isMaximized ? (\n              <Minimize2 size={18} className=\"stroke-2\" aria-hidden=\"true\" />\n            ) : (\n              <Maximize2 size={18} className=\"stroke-2\" aria-hidden=\"true\" />\n            )}\n          </button>\n        )}\n\n        <button\n          onClick={closePainel}\n          className={`text-gray-700 hover:text-gray-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ${\n            isMobileLandscape ? 'p-1.5' : 'p-2'\n          }`}\n          aria-label=\"Fechar painel\"\n        >\n          <X \n            size={isMobileLandscape ? 18 : 20} \n            aria-hidden=\"true\"\n            className=\"stroke-2\"\n          />\n        </button>\n      </div>\n    </header>\n  );\n};\n\nexport default PainelHeader;\n","import React, { useState } from 'react';\nimport OptimizedImage from '../../shared/OptimizedImage';\nimport './EscolaHeaderImage.css';\n\nconst EscolaHeaderImage = ({ imagemUrl, className = '', isPreloaded = false }) => {\n  const [imageError, setImageError] = useState(false);\n\n  const handleImageLoad = () => {\n    setImageError(false);\n  };\n\n  const handleImageError = () => {\n    setImageError(true);\n  };\n\n  // Se no h URL ou houve erro, no renderiza nada\n  if (!imagemUrl || imageError) {\n    return null;\n  }\n\n  return (\n    <div className={`escola-header-image escola-header-shimmer relative overflow-hidden ${className}`}>\n      {/* Imagem de fundo que rola com a pgina */}\n      <div className=\"absolute inset-0\">\n        <OptimizedImage\n          src={imagemUrl}\n          alt=\"Imagem da escola\"\n          className=\"w-full h-full object-cover transition-all duration-700 ease-out\"\n          isPreloaded={isPreloaded}\n          onLoad={handleImageLoad}\n          onError={handleImageError}\n        />\n      </div>\n\n      {/* Gradiente overlay mais sutil para preservar as cores */}\n      <div className=\"absolute inset-0 bg-gradient-to-br from-black/20 via-black/10 to-black/30\" />\n      <div className=\"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent\" />\n      \n      {/* Padro decorativo muito sutil */}\n      <div className=\"absolute inset-0 opacity-5\">\n        <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.05)_0%,transparent_50%)]\" />\n      </div>\n      \n      {/* Efeito de brilho muito sutil */}\n      <div className=\"absolute top-0 right-0 w-32 h-32 bg-gradient-radial from-white/5 to-transparent rounded-full blur-xl\"></div>\n    </div>\n  );\n};\n\nexport default EscolaHeaderImage;\n","import React, { useEffect, useMemo, useState, useCallback } from 'react';\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\nimport { supabase } from '../../../supabaseClient';\nimport { getLegendaByImageUrlFlexivel } from '../../../services/legendasService';\nimport OptimizedImage from '../../shared/OptimizedImage';\nimport useImagePreloader from '../../../hooks/useImagePreloader';\n\nconst SidebarMediaViewer = ({ escolaId, refreshKey = 0, showTeacher = true, showSchool = true, scrollProgress, headerUrl, onCurrentItemChange }) => {\n  const [items, setItems] = useState([]);\n  const [current, setCurrent] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const { isImagePreloaded } = useImagePreloader(escolaId, true);\n  const [manualOverrideUntil, setManualOverrideUntil] = useState(0);\n\n  const fetchBucketList = useCallback(async (bucket, categoria) => {\n    const { data: files, error: listErr } = await supabase.storage.from(bucket).list(`${escolaId}/`);\n    if (listErr) throw listErr;\n    if (!files || files.length === 0) return [];\n\n    const mapped = await Promise.all(\n      files.map(async (file, index) => {\n        const filePath = `${escolaId}/${file.name}`;\n        const { data: { publicUrl } } = supabase.storage.from(bucket).getPublicUrl(filePath);\n        let legenda = null;\n        try {\n          legenda = await getLegendaByImageUrlFlexivel(filePath, escolaId, {\n            categoria,\n            tipo_foto: categoria,\n          });\n        } catch (_) {}\n        return {\n          id: `${bucket}-${file.name}`,\n          url: publicUrl,\n          titulo: legenda?.legenda || `Imagem ${index + 1}`,\n          descricao: legenda?.descricao_detalhada || '',\n          autor: legenda?.autor_foto || '',\n          dataFoto: legenda?.data_foto || '',\n          origem: categoria,\n        };\n      })\n    );\n    return mapped;\n  }, [escolaId]);\n\n  useEffect(() => {\n    let mounted = true;\n    if (!escolaId) {\n      setItems([]);\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    setError('');\n    (async () => {\n      try {\n        const promises = [];\n        if (showSchool) promises.push(fetchBucketList('imagens-das-escolas', 'escola'));\n        if (showTeacher) promises.push(fetchBucketList('imagens-professores', 'professor'));\n        const results = await Promise.all(promises);\n        let combined = results.flat();\n        // Prepend header image if provided and not already in list\n        if (headerUrl) {\n          const exists = combined.some(i => i.url === headerUrl);\n          const headerItem = {\n            id: `header-${escolaId}`,\n            url: headerUrl,\n            titulo: '',\n            descricao: '',\n            autor: '',\n            dataFoto: '',\n            origem: 'capa',\n          };\n          combined = exists ? combined : [headerItem, ...combined];\n        }\n        if (!mounted) return;\n        // Sort by origem to prioritize school first then teacher, maintain stable order\n        // Ensure header stays first if present\n        const ordered = combined.sort((a, b) => {\n          if (a.origem === 'capa') return -1;\n          if (b.origem === 'capa') return 1;\n          return a.origem.localeCompare(b.origem);\n        });\n        setItems(ordered);\n        setCurrent(0);\n      } catch (e) {\n        if (!mounted) return;\n        setError('Erro ao carregar imagens.');\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    })();\n    return () => { mounted = false; };\n  }, [escolaId, refreshKey, fetchBucketList, showSchool, showTeacher]);\n\n  const hasItems = items.length > 0;\n  const currentItem = useMemo(() => (hasItems ? items[current] : null), [items, current, hasItems]);\n\n  // Notify parent when current item changes\n  useEffect(() => {\n    if (onCurrentItemChange && currentItem) {\n      onCurrentItemChange(currentItem);\n    }\n  }, [currentItem, onCurrentItemChange]);\n\n  // Sync current image to scroll progress\n  useEffect(() => {\n    if (!hasItems || typeof scrollProgress !== 'number') return;\n    // If user recently navigated manually, skip syncing from scroll\n    if (Date.now() < manualOverrideUntil) return;\n    const idx = Math.floor(scrollProgress * Math.max(0, items.length - 1));\n    if (Number.isFinite(idx) && idx !== current) {\n      setCurrent(idx);\n    }\n  }, [scrollProgress, hasItems, items.length, current, manualOverrideUntil]);\n\n  const prev = useCallback(() => {\n    if (!hasItems) return;\n    setCurrent((idx) => (idx > 0 ? idx - 1 : items.length - 1));\n    setManualOverrideUntil(Date.now() + 1200);\n  }, [hasItems, items.length]);\n\n  const next = useCallback(() => {\n    if (!hasItems) return;\n    setCurrent((idx) => (idx < items.length - 1 ? idx + 1 : 0));\n    setManualOverrideUntil(Date.now() + 1200);\n  }, [hasItems, items.length]);\n\n  if (loading) {\n    return <div className=\"text-gray-500\">Carregando imagens...</div>;\n  }\n  if (error) {\n    return <div className=\"text-red-600\">{error}</div>;\n  }\n  if (!hasItems) {\n    return <div className=\"text-gray-600\">Nenhuma imagem disponvel.</div>;\n  }\n\n  return (\n    <div className=\"h-full w-full relative\">\n      <div className=\"absolute inset-0\">\n        <button\n          type=\"button\"\n          className=\"absolute left-3 top-1/2 -translate-y-1/2 z-10 bg-white/80 hover:bg-white text-gray-700 rounded-full p-2 shadow\"\n          onClick={prev}\n          aria-label=\"Imagem anterior\"\n        >\n          <ChevronLeft className=\"w-5 h-5\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"absolute right-3 top-1/2 -translate-y-1/2 z-10 bg-white/80 hover:bg-white text-gray-700 rounded-full p-2 shadow\"\n          onClick={next}\n          aria-label=\"Prxima imagem\"\n        >\n          <ChevronRight className=\"w-5 h-5\" />\n        </button>\n\n        <div className=\"w-full h-full bg-black/5 overflow-hidden\">\n          <OptimizedImage\n            src={currentItem.url}\n            alt={currentItem.titulo || 'Imagem'}\n            className=\"w-full h-full object-cover\"\n            isPreloaded={isImagePreloaded(currentItem.url)}\n            style={{ maxHeight: '100%', maxWidth: '100%' }}\n          />\n        </div>\n\n        {/* Caption at bottom with black background */}\n        <div className=\"absolute bottom-3 left-3 right-3 z-10 flex\">\n          <div\n            className=\"text-white px-3 py-2\"\n            style={{\n              backgroundColor: 'rgba(0,0,0,0.88)',\n              borderRadius: '8px',\n              maxWidth: '80%',\n            }}\n          >\n            {currentItem.titulo && (\n              <h4 className=\"text-sm font-semibold m-0\">{currentItem.titulo}</h4>\n            )}\n            <div className=\"text-[11px] mt-0.5 space-x-2\">\n              {currentItem.origem && <span className=\"capitalize\">{currentItem.origem}</span>}\n              {currentItem.autor && <span>Por: {currentItem.autor}</span>}\n              {currentItem.dataFoto && (\n                <span>{new Date(currentItem.dataFoto).toLocaleDateString('pt-BR')}</span>\n              )}\n            </div>\n            {currentItem.descricao && (\n              <p className=\"text-xs mt-1 m-0\">\n                {currentItem.descricao}\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(SidebarMediaViewer);\n\n\n","import { useState, useEffect } from \"react\";\nimport { useBreakpoint } from \"../../hooks/responsive/useBreakpoint\";\nimport logger from \"../../utils/logger\";\n\n/**\n * Hook para controlar visibilidade do painel\n * \n * @param {Object|null} painelInfo - Informaes do painel a ser exibido\n * @returns {Object} Objeto com isVisible e isMobile\n */\nconst usePainelVisibility = (painelInfo) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const { isMobile } = useBreakpoint();\n\n  useEffect(() => {\n    logger.debug(\"usePainelVisibility - painelInfo mudou:\", painelInfo);\n    \n    if (painelInfo && typeof painelInfo === 'object') {\n      logger.debug(\"usePainelVisibility: Definindo visibilidade como true\");\n      setIsVisible(true);\n      document.body.style.overflow = \"hidden\";\n    } else {\n      logger.debug(\"usePainelVisibility: Definindo visibilidade como false\");\n      setIsVisible(false);\n      document.body.style.overflow = \"\";\n    }\n\n    return () => {\n      document.body.style.overflow = \"\";\n    };\n  }, [painelInfo]);\n\n  return { isVisible, isMobile };\n};\n\nexport default usePainelVisibility;","import React, { useEffect, useState } from 'react';\nimport '../PainelInformacoes.css';\nimport PainelHeader from '../../PainelHeader';\nimport EscolaHeaderImage from './EscolaHeaderImage';\nimport SidebarMediaViewer from './SidebarMediaViewer';\nimport usePainelVisibility from '../../hooks/usePainelVisibility';\nimport { usePainelDimensions } from '../../hooks/usePainelDimensions';\nimport useImagePreloader from '../../../hooks/useImagePreloader';\n\nconst PainelContainer = ({ \n  painelInfo, \n  closePainel, \n  children,\n  isMaximized,\n  onToggleMaximize,\n  contentRef,\n  rightNav,\n  refreshKey,\n  shareUrl,\n  shareTitle\n}) => {\n  const [scrollProgress, setScrollProgress] = useState(0);\n  const [currentImageCaption, setCurrentImageCaption] = useState(null);\n  const { isVisible, isMobile } = usePainelVisibility(painelInfo);\n  const painelDimensions = usePainelDimensions(isMobile, isMaximized);\n  \n  // Hook de preload de imagens\n  const { isImagePreloaded } = useImagePreloader(painelInfo?.id, true);\n\n  if (!painelInfo) return null;\n\n  // No h mais barra superior no mapa; o painel deve iniciar no topo\n\n  const baseClasses = `\n    fixed\n    ${isMobile \n      ? `inset-x-0 top-0 w-full h-full` \n      : 'top-0 bottom-0 right-0 w-full sm:w-3/4 lg:w-[49%] h-auto'\n    }\n    rounded-t-xl shadow-xl z-[9999] transform transition-all duration-500 ease-in-out\n    bg-white border-t-4 border-white mj-panel\n  `;\n  \n  const visibilityClasses = isVisible \n    ? isMobile \n      ? \"translate-y-0 opacity-100\" \n      : \"translate-y-0 opacity-100\"\n    : isMobile \n      ? \"translate-y-full opacity-0\" \n      : \"translate-y-full opacity-0\";\n\n  return (\n    <div\n      role=\"dialog\"\n      aria-labelledby=\"painel-titulo\"\n      aria-describedby=\"painel-descricao\"\n      aria-modal=\"true\"\n      className={`${baseClasses} ${visibilityClasses}${isMobile ? ' painel-informacoes-mobile' : ''}${!isMobile && isMaximized ? ' mj-maximized' : ''}`}\n      style={{\n        height: painelDimensions.height,\n        maxHeight: painelDimensions.maxHeight,\n        width: isMobile ? '100%' : painelDimensions.width,\n        top: 0,\n        display: \"flex\",\n        flexDirection: \"column\",\n        position: 'fixed',\n        ...(isMobile && {\n          borderRadius: painelDimensions.isMobileLandscape ? '0' : '1rem 1rem 0 0',\n          boxShadow: painelDimensions.isMobileLandscape \n            ? '0 0 0 0' \n            : '0 -4px 6px -1px rgba(0, 0, 0, 0.1), 0 -2px 4px -1px rgba(0, 0, 0, 0.06)'\n        })\n      }}\n    >\n      <PainelHeader \n        titulo={painelInfo.titulo} \n        closePainel={closePainel}\n        toggleMaximize={onToggleMaximize}\n        isMaximized={isMaximized}\n        imagemHeader={painelInfo.imagem_header}\n        shareUrl={shareUrl}\n        shareTitle={shareTitle}\n      />\n      \n      {/* Navegao fixa  direita do painel */}\n      {rightNav && (\n        <div className=\"hidden sm:flex flex-col gap-1 absolute right-0 top-1/2 -translate-y-1/2 z-[10000]\">\n          {rightNav}\n        </div>\n      )}\n\n      {isMaximized && !isMobile ? (\n        <div className=\"flex-1 mj-split\">\n          <aside className=\"mj-split-left\">\n            <SidebarMediaViewer\n              escolaId={painelInfo.id}\n              refreshKey={refreshKey || 0}\n              scrollProgress={scrollProgress}\n              headerUrl={painelInfo.imagem_header}\n              onCurrentItemChange={setCurrentImageCaption}\n            />\n          </aside>\n          <div\n            ref={contentRef}\n            className=\"mj-split-right overflow-y-auto mj-panel-content\"\n            onScroll={(e) => {\n              const el = e.currentTarget;\n              const max = el.scrollHeight - el.clientHeight;\n              const ratio = max > 0 ? el.scrollTop / max : 0;\n              setScrollProgress(Math.min(1, Math.max(0, ratio)));\n            }}\n          >\n            <div className={`${isMobile ? 'p-3 sm:p-4' : 'p-6'} space-y-4 sm:space-y-5`}>\n              <div className=\"prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none mj-prose\">\n                {children}\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div ref={contentRef} className=\"flex-1 overflow-y-auto mj-panel-content\">\n          {painelInfo.imagem_header && (\n            <EscolaHeaderImage \n              imagemUrl={painelInfo.imagem_header}\n              className=\"h-56 sm:h-64 md:h-72 lg:h-80 xl:h-96 w-full\"\n              isPreloaded={isImagePreloaded(painelInfo.imagem_header)}\n            />\n          )}\n          <div className={`${isMobile ? 'p-3 sm:p-4' : 'p-6'} space-y-4 sm:space-y-5 -mt-2`}>\n            <div className=\"prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none mj-prose\">\n              {children}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default React.memo(PainelContainer); ","import { useState, useEffect, useMemo } from 'react';\n\nexport const usePainelDimensions = (isMobile, isMaximized) => {\n  const [windowWidth, setWindowWidth] = useState(window.innerWidth);\n  const [windowHeight, setWindowHeight] = useState(window.innerHeight);\n  \n  // Breakpoints para responsividade\n  const breakpoints = {\n    sm: 640,\n    md: 768,\n    lg: 1024,\n    xl: 1280,\n    '2xl': 1536\n  };\n\n  // Detectar mudanas no tamanho da janela\n  useEffect(() => {\n    const handleResize = () => {\n      setWindowWidth(window.innerWidth);\n      setWindowHeight(window.innerHeight);\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Calcular dimenses base\n  const dimensions = useMemo(() => {\n    // Determinar orientao para alguns comportamentos de layout\n    const isMobileLandscape = isMobile && windowWidth > windowHeight;\n    const baseHeight = '100vh';\n    const baseMaxHeight = '100vh';\n\n    // Determinar se est em modo desktop\n    const isDesktop = windowWidth >= breakpoints.md;\n    \n    // Determinar se deve usar grid\n    const shouldUseGrid = isDesktop && isMaximized;\n\n    // Calcular largura do painel\n    let panelWidth;\n    if (isMobile) {\n      if (isMobileLandscape) {\n        // Mobile na horizontal: preencher toda a tela\n        panelWidth = '100%';\n      } else {\n        // Mobile na vertical: preencher toda a largura\n        panelWidth = '100%';\n      }\n    } else {\n      // Desktop\n      panelWidth = isMaximized \n      ? '100%' \n      : windowWidth >= breakpoints.lg \n        ? '49%' \n        : '75%';\n    }\n\n    return {\n      height: baseHeight,\n      maxHeight: baseMaxHeight,\n      width: panelWidth,\n      isDesktop,\n      isMobileLandscape,\n      shouldUseGrid,\n      breakpoints,\n      zIndex: 1000\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isMobile, isMaximized, windowWidth, windowHeight]);\n\n  return dimensions;\n};","import React, { useRef, useState, useEffect } from 'react';\n\n/**\n * DocumentViewer\n * Componente para exibir uma lista de documentos (PDFs) associados a uma escola.\n * Permite visualizao via iframe (Google Drive/Docs) ou download externo, com tratamento de erros e fallback amigvel.\n * Props:\n *   - documentos: Array de objetos { id, titulo, autoria, tipo, link_pdf }\n *   - title: string (opcional)\n */\n\n// Utility function to transform Google Drive links\nconst transformarLinkGoogleDrive = (link) => {\n  if (!link || typeof link !== 'string') return null;\n  \n  const match = link.match(/\\/d\\/([a-zA-Z0-9-_]+)/);\n  if (!match) return null;\n  \n  const fileId = match[1];\n  return `https://docs.google.com/gview?url=https://drive.google.com/uc?id=${fileId}&embedded=true`;\n};\n\n/**\n * Componente de troca de visualizao (lista/grade) acessvel e reutilizvel\n */\nconst ViewModeToggle = ({ viewMode, setViewMode }) => (\n  <div className=\"flex items-center gap-2\" role=\"tablist\" aria-label=\"Modos de visualizao dos documentos\">\n    <button\n      type=\"button\"\n      role=\"tab\"\n      aria-selected={viewMode === 'list'}\n      aria-label=\"Visualizar em lista\"\n      onClick={() => setViewMode('list')}\n      className={`p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ${\n        viewMode === 'list'\n          ? 'bg-green-100 text-green-800 font-semibold'\n          : 'text-gray-600 hover:bg-gray-100'\n      }`}\n      tabIndex={0}\n    >\n      {/* cone de lista */}\n      <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\n      </svg>\n      <span className=\"hidden sm:inline\">Lista</span>\n    </button>\n    <button\n      type=\"button\"\n      role=\"tab\"\n      aria-selected={viewMode === 'grid'}\n      aria-label=\"Visualizar em grade\"\n      onClick={() => setViewMode('grid')}\n      className={`p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ${\n        viewMode === 'grid'\n          ? 'bg-green-100 text-green-800 font-semibold'\n          : 'text-gray-600 hover:bg-gray-100'\n      }`}\n      tabIndex={0}\n    >\n      {/* cone de grade */}\n      <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z\" />\n      </svg>\n      <span className=\"hidden sm:inline\">Grade</span>\n    </button>\n  </div>\n);\n\nconst DocumentViewer = ({ documentos, title = \"Documentos\" }) => {\n  const [selectedDoc, setSelectedDoc] = useState(null);\n  const [viewMode, setViewMode] = useState('list'); // 'list' ou 'grid'\n  const iframeRef = useRef(null);\n  const [iframeError, setIframeError] = useState(false);\n  const [useGoogleDocsViewer, setUseGoogleDocsViewer] = useState(false);\n\n  // Reset states when selected document changes\n  useEffect(() => {\n    if (selectedDoc) {\n      setIframeError(false);\n      setUseGoogleDocsViewer(false);\n    }\n  }, [selectedDoc]);\n\n  // Set first document as selected if none is selected\n  useEffect(() => {\n    if (!selectedDoc && documentos?.length > 0) {\n      setSelectedDoc(documentos[0]);\n    }\n  }, [documentos, selectedDoc]);\n\n  // Handle iframe events\n  useEffect(() => {\n    const iframe = iframeRef.current;\n    if (!iframe || !selectedDoc) return;\n\n    const handleLoad = () => {\n      setIframeError(false);\n    };\n\n    const handleError = () => {\n      setIframeError(true);\n      setUseGoogleDocsViewer(true);\n    };\n\n    iframe.addEventListener('load', handleLoad);\n    iframe.addEventListener('error', handleError);\n\n    return () => {\n      iframe.removeEventListener('load', handleLoad);\n      iframe.removeEventListener('error', handleError);\n    };\n  }, [selectedDoc]);\n\n  // Early return after all hooks\n  if (!documentos || documentos.length === 0) {\n    return null;\n  }\n\n  const renderDocumentGrid = () => {\n    return (\n      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-6\">\n        {documentos.map((doc) => (\n          <div\n            key={doc.id}\n            className={`\n              flex flex-col justify-between h-full max-w-xs mx-auto\n              rounded-2xl transition-all duration-200 cursor-pointer\n              shadow-sm hover:shadow-lg\n              ${selectedDoc?.id === doc.id\n                ? 'bg-green-100 scale-[1.03]'\n                : 'bg-white hover:bg-green-50'\n              }\n            `}\n            onClick={() => {\n              setSelectedDoc(doc);\n            }}\n            tabIndex={0}\n            aria-label={`Selecionar documento: ${doc.titulo}`}\n          >\n            <div className=\"p-5 flex-1 flex flex-col justify-between\">\n              <h4 className=\"font-semibold text-green-800 mb-2 line-clamp-2 text-lg\">{doc.titulo}</h4>\n              {doc.autoria && (\n                <p className=\"text-sm text-gray-600 mb-2 line-clamp-1\">Por: {doc.autoria}</p>\n              )}\n              {doc.tipo && (\n                <span className=\"inline-block px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full\">\n                  {doc.tipo}\n                </span>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  };\n\n  const renderDocumentList = () => {\n    return (\n      <div className=\"space-y-2\">\n        {documentos.map((doc) => (\n          <button\n            key={doc.id}\n            onClick={() => {\n              setSelectedDoc(doc);\n            }}\n            className={`w-full text-left p-3 rounded-lg transition-colors duration-200 ${\n              selectedDoc?.id === doc.id\n                ? 'bg-green-100'\n                : 'hover:bg-green-50'\n            }`}\n          >\n            <h4 className=\"font-medium text-green-800\">{doc.titulo}</h4>\n            {doc.autoria && (\n              <p className=\"text-sm text-gray-600\">Por: {doc.autoria}</p>\n            )}\n            {doc.tipo && (\n              <span className=\"inline-block mt-1 px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full\">\n                {doc.tipo}\n              </span>\n            )}\n          </button>\n        ))}\n      </div>\n    );\n  };\n\n  const renderDocumentViewer = () => {\n    if (!selectedDoc) return null;\n\n    const isGoogleDriveLink = selectedDoc.link_pdf.includes('drive.google.com/file/d/');\n\n    return (\n      <div className=\"rounded-lg overflow-hidden shadow-lg bg-white\">\n        {isGoogleDriveLink ? (\n          <>\n            {!useGoogleDocsViewer ? (\n              <iframe \n                ref={iframeRef}\n                src={selectedDoc.link_pdf.replace('/view?usp=sharing', '/preview')}\n                width=\"100%\" \n                height=\"500px\"\n                allow=\"autoplay\"\n                loading=\"lazy\"\n                title={selectedDoc.titulo}\n                sandbox=\"allow-same-origin allow-scripts allow-popups allow-forms\"\n                className=\"bg-white\"\n              />\n            ) : (\n              <iframe\n                ref={iframeRef}\n                src={transformarLinkGoogleDrive(selectedDoc.link_pdf)}\n                width=\"100%\"\n                height=\"500px\"\n                allow=\"autoplay\"\n                loading=\"lazy\"\n                title={`${selectedDoc.titulo} (Google Docs Viewer)`}\n                sandbox=\"allow-same-origin allow-scripts allow-popups allow-forms\"\n                className=\"bg-white\"\n              />\n            )}\n            {iframeError && (\n              <div className=\"p-6 text-center text-gray-600 bg-green-100\">\n                <p className=\"mb-3 text-lg\">No foi possvel carregar o documento diretamente.</p>\n                <a\n                  href={selectedDoc.link_pdf}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg\"\n                >\n                  <svg \n                    className=\"w-5 h-5 mr-2\" \n                    fill=\"none\" \n                    stroke=\"currentColor\" \n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path \n                      strokeLinecap=\"round\" \n                      strokeLinejoin=\"round\" \n                      strokeWidth={2} \n                      d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" \n                    />\n                  </svg>\n                  Abrir em nova aba\n                </a>\n              </div>\n            )}\n          </>\n        ) : (\n          <div className=\"flex justify-center p-6\">\n            <a\n              href={selectedDoc.link_pdf}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"inline-flex items-center px-6 py-3 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg\"\n            >\n              <svg \n                className=\"w-5 h-5 mr-2\" \n                fill=\"none\" \n                stroke=\"currentColor\" \n                viewBox=\"0 0 24 24\"\n              >\n                <path \n                  strokeLinecap=\"round\" \n                  strokeLinejoin=\"round\" \n                  strokeWidth={2} \n                  d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" \n                />\n              </svg>\n              Ver documento PDF\n            </a>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"mt-8 max-w-4xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-xl font-semibold text-green-800\">{title}:</h3>\n        {documentos.length > 1 && (\n          <ViewModeToggle viewMode={viewMode} setViewMode={setViewMode} />\n        )}\n      </div>\n      \n      {documentos.length > 1 && (\n        <div className=\"mb-6\">\n          {viewMode === 'grid' ? renderDocumentGrid() : renderDocumentList()}\n        </div>\n      )}\n      \n      {renderDocumentViewer()}\n    </div>\n  );\n};\n\nexport default React.memo(DocumentViewer); ","import React, { useState, useEffect } from 'react';\nimport { getTituloByVideoUrl } from '../../../services/legendasService';\n\n/**\n * VideoPlayer\n * Componente para exibir vdeos do YouTube de forma responsiva e acessvel.\n * Faz extrao do ID do vdeo a partir de diferentes formatos de URL e exibe fallback amigvel em caso de erro.\n * Props:\n *   - videoUrl: string (URL do vdeo)\n *   - title: string (opcional)\n *   - escolaId: number (ID da escola para buscar ttulo personalizado)\n */\n\n// Utility function to extract YouTube video ID\nconst extrairIdYoutube = (url) => {\n  if (!url || typeof url !== 'string') {\n    return null;\n  }\n\n  // Remove query parameters to simplify\n  const baseUrl = url.split('?')[0];\n\n  // Patterns to extract video ID\n  const patterns = [\n    /youtube\\.com\\/embed\\/([^/?&]+)/,                 // embed/ID\n    /youtube\\.com\\/watch\\?v=([^&]+)/,                 // watch?v=ID\n    /youtu\\.be\\/([^?&]+)/,                            // youtu.be/ID\n    /youtube\\.com\\/v\\/([^?&]+)/                       // youtube.com/v/ID\n  ];\n\n  for (const pattern of patterns) {\n    const match = baseUrl.match(pattern);\n    if (match && match[1]) {\n      return match[1];\n    }\n  }\n\n  return null;\n};\n\nconst VideoPlayer = ({ videoUrl, title = \"Vdeo\", escolaId }) => {\n  const [tituloPersonalizado, setTituloPersonalizado] = useState(null);\n  const [, setLoading] = useState(false);\n\n  // Buscar ttulo personalizado da nova tabela\n  useEffect(() => {\n    const buscarTitulo = async () => {\n      if (!videoUrl || !escolaId) return;\n\n      try {\n        setLoading(true);\n        const titulo = await getTituloByVideoUrl(videoUrl, escolaId);\n        setTituloPersonalizado(titulo);\n      } catch (error) {\n        console.warn('Erro ao buscar ttulo personalizado:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    buscarTitulo();\n  }, [videoUrl, escolaId]);\n\n  if (!videoUrl) return null;\n\n  const videoId = extrairIdYoutube(videoUrl);\n  \n  if (!videoId) {\n    return (\n      <div className=\"mt-8 max-w-4xl mx-auto\">\n        <h3 className=\"text-xl font-semibold text-green-800 mb-4\">\n          {tituloPersonalizado?.titulo || title}:\n        </h3>\n        <div className=\"p-6 text-center text-gray-600 bg-gray-50 rounded-lg\">\n          <p className=\"mb-3 text-lg\">Link do vdeo invlido ou no suportado.</p>\n          <a\n            href={videoUrl}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg\"\n          >\n            <svg \n              className=\"w-5 h-5 mr-2\" \n              fill=\"none\" \n              stroke=\"currentColor\" \n              viewBox=\"0 0 24 24\"\n            >\n              <path \n                strokeLinecap=\"round\" \n                strokeLinejoin=\"round\" \n                strokeWidth={2} \n                d=\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\" \n              />\n              <path \n                strokeLinecap=\"round\" \n                strokeLinejoin=\"round\" \n                strokeWidth={2} \n                d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" \n              />\n            </svg>\n            Tentar abrir no YouTube\n          </a>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"mt-8 max-w-4xl mx-auto\">\n      <h3 className=\"text-xl font-semibold text-green-800 mb-4\">\n        {tituloPersonalizado?.titulo || title}:\n      </h3>\n      \n      {/* Informaes adicionais do ttulo personalizado */}\n      {tituloPersonalizado && (\n        <div className=\"mb-4 p-4 bg-green-100 rounded-lg\">\n          {tituloPersonalizado.descricao && (\n            <p className=\"text-gray-700 mb-2\">{tituloPersonalizado.descricao}</p>\n          )}\n          \n          <div className=\"flex items-center gap-4 text-sm text-gray-600\">\n            {tituloPersonalizado.categoria && (\n              <span className=\"capitalize bg-green-200 text-green-800 px-2 py-1 rounded\">\n                {tituloPersonalizado.categoria}\n              </span>\n            )}\n            {tituloPersonalizado.plataforma && (\n              <span className=\"capitalize\">\n                {tituloPersonalizado.plataforma}\n              </span>\n            )}\n            {tituloPersonalizado.duracao && (\n              <span>Durao: {tituloPersonalizado.duracao}</span>\n            )}\n          </div>\n        </div>\n      )}\n      \n      <div className=\"rounded-lg overflow-hidden shadow-lg bg-white\">\n        <div className=\"relative pb-[56.25%] h-0\">\n          <iframe\n            className=\"absolute top-0 left-0 w-full h-full\"\n            src={`https://www.youtube.com/embed/${videoId}`}\n            title={tituloPersonalizado?.titulo || title}\n            frameBorder=\"0\"\n            allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n            allowFullScreen\n            loading=\"lazy\"\n            referrerPolicy=\"origin\"\n          />\n        </div>\n      </div>\n      \n\n    </div>\n  );\n};\n\nexport default React.memo(VideoPlayer); ","import React, { useRef, useState, useEffect, useMemo } from \"react\";\nimport { useShare } from \"../hooks/useShare\";\nimport { useDynamicURL } from \"../hooks/useDynamicURL\";\nimport { useClickOutside } from \"../hooks/useClickOutside\";\nimport useDocumentosEscola from \"../hooks/useDocumentosEscola\";\n\n// Import modular components\nimport EscolaInfo from \"./components/EscolaInfo\";\nimport TerraIndigenaInfo from \"./TerraIndigenaInfo\";\nimport IntroPanel from \"./IntroPanel\";\nimport PainelContainer from \"./components/PainelContainer\";\nimport DocumentViewer from \"./components/DocumentViewer\";\nimport VideoPlayer from \"./components/VideoPlayer\";\n\nconst PainelInformacoes = ({ painelInfo, closePainel, escola_id, refreshKey = 0 }) => {\n  const painelRef = useRef(null);\n  const contentRef = useRef(null);\n  const sectionRefs = useRef({});\n  const [activeIndex, setActiveIndex] = useState(0);\n  const [isMaximized, setIsMaximized] = useState(false);\n  \n  const { gerarLinkCustomizado } = useShare(painelInfo);\n  const { documentos } = useDocumentosEscola(painelInfo?.id);\n  \n  const toggleMaximize = () => setIsMaximized(prev => !prev);\n  \n  useDynamicURL(painelInfo, gerarLinkCustomizado);\n  useClickOutside(painelRef, closePainel);\n\n  // Forar re-renderizao quando refreshKey mudar\n  useEffect(() => {\n    console.log('PainelInformacoes: refreshKey mudou para', refreshKey);\n  }, [refreshKey]);\n\n  const sections = useMemo(() => {\n    const list = [];\n    list.push({ key: 'dados', label: 'Dados' });\n    list.push({ key: 'historia', label: 'Histria' });\n    list.push({ key: 'depoimentos', label: 'Depoimentos' });\n    if (painelInfo && painelInfo.link_para_videos) list.push({ key: 'videos', label: 'Vdeos' });\n    return list;\n  }, [painelInfo]);\n\n  useEffect(() => {\n    const el = contentRef.current;\n    if (!el) return;\n    const handleScroll = () => {\n      const containerRect = el.getBoundingClientRect();\n      let bestIndex = 0;\n      let bestDelta = Infinity;\n      sections.forEach((s, idx) => {\n        const sec = sectionRefs.current[s.key];\n        if (!sec) return;\n        const r = sec.getBoundingClientRect();\n        const delta = Math.abs(r.top - containerRect.top - 80);\n        if (delta < bestDelta) {\n          bestDelta = delta;\n          bestIndex = idx;\n        }\n      });\n      setActiveIndex(bestIndex);\n    };\n    el.addEventListener('scroll', handleScroll, { passive: true });\n    handleScroll();\n    return () => el.removeEventListener('scroll', handleScroll);\n  }, [sections]);\n\n  const scrollToSection = (idx) => {\n    const el = contentRef.current;\n    if (!el) return;\n    const key = sections[idx]?.key;\n    const target = key ? sectionRefs.current[key] : null;\n    if (!target) return;\n    const containerTop = el.getBoundingClientRect().top;\n    const targetTop = target.getBoundingClientRect().top;\n    const scrollBy = targetTop - containerTop + el.scrollTop - 72; // pequeno offset sob header\n    el.scrollTo({ top: scrollBy, behavior: 'smooth' });\n  };\n\n  const prevSection = () => {\n    const nextIdx = activeIndex > 0 ? activeIndex - 1 : 0;\n    scrollToSection(nextIdx);\n  };\n\n  const nextSection = () => {\n    const last = sections.length - 1;\n    const nextIdx = activeIndex < last ? activeIndex + 1 : last;\n    scrollToSection(nextIdx);\n  };\n\n  const handleKeyActivate = (e, action) => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault();\n      action();\n    }\n  };\n\n  if (!painelInfo) {\n    return null;\n  }\n\n  // Determine panel type\n  const isTerraIndigena = painelInfo.tipo === 'terra_indigena';\n  const isIntro = painelInfo.titulo === 'Sobre o site';\n\n  const renderContent = () => {\n    if (isIntro) {\n      return <IntroPanel painelInfo={painelInfo} />;\n    }\n    \n    if (isTerraIndigena) {\n      return <TerraIndigenaInfo terraIndigena={painelInfo} />;\n    }\n\n    return (\n      <div className=\"relative\">\n        <EscolaInfo \n          escola={painelInfo} \n          shouldUseGrid={true}\n          refreshKey={refreshKey}\n          sectionRefs={sectionRefs.current}\n          isMaximized={isMaximized}\n        />\n        {documentos && documentos.length > 0 && (\n          <DocumentViewer \n            documentos={documentos}\n            title=\"Produes e materiais da escola\"\n          />\n        )}\n        {painelInfo.link_para_videos && (\n          <div ref={(el) => (sectionRefs.current['videos'] = el)}>\n            <VideoPlayer \n              videoUrl={painelInfo.link_para_videos}\n              title={<span style={{ fontSize: '0.75em' }}>{`Produes audiovisuais realizadas na ${painelInfo.titulo}`}</span>}\n              escolaId={painelInfo.id}\n            />\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  // Generate share URL\n  const shareUrl = painelInfo ? gerarLinkCustomizado() : '';\n\n  return (\n    <div ref={painelRef}>\n      <PainelContainer\n        painelInfo={painelInfo}\n        closePainel={closePainel}\n        isMaximized={isMaximized}\n        onToggleMaximize={toggleMaximize}\n        contentRef={contentRef}\n        refreshKey={refreshKey}\n        rightNav={null}\n        shareUrl={shareUrl}\n        shareTitle={painelInfo?.titulo}\n      >\n        {renderContent()}\n      </PainelContainer>\n    </div>\n  );\n};\n\nexport default React.memo(PainelInformacoes); ","import { criarSlug } from '../../utils/slug';\n\nexport const useShare = (painelInfo) => {\n  const gerarLinkCustomizado = () => {\n    return (\n      window.location.origin +\n      window.location.pathname +\n      \"?panel=\" +\n      criarSlug(painelInfo.titulo)\n    );\n  };\n\n  const copiarLink = async () => {\n    const url = gerarLinkCustomizado();\n    try {\n      await navigator.clipboard.writeText(url);\n      alert(\"Link copiado!\");\n    } catch (err) {\n      const input = document.createElement(\"input\");\n      input.value = url;\n      document.body.appendChild(input);\n      input.select();\n      document.execCommand(\"copy\");\n      document.body.removeChild(input);\n      alert(\"Link copiado!\");\n    }\n  };\n\n  const compartilhar = () => {\n    const url = gerarLinkCustomizado();\n    const texto = `Confira este painel: ${painelInfo.titulo}`;\n    \n    if (navigator.share) {\n      navigator.share({\n        title: painelInfo.titulo,\n        text: texto,\n        url: url,\n      });\n    } else {\n      window.open(\n        `https://twitter.com/intent/tweet?text=${encodeURIComponent(texto)}&url=${encodeURIComponent(url)}`,\n        \"_blank\"\n      );\n    }\n  };\n\n  return { gerarLinkCustomizado, copiarLink, compartilhar };\n};","import { useEffect } from 'react';\n\nexport const useClickOutside = (ref, handler) => {\n  useEffect(() => {\n    const listener = (event) => {\n      // S fecha se o clique for no mapa (openlayers-container)\n      const el = event.target;\n      if (el.classList && el.classList.contains('openlayers-container')) {\n        return;\n      }\n      \n      if (!ref.current || ref.current.contains(event.target)) {\n        return;\n      }\n      handler(event);\n    };\n\n    document.addEventListener('mousedown', listener);\n    document.addEventListener('touchstart', listener);\n\n    return () => {\n      document.removeEventListener('mousedown', listener);\n      document.removeEventListener('touchstart', listener);\n    };\n  }, [ref, handler]);\n};","import { useEffect, useRef } from \"react\";\n\nexport const useDynamicURL = (painelInfo, gerarLinkCustomizado) => {\n  const lastUrlRef = useRef(null);\n  const timeoutRef = useRef(null);\n\n  useEffect(() => {\n    if (!painelInfo) return;\n\n    // Limpa o timeout anterior se existir\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    // Cria um novo timeout para debounce\n    timeoutRef.current = setTimeout(() => {\n      const newUrl = gerarLinkCustomizado();\n      \n      // S atualiza se a URL realmente mudou\n      if (newUrl !== lastUrlRef.current) {\n        try {\n          window.history.replaceState({}, \"\", newUrl);\n          lastUrlRef.current = newUrl;\n        } catch (error) {\n          console.warn('Erro ao atualizar URL:', error);\n        }\n      }\n    }, 300); // 300ms de debounce\n\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, [painelInfo, gerarLinkCustomizado]);\n};","/**\n * Componente MapaEscolasIndigenas - Exibe o mapa interativo com escolas indgenas e terras indgenas\n * \n * @param {Object} props - Propriedades do componente\n * @param {Array} props.dataPoints - Array de pontos de dados das escolas\n * @param {Function} props.onPainelOpen - Funo para abrir o painel de informaes\n * @returns {React.ReactElement} - Componente renderizado\n */\nimport React, { useState, useEffect, useMemo, useCallback } from \"react\";\nimport MapSelector from \"./MapSelector\";\nimport { Link, useLocation } from 'react-router-dom';\nimport PainelInformacoes from \"./PainelInformacoes\";\nimport \"./MapaEscolasIndigenas.css\";\nimport { criarSlug } from '../utils/slug';\nimport { useRefresh } from '../contexts/RefreshContext';\nimport logger from '../utils/logger';\n\nconst MapaEscolasIndigenas = ({ dataPoints, onPainelOpen, isLoading = false }) => {\n  logger.debug(\"DataPoints recebidos no MapaEscolasIndigenas:\", dataPoints ? {\n    quantidade: dataPoints.length,\n    exemplo: dataPoints[0] ? {\n      titulo: dataPoints[0].titulo,\n      latitude: dataPoints[0].Latitude,\n      longitude: dataPoints[0].Longitude,\n      tipo: dataPoints[0].tipo\n    } : 'Nenhum ponto'\n  } : 'Nenhum dataPoint');\n\n  const { refreshKey } = useRefresh();\n  const location = useLocation();\n\n  const urlParams = useMemo(() => new URLSearchParams(window.location.search), []);\n  const panel = urlParams.get('panel');\n  const initialPanel = useMemo(() => {\n    // Primeiro verificar se h dados da escola no navigation state\n    if (location.state?.schoolData) {\n      return location.state.schoolData;\n    }\n    \n    // Depois verificar URL params\n    if (panel && panel !== '' && dataPoints && dataPoints.length > 0) {\n      const pointFound = dataPoints.find((item) => criarSlug(item.titulo) === panel);\n      return pointFound || null;\n    }\n    return null;\n  }, [panel, dataPoints, location.state]);\n\n  const [painelInfo, setPainelInfo] = useState(initialPanel);\n  const [initialPanelOpened, setInitialPanelOpened] = useState(!!initialPanel);\n  \n  // Memoize escolasVisiveis para evitar reclculos desnecessrios\n  const escolasVisiveis = useMemo(() => \n    dataPoints ? dataPoints.filter(point => point.pontuacao >= 0) : [],\n    [dataPoints]\n  );\n\n  // Otimizar a funo de abrir painel\n  const abrirPainel = useCallback((info) => {\n    if (!info) return;\n    setPainelInfo(info);\n  }, []);\n\n  // Funo para forar refresh do painel\n  const refreshPainel = useCallback(() => {\n    logger.debug('Forando refresh do painel de informaes');\n    // O refresh ser disparado pelo contexto\n  }, []);\n\n  // Abrir painel automaticamente quando initialPanel for encontrado (apenas uma vez)\n  useEffect(() => {\n    if (initialPanel && !initialPanelOpened) {\n      logger.debug('MapaEscolasIndigenas: Abrindo painel automaticamente para:', initialPanel.titulo);\n      setPainelInfo(initialPanel);\n      setInitialPanelOpened(true);\n    }\n  }, [initialPanel, initialPanelOpened]);\n\n  // Abrir painel quando navigation state mudar (quando vem da busca)\n  useEffect(() => {\n    if (location.state?.schoolData) {\n      const schoolData = location.state.schoolData;\n      // Verificar se  uma escola diferente da atual\n      const isDifferentSchool = !painelInfo || painelInfo.id !== schoolData.id;\n      if (isDifferentSchool) {\n        logger.debug('MapaEscolasIndigenas: Abrindo painel a partir do navigation state:', schoolData.titulo);\n        setPainelInfo(schoolData);\n      }\n    }\n  }, [location.state?.schoolData?.id, painelInfo?.id]);\n\n  // Expor a funo abrirPainel e refreshPainel para componentes externos\n  useEffect(() => {\n    logger.debug('MapaEscolasIndigenas: onPainelOpen disponvel:', !!onPainelOpen);\n    logger.debug('MapaEscolasIndigenas: abrirPainel disponvel:', !!abrirPainel);\n    if (onPainelOpen && typeof onPainelOpen === 'function') {\n      logger.debug('MapaEscolasIndigenas: Expondo funo abrirPainel e refreshPainel');\n      onPainelOpen(abrirPainel, refreshPainel);\n    }\n  }, [abrirPainel, onPainelOpen, refreshPainel]);\n\n  // Otimizar a funo de fechar painel\n  const fecharPainel = useCallback(() => {\n    setPainelInfo(null);\n  }, []);\n\n  return (\n    <div className=\"relative h-screen w-full overflow-hidden\">\n      {/* Novo mapa sem gaps */}\n      <MapSelector\n        dataPoints={escolasVisiveis}\n        onPainelOpen={abrirPainel}\n        painelAberto={!!painelInfo}\n        className=\"h-full w-full\"\n        isMainLoading={isLoading}\n      />\n\n      {/* Painel de informaes */}\n      {painelInfo && (\n        <PainelInformacoes \n          painelInfo={painelInfo} \n          closePainel={fecharPainel} \n          refreshKey={refreshKey}\n        />\n      )}\n      <div className=\"fixed top-1/2 -translate-y-1/2 left-4 z-30 pointer-events-auto\">\n        <Link\n          to=\"/\"\n          className=\"block rounded-xl bg-green-900/90 hover:bg-green-800 p-2.5 cursor-pointer transition-all duration-200\"\n          aria-label=\"Sair do mapa e voltar para a pgina inicial\"\n          title=\"Sair do mapa\"\n        >\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\">\n            <path d=\"M16 17L21 12L16 7\" stroke=\"#CDE8CF\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"></path>\n            <path d=\"M21 12H9\" stroke=\"#CDE8CF\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"></path>\n            <path d=\"M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9\" stroke=\"#CDE8CF\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"></path>\n          </svg>\n        </Link>\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(MapaEscolasIndigenas);","import { supabase } from '../supabaseClient';\n\n/**\n * Servio para gerenciar legendas de fotos\n */\n\n/**\n * Testar se a tabela legendas_fotos existe e est acessvel\n * @returns {Promise<boolean>} True se a tabela existe\n */\nexport const testLegendasTable = async () => {\n  try {\n    const { error } = await supabase\n      .from('legendas_fotos')\n      .select('count')\n      .limit(1);\n    \n    if (error) {\n      console.warn('Tabela legendas_fotos no encontrada ou sem permisso:', error.message);\n      return false;\n    }\n    \n    console.log('Tabela legendas_fotos acessvel');\n    return true;\n  } catch (error) {\n    console.warn('Erro ao testar tabela legendas_fotos:', error.message);\n    return false;\n  }\n};\n\n/**\n * Buscar legenda por URL da imagem (todos os atributos opcionais)\n * @param {string} imageUrl - URL da imagem\n * @param {number} escolaId - ID da escola\n * @param {Object} options - Opes de busca (todos opcionais)\n * @param {string} options.categoria - Categoria da imagem\n * @param {string} options.tipo_foto - Tipo da foto\n * @param {boolean} options.ativo - Se deve buscar apenas ativas\n * @returns {Promise<Object|null>} Legenda encontrada ou null\n */\nexport const getLegendaByImageUrl = async (imageUrl, escolaId, options = {}) => {\n  try {\n    let query = supabase\n      .from('legendas_fotos')\n      .select('*')\n      .eq('imagem_url', imageUrl)\n      .eq('escola_id', escolaId);\n\n    // Aplicar filtros opcionais\n    if (options.ativo !== false) { // Por padro, busca apenas ativas\n      query = query.eq('ativo', true);\n    }\n    \n    if (options.categoria) {\n      query = query.eq('categoria', options.categoria);\n    }\n    \n    if (options.tipo_foto) {\n      query = query.eq('tipo_foto', options.tipo_foto);\n    }\n\n    const { data, error } = await query.order('created_at', { ascending: false });\n\n    if (error) {\n      console.warn('Erro ao buscar legenda:', error.message);\n      return null;\n    }\n\n    // Retorna a primeira legenda encontrada (mais recente)\n    return data && data.length > 0 ? data[0] : null;\n  } catch (error) {\n    console.warn('Erro ao buscar legenda:', error.message);\n    return null;\n  }\n};\n\n/**\n * Buscar legenda por URL da imagem (busca flexvel com mltiplas estratgias)\n * @param {string} imageUrl - URL da imagem\n * @param {number} escolaId - ID da escola\n * @param {Object} preferencias - Preferncias de busca (todos opcionais)\n * @param {string} preferencias.categoria - Categoria preferida\n * @param {string} preferencias.tipo_foto - Tipo de foto preferido\n * @returns {Promise<Object|null>} Legenda encontrada ou null\n */\nexport const getLegendaByImageUrlFlexivel = async (imageUrl, escolaId, preferencias = {}) => {\n  try {\n    console.log(` Buscando legenda flexvel para: ${imageUrl} (escola: ${escolaId})`);\n    \n    // Estratgia 1: Busca com preferncias especficas\n    if (preferencias.categoria || preferencias.tipo_foto) {\n      console.log('   Tentativa 1: Busca com preferncias especficas');\n      const legenda = await getLegendaByImageUrl(imageUrl, escolaId, preferencias);\n      if (legenda) {\n        console.log('   Encontrada com preferncias especficas');\n        return legenda;\n      }\n    }\n\n    // Estratgia 2: Busca apenas por URL e escola (sem outros filtros)\n    console.log('   Tentativa 2: Busca apenas por URL e escola');\n    const { data: data2, error: error2 } = await supabase\n      .from('legendas_fotos')\n      .select('*')\n      .eq('imagem_url', imageUrl)\n      .eq('escola_id', escolaId)\n      .eq('ativo', true)\n      .order('created_at', { ascending: false });\n\n    if (error2) {\n      console.warn('   Erro na busca por URL e escola:', error2.message);\n    } else if (data2 && data2.length > 0) {\n      console.log('   Encontrada por URL e escola');\n      return data2[0];\n    }\n\n    // Estratgia 3: Busca incluindo legendas inativas\n    console.log('   Tentativa 3: Busca incluindo legendas inativas');\n    const { data: data3, error: error3 } = await supabase\n      .from('legendas_fotos')\n      .select('*')\n      .eq('imagem_url', imageUrl)\n      .eq('escola_id', escolaId)\n      .order('created_at', { ascending: false });\n\n    if (error3) {\n      console.warn('   Erro na busca incluindo inativas:', error3.message);\n    } else if (data3 && data3.length > 0) {\n      console.log('   Encontrada incluindo legendas inativas');\n      return data3[0];\n    }\n\n    // Estratgia 4: Busca por nome do arquivo (sem caminho completo)\n    const nomeArquivo = imageUrl.split('/').pop();\n    console.log(`   Tentativa 4: Busca por nome do arquivo: ${nomeArquivo}`);\n    const { data: data4, error: error4 } = await supabase\n      .from('legendas_fotos')\n      .select('*')\n      .ilike('imagem_url', `%${nomeArquivo}`)\n      .eq('escola_id', escolaId)\n      .eq('ativo', true)\n      .order('created_at', { ascending: false });\n\n    if (error4) {\n      console.warn('   Erro na busca por nome do arquivo:', error4.message);\n    } else if (data4 && data4.length > 0) {\n      console.log('   Encontrada por nome do arquivo');\n      return data4[0];\n    }\n\n    console.log('   Nenhuma legenda encontrada com todas as estratgias');\n    return null;\n\n  } catch (error) {\n    console.warn('Erro ao buscar legenda flexvel:', error.message);\n    return null;\n  }\n};\n\n/**\n * Buscar legenda por URL da imagem (sem filtro de categoria) - MANTIDA PARA COMPATIBILIDADE\n * @param {string} imageUrl - URL da imagem\n * @param {number} escolaId - ID da escola\n * @returns {Promise<Object|null>} Legenda encontrada ou null\n */\nexport const getLegendaByImageUrlAnyCategory = async (imageUrl, escolaId) => {\n  return getLegendaByImageUrlFlexivel(imageUrl, escolaId);\n};\n\n/**\n * Adicionar nova legenda de foto\n * @param {Object} legendaData - Dados da legenda\n * @returns {Promise<Object>} Legenda criada\n */\nexport const addLegendaFoto = async (legendaData) => {\n  try {\n    const { data, error } = await supabase\n      .from('legendas_fotos')\n      .insert([legendaData])\n      .select()\n      .single();\n\n    if (error) {\n      throw error;\n    }\n\n    return data;\n  } catch (error) {\n    console.error('Erro ao adicionar legenda:', error);\n    throw error;\n  }\n};\n\n/**\n * Atualizar legenda de foto existente\n * @param {number} legendaId - ID da legenda\n * @param {Object} updateData - Dados para atualizar\n * @returns {Promise<Object>} Legenda atualizada\n */\nexport const updateLegendaFoto = async (legendaId, updateData) => {\n  try {\n    const { data, error } = await supabase\n      .from('legendas_fotos')\n      .update(updateData)\n      .eq('id', legendaId)\n      .select()\n      .single();\n\n    if (error) {\n      throw error;\n    }\n\n    return data;\n  } catch (error) {\n    console.error('Erro ao atualizar legenda:', error);\n    throw error;\n  }\n};\n\n/**\n * Deletar legenda de foto\n * @param {number} legendaId - ID da legenda\n * @returns {Promise<boolean>} True se deletado com sucesso\n */\nexport const deleteLegendaFoto = async (legendaId) => {\n  try {\n    const { error } = await supabase\n      .from('legendas_fotos')\n      .delete()\n      .eq('id', legendaId);\n\n    if (error) {\n      throw error;\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Erro ao deletar legenda:', error);\n    throw error;\n  }\n};\n\n/**\n * Buscar todas as legendas de uma escola\n * @param {number} escolaId - ID da escola\n * @param {string} categoria - Categoria das imagens (opcional)\n * @returns {Promise<Array>} Lista de legendas\n */\nexport const getLegendasByEscola = async (escolaId, categoria = null) => {\n  try {\n    let query = supabase\n      .from('legendas_fotos')\n      .select('*')\n      .eq('escola_id', escolaId);\n\n    if (categoria) {\n      query = query.eq('categoria', categoria);\n    }\n\n    const { data, error } = await query.order('created_at', { ascending: false });\n\n    if (error) {\n      throw error;\n    }\n\n    return data || [];\n  } catch (error) {\n    console.error('Erro ao buscar legendas da escola:', error);\n    throw error;\n  }\n};\n\n/**\n * Buscar ttulo personalizado de vdeo por URL\n * @param {string} videoUrl - URL do vdeo\n * @param {number} escolaId - ID da escola\n * @returns {Promise<Object|null>} Ttulo encontrado ou null\n */\nexport const getTituloByVideoUrl = async (videoUrl, escolaId) => {\n  try {\n    const { data, error } = await supabase\n      .from('legendas_fotos')\n      .select('*')\n      .eq('imagem_url', videoUrl)\n      .eq('escola_id', escolaId)\n      .eq('categoria', 'video')\n      .single();\n\n    if (error) {\n      // Se no encontrar, retorna null (no  erro)\n      if (error.code === 'PGRST116') {\n        return null;\n      }\n      throw error;\n    }\n\n    return data;\n  } catch (error) {\n    console.warn('Erro ao buscar ttulo do vdeo:', error.message);\n    return null;\n  }\n};\n\nconst LegendasService = {\n  testLegendasTable,\n  getLegendaByImageUrl,\n  getLegendaByImageUrlFlexivel,\n  getLegendaByImageUrlAnyCategory,\n  addLegendaFoto,\n  updateLegendaFoto,\n  deleteLegendaFoto,\n  getLegendasByEscola,\n  getTituloByVideoUrl\n};\n\nexport default LegendasService;\n","import { supabase } from '../supabaseClient';\n\n// Configuraes para imagens das histrias do professor\nconst HISTORIA_PROFESSOR_CONFIG = {\n  BUCKET_NAME: 'historia-professor-imagens',\n  MAX_FILE_SIZE: 5 * 1024 * 1024, // 5MB\n  ALLOWED_TYPES: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp', 'image/gif'],\n  MAX_IMAGES_PER_HISTORIA: 1,\n  MIN_DIMENSIONS: { width: 200, height: 200 }\n};\n\n/**\n * Valida um arquivo de imagem\n * @param {File} file - Arquivo a ser validado\n * @returns {Object} Resultado da validao\n */\nconst validateImageFile = (file) => {\n  // Verificar tipo MIME\n  if (!HISTORIA_PROFESSOR_CONFIG.ALLOWED_TYPES.includes(file.type)) {\n    return {\n      isValid: false,\n      error: `Tipo de arquivo no suportado. Use apenas: ${HISTORIA_PROFESSOR_CONFIG.ALLOWED_TYPES.map(t => t.split('/')[1].toUpperCase()).join(', ')}`\n    };\n  }\n\n  // Verificar tamanho\n  if (file.size > HISTORIA_PROFESSOR_CONFIG.MAX_FILE_SIZE) {\n    return {\n      isValid: false,\n      error: `Arquivo muito grande. Tamanho mximo: ${HISTORIA_PROFESSOR_CONFIG.MAX_FILE_SIZE / (1024 * 1024)}MB`\n    };\n  }\n\n  // Verificar extenso\n  const extension = file.name.split('.').pop().toLowerCase();\n  const allowedExtensions = HISTORIA_PROFESSOR_CONFIG.ALLOWED_TYPES.map(t => t.split('/')[1]);\n  if (!allowedExtensions.includes(extension)) {\n    return {\n      isValid: false,\n      error: `Extenso no permitida. Use apenas: ${allowedExtensions.join(', ')}`\n    };\n  }\n\n  return { isValid: true };\n};\n\n/**\n * Valida dimenses da imagem (opcional)\n * @param {File} file - Arquivo de imagem\n * @returns {Promise<boolean>} Se as dimenses so vlidas\n */\nconst validateImageDimensions = (file) => {\n  return new Promise((resolve) => {\n    const img = new Image();\n    img.onload = () => {\n      const isValid = img.width >= HISTORIA_PROFESSOR_CONFIG.MIN_DIMENSIONS.width &&\n                     img.height >= HISTORIA_PROFESSOR_CONFIG.MIN_DIMENSIONS.height;\n      resolve(isValid);\n    };\n    img.onerror = () => resolve(false);\n    img.src = URL.createObjectURL(file);\n  });\n};\n\n/**\n * Gera nome nico para o arquivo\n * @param {File} file - Arquivo\n * @param {number} escolaId - ID da escola\n * @param {number} historiaId - ID da histria\n * @returns {string} Nome nico do arquivo\n */\nconst generateUniqueFileName = (file, escolaId, historiaId) => {\n  const timestamp = Date.now();\n  const random = Math.random().toString(36).substring(2, 8);\n  const extension = file.name.split('.').pop().toLowerCase();\n  return `historia_${historiaId}_${timestamp}_${random}.${extension}`;\n};\n\n/**\n * Buscar todas as histrias do professor de uma escola\n * @param {number} escolaId - ID da escola\n * @returns {Promise<Array>} Lista de histrias\n */\nexport const getHistoriasProfessor = async (escolaId) => {\n  try {\n    const { data, error } = await supabase\n      .from('historias_professor')\n      .select('*')\n      .eq('escola_id', escolaId)\n      .eq('ativo', true)\n      .order('ordem', { ascending: true })\n      .order('created_at', { ascending: true });\n\n    if (error) {\n      throw error;\n    }\n\n    if (!data || data.length === 0) {\n      return [];\n    }\n\n    // Adicionar URLs pblicas das imagens\n    const historiasComImagens = data.map((historia) => {\n      if (historia.imagem_url) {\n        try {\n          const { data: { publicUrl } } = supabase.storage\n            .from(HISTORIA_PROFESSOR_CONFIG.BUCKET_NAME)\n            .getPublicUrl(historia.imagem_url);\n\n          return { ...historia, imagem_public_url: publicUrl };\n        } catch (err) {\n          return { ...historia, imagem_public_url: null, urlError: err.message };\n        }\n      }\n      return historia;\n    });\n\n    return historiasComImagens;\n\n  } catch (error) {\n    console.error('Erro ao buscar histrias do professor:', error);\n    throw error;\n  }\n};\n\n/**\n * Criar nova histria do professor\n * @param {Object} historiaData - Dados da histria\n * @returns {Promise<Object>} Histria criada\n */\nexport const createHistoriaProfessor = async (historiaData) => {\n  try {\n    const { data, error } = await supabase\n      .from('historias_professor')\n      .insert([{\n        escola_id: historiaData.escola_id,\n        nome_professor: historiaData.nome_professor || null,\n        historia: historiaData.historia,\n        ordem: historiaData.ordem || 1,\n        ativo: historiaData.ativo !== false,\n        foto_rosto: historiaData.foto_rosto || null\n      }])\n      .select()\n      .single();\n\n    if (error) {\n      throw error;\n    }\n\n    return data;\n\n  } catch (error) {\n    console.error('Erro ao criar histria do professor:', error);\n    throw error;\n  }\n};\n\n/**\n * Atualizar histria do professor\n * @param {number} historiaId - ID da histria\n * @param {Object} historiaData - Dados atualizados\n * @returns {Promise<Object>} Histria atualizada\n */\nexport const updateHistoriaProfessor = async (historiaId, historiaData) => {\n  try {\n    const { data, error } = await supabase\n      .from('historias_professor')\n      .update({\n        nome_professor: historiaData.nome_professor,\n        historia: historiaData.historia,\n        ordem: historiaData.ordem,\n        ativo: historiaData.ativo,\n        foto_rosto: historiaData.foto_rosto || null,\n        updated_at: new Date().toISOString()\n      })\n      .eq('id', historiaId)\n      .select()\n      .single();\n\n    if (error) {\n      throw error;\n    }\n\n    return data;\n\n  } catch (error) {\n    console.error('Erro ao atualizar histria do professor:', error);\n    throw error;\n  }\n};\n\n/**\n * Deletar histria do professor\n * @param {number} historiaId - ID da histria\n * @returns {Promise<void>}\n */\nexport const deleteHistoriaProfessor = async (historiaId) => {\n  try {\n    // Deletar a histria\n    const { error: deleteError } = await supabase\n      .from('historias_professor')\n      .delete()\n      .eq('id', historiaId);\n\n    if (deleteError) {\n      throw deleteError;\n    }\n  } catch (error) {\n    console.error('Erro ao deletar histria do professor:', error);\n    throw error;\n  }\n};\n\n/**\n * Upload de imagem para uma histria do professor\n * @param {File} file - Arquivo de imagem\n * @param {number} escolaId - ID da escola\n * @param {number} historiaId - ID da histria\n * @param {string} descricao - Descrio da imagem\n * @returns {Promise<Object>} Dados da imagem salva\n */\nexport const uploadHistoriaProfessorImage = async (file, escolaId, historiaId, descricao = '') => {\n  try {\n    // Validar arquivo\n    const validation = validateImageFile(file);\n    if (!validation.isValid) {\n      throw new Error(validation.error);\n    }\n\n    // Validar dimenses (opcional)\n    const hasValidDimensions = await validateImageDimensions(file);\n    if (!hasValidDimensions) {\n      console.warn('Imagem com dimenses menores que o recomendado');\n    }\n\n    // Gerar nome nico\n    const fileName = generateUniqueFileName(file, escolaId, historiaId);\n    const filePath = `${escolaId}/${fileName}`;\n\n    // Upload ao bucket\n    const { error: uploadError } = await supabase.storage\n      .from(HISTORIA_PROFESSOR_CONFIG.BUCKET_NAME)\n      .upload(filePath, file, {\n        cacheControl: '3600',\n        upsert: false\n      });\n\n    if (uploadError) {\n      throw new Error(`Erro no upload: ${uploadError.message}`);\n    }\n\n    // Obter URL pblica - no usado\n    // const { data: { publicUrl } } = supabase.storage\n    //   .from(HISTORIA_PROFESSOR_CONFIG.BUCKET_NAME)\n    //   .getPublicUrl(filePath);\n\n    // Atualizar a histria com a URL da imagem\n    const { data: historia, error: updateError } = await supabase\n      .from('historias_professor')\n      .update({\n        descricao_imagem: descricao.trim() || null,\n        updated_at: new Date().toISOString()\n      })\n      .eq('id', historiaId)\n      .select()\n      .single();\n\n    if (updateError) {\n      // Se falhar ao atualizar, deletar o arquivo\n      await supabase.storage\n        .from(HISTORIA_PROFESSOR_CONFIG.BUCKET_NAME)\n        .remove([filePath]);\n      throw new Error(`Erro ao salvar metadados: ${updateError.message}`);\n    }\n\n    return {\n      id: historia.id,\n      descricao_imagem: historia.descricao_imagem\n    };\n\n  } catch (error) {\n    console.error('Erro no upload da imagem da histria do professor:', error);\n    throw error;\n  }\n};\n\n/**\n * Deletar imagem de uma histria do professor\n * @param {number} historiaId - ID da histria\n * @returns {Promise<void>}\n */\nexport const deleteHistoriaProfessorImage = async (historiaId) => {\n  try {\n    // Buscar a histria para obter a URL da imagem\n    const { data: historia, error: fetchError } = await supabase\n      .from('historias_professor')\n      .select('imagem_url')\n      .eq('id', historiaId)\n      .single();\n\n    if (fetchError) {\n      throw fetchError;\n    }\n\n    if (!historia.imagem_url) {\n      return; // No h imagem para deletar\n    }\n\n    // Atualizar a histria removendo a referncia da imagem\n    const { error: updateError } = await supabase\n      .from('historias_professor')\n      .update({\n        descricao_imagem: null,\n        updated_at: new Date().toISOString()\n      })\n      .eq('id', historiaId);\n\n    if (updateError) {\n      throw updateError;\n    }\n\n    // Deletar arquivo do storage\n    const { error: storageError } = await supabase.storage\n      .from(HISTORIA_PROFESSOR_CONFIG.BUCKET_NAME)\n      .remove([historia.imagem_url]);\n\n    if (storageError) {\n      console.warn('Erro ao deletar imagem do storage:', storageError);\n    }\n\n  } catch (error) {\n    console.error('Erro ao deletar imagem da histria do professor:', error);\n    throw error;\n  }\n};\n\n/**\n * Migrar dados existentes da tabela escolas_completa\n * @returns {Promise<Object>} Resultado da migrao\n */\nexport const migrarDadosExistentes = async () => {\n  try {\n    // Buscar escolas com histria do professor\n    const { data: escolas, error: fetchError } = await supabase\n      .from('escolas_completa')\n      .select('id, historia_do_prof')\n      .not('historia_do_prof', 'is', null)\n      .neq('historia_do_prof', '');\n\n    if (fetchError) {\n      throw fetchError;\n    }\n\n    if (!escolas || escolas.length === 0) {\n      return { migradas: 0, mensagem: 'Nenhuma histria para migrar' };\n    }\n\n    // Inserir histrias na nova tabela\n    const historiasParaInserir = escolas.map(escola => ({\n      escola_id: escola.id,\n      historia: escola.historia_do_prof,\n      ordem: 1,\n      ativo: true,\n      created_at: new Date().toISOString()\n    }));\n\n    const { data: historiasInseridas, error: insertError } = await supabase\n      .from('historias_professor')\n      .insert(historiasParaInserir)\n      .select();\n\n    if (insertError) {\n      throw insertError;\n    }\n\n    return {\n      migradas: historiasInseridas.length,\n      mensagem: `${historiasInseridas.length} histrias migradas com sucesso`\n    };\n\n  } catch (error) {\n    console.error('Erro na migrao de dados:', error);\n    throw error;\n  }\n};\n\n/**\n * Verificar se uma escola tem histrias do professor\n * @param {number} escolaId - ID da escola\n * @returns {Promise<boolean>} Se tem histrias\n */\nexport const escolaTemHistoriasProfessor = async (escolaId) => {\n  try {\n    const { count, error } = await supabase\n      .from('historias_professor')\n      .select('*', { count: 'exact', head: true })\n      .eq('escola_id', escolaId)\n      .eq('ativo', true);\n\n    if (error) {\n      throw error;\n    }\n\n    return (count || 0) > 0;\n\n  } catch (error) {\n    console.error('Erro ao verificar histrias do professor:', error);\n    return false;\n  }\n}; "],"names":["_ref","url","title","description","copied","setCopied","useState","shareUrl","window","location","href","shareText","_jsxs","className","children","_jsx","FacebookShareButton","quote","Facebook","TwitterShareButton","Twitter","WhatsappShareButton","MessageCircle","onClick","async","navigator","clipboard","writeText","setTimeout","err","input","document","createElement","value","body","appendChild","select","execCommand","removeChild","Check","LinkIcon","MARKER_SVG_PATH","concat","process","createMarkerStyle","feature","showNames","arguments","length","undefined","markerData","get","isNearbyPair","markerStyle","Style","image","Icon","src","scale","anchor","anchorXUnits","anchorYUnits","geometry","getGeometry","titulo","text","Text","font","fill","Fill","color","stroke","Stroke","width","offsetY","textAlign","isMobile","innerWidth","isMobileWidth","isMobileUserAgent","test","userAgent","isMobileOrientation","orientation","maxTouchPoints","OpenLayersInteractions","constructor","map","options","this","_objectSpread","enableHover","enableClick","enableDoubleClick","enableTouch","hoverDelay","clickDelay","eventHandlers","Map","hoveredFeature","clickedFeature","clickTimeout","hoverTimeout","tooltipElement","console","log","initializeInteractions","mobile","hasTouch","windowWidth","setupHoverInteraction","setupClickInteraction","setupDoubleClickInteraction","setupTouchInteraction","on","event","handlePointerMove","handlePointerLeave","handleClick","handleDoubleClick","forEachFeatureAtPixel","pixel","type","schoolData","terraIndigenaInfo","clearHover","applyHover","handleMobileClick","clearTimeout","executeClickHandler","executeDoubleClickHandler","handleTouchEnd","forceHideTooltip","showTooltip","executeHoverHandler","applyHoverStyle","clearHoverStyle","hideTooltip","executeHoverOutHandler","hoverStyleFunction","tooltipContent","getTooltipContent","createTooltipElement","getTargetElement","remove","content","element","isTerraIndigena","includes","clickableContent","innerHTML","tooltipStyles","backgroundColor","borderColor","Object","assign","style","position","padding","borderRadius","fontSize","fontFamily","fontWeight","pointerEvents","zIndex","maxWidth","whiteSpace","overflow","textOverflow","boxShadow","border","cursor","clickableSpan","querySelector","textDecoration","textDecorationColor","textDecorationThickness","transition","display","addEventListener","transform","coordinate","getPixelFromCoordinate","left","top","tooltipContentFunction","handler","eventType","set","off","delete","clearHandlers","clear","updateOptions","newOptions","destroy","createDefaultInteractions","flyTo","_options$durationMs2","durationMs","view","getView","animateParams","center","duration","zoom","animate","LogLevel","LOG_LEVEL","debug","_len","args","Array","_key","info","_len2","_key2","warn","_len3","_key3","error","_len4","_key4","group","label","groupEnd","dataPoints","onPainelOpen","showMarcadores","showNomesEscolas","vectorSourceRef","useRef","vectorLayerRef","setHoveredMarker","React","initializeMarkers","useCallback","logger","current","VectorSource","VectorLayer","source","addLayer","setupInteractions","interactions","onMarkerClick","onMarkerHover","createMarkerInteractions","handleMarkerClick","handleMarkerHover","handleMarkerHoverOut","_feature$getGeometry","coord","getCoordinates","_options$durationMs4","fractionX","fractionY","mapSize","getSize","mapWidth","mapHeight","desiredX","Math","max","min","desiredY","pointPx","newCenterPx","newCenterCoord","getCoordinateFromPixel","flyToAtFractionX","_options$radiusPx","_options$durationMs","radiusPx","height","marginLeft","marginTop","overlay","Overlay","positioning","stopEvent","addOverlay","setPosition","cleanup","removeOverlay","_unused","once","showClickPulse","setStyle","f","baseStyle","hoverStyle","isArray","changed","updateMarkers","pontosValidos","filter","point","latitude","longitude","lat","parseFloat","lng","isNaN","forEach","index","Feature","Point","fromLonLat","addFeature","updateMarkerStyles","useEffect","removeLayer","LAYER_COLORS","terrasIndigenas","regularizada","hover","declarada","estadoSP","createTerrasIndigenasStyle","isHovered","properties","colorConfig","fase_ti","colors","lineDash","MAP_CONFIG","maxZoom","minZoom","clusterDistance","clusterMinDistance","clusterAnimationDuration","proximityThreshold","disableClusteringAtZoom","tooltipOffset","tooltipDelay","interaction","performance","enableLazyLoading","maxFeaturesPerTile","enableFeatureCulling","enableTileCaching","ANIMATION_CONFIG","marker","cluster","pan","easing","MARKER_COLORS","small","medium","large","xlarge","CLUSTER_SIZES","size","PROJECTION_CONFIG","BASE_LAYER_CONFIG","attributions","wrapX","tilePixelRatio","tileSize","forwardRef","ref","data","showTerrasIndigenas","interactionsRef","setHoveredFeature","selectedFeature","setSelectedFeature","isMobileDevice","useMemo","initializeLayer","features","geoJSONFeatures","GeoJSON","dataProjection","featureProjection","readFeatures","getProperties","terrai_nom","tipo","etnia","etnia_nome","municipio","municipio_","uf","uf_sigla","superficie","fase","modalidade","reestudo","reestudo_t","cr","faixa_fron","undadm_nom","undadm_sig","dominio_un","data_atual","terrai_cod","undadm_cod","onFeatureClick","onFeatureHover","createGeoJSONInteractions","handleFeatureClick","handleFeatureHover","handleFeatureHoverOut","extent","getExtent","fit","applySelectionStyleToFeature","selectionOptions","fillColor","strokeColor","strokeWidth","selectionStyle","applySelectionStyle","removeSelectionStyleFromFeature","timeout","showEstadoSP","createEstadoSPStyle","interactive","terrasIndigenasData","estadoSPData","terrasIndigenasRef","estadoSPRef","layersStatus","setLayersStatus","visible","loaded","hasValidData","updateLayerStatus","layerName","updates","prev","handleLayerError","message","handleLayerSuccess","getLayersStats","stats","total","errors","values","layer","getLayersInfo","hasData","featureCount","OpenLayersTerrasIndigenas","onLoad","onError","OpenLayersEstadoSP","useMapControls","screenSize","setScreenSize","innerHeight","setIsMobile","isTablet","setIsTablet","isDesktop","setIsDesktop","handleResize","removeEventListener","zoomConfig","bottom","buttonSize","spacing","accessibility","prefersReducedMotion","matchMedia","matches","prefersHighContrast","isLandscape","mapRef","controlsRef","zoomControl","getControls","getArray","find","control","getClassName","querySelectorAll","button","minHeight","minWidth","marginBottom","classList","add","JSON","stringify","props","id","proj4","defs","register","mapContainer","baseLayer","setMapInfo","initialCenter","initialZoom","createBaseLayers","satelliteLayer","TileLayer","XYZ","preload","useInterimTilesOnError","initializeMap","target","layers","View","enableRotation","controls","defaultControls","toLonLat","getCenter","newView","toFixed","getZoom","updateMapConfig","newCenter","newZoom","currentCenter","currentZoom","setCenter","setZoom","setTarget","MapWrapper","_Fragment","OpenLayersMarkers","OpenLayersLayers","ResponsiveZoomControls","cache","useGeoJSONCache","key","setData","loading","setLoading","setError","_geoJSON$features","response","fetch","ok","Error","status","geoJSON","json","fetchGeoJSON","useResponsiveIcon","isMinimized","minimized","path","ariaLabel","expanded","ResponsiveIcon","iconConfig","currentConfig","viewBox","strokeLinecap","strokeLinejoin","d","MapSelector","painelAberto","isMainLoading","terrasLoading","terrasError","estadoLoading","estadoError","setShowTerrasIndigenas","setShowEstadoSP","setShowMarcadores","useBreakpoint","setIsMinimized","handleMinimize","textScale","setTextScale","stored","localStorage","getItem","clamped","documentElement","setItem","String","_terrasIndigenasData$","_estadoSPData$feature","CabecalhoMenu","_ref2","onMinimize","BotaoCamada","_ref3","checked","onChange","disabled","role","mapCenter","mapZoom","v","round","xmlns","fillRule","clipRule","OpenLayersMap","escolaId","documentos","setDocumentos","isLoading","setIsLoading","authData","authError","supabase","auth","getSession","temSessao","session","rlsError","from","limit","podeAcessar","code","details","hint","allDocs","allDocsError","doc","escola_id","tipo_escola_id","valor_escola_id","eq","toString","order","ascending","dataAsNumber","errorAsNumber","Number","dataAsString","errorAsString","count","fetchDocumentos","InfoGrid","memo","columns","gap","InfoTable","row","InfoStats","_ref4","stat","icon","_ref5","defaultCollapsed","layout","layoutProps","isCollapsed","setIsCollapsed","renderContent","capitalize","str","charAt","toUpperCase","slice","toLowerCase","CompactCard","renderValue","X","AddressDetails","escola","logradouro","numero","bairro","cep","endereco","field","MapPin","estado","Boolean","join","MapButton","Latitude","Longitude","openMap","open","Navigation","SocialLinks","links","onToggle","socialLinks","split","trim","social","Globe","ChevronRight","link","rel","ExternalLink","_ref6","setExpanded","toggle","basicInfoCards","Building","Calendar","ano_criacao","usa_redes_sociais","item","povos_indigenas","InfoSection","diretoria_ensino","links_redes_sociais","htmlContent","dangerouslySetInnerHTML","__html","HistoriaEscolaHeader","alt","margin","outline","refreshKey","isMaximized","historia_da_escola","HistoriaEscolaContent","ExpandableList","items","maxVisible","idx","MiniCard","turnosValue","turnos_funcionamento","modalidadeList","modalidade_ensino","gridItems","Clock","Users","numero_alunos","linguas_faladas","materiaisItems","BookOpen","BooleanValue","material_nao_indigena","material_indigena","ppp_proprio","ppp_comunidade","Sparkles","remainingCards","groups","i","push","groupIdx","Droplet","acesso_agua","Trash2","coleta_lixo","Wifi","acesso_internet","Monitor","equipamentos","modo_acesso","Utensils","cozinha","Apple","merenda_escolar","ChefHat","diferenciada","Home","espaco_escolar","renderBooleanStatus","valor","normalizado","formacao","resto","descricao","formatarFormacaoProfessores","formacao_professores","continuada","formatarFormacaoContinuada","formacao_continuada","UsersRound","UserCheck","professores_indigenas","UserMinus","professores_nao_indigenas","professores_falam_lingua","Star","User","gestao","outros_funcionarios","NotebookPen","ProjectCard","isNegative","availableProjects","GraduationCap","Heart","Target","project","images","currentImageIndex","isOpen","onClose","onImageChange","showNavigation","showControls","showCounter","showCaption","zoomLevel","setZoomLevel","rotation","setRotation","currentIndex","setCurrentIndex","currentImage","fecharZoom","resetImage","nextImage","newIndex","prevImage","handleEsc","e","handleKeyDown","preventDefault","stopPropagation","ZoomIn","ZoomOut","RotateCw","ChevronLeft","publicURL","imagem_public_url","descricao_imagem","onMouseDown","categoria","autor","dataFoto","Date","toLocaleDateString","descricaoDetalhada","isPreloaded","placeholder","_objectWithoutProperties","_excluded","imageLoaded","setImageLoaded","imageError","setImageError","showImage","setShowImage","handleImageLoad","handleImageError","enabled","preloadedImages","setPreloadedImages","isPreloading","setIsPreloading","preloadTimeoutRef","preloadImages","promises","urls","Promise","resolve","reject","img","Image","onload","onerror","preloadImage","catch","all","startPreload","escolaFiles","storage","list","professorFiles","urlsToPreload","file","publicUrl","getPublicUrl","name","batchSize","batches","batch","preloadedMap","isImagePreloaded","has","ImagemHistoriadoProfessor","imagens","setImagens","imagemZoom","setImagemZoom","setCurrentImageIndex","useImagePreloader","then","imagensComUrl","_legenda","_legenda2","_legenda3","_legenda4","_legenda5","genero","startsWith","legenda","caminhoRelativo","getLegendaByImageUrlFlexivel","tipo_foto","nome","created_at","descricao_detalhada","autor_foto","data_foto","OptimizedImage","maxHeight","ReusableImageZoom","customSize","shape","variant","clickable","textColor","badge","badgePosition","badgeColor","badgeSize","fallbackIcon","showInitials","maxInitials","lazy","priority","imageLoading","setImageLoading","sizeConfig","container","sizes","xs","xxlarge","shapeConfig","shapes","circle","square","rounded","none","variantConfig","variants","default","shadow","minimal","flat","elevated","badgeConfig","positions","badgeSizes","initials","word","char","match","FallbackIcon","icons","user","alert","AlertCircle","Loader2","shouldShowImage","shouldShowInitials","shouldShowIcon","baseClasses","replace","tabIndex","fetchPriority","avatarThemes","hoverBorderColor","professor","neutral","indigena","success","warning","fotoUrl","nomeProfessor","tamanho","showFallback","theme","mappedSize","themeConfig","Avatar","historias","setHistorias","currentHistoriaIndex","setCurrentHistoriaIndex","getHistoriasProfessor","carregarHistorias","nextHistoria","prevHistoria","currentHistoria","hasMultipleHistorias","nome_professor","FotoProfessor","foto_rosto","historia","_","ImagensdasEscolas","cacheRef","cacheVersion","setCacheVersion","limparCacheERecarregar","cacheKey","files","imagensEncontradas","filePath","urlError","buscarImagens","RefreshCw","findIndex","GridLayoutWrapper","shouldUseGrid","containerClasses","sectionRefs","gridSections","Component","BasicInfo","Modalidades","Infraestrutura","GestaoProfessores","ProjetosParcerias","el","dados","HistoriaEscola","depoimentos","HistoriadoProfessor","isTextArea","LargeHandFistIcon","HandFistIcon","terraIndigena","InfoItem","PainelDescricao","sanitizedHTML","DOMPurify","sanitize","formattedText","endsWith","formatText","ALLOWED_TAGS","ALLOWED_ATTR","ADD_TAGS","ADD_ATTR","KEEP_CONTENT","ALLOW_DATA_ATTR","lineHeight","letterSpacing","painelInfo","audioUrl","SIGLAS_MAIUSCULAS","capitalizeWords","substr","formatarTituloEscola","tituloLower","partes","indiceAldeia","parte","nomeAldeia","closePainel","toggleMaximize","imagemHeader","shareTitle","isMobileLandscape","isVerySmallLandscape","headerHalfClass","MinimalShareButtons","Minimize2","Maximize2","imagemUrl","SidebarMediaViewer","showTeacher","showSchool","scrollProgress","headerUrl","onCurrentItemChange","setItems","setCurrent","manualOverrideUntil","setManualOverrideUntil","fetchBucketList","bucket","listErr","origem","mounted","combined","exists","some","headerItem","ordered","sort","a","b","localeCompare","hasItems","currentItem","now","floor","isFinite","next","isVisible","setIsVisible","PainelContainer","onToggleMaximize","contentRef","rightNav","setScrollProgress","currentImageCaption","setCurrentImageCaption","usePainelVisibility","painelDimensions","usePainelDimensions","setWindowWidth","windowHeight","setWindowHeight","breakpoints","sm","md","lg","xl","dimensions","panelWidth","visibilityClasses","flexDirection","PainelHeader","imagem_header","onScroll","currentTarget","scrollHeight","clientHeight","ratio","scrollTop","EscolaHeaderImage","transformarLinkGoogleDrive","fileId","ViewModeToggle","viewMode","setViewMode","DocumentViewer","selectedDoc","setSelectedDoc","iframeRef","iframeError","setIframeError","useGoogleDocsViewer","setUseGoogleDocsViewer","iframe","handleLoad","handleError","autoria","renderDocumentViewer","isGoogleDriveLink","link_pdf","allow","sandbox","VideoPlayer","videoUrl","tituloPersonalizado","setTituloPersonalizado","getTituloByVideoUrl","buscarTitulo","videoId","baseUrl","patterns","pattern","extrairIdYoutube","plataforma","duracao","frameBorder","allowFullScreen","referrerPolicy","PainelInformacoes","painelRef","activeIndex","setActiveIndex","setIsMaximized","gerarLinkCustomizado","origin","pathname","criarSlug","copiarLink","compartilhar","texto","share","encodeURIComponent","useShare","useDocumentosEscola","useClickOutside","useDynamicURL","lastUrlRef","timeoutRef","newUrl","history","replaceState","listener","contains","sections","link_para_videos","handleScroll","containerRect","getBoundingClientRect","bestIndex","bestDelta","Infinity","s","sec","r","delta","abs","passive","isIntro","IntroPanel","TerraIndigenaInfo","EscolaInfo","MapaEscolasIndigenas","_location$state3","_location$state3$scho","quantidade","exemplo","useRefresh","useLocation","panel","URLSearchParams","search","initialPanel","_location$state","state","setPainelInfo","initialPanelOpened","setInitialPanelOpened","escolasVisiveis","pontuacao","abrirPainel","refreshPainel","_location$state2","fecharPainel","Link","to","testLegendasTable","getLegendaByImageUrl","imageUrl","query","ativo","preferencias","data2","error2","data3","error3","nomeArquivo","pop","data4","error4","ilike","addLegendaFoto","insert","legendaData","single","updateLegendaFoto","legendaId","updateData","update","HISTORIA_PROFESSOR_CONFIG","BUCKET_NAME","MAX_FILE_SIZE","ALLOWED_TYPES","MAX_IMAGES_PER_HISTORIA","MIN_DIMENSIONS","imagem_url","createHistoriaProfessor","historiaData","ordem","updateHistoriaProfessor","historiaId","updated_at","toISOString","deleteHistoriaProfessor","deleteError"],"sourceRoot":""}