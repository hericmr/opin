"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[357],{1440:(e,a,s)=>{s.d(a,{Gw:()=>d,gE:()=>i,vS:()=>c,vx:()=>m,wG:()=>l});var o=s(2880);const r={BUCKET_NAME:"imagens-das-escolas",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:1/0,MIN_DIMENSIONS:{width:200,height:200}},t={BUCKET_NAME:"imagens-professores",MAX_FILE_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/jpg","image/png","image/webp","image/gif"],MAX_IMAGES_PER_SCHOOL:1/0,MIN_DIMENSIONS:{width:200,height:200}},n=(e,a)=>{if(!a.ALLOWED_TYPES.includes(e.type))return{isValid:!1,error:"Tipo de arquivo n\xe3o suportado. Use apenas: ".concat(a.ALLOWED_TYPES.map((e=>e.split("/")[1].toUpperCase())).join(", "))};if(e.size>a.MAX_FILE_SIZE)return{isValid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(a.MAX_FILE_SIZE/1048576,"MB")};const s=e.name.split(".").pop().toLowerCase(),o=a.ALLOWED_TYPES.map((e=>e.split("/")[1]));return o.includes(s)?{isValid:!0}:{isValid:!1,error:"Extens\xe3o n\xe3o permitida. Use apenas: ".concat(o.join(", "))}},i=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const t=n(e,r);if(!t.isValid)throw new Error(t.error);const i=((e,a)=>{const s=Date.now(),o=Math.random().toString(36).substring(2,8),r=e.name.split(".").pop().toLowerCase();return"".concat(a,"_").concat(s,"_").concat(o,".").concat(r)})(e,a),l="".concat(a,"/").concat(i),{error:d}=await o.N.storage.from(r.BUCKET_NAME).upload(l,e,{cacheControl:"3600",upsert:!1});if(d)throw new Error("Erro no upload: ".concat(d.message));const{data:{publicUrl:c}}=o.N.storage.from(r.BUCKET_NAME).getPublicUrl(l);return{id:Date.now(),url:l,publicUrl:c,descricao:s.trim()||"Imagem da escola ".concat(a),created_at:(new Date).toISOString()}}catch(t){throw console.error("Erro no upload da imagem da escola:",t),t}},l=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"professor";try{const i=n(e,t);if(!i.isValid)throw new Error(i.error);const l=((e,a,s)=>{const o=Date.now(),r=Math.random().toString(36).substring(2,8),t=e.name.split(".").pop().toLowerCase();return"".concat(s,"_").concat(a,"_").concat(o,"_").concat(r,".").concat(t)})(e,a,r),d="".concat(a,"/").concat(l),{error:c}=await o.N.storage.from(t.BUCKET_NAME).upload(d,e,{cacheControl:"3600",upsert:!1});if(c)throw console.error("Erro detalhado do upload:",c),new Error("Erro no upload: ".concat(c.message));const{data:{publicUrl:m}}=o.N.storage.from(t.BUCKET_NAME).getPublicUrl(d);return{id:Date.now(),url:d,publicUrl:m,descricao:s.trim()||"Imagem do ".concat(r," da escola ").concat(a),genero:r,created_at:(new Date).toISOString()}}catch(i){throw console.error("Erro no upload da imagem do professor:",i),i}},d=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BUCKET_NAME;try{const{data:s,error:r}=await o.N.storage.from(a).list("".concat(e,"/"));if(r)throw r;if(!s||0===s.length)return[];return s.map(((s,r)=>{const t="".concat(e,"/").concat(s.name),{data:{publicUrl:n}}=o.N.storage.from(a).getPublicUrl(t);return{id:r+1,url:t,publicUrl:n,descricao:"Imagem ".concat(r+1),created_at:s.created_at||(new Date).toISOString()}}))}catch(s){throw console.error("Erro ao buscar imagens da escola:",s),s}},c=async(e,a,s)=>{try{const{error:e}=await o.N.storage.from(s).remove([a]);if(e)throw new Error("Erro ao deletar arquivo: ".concat(e.message))}catch(r){throw console.error("Erro ao deletar imagem:",r),r}},m=async(e,a)=>{try{return{id:e,descricao:a.trim()}}catch(s){throw console.error("Erro ao atualizar descri\xe7\xe3o da imagem:",s),s}}},1553:(e,a,s)=>{s.r(a),s.d(a,{default:()=>fe});var o=s(5043),r=s(9379),t=s(3303),n=s(2880);const i=()=>{const[e,a]=(0,o.useState)([]),[s,t]=(0,o.useState)(!0),[i,l]=(0,o.useState)(null),[d,c]=(0,o.useState)(""),[m,u]=(0,o.useState)("todos"),g=(0,o.useCallback)((async()=>{try{t(!0),l(null);const{data:e,error:s}=await n.N.from("escolas_completa").select("*").order("Escola",{ascending:!0});if(s)throw s;const o=e.map((e=>(0,r.A)((0,r.A)({},e),{},{logradouro:e.logradouro||"",numero:e.numero||"",complemento:e.complemento||"",bairro:e.bairro||"",cep:e.cep||"",estado:e.estado||"SP"})));a(o)}catch(e){console.error("Erro ao buscar escolas:",e),l(e.message)}finally{t(!1)}}),[]),x=(0,o.useCallback)((()=>e.filter((e=>{var a;return null===(a=e.Escola)||void 0===a?void 0:a.toLowerCase().includes(d.toLowerCase())}))),[e,d]),p=(0,o.useCallback)(((e,s)=>{a((a=>a.map((a=>a.id===e?(0,r.A)((0,r.A)({},a),s):a))))}),[]),b=(0,o.useCallback)((e=>{a((a=>[...a,e]))}),[]),h=(0,o.useCallback)((e=>{a((a=>a.filter((a=>a.id!==e))))}),[]),f=(0,o.useCallback)((a=>e.find((e=>e.id===a))),[e]),y=(0,o.useCallback)((a=>e.find((e=>{var s;return(null===(s=e.Escola)||void 0===s?void 0:s.toLowerCase())===a.toLowerCase()}))),[e]),v=(0,o.useCallback)((async e=>{try{if(l(null),e.id){const{data:a,error:s}=await n.N.from("escolas_completa").update({Escola:e.Escola,"Munic\xedpio":e["Munic\xedpio"],"Endere\xe7o":e["Endere\xe7o"],"Terra Indigena (TI)":e["Terra Indigena (TI)"],"Parcerias com o munic\xedpio":e["Parcerias com o munic\xedpio"],"Diretoria de Ensino":e["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":e["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":e["Povos indigenas"],"Linguas faladas":e["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":e["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":e["Numero de alunos"],turnos_funcionamento:e.turnos_funcionamento,"Espa\xe7o escolar e estrutura":e["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":e["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":e["Tem coleta de lixo?"],"Acesso \xe0 internet":e["Acesso \xe0 internet"],"Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":e["Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)"],"Modo de acesso \xe0 escola":e["Modo de acesso \xe0 escola"],"Gest\xe3o/Nome":e["Gest\xe3o/Nome"],"Outros funcion\xe1rios":e["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":e["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":e["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":e["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":e["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":e["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":e["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":e["PPP elaborado com a comunidade?"],"Projetos em andamento":e["Projetos em andamento"],"Parcerias com universidades?":e["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":e["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":e["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":e["Escola utiliza redes sociais?"],"Links das redes sociais":e["Links das redes sociais"],historia_da_escola:e.historia_da_escola,Latitude:e.Latitude,Longitude:e.Longitude,historia_do_prof:e.historia_do_prof,links:e.links,link_para_videos:e.link_para_videos,logradouro:e.logradouro,numero:e.numero,complemento:e.complemento,bairro:e.bairro,cep:e.cep,estado:e.estado,nome_professor:e.nome_professor,professores_indigenas:e.professores_indigenas,professores_nao_indigenas:e.professores_nao_indigenas,professores_falam_lingua_indigena:e.professores_falam_lingua_indigena,formacao_professores:e.formacao_professores,visitas_supervisores_formacao:e.visitas_supervisores_formacao,outros_funcionarios:e.outros_funcionarios,gestao:e.gestao,merenda_diferenciada:e.merenda_diferenciada,cozinha:e.cozinha,merenda_escolar:e.merenda_escolar,diferenciada:e.diferenciada}).eq("id",e.id).select();if(s)throw s;return p(e.id,a[0]),{success:!0,data:a[0]}}{const{data:a,error:s}=await n.N.from("escolas_completa").insert({Escola:e.Escola,"Munic\xedpio":e["Munic\xedpio"],"Endere\xe7o":e["Endere\xe7o"],"Terra Indigena (TI)":e["Terra Indigena (TI)"],"Parcerias com o munic\xedpio":e["Parcerias com o munic\xedpio"],"Diretoria de Ensino":e["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":e["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":e["Povos indigenas"],"Linguas faladas":e["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":e["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":e["Numero de alunos"],turnos_funcionamento:e.turnos_funcionamento,"Espa\xe7o escolar e estrutura":e["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":e["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":e["Tem coleta de lixo?"],"Acesso \xe0 internet":e["Acesso \xe0 internet"],"Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":e["Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)"],"Modo de acesso \xe0 escola":e["Modo de acesso \xe0 escola"],"Gest\xe3o/Nome":e["Gest\xe3o/Nome"],"Outros funcion\xe1rios":e["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":e["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":e["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":e["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":e["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":e["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":e["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":e["PPP elaborado com a comunidade?"],"Projetos em andamento":e["Projetos em andamento"],"Parcerias com universidades?":e["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":e["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":e["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":e["Escola utiliza redes sociais?"],"Links das redes sociais":e["Links das redes sociais"],historia_da_escola:e.historia_da_escola,Latitude:e.Latitude,Longitude:e.Longitude,historia_do_prof:e.historia_do_prof,links:e.links,link_para_videos:e.link_para_videos,logradouro:e.logradouro,numero:e.numero,complemento:e.complemento,bairro:e.bairro,cep:e.cep,estado:e.estado,nome_professor:e.nome_professor,professores_indigenas:e.professores_indigenas,professores_nao_indigenas:e.professores_nao_indigenas,professores_falam_lingua_indigena:e.professores_falam_lingua_indigena,formacao_professores:e.formacao_professores,visitas_supervisores_formacao:e.visitas_supervisores_formacao,outros_funcionarios:e.outros_funcionarios,gestao:e.gestao,merenda_diferenciada:e.merenda_diferenciada,cozinha:e.cozinha,merenda_escolar:e.merenda_escolar,diferenciada:e.diferenciada}).select();if(s)throw s;return b(a[0]),{success:!0,data:a[0]}}}catch(a){return console.error("Erro ao salvar escola:",a),l(a.message),{success:!1,error:a.message}}}),[p,b]);return(0,o.useEffect)((()=>{g()}),[g]),{escolas:e,loading:s,error:i,searchTerm:d,selectedType:m,setSearchTerm:c,setSelectedType:u,fetchEscolas:g,updateEscolaInList:p,addEscolaToList:b,removeEscolaFromList:h,saveEscola:v,filteredEscolas:x(),getEscolaById:f,getEscolaByName:y}},l=["Educa\xe7\xe3o Infantil","Educa\xe7\xe3o Infantil (Idade 0 a 6 anos)","Educa\xe7\xe3o Infantil (Pr\xe9-escola I e II) \u2013 1 sala multisseriada","Educa\xe7\xe3o Infantil (Pr\xe9-escola I) \u2013 1 sala regular","Educa\xe7\xe3o Infantil + Ensino Fundamental \u2013 multisseriado","Educa\xe7\xe3o Infantil + Ensino Fundamental \u2013 regular e multisseriado","Educa\xe7\xe3o Infantil + Ensino Fundamental","Educa\xe7\xe3o Infantil + Ensino Fundamental (Anos Iniciais e Anos Finais)","Educa\xe7\xe3o Infantil + Ensino Fundamental (Anos Iniciais multisseriado + Anos Finais multisseriado)","Educa\xe7\xe3o Infantil + Ensino Fundamental (1\xba ao 9\xba ano) \u2013 Salas multisseriadas","Educa\xe7\xe3o Infantil + Ensino Fundamental (Pr\xe9 I + 1\xba ao 4\xba ano) \u2013 1 sala multisseriada","Educa\xe7\xe3o Infantil + Ensino Fundamental com EJA \u2013 Multisseriado","Ensino Fundamental Anos Iniciais (1\xba ao 3\xba)","Ensino Fundamental Anos Iniciais (1\xba ao 5\xba ano) \u2013 1 sala multisseriada","Ensino Fundamental Anos Iniciais (4\xba e 5\xba ano) \u2013 1 sala multisseriada","Ensino Fundamental Anos Iniciais \u2013 EJA (1\xba ao 5\xba ano) \u2013 multisseriado","Ensino Fundamental Anos Finais (6\xba ao 9\xba ano) \u2013 1 sala multisseriada","Ensino Fundamental Anos Finais \u2013 EJA (6\xba ao 9\xba ano) \u2013 multisseriado","Ensino Fundamental (Anos Iniciais e Finais) \u2013 regular e multisseriado","Ensino Fundamental \u2013 Atendimento tempor\xe1rio em escola n\xe3o ind\xedgena","Ensino M\xe9dio (1\xba ao 3\xba ano) \u2013 regular","Ensino M\xe9dio (1\xba ao 3\xba ano) \u2013 multisseriado","Ensino M\xe9dio \u2013 EJA (1\xba ao 3\xba ano) \u2013 multisseriado","Ensino M\xe9dio \u2013 N\xe3o h\xe1 atendimento"],d=[{id:"educacao-infantil",titulo:"1. Educa\xe7\xe3o Infantil",indices:[0,1,2,3,4,5]},{id:"educacao-infantil-fundamental",titulo:"2. Educa\xe7\xe3o Infantil + Ensino Fundamental",indices:[6,7,8,9,10,11,12]},{id:"ensino-fundamental",titulo:"3. Ensino Fundamental",indices:[13,14,15,16,17,18,19,20]},{id:"ensino-medio",titulo:"4. Ensino M\xe9dio",indices:[21,22,23,24]}],c=()=>{const[e,a]=(0,o.useState)([]),[s,r]=(0,o.useState)(""),t=(0,o.useCallback)((e=>{a((a=>a.includes(e)?a.filter((a=>a!==e)):[...a,e]))}),[]),n=(0,o.useCallback)((e=>{r(e),a((a=>{const s=a.some((e=>e.startsWith("Outro:")));return e.trim()?s?a.map((a=>a.startsWith("Outro:")?"Outro: ".concat(e):a)):[...a,"Outro: ".concat(e)]:a.filter((e=>!e.startsWith("Outro:")))}))}),[]),i=(0,o.useCallback)((()=>e.join("; ")),[e]),d=(0,o.useCallback)((e=>{if(!e)return a([]),void r("");const s=e.split(";").map((e=>e.trim())),o=[];let t="";s.forEach((e=>{e.startsWith("Outro:")?(t=e.replace("Outro:","").trim(),o.push(e)):l.includes(e)?o.push(e):e&&(t=e,o.push("Outro: ".concat(e)))})),a(o),r(t)}),[]),c=(0,o.useCallback)((()=>{a([]),r("")}),[]),m=(0,o.useCallback)((()=>e.join("; ")||"Nenhuma modalidade selecionada"),[e]),u=(0,o.useCallback)((()=>e.length>0),[e]);return{selectedModalidades:e,outroModalidade:s,handleModalidadeChange:t,handleOutroModalidadeChange:n,saveModalidades:i,loadExistingModalidades:d,clearModalidades:c,getModalidadesPreview:m,hasSelectedModalidades:u}},m=[{id:"dados-basicos",label:"Dados B\xe1sicos"},{id:"povos-linguas",label:"Povos"},{id:"modalidades",label:"Modalidades"},{id:"infraestrutura",label:"Infraestrutura"},{id:"gestao-professores",label:"Gestores"},{id:"material-pedagogico",label:"Material Pedag\xf3gico"},{id:"projetos-parcerias",label:"Projetos e Parcerias"},{id:"redes-sociais",label:"Redes Sociais"},{id:"video",label:"V\xeddeo"},{id:"historias",label:"Hist\xf3rias"},{id:"historia-professores",label:"Hist\xf3ria dos Professores"},{id:"coordenadas",label:"Coordenadas"},{id:"imagens-escola",label:"Imagens da Escola"},{id:"imagens-professores",label:"Imagens dos Professores"},{id:"documentos",label:"Documentos"},{id:"tabelas-integrais",label:"Tabelas Integrais"}],u=768,g="w-64",x="max-w-[80vw]",p=72,b="dados-basicos";var h=s(7986),f=s(579);const y=e=>{let{isMobile:a,sidebarOpen:s,setSidebarOpen:o,editingLocation:r,onEscolaSelect:t}=e;const{searchTerm:n,setSearchTerm:l,filteredEscolas:d}=i();return(0,f.jsxs)(f.Fragment,{children:[a&&!s&&(0,f.jsx)("button",{className:"fixed top-4 left-4 z-50 bg-gray-900 rounded-full shadow-lg p-2 border border-gray-800",onClick:()=>o(!0),"aria-label":"Abrir menu lateral",children:(0,f.jsx)(h.A,{className:"w-6 h-6 text-gray-200"})}),(!a||s)&&(0,f.jsxs)("aside",{className:"bg-gray-900 border-r border-gray-700 rounded-r-2xl shadow-lg p-4 overflow-y-auto h-screen sticky top-0 z-40 transition-transform duration-300 ".concat(a?"fixed left-0 top-0 ".concat(x," shadow-2xl"):g),style:{transform:a&&!s?"translateX(-100%)":"translateX(0)",top:a?0:p},children:[a&&(0,f.jsx)("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-green-400",onClick:()=>o(!1),"aria-label":"Fechar menu lateral",children:(0,f.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,f.jsx)("h2",{className:"text-xl font-bold tracking-wide text-green-400 uppercase mb-6 sticky top-0 bg-gray-900 pb-2",children:"Escolas"}),(0,f.jsx)("div",{className:"mb-4 sticky top-24 mt-8 bg-gray-900 pb-2",children:(0,f.jsx)("input",{type:"text",placeholder:"Buscar escola...",className:"w-full px-3 py-2 border border-gray-700 rounded text-sm bg-gray-800 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-amber-400 focus:border-amber-400",value:n,onChange:e=>l(e.target.value)})}),(0,f.jsx)("ul",{className:"space-y-1",children:d.map((e=>(0,f.jsx)("li",{children:(0,f.jsx)("button",{className:"block w-full text-left px-2 py-1 rounded hover:bg-green-800 text-sm text-gray-200 ".concat((null===r||void 0===r?void 0:r.id)===e.id?"bg-green-700 font-bold text-white":""),onClick:()=>{t(e),a&&o(!1)},children:e.Escola})},e.id)))}),0===d.length&&n&&(0,f.jsx)("div",{className:"text-gray-400 text-sm text-center py-4",children:"Nenhuma escola encontrada"})]})]})},v=e=>{let{searchTerm:a,setSearchTerm:s,selectedType:o,setSelectedType:r,onNovaEscola:t}=e;return(0,f.jsxs)("div",{className:"bg-gray-900 p-4 rounded-lg shadow mb-6 border border-gray-800",children:[(0,f.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,f.jsxs)("div",{className:"relative flex-1",children:[(0,f.jsx)("input",{type:"text",placeholder:"Buscar por t\xedtulo ou descri\xe7\xe3o...",className:"w-full pl-10 pr-4 py-2 border border-gray-700 rounded-lg bg-gray-800 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-amber-400 focus:border-amber-400",value:a,onChange:e=>s(e.target.value)}),(0,f.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,f.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsxs)("select",{className:"pl-10 pr-4 py-2 border border-gray-700 rounded-lg bg-gray-800 text-gray-100 focus:ring-2 focus:ring-amber-400 focus:border-amber-400",value:o,onChange:e=>r(e.target.value),children:[(0,f.jsx)("option",{value:"todos",children:"Todos"}),(0,f.jsx)("option",{value:"indigena",children:"Ind\xedgena"}),(0,f.jsx)("option",{value:"urbana",children:"Urbana"}),(0,f.jsx)("option",{value:"rural",children:"Rural"})]}),(0,f.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,f.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]}),(0,f.jsxs)("button",{onClick:t,className:"px-4 py-2 bg-green-700 text-white rounded-lg hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors flex items-center gap-2",children:[(0,f.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"+ Nova Escola"]})]}),(0,f.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-700 flex flex-wrap gap-4 text-sm text-gray-300",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,f.jsxs)("span",{children:["Total de escolas: ",(0,f.jsx)("span",{className:"font-semibold text-green-400",children:"0"})]})]}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,f.jsxs)("span",{children:["Escolas ind\xedgenas: ",(0,f.jsx)("span",{className:"font-semibold text-blue-400",children:"0"})]})]}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,f.jsxs)("span",{children:["Em edi\xe7\xe3o: ",(0,f.jsx)("span",{className:"font-semibold text-yellow-400",children:"0"})]})]})]})]})},j=e=>{let{editingLocation:a,setEditingLocation:s}=e;const{selectedModalidades:o,outroModalidade:t,handleModalidadeChange:n,handleOutroModalidadeChange:i,saveModalidades:m,getModalidadesPreview:u,hasSelectedModalidades:g}=c();return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-4 text-base",children:"Modalidades de Ensino"}),(0,f.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 max-h-96 overflow-y-auto",children:(0,f.jsxs)("div",{className:"space-y-4",children:[d.map((e=>(0,f.jsxs)("div",{children:[(0,f.jsx)("h4",{className:"text-sm font-semibold text-green-400 mb-2 border-b border-gray-600 pb-1",children:e.titulo}),(0,f.jsx)("div",{className:"space-y-2 ml-2",children:e.indices.map((e=>{const a=l[e];return(0,f.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[(0,f.jsx)("input",{type:"checkbox",className:"mt-1 h-4 w-4 text-green-600 bg-gray-700 border-gray-600 rounded focus:ring-green-500 focus:ring-2",checked:o.includes(a),onChange:()=>n(a)}),(0,f.jsx)("span",{className:"text-sm text-gray-200 leading-relaxed",children:a})]},e)}))})]},e.id))),(0,f.jsx)("div",{className:"border-t border-gray-600 pt-3 mt-3",children:(0,f.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[(0,f.jsx)("input",{type:"checkbox",className:"mt-1 h-4 w-4 text-green-600 bg-gray-700 border-gray-600 rounded focus:ring-green-500 focus:ring-2",checked:o.some((e=>e.startsWith("Outro:"))),onChange:()=>i(t)}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("span",{className:"text-sm text-gray-200",children:"Outro (especificar):"}),(0,f.jsx)("input",{type:"text",className:"mt-1 w-full px-3 py-2 border border-gray-600 rounded text-sm bg-gray-700 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Digite a modalidade espec\xedfica...",value:t,onChange:e=>i(e.target.value)})]})]})})]})})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"N\xfamero de Alunos"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Numero de alunos"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Numero de alunos":e.target.value}))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Turnos de Funcionamento"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a.turnos_funcionamento||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{turnos_funcionamento:e.target.value})),placeholder:"Ex: Diurno, Noturno, Vespertino, etc."})]}),(0,f.jsx)("div",{className:"md:col-span-2",children:(0,f.jsx)("button",{type:"button",onClick:()=>{const e=m();s((a=>(0,r.A)((0,r.A)({},a),{},{"Modalidade de Ensino/turnos de funcionamento":e})))},className:"px-4 py-2 bg-green-700 text-white rounded-lg hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors",children:"Salvar Modalidades Selecionadas"})}),g()&&(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Preview do Texto Final"}),(0,f.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded px-3 py-2 text-gray-200 text-sm min-h-[60px]",children:u()})]})]})},N=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Nome da Escola"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a.Escola||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{Escola:e.target.value})),placeholder:"Digite o nome da escola"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Munic\xedpio"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Munic\xedpio"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Munic\xedpio":e.target.value})),placeholder:"Digite o munic\xedpio"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Ano de Cria\xe7\xe3o da Escola"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Ano de cria\xe7\xe3o da escola"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Ano de cria\xe7\xe3o da escola":e.target.value})),placeholder:"Ex: 1995"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Terra Ind\xedgena (TI)"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Terra Indigena (TI)"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Terra Indigena (TI)":e.target.value})),placeholder:"Digite o nome da Terra Ind\xedgena"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Diretoria de Ensino"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Diretoria de Ensino"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Diretoria de Ensino":e.target.value})),placeholder:"Digite a diretoria de ensino"})]}),(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Parcerias com o Munic\xedpio"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Parcerias com o munic\xedpio"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Parcerias com o munic\xedpio":e.target.value})),placeholder:"Descreva as parcerias com o munic\xedpio..."})]}),(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4 border-b border-gray-700 pb-2",children:"Endere\xe7o Completo"}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Logradouro"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400",value:a.logradouro||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{logradouro:e.target.value})),placeholder:"Rua, Avenida, etc."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"N\xfamero"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400",value:a.numero||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{numero:e.target.value})),placeholder:"N\xfamero"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Complemento"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400",value:a.complemento||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{complemento:e.target.value})),placeholder:"Apto, Casa, etc."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Bairro"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400",value:a.bairro||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{bairro:e.target.value})),placeholder:"Nome do bairro"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"CEP"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400",value:a.cep||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{cep:e.target.value})),placeholder:"00000-000"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Estado"}),(0,f.jsxs)("select",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100",value:a.estado||"SP",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{estado:e.target.value})),children:[(0,f.jsx)("option",{value:"SP",children:"S\xe3o Paulo"}),(0,f.jsx)("option",{value:"RJ",children:"Rio de Janeiro"}),(0,f.jsx)("option",{value:"MG",children:"Minas Gerais"}),(0,f.jsx)("option",{value:"ES",children:"Esp\xedrito Santo"}),(0,f.jsx)("option",{value:"RS",children:"Rio Grande do Sul"}),(0,f.jsx)("option",{value:"SC",children:"Santa Catarina"}),(0,f.jsx)("option",{value:"PR",children:"Paran\xe1"}),(0,f.jsx)("option",{value:"MS",children:"Mato Grosso do Sul"}),(0,f.jsx)("option",{value:"MT",children:"Mato Grosso"}),(0,f.jsx)("option",{value:"GO",children:"Goi\xe1s"}),(0,f.jsx)("option",{value:"DF",children:"Distrito Federal"}),(0,f.jsx)("option",{value:"BA",children:"Bahia"}),(0,f.jsx)("option",{value:"SE",children:"Sergipe"}),(0,f.jsx)("option",{value:"AL",children:"Alagoas"}),(0,f.jsx)("option",{value:"PE",children:"Pernambuco"}),(0,f.jsx)("option",{value:"PB",children:"Para\xedba"}),(0,f.jsx)("option",{value:"RN",children:"Rio Grande do Norte"}),(0,f.jsx)("option",{value:"CE",children:"Cear\xe1"}),(0,f.jsx)("option",{value:"PI",children:"Piau\xed"}),(0,f.jsx)("option",{value:"MA",children:"Maranh\xe3o"}),(0,f.jsx)("option",{value:"PA",children:"Par\xe1"}),(0,f.jsx)("option",{value:"AP",children:"Amap\xe1"}),(0,f.jsx)("option",{value:"TO",children:"Tocantins"}),(0,f.jsx)("option",{value:"RO",children:"Rond\xf4nia"}),(0,f.jsx)("option",{value:"AC",children:"Acre"}),(0,f.jsx)("option",{value:"AM",children:"Amazonas"}),(0,f.jsx)("option",{value:"RR",children:"Roraima"})]})]})]})]}),(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Endere\xe7o (Campo Legado)"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-20 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Endere\xe7o"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Endere\xe7o":e.target.value})),placeholder:"Endere\xe7o completo (campo legado - use os campos acima para novos registros)"}),(0,f.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Este campo \xe9 mantido para compatibilidade com dados existentes. Para novos registros, use os campos de endere\xe7o estruturado acima."})]})]})},w=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Povos Ind\xedgenas"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Povos indigenas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Povos indigenas":e.target.value})),placeholder:"Descreva os povos ind\xedgenas atendidos pela escola..."}),(0,f.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Ex: Guarani, Kaingang, Terena, etc."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"L\xednguas Faladas"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Linguas faladas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Linguas faladas":e.target.value})),placeholder:"Descreva as l\xednguas faladas na comunidade escolar..."}),(0,f.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Ex: Portugu\xeas, Guarani, Kaingang, etc."})]})]})},A=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Acesso \xe0 \xc1gua"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Acesso \xe0 \xe1gua"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Acesso \xe0 \xe1gua":e.target.value})),placeholder:"Descreva como \xe9 o acesso \xe0 \xe1gua na escola..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Coleta de Lixo"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Tem coleta de lixo?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Tem coleta de lixo?":e.target.value})),placeholder:"Descreva como \xe9 feita a coleta de lixo..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Acesso \xe0 Internet"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Acesso \xe0 internet"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Acesso \xe0 internet":e.target.value})),placeholder:"Descreva o acesso \xe0 internet na escola..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Equipamentos Tecnol\xf3gicos"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":e.target.value})),placeholder:"Descreva os equipamentos tecnol\xf3gicos dispon\xedveis..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Modo de Acesso \xe0 Escola"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Modo de acesso \xe0 escola"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Modo de acesso \xe0 escola":e.target.value})),placeholder:"Descreva como \xe9 o acesso \xe0 escola..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Cozinha"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.cozinha||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{cozinha:e.target.value})),placeholder:"Descreva a estrutura da cozinha..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Escolar"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.merenda_escolar||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{merenda_escolar:e.target.value})),placeholder:"Descreva como \xe9 fornecida a merenda escolar..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Diferenciada"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.diferenciada||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{diferenciada:e.target.value})),placeholder:"Descreva se h\xe1 merenda diferenciada (cultural, religiosa, etc.)..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Merenda Diferenciada (Detalhes)"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.merenda_diferenciada||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{merenda_diferenciada:e.target.value})),placeholder:"Descreva detalhes sobre a merenda diferenciada..."})]})]})},E=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Gest\xe3o/Nome"}),(0,f.jsx)("input",{type:"text",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 min-h-[44px] text-base",value:a["Gest\xe3o/Nome"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Gest\xe3o/Nome":e.target.value})),placeholder:"Digite o nome do gestor/diretor"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores Ind\xedgenas"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Quantidade de professores ind\xedgenas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Quantidade de professores ind\xedgenas":e.target.value})),placeholder:"Descreva os professores ind\xedgenas..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores N\xe3o Ind\xedgenas"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Quantidade de professores n\xe3o ind\xedgenas"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Quantidade de professores n\xe3o ind\xedgenas":e.target.value})),placeholder:"Descreva os professores n\xe3o ind\xedgenas..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Professores Falam L\xedngua Ind\xedgena?"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Professores falam a l\xedngua ind\xedgena?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Professores falam a l\xedngua ind\xedgena?":e.target.value})),placeholder:"Descreva se os professores falam a l\xedngua ind\xedgena..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Forma\xe7\xe3o dos Professores"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Forma\xe7\xe3o dos professores"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Forma\xe7\xe3o dos professores":e.target.value})),placeholder:"Descreva a forma\xe7\xe3o dos professores..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Forma\xe7\xe3o Continuada"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Forma\xe7\xe3o continuada oferecida"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Forma\xe7\xe3o continuada oferecida":e.target.value})),placeholder:"Descreva a forma\xe7\xe3o continuada oferecida aos professores..."})]})]})},_=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"A escola possui PPP pr\xf3prio?"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["A escola possui PPP pr\xf3prio?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"A escola possui PPP pr\xf3prio?":e.target.value})),placeholder:"Descreva se a escola possui PPP pr\xf3prio..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"PPP elaborado com a comunidade?"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["PPP elaborado com a comunidade?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"PPP elaborado com a comunidade?":e.target.value})),placeholder:"Descreva se o PPP foi elaborado com a comunidade..."})]})]})},k=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Projetos em Andamento"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Projetos em andamento"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Projetos em andamento":e.target.value})),placeholder:"Descreva os projetos em andamento na escola..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Parcerias com Universidades"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Parcerias com universidades?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Parcerias com universidades?":e.target.value})),placeholder:"Descreva as parcerias com universidades..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"A\xe7\xf5es com ONGs ou Coletivos"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["A\xe7\xf5es com ONGs ou coletivos?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"A\xe7\xf5es com ONGs ou coletivos?":e.target.value})),placeholder:"Descreva as a\xe7\xf5es com ONGs ou coletivos..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Desejos da Comunidade"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Desejos da comunidade para a escola"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Desejos da comunidade para a escola":e.target.value})),placeholder:"Descreva os desejos da comunidade para a escola..."})]})]})},C=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Escola utiliza redes sociais?"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-24 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Escola utiliza redes sociais?"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Escola utiliza redes sociais?":e.target.value})),placeholder:"Descreva se a escola utiliza redes sociais..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Links das Redes Sociais"}),(0,f.jsx)("textarea",{className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 h-32 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a["Links das redes sociais"]||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{"Links das redes sociais":e.target.value})),placeholder:"Cole aqui os links das redes sociais da escola (Facebook, Instagram, YouTube, etc.)..."})]})]})};var P=s(6637),S=s(2481),L=s(1184),D=s(4488);const I=e=>{let{escolaId:a}=e;const[s,t]=(0,o.useState)([]),[i,l]=(0,o.useState)(!0),[d,c]=(0,o.useState)(null),[m,u]=(0,o.useState)(""),[g,x]=(0,o.useState)(!1),[p,b]=(0,o.useState)(null),[h,y]=(0,o.useState)({titulo:"",video_url:"",descricao:"",plataforma:"youtube",categoria:"geral",ativo:!0}),v=async()=>{try{l(!0),c(null);const e=await async function(e){const{data:a,error:s}=await n.N.from("titulos_videos").select("*").eq("escola_id",e).eq("ativo",!0).order("created_at",{ascending:!1});if(s)throw s;return a}(a);t(e)}catch(e){c(e.message)}finally{l(!1)}};(0,o.useEffect)((()=>{a&&v()}),[a]);const j=()=>{y({titulo:"",video_url:"",descricao:"",plataforma:"youtube",categoria:"geral",ativo:!0}),b(null),x(!1)},N=async e=>{if(window.confirm("Tem certeza que deseja excluir este v\xeddeo?"))try{await async function(e){const{error:a}=await n.N.from("titulos_videos").delete().eq("id",e);if(a)throw a;return!0}(e),u("V\xeddeo exclu\xeddo com sucesso!"),v()}catch(a){c(a.message)}};return i?(0,f.jsx)("div",{className:"p-6 text-center",children:"Carregando v\xeddeos..."}):(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"V\xeddeos da Escola"}),(0,f.jsxs)("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,f.jsx)(P.A,{className:"w-5 h-5"}),"Novo V\xeddeo"]})]}),d&&(0,f.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-600",children:d}),m&&(0,f.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg text-green-600",children:m}),(0,f.jsx)("div",{className:"space-y-4",children:0===s.length?(0,f.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,f.jsx)("p",{className:"text-gray-500",children:"Nenhum v\xeddeo cadastrado."}),(0,f.jsx)("button",{onClick:()=>x(!0),className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Adicionar v\xeddeo"})]}):s.map((e=>(0,f.jsx)("div",{className:"p-6 bg-white rounded-lg border ".concat(e.ativo?"":"opacity-60"),children:(0,f.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,f.jsx)("h4",{className:"font-medium text-gray-900",children:e.titulo}),!e.ativo&&(0,f.jsx)("span",{className:"flex items-center gap-1 text-orange-600 text-sm",children:"Inativo"})]}),(0,f.jsx)("p",{className:"text-gray-700 text-sm mb-2",children:e.descricao}),(0,f.jsx)("div",{className:"mb-2",children:(0,f.jsx)("iframe",{src:e.video_url,title:e.titulo,className:"w-full aspect-video rounded-lg border",allowFullScreen:!0})}),(0,f.jsxs)("div",{className:"text-xs text-gray-500",children:["Plataforma: ",e.plataforma," | Categoria: ",e.categoria]})]}),(0,f.jsxs)("div",{className:"flex flex-col gap-2 ml-4",children:[(0,f.jsx)("button",{onClick:()=>(e=>{b(e),y({titulo:e.titulo||"",video_url:e.video_url||"",descricao:e.descricao||"",plataforma:e.plataforma||"youtube",categoria:e.categoria||"geral",ativo:e.ativo}),x(!0)})(e),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg",title:"Editar",children:(0,f.jsx)(S.A,{className:"w-5 h-5"})}),(0,f.jsx)("button",{onClick:()=>N(e.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg",title:"Excluir",children:(0,f.jsx)(L.A,{className:"w-5 h-5"})})]})]})},e.id)))}),g&&(0,f.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,f.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:p?"Editar V\xeddeo":"Novo V\xeddeo"}),(0,f.jsxs)("button",{onClick:j,className:"text-gray-400 hover:text-gray-600",children:[(0,f.jsx)("span",{className:"sr-only",children:"Fechar"}),"\xd7"]})]}),(0,f.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!h.titulo.trim()||!h.video_url.trim())return void c("T\xedtulo e URL do v\xeddeo s\xe3o obrigat\xf3rios.");const s=(0,r.A)((0,r.A)({escola_id:Number(a)},h),{},{ativo:Boolean(h.ativo)});try{c(""),u(""),p?(await async function(e,a){const{data:s,error:o}=await n.N.from("titulos_videos").update(a).eq("id",e).select();if(o)throw o;return null===s||void 0===s?void 0:s[0]}(p.id,s),u("V\xeddeo atualizado com sucesso!")):(await async function(e){const{data:a,error:s}=await n.N.from("titulos_videos").insert([e]).select();if(s)throw s;return null===a||void 0===a?void 0:a[0]}(s),u("V\xeddeo criado com sucesso!")),j(),v()}catch(o){c(o.message)}},className:"space-y-4",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T\xedtulo *"}),(0,f.jsx)("input",{type:"text",value:h.titulo,onChange:e=>y((0,r.A)((0,r.A)({},h),{},{titulo:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"T\xedtulo do v\xeddeo",required:!0})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do V\xeddeo *"}),(0,f.jsx)("input",{type:"url",value:h.video_url,onChange:e=>y((0,r.A)((0,r.A)({},h),{},{video_url:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"https://www.youtube.com/embed/...",required:!0})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,f.jsx)("textarea",{value:h.descricao,onChange:e=>y((0,r.A)((0,r.A)({},h),{},{descricao:e.target.value})),rows:3,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Descri\xe7\xe3o do v\xeddeo (opcional)"})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plataforma"}),(0,f.jsx)("input",{type:"text",value:h.plataforma,onChange:e=>y((0,r.A)((0,r.A)({},h),{},{plataforma:e.target.value})),className:"w-full border rounded-lg px-3 py-2",placeholder:"youtube, vimeo..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,f.jsx)("input",{type:"text",value:h.categoria,onChange:e=>y((0,r.A)((0,r.A)({},h),{},{categoria:e.target.value})),className:"w-full border rounded-lg px-3 py-2",placeholder:"geral, institucional..."})]}),(0,f.jsxs)("div",{className:"flex items-center gap-2 mt-6",children:[(0,f.jsx)("input",{type:"checkbox",checked:h.ativo,onChange:e=>y((0,r.A)((0,r.A)({},h),{},{ativo:e.target.checked})),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,f.jsx)("span",{className:"text-sm text-gray-700",children:"Ativo"})]})]}),(0,f.jsxs)("div",{className:"flex gap-3",children:[(0,f.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,f.jsx)(D.A,{className:"w-5 h-5"}),p?"Atualizar":"Criar"]}),(0,f.jsx)("button",{type:"button",onClick:j,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})]})},M=e=>{let{editingLocation:a}=e;const s=(null===a||void 0===a?void 0:a.id)||(null===a||void 0===a?void 0:a.escola_id);return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4 border-b border-gray-600 pb-2",children:"Gerenciamento de V\xeddeos"}),(0,f.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"Aqui voc\xea pode adicionar, editar e gerenciar v\xeddeos relacionados \xe0 escola. Os v\xeddeos podem ser do YouTube, Vimeo ou outras plataformas."})]}),s?(0,f.jsx)("div",{className:"bg-white rounded-lg shadow-sm",children:(0,f.jsx)(I,{escolaId:s})}):(0,f.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6 text-center",children:(0,f.jsx)("p",{className:"text-gray-300",children:"Selecione uma escola para gerenciar os v\xeddeos."})}),(0,f.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4 border-b border-gray-600 pb-2",children:"Como Adicionar V\xeddeos"}),(0,f.jsxs)("div",{className:"space-y-3 text-sm text-gray-300",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{className:"text-amber-400",children:"YouTube:"}),(0,f.jsx)("p",{children:"Use o formato: https://www.youtube.com/embed/VIDEO_ID"}),(0,f.jsx)("p",{className:"text-xs text-gray-400",children:"Exemplo: https://www.youtube.com/embed/dQw4w9WgXcQ"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{className:"text-amber-400",children:"Vimeo:"}),(0,f.jsx)("p",{children:"Use o formato: https://player.vimeo.com/video/VIDEO_ID"}),(0,f.jsx)("p",{className:"text-xs text-gray-400",children:"Exemplo: https://player.vimeo.com/video/123456789"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{className:"text-amber-400",children:"Outras plataformas:"}),(0,f.jsx)("p",{children:"Use o URL de embed fornecido pela plataforma"})]})]})]})]})};var T=s(2823),O=s.n(T),F=(s(5884),s(2349));const z=e=>{let{value:a,onChange:s,placeholder:t,label:n,style:i={}}=e;const l=(0,o.useRef)(null),[d,c]=o.useState(null),m=(0,o.useCallback)((async()=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=async()=>{const a=e.files[0];if(a&&d)try{const e=d.getSelection();d.insertEmbed(e.index,"image","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");const s=await(0,F.V6)(a);d.deleteText(e.index,1),d.insertEmbed(e.index,"image",s),d.setSelection(e.index+1)}catch(s){console.error("Erro ao fazer upload da imagem:",s),alert("Erro ao fazer upload da imagem. Tente novamente.")}}}),[d]),u=o.useMemo((()=>({toolbar:{container:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link"],["image"],["clean"]],handlers:{image:m}}})),[m]),g=(0,o.useCallback)(((e,a,o,r)=>{s&&s(e,a,o,r)}),[s]),x=(0,o.useCallback)((e=>{c(e)}),[]);return(0,f.jsxs)("div",{className:"rich-text-editor",children:[n&&(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:n}),(0,f.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:(0,f.jsx)(O(),{ref:l,theme:"snow",value:a||"",onChange:g,onEditorReady:x,modules:u,formats:["header","bold","italic","underline","strike","color","background","list","bullet","align","link","image"],placeholder:t,style:(0,r.A)({height:"300px",backgroundColor:"#1f2937",color:"#f3f4f6"},i)})})]})},U=e=>{let{value:a,onChange:s,placeholder:o,label:r}=e;return(0,f.jsx)(z,{value:a,onChange:s,placeholder:o,label:r})},q=e=>{let{editingLocation:a,setEditingLocation:s}=e;return(0,f.jsx)("div",{className:"space-y-6",children:(0,f.jsx)(U,{label:"Hist\xf3ria da Escola",value:a.historia_da_escola||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{historia_da_escola:e})),placeholder:"Digite a hist\xf3ria da escola..."})})};var G=s(2006);const B=e=>{let{editingLocation:a,setEditingLocation:s}=e;const[t,n]=(0,o.useState)([]),[i,l]=(0,o.useState)(!1),[d,c]=(0,o.useState)(null),[m,u]=(0,o.useState)(!1);(0,o.useEffect)((()=>{null!==a&&void 0!==a&&a.id&&g()}),[null===a||void 0===a?void 0:a.id]);const g=async()=>{if(null!==a&&void 0!==a&&a.id){l(!0);try{const e=await(0,G.Y8)(a.id);n(e||[])}catch(e){console.error("Erro ao carregar hist\xf3rias:",e)}finally{l(!1)}}};return i?(0,f.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,f.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,f.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando hist\xf3rias..."})]}):(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-200",children:"Depoimentos dos Professores"}),(0,f.jsx)("button",{onClick:()=>{c({nome_professor:"",historia:""}),u(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"+ Nova Hist\xf3ria"})]}),d&&(0,f.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[(0,f.jsx)("h4",{className:"text-md font-medium text-gray-200 mb-4",children:m?"Nova Hist\xf3ria do Professor":"Editar Hist\xf3ria do Professor"}),(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Nome do Professor"}),(0,f.jsx)("input",{type:"text",value:d.nome_professor||"",onChange:e=>c((0,r.A)((0,r.A)({},d),{},{nome_professor:e.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-gray-200 focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Nome do professor (opcional)"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"Depoimento/Hist\xf3ria"}),(0,f.jsx)(U,{value:d.historia||"",onChange:e=>c((0,r.A)((0,r.A)({},d),{},{historia:e})),placeholder:"Digite o depoimento ou hist\xf3ria do professor..."})]}),(0,f.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,f.jsx)("button",{onClick:()=>(async e=>{if(null!==a&&void 0!==a&&a.id)try{null!==d&&void 0!==d&&d.id?await(0,G.e0)(d.id,e):await(0,G.lz)((0,r.A)((0,r.A)({},e),{},{escola_id:a.id})),await g(),c(null),u(!1)}catch(s){console.error("Erro ao salvar hist\xf3ria:",s),alert("Erro ao salvar hist\xf3ria: "+s.message)}})(d),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:m?"Criar":"Salvar"}),(0,f.jsx)("button",{onClick:()=>{c(null),u(!1)},className:"px-4 py-2 bg-gray-600 text-gray-200 rounded-lg hover:bg-gray-700 transition-colors",children:"Cancelar"})]})]})]}),t.length>0&&(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsx)("h4",{className:"text-md font-medium text-gray-200",children:"Hist\xf3rias Existentes"}),t.map((e=>(0,f.jsx)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:(0,f.jsxs)("div",{className:"flex items-start justify-between",children:[(0,f.jsxs)("div",{className:"flex-1",children:[e.nome_professor&&(0,f.jsx)("h5",{className:"font-medium text-green-400 mb-2",children:e.nome_professor}),(0,f.jsx)("div",{className:"text-gray-300 prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:e.historia}})]}),(0,f.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,f.jsx)("button",{onClick:()=>(e=>{console.log("handleEditHistoria chamado com:",e),console.log("Estado atual editingHistoria:",d),console.log("Estado atual isCreating:",m),c(e),u(!1),console.log("Ap\xf3s setState - editingHistoria ser\xe1:",e),console.log("Ap\xf3s setState - isCreating ser\xe1: false")})(e),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"Editar"}),(0,f.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir esta hist\xf3ria?"))try{await(0,G.g2)(e),await g()}catch(a){console.error("Erro ao deletar hist\xf3ria:",a),alert("Erro ao deletar hist\xf3ria: "+a.message)}})(e.id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Excluir"})]})]})},e.id)))]}),0===t.length&&!d&&(0,f.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,f.jsx)("p",{children:"Nenhuma hist\xf3ria de professor cadastrada ainda."}),(0,f.jsx)("p",{className:"text-sm mt-2",children:'Clique em "Nova Hist\xf3ria" para come\xe7ar.'})]})]})};var R=s(154),V=s(5351),W=s(6528),J=s(5366),Q=s(495),X=s(9468),H=s(2463),Y=s(3241),Z=s(3104),K=s(5921),$=s(5263);s(3976);const ee="".concat("/escolasindigenas","/map-marker.svg"),ae=e=>{let{editingLocation:a,setEditingLocation:s}=e;const t=(0,o.useRef)(null),n=(0,o.useRef)(null),i=(0,o.useRef)(null),l=(e,a)=>{if(!n.current)return;const s=n.current.getView();if(e&&a&&!isNaN(e)&&!isNaN(a)){var o;const r=(0,H.Rb)([parseFloat(a),parseFloat(e)]);s.setCenter(r),s.setZoom(15);const t=null===(o=n.current.getLayers().getArray().find((e=>e instanceof J.A)))||void 0===o?void 0:o.getSource();if(t){i.current&&t.removeFeature(i.current);const e=new Z.A({geometry:new Y.A(r)});e.setStyle(new K.Ay({image:new $.A({src:ee,scale:.6,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",color:"#fbbf24"})})),t.addFeature(e),i.current=e}}},d=e=>{const o=(0,H.WP)(e.coordinate),[t,n]=o;s((0,r.A)((0,r.A)({},a),{},{latitude:n.toFixed(6),longitude:t.toFixed(6)}))};return(0,o.useEffect)((()=>{if(!t.current)return;const e=new R.A({target:t.current,layers:[new W.A({source:new X.A({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),new J.A({source:new Q.A})],view:new V.Ay({center:(0,H.Rb)([-46.6388,-23.5489]),zoom:8})});n.current=e,e.on("click",d);const s=a.Latitude,o=a.Longitude;return s&&o&&l(s,o),()=>{n.current&&n.current.setTarget(void 0)}}),[]),(0,o.useEffect)((()=>{const e=a.Latitude,s=a.Longitude;l(e,s)}),[a.Latitude,a.Longitude]),(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Latitude"}),(0,f.jsx)("input",{type:"number",step:"any",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.Latitude||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{Latitude:e.target.value})),placeholder:"Ex: -23.5489"}),(0,f.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Valor entre -90 e 90 (ex: -23.5489 para S\xe3o Paulo)"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Longitude"}),(0,f.jsx)("input",{type:"number",step:"any",className:"w-full border border-gray-700 bg-gray-800 rounded px-3 py-2 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 text-gray-100 placeholder-gray-400 text-base",value:a.Longitude||"",onChange:e=>s((0,r.A)((0,r.A)({},a),{},{Longitude:e.target.value})),placeholder:"Ex: -46.6388"}),(0,f.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Valor entre -180 e 180 (ex: -46.6388 para S\xe3o Paulo)"})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2 text-base",children:"Mapa - Clique para definir a localiza\xe7\xe3o"}),(0,f.jsx)("div",{ref:t,className:"w-full h-64 border border-gray-700 rounded-lg bg-gray-800",style:{minHeight:"256px"}}),(0,f.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Clique no mapa para definir as coordenadas automaticamente"})]}),(0,f.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4 border-b border-gray-600 pb-2",children:"Como Usar as Coordenadas"}),(0,f.jsxs)("div",{className:"space-y-3 text-sm text-gray-300",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{className:"text-amber-400",children:"M\xe9todo 1 - Digite manualmente:"}),(0,f.jsx)("p",{children:"Digite as coordenadas nos campos acima. Use ponto decimal (ex: -23.5489)."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{className:"text-amber-400",children:"M\xe9todo 2 - Clique no mapa:"}),(0,f.jsx)("p",{children:"Clique no mapa para definir automaticamente as coordenadas da localiza\xe7\xe3o."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{className:"text-amber-400",children:"Formato das coordenadas:"}),(0,f.jsx)("p",{children:"Latitude: -90 a +90 | Longitude: -180 a +180"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{className:"text-amber-400",children:"Exemplos para S\xe3o Paulo:"}),(0,f.jsx)("p",{children:"Latitude: -23.5489 | Longitude: -46.6388"})]})]})]})]})};var se=s(4008),oe=s(2065),re=s(2623),te=s(8590),ne=s(6464),ie=s(5827),le=s(4768),de=s(9732),ce=s(7184),me=s(5349),ue=s(7473);const ge=()=>{var e;const[a,t]=(0,o.useState)([]),[i,l]=(0,o.useState)(!0),[d,c]=(0,o.useState)(null),[m,u]=(0,o.useState)(null),[g,x]=(0,o.useState)([]),[p,b]=(0,o.useState)(!1),[h,y]=(0,o.useState)({}),[v,j]=(0,o.useState)(0),N=[{id:"escolas_completa",nome:"Escolas Completas",descricao:"Dados principais de todas as escolas ind\xedgenas",icone:se.A,cor:"bg-blue-500"},{id:"historias_professor",nome:"Hist\xf3rias dos Professores",descricao:"Depoimentos e hist\xf3rias dos professores ind\xedgenas",icone:oe.A,cor:"bg-green-500"},{id:"documentos_escola",nome:"Documentos das Escolas",descricao:"PDFs e documentos das escolas",icone:re.A,cor:"bg-purple-500"},{id:"titulos_videos",nome:"V\xeddeos das Escolas",descricao:"Links e t\xedtulos dos v\xeddeos das escolas",icone:te.A,cor:"bg-red-500"},{id:"legendas_fotos",nome:"Legendas das Fotos",descricao:"Legendas e descri\xe7\xf5es das imagens",icone:ne.A,cor:"bg-yellow-500"}],w=[{id:"imagens-das-escolas",nome:"Imagens das Escolas",descricao:"Fotos das escolas ind\xedgenas",icone:ne.A,cor:"bg-indigo-500"},{id:"imagens-professores",nome:"Imagens dos Professores",descricao:"Fotos dos professores ind\xedgenas",icone:oe.A,cor:"bg-teal-500"},{id:"pdfs",nome:"Documentos PDF",descricao:"Documentos das escolas em PDF",icone:re.A,cor:"bg-orange-500"}];(0,o.useEffect)((()=>{t(N),l(!1)}),[]);const A=async e=>{try{b(!0),c(null);const{data:a,error:s}=await n.N.from(e).select("*").order("id",{ascending:!0});if(s)throw s;x(a||[]),u(e)}catch(a){console.error("Erro ao carregar dados da tabela ".concat(e,":"),a),c("Erro ao carregar dados: ".concat(a.message))}finally{b(!1)}},E=async(e,a)=>{try{const s=await fetch(e),o=await s.blob(),r=window.URL.createObjectURL(o),t=document.createElement("a");t.href=r,t.download=a,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(r)}catch(d){console.error("Erro ao baixar ".concat(a,":"),d)}},_=async(e,a)=>{try{if("undefined"===typeof o){alert("JSZip n\xe3o dispon\xedvel. Baixando arquivos individualmente...");for(const a of e)await E(a.url,a.name),await new Promise((e=>setTimeout(e,100)));return}const o=(await s.e(159).then(s.t.bind(s,6159,23))).default,r=new o;for(const a of e)try{const e=await fetch(a.url),s=await e.blob();r.file(a.name,s)}catch(d){console.error("Erro ao adicionar ".concat(a.name," ao ZIP:"),d)}const t=await r.generateAsync({type:"blob"}),n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)}catch(d){console.error("Erro ao criar ZIP:",d),alert("Erro ao criar ZIP. Baixando arquivos individualmente...");for(const s of e)await E(s.url,s.name),await new Promise((e=>setTimeout(e,100)))}};return i?(0,f.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,f.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,f.jsx)("span",{className:"ml-2 text-gray-400",children:"Carregando tabelas..."})]}):(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tabelas Integrais e Backup do Sistema"}),(0,f.jsx)("p",{className:"text-sm text-gray-600",children:"Visualize, baixe e fa\xe7a backup completo de todas as tabelas e arquivos do sistema"})]}),(0,f.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,f.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,f.jsx)(ie.A,{className:"w-5 h-5 mr-2 text-blue-600"}),"Backup Completo do Sistema"]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,f.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,f.jsx)("h5",{className:"font-medium text-blue-900 mb-2",children:"Backup Completo"}),(0,f.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"Inclui todas as tabelas, imagens dos buckets e metadados do sistema"}),(0,f.jsxs)("button",{onClick:async()=>{try{y({status:"iniciando",message:"Iniciando backup completo..."}),j(0),y({status:"tabelas",message:"Fazendo backup das tabelas..."}),j(10);const a={};for(const r of N)try{const{data:e,error:s}=await n.N.from(r.id).select("*");if(s)throw s;a[r.id]=e||[]}catch(e){console.error("Erro ao fazer backup da tabela ".concat(r.id,":"),e)}j(25),y({status:"buckets",message:"Preparando download das imagens..."}),j(30);const s={},o=[];for(const m of w)try{const{data:a,error:t}=await n.N.storage.from(m.id).list("",{limit:1e3});if(t)throw t;const i=[];for(const s of a)try{const{data:e}=await n.N.storage.from(m.id).createSignedUrl(s.name,3600);if(null!==e&&void 0!==e&&e.signedUrl){const a=(0,r.A)((0,r.A)({},s),{},{url:e.signedUrl,bucket:m.id,bucketNome:m.nome});i.push(a),o.push(a)}}catch(e){console.error("Erro ao gerar URL para ".concat(s.name,":"),e)}s[m.id]=i}catch(e){console.error("Erro ao fazer backup do bucket ".concat(m.id,":"),e)}j(75),y({status:"finalizando",message:"Criando arquivo de backup..."}),j(80);const t={metadata:{dataBackup:(new Date).toISOString(),versao:"1.0",descricao:"Backup completo do sistema OPIN - Observat\xf3rio dos Professores Ind\xedgenas",tabelas:N.map((e=>({id:e.id,nome:e.nome}))),buckets:w.map((e=>({id:e.id,nome:e.nome}))),totalRegistros:Object.values(a).reduce(((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0)),0),totalArquivos:Object.values(s).reduce(((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0)),0)},dados:a,arquivos:s};y({status:"download",message:"Preparando download..."}),j(90);const i=JSON.stringify(t,null,2),l=new Blob([i],{type:"application/json;charset=utf-8;"}),d=document.createElement("a"),c=URL.createObjectURL(l);d.setAttribute("href",c),d.setAttribute("download","backup_completo_opin_".concat((new Date).toISOString().split("T")[0],".json")),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),o.length>0&&(y({status:"imagens",message:"Baixando imagens..."}),j(95),await _(o,"imagens_opin_".concat((new Date).toISOString().split("T")[0],".zip"))),j(100),y({status:"concluido",message:"Backup completo realizado com sucesso!",detalhes:{tabelas:Object.keys(a).length,registros:Object.values(a).reduce(((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0)),0),arquivos:Object.values(s).reduce(((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0)),0)}}),setTimeout((()=>{y({}),j(0)}),5e3)}catch(e){console.error("Erro no backup completo:",e),y({status:"erro",message:"Erro no backup: ".concat(e.message)}),j(0)}},disabled:"iniciando"===h.status||"tabelas"===h.status||"buckets"===h.status||"finalizando"===h.status||"download"===h.status||"imagens"===h.status,className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,f.jsx)(ie.A,{className:"w-4 h-4 inline mr-2"}),"Backup Completo"]})]}),(0,f.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[(0,f.jsx)("h5",{className:"font-medium text-green-900 mb-2",children:"Backup das Tabelas"}),(0,f.jsx)("p",{className:"text-sm text-green-700 mb-3",children:"Apenas os dados das tabelas em formato JSON"}),(0,f.jsxs)("button",{onClick:async()=>{try{y({status:"tabelas",message:"Fazendo backup das tabelas..."}),j(0);const a={};for(let l=0;l<N.length;l++){const s=N[l];try{const{data:e,error:o}=await n.N.from(s.id).select("*");if(o)throw o;a[s.id]=e||[],j((l+1)/N.length*100)}catch(e){console.error("Erro ao fazer backup da tabela ".concat(s.id,":"),e)}}const s={metadata:{dataBackup:(new Date).toISOString(),tipo:"backup_tabelas",tabelas:Object.keys(a),totalRegistros:Object.values(a).reduce(((e,a)=>e+((null===a||void 0===a?void 0:a.length)||0)),0)},dados:a},o=JSON.stringify(s,null,2),r=new Blob([o],{type:"application/json;charset=utf-8;"}),t=document.createElement("a"),i=URL.createObjectURL(r);t.setAttribute("href",i),t.setAttribute("download","backup_tabelas_opin_".concat((new Date).toISOString().split("T")[0],".json")),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t),y({status:"concluido",message:"Backup das tabelas realizado com sucesso!"}),setTimeout((()=>{y({}),j(0)}),3e3)}catch(e){console.error("Erro no backup das tabelas:",e),y({status:"erro",message:"Erro no backup: ".concat(e.message)}),j(0)}},disabled:"tabelas"===h.status,className:"w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,f.jsx)(se.A,{className:"w-4 h-4 inline mr-2"}),"Backup Tabelas"]})]}),(0,f.jsxs)("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[(0,f.jsx)("h5",{className:"font-medium text-purple-900 mb-2",children:"Backup das Imagens"}),(0,f.jsx)("p",{className:"text-sm text-purple-700 mb-3",children:"Apenas as imagens dos buckets em arquivo ZIP"}),(0,f.jsxs)("button",{onClick:async()=>{try{y({status:"imagens",message:"Preparando backup das imagens..."}),j(0);const a=[];for(let s=0;s<w.length;s++){const o=w[s];try{y({status:"imagens",message:"Processando bucket: ".concat(o.nome,"...")});const{data:t,error:i}=await n.N.storage.from(o.id).list("",{limit:1e3});if(i)throw i;for(const s of t)try{const{data:e}=await n.N.storage.from(o.id).createSignedUrl(s.name,3600);null!==e&&void 0!==e&&e.signedUrl&&a.push((0,r.A)((0,r.A)({},s),{},{url:e.signedUrl,bucket:o.id,bucketNome:o.nome}))}catch(e){console.error("Erro ao gerar URL para ".concat(s.name,":"),e)}j((s+1)/w.length*100)}catch(e){console.error("Erro ao fazer backup do bucket ".concat(o.id,":"),e)}}a.length>0?(y({status:"download",message:"Criando arquivo ZIP com as imagens..."}),await _(a,"imagens_opin_".concat((new Date).toISOString().split("T")[0],".zip")),y({status:"concluido",message:"Backup das imagens realizado com sucesso! ".concat(a.length," arquivos baixados.")})):y({status:"concluido",message:"Nenhuma imagem encontrada para backup."}),setTimeout((()=>{y({}),j(0)}),3e3)}catch(e){console.error("Erro no backup das imagens:",e),y({status:"erro",message:"Erro no backup: ".concat(e.message)}),j(0)}},disabled:"imagens"===h.status||"download"===h.status,className:"w-full px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,f.jsx)(le.A,{className:"w-4 h-4 inline mr-2"}),"Backup Imagens"]})]})]}),h.status&&(0,f.jsx)("div",{className:"p-4 rounded-lg border ".concat("concluido"===h.status?"bg-green-50 border-green-200 text-green-800":"erro"===h.status?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"),children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"font-medium",children:h.message}),h.detalhes&&(0,f.jsxs)("p",{className:"text-sm mt-1",children:["Tabelas: ",h.detalhes.tabelas," | Registros: ",h.detalhes.registros," | Arquivos: ",h.detalhes.arquivos]})]}),v>0&&v<100&&(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2 mr-2",children:(0,f.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(v,"%")}})}),(0,f.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(v),"%"]})]})]})})]}),(0,f.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,f.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,f.jsx)(se.A,{className:"w-5 h-5 mr-2 text-gray-600"}),"Tabelas do Sistema"]}),(0,f.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((e=>{const a=e.icone,s=m===e.id;return(0,f.jsx)("div",{className:"bg-white rounded-lg shadow-sm border-2 cursor-pointer transition-all duration-200 hover:shadow-md ".concat(s?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"),onClick:()=>A(e.id),children:(0,f.jsxs)("div",{className:"p-4",children:[(0,f.jsxs)("div",{className:"flex items-center mb-3",children:[(0,f.jsx)("div",{className:"".concat(e.cor," p-2 rounded-lg mr-3"),children:(0,f.jsx)(a,{className:"w-5 h-5 text-white"})}),(0,f.jsx)("h4",{className:"font-medium text-gray-900",children:e.nome})]}),(0,f.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.descricao}),(0,f.jsx)("div",{className:"flex space-x-2",children:(0,f.jsxs)("button",{className:"flex items-center px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",onClick:a=>{a.stopPropagation(),A(e.id)},children:[(0,f.jsx)(de.A,{className:"w-3 h-3 mr-1"}),"Visualizar"]})})]})},e.id)}))})]}),(0,f.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,f.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,f.jsx)(ce.A,{className:"w-5 h-5 mr-2 text-gray-600"}),"Buckets de Arquivos"]}),(0,f.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map((e=>{const a=e.icone;return(0,f.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[(0,f.jsxs)("div",{className:"flex items-center mb-3",children:[(0,f.jsx)("div",{className:"".concat(e.cor," p-2 rounded-lg mr-3"),children:(0,f.jsx)(a,{className:"w-5 h-5 text-white"})}),(0,f.jsx)("h4",{className:"font-medium text-gray-900",children:e.nome})]}),(0,f.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.descricao}),(0,f.jsx)("p",{className:"text-xs text-gray-500",children:"Inclu\xeddo no backup completo do sistema"})]},e.id)}))})]}),m&&(0,f.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)("h4",{className:"text-lg font-semibold text-gray-900",children:["Dados da Tabela: ",null===(e=a.find((e=>e.id===m)))||void 0===e?void 0:e.nome]}),(0,f.jsxs)("p",{className:"text-sm text-gray-600",children:[g.length," registros encontrados"]})]}),(0,f.jsxs)("div",{className:"flex space-x-2",children:[(0,f.jsxs)("button",{onClick:()=>A(m),disabled:p,className:"flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors disabled:opacity-50",children:[(0,f.jsx)(me.A,{className:"w-4 h-4 mr-1 ".concat(p?"animate-spin":"")}),"Atualizar"]}),(0,f.jsxs)("button",{onClick:()=>((e,a)=>{if(!a||0===a.length)return void alert("Nenhum dado para baixar");const s=Object.keys(a[0]),o=[s.join(","),...a.map((e=>s.map((a=>{const s=e[a];return"string"===typeof s&&(s.includes(",")||s.includes("\n")||s.includes('"'))?'"'.concat(s.replace(/"/g,'""'),'"'):s||""})).join(",")))].join("\n"),r=new Blob([o],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),n=URL.createObjectURL(r);t.setAttribute("href",n),t.setAttribute("download","".concat(e,"_").concat((new Date).toISOString().split("T")[0],".csv")),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)})(m,g),disabled:p||0===g.length,className:"flex items-center px-3 py-2 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors disabled:opacity-50",children:[(0,f.jsx)(ue.A,{className:"w-4 h-4 mr-1"}),"CSV"]}),(0,f.jsxs)("button",{onClick:()=>((e,a)=>{if(!a||0===a.length)return void alert("Nenhum dado para baixar");const s=JSON.stringify(a,null,2),o=new Blob([s],{type:"application/json;charset=utf-8;"}),r=document.createElement("a"),t=URL.createObjectURL(o);r.setAttribute("href",t),r.setAttribute("download","".concat(e,"_").concat((new Date).toISOString().split("T")[0],".json")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)})(m,g),disabled:p||0===g.length,className:"flex items-center px-3 py-2 text-sm bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors disabled:opacity-50",children:[(0,f.jsx)(ue.A,{className:"w-4 h-4 mr-1"}),"JSON"]})]})]}),d&&(0,f.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded",children:d}),p?(0,f.jsxs)("div",{className:"flex items-center justify-center h-32",children:[(0,f.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-green-600"}),(0,f.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando dados..."})]}):(0,f.jsxs)("div",{className:"overflow-x-auto",children:[g.length>0?(0,f.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,f.jsx)("thead",{className:"bg-gray-50",children:(0,f.jsx)("tr",{children:Object.keys(g[0]).map((e=>(0,f.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},e)))})}),(0,f.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g.slice(0,100).map(((e,a)=>(0,f.jsx)("tr",{className:"hover:bg-gray-50",children:Object.values(e).map(((e,a)=>(0,f.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 max-w-xs truncate",title:"string"===typeof e&&e.length>50?e:"",children:"string"===typeof e&&e.length>50?"".concat(e.substring(0,50),"..."):e||"-"},a)))},a)))})]}):(0,f.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Nenhum dado encontrado nesta tabela"}),g.length>100&&(0,f.jsxs)("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Mostrando os primeiros 100 registros de ",g.length," total. Use os bot\xf5es de download para acessar todos os dados."]})]})]})]})};let xe=null,pe=null,be=null;try{xe=s(2097).A}catch(ye){console.warn("ImagensEscolaTab n\xe3o encontrado:",ye)}try{pe=s(3113).A}catch(ye){console.warn("ImagensProfessoresTab n\xe3o encontrado:",ye)}try{be=s(2092).A}catch(ye){console.warn("DocumentosTab n\xe3o encontrado:",ye)}const he=()=>{const{triggerRefresh:e}=(0,t.b)(),[a,s]=(0,o.useState)(null),[n,l]=(0,o.useState)(!1),[d,g]=(0,o.useState)(null),[x,p]=(0,o.useState)(!1),[h,P]=(0,o.useState)(!1),S="undefined"!==typeof window&&window.innerWidth<=u,{escolas:L,loading:D,error:I,searchTerm:T,setSearchTerm:O,selectedType:F,setSelectedType:z,filteredEscolas:U,saveEscola:G}=i(),{loadExistingModalidades:R,clearModalidades:V}=c(),W=()=>{s((V(),{Escola:"","Munic\xedpio":"","Endere\xe7o":"","Terra Indigena (TI)":"","Parcerias com o munic\xedpio":"","Diretoria de Ensino":"","Ano de cria\xe7\xe3o da escola":"","Povos indigenas":"","Linguas faladas":"","Modalidade de Ensino/turnos de funcionamento":"","Numero de alunos":"",turnos_funcionamento:"","Espa\xe7o escolar e estrutura":"","Acesso \xe0 \xe1gua":"","Tem coleta de lixo?":"","Acesso \xe0 internet":"","Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":"","Modo de acesso \xe0 escola":"","Gest\xe3o/Nome":"","Outros funcion\xe1rios":"","Quantidade de professores ind\xedgenas":"","Quantidade de professores n\xe3o ind\xedgenas":"","Professores falam a l\xedngua ind\xedgena?":"","Forma\xe7\xe3o dos professores":"","Forma\xe7\xe3o continuada oferecida":"","A escola possui PPP pr\xf3prio?":"","PPP elaborado com a comunidade?":"","Projetos em andamento":"","Parcerias com universidades?":"","A\xe7\xf5es com ONGs ou coletivos?":"","Desejos da comunidade para a escola":"","Escola utiliza redes sociais?":"","Links das redes sociais":"",historia_da_escola:"",Latitude:"",Longitude:"",links:"",link_para_videos:"",logradouro:"",numero:"",complemento:"",bairro:"",cep:"",estado:"SP",nome_professor:"",professores_indigenas:"",professores_nao_indigenas:"",professores_falam_lingua_indigena:"",formacao_professores:"",visitas_supervisores_formacao:"",outros_funcionarios:"",gestao:"",merenda_diferenciada:"",cozinha:"",merenda_escolar:"",diferenciada:"",activeTab:b}))};return(0,f.jsxs)("div",{className:"flex min-h-screen bg-gray-950",children:[(0,f.jsx)(y,{isMobile:S,sidebarOpen:h,setSidebarOpen:P,editingLocation:a,onEscolaSelect:e=>{R(e["Modalidade de Ensino/turnos de funcionamento"]);const a={id:e.id,Escola:e.Escola,"Munic\xedpio":e["Munic\xedpio"],"Endere\xe7o":e["Endere\xe7o"],"Terra Indigena (TI)":e["Terra Indigena (TI)"],"Parcerias com o munic\xedpio":e["Parcerias com o munic\xedpio"],"Diretoria de Ensino":e["Diretoria de Ensino"],"Ano de cria\xe7\xe3o da escola":e["Ano de cria\xe7\xe3o da escola"],"Povos indigenas":e["Povos indigenas"],"Linguas faladas":e["Linguas faladas"],"Modalidade de Ensino/turnos de funcionamento":e["Modalidade de Ensino/turnos de funcionamento"],"Numero de alunos":e["Numero de alunos"],turnos_funcionamento:e.turnos_funcionamento||"","Espa\xe7o escolar e estrutura":e["Espa\xe7o escolar e estrutura"],"Acesso \xe0 \xe1gua":e["Acesso \xe0 \xe1gua"],"Tem coleta de lixo?":e["Tem coleta de lixo?"],"Acesso \xe0 internet":e["Acesso \xe0 internet"],"Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)":e["Equipamentos Tecnol\xf3gicos (Computadores, tablets e impressoras)"],"Modo de acesso \xe0 escola":e["Modo de acesso \xe0 escola"],"Gest\xe3o/Nome":e["Gest\xe3o/Nome"],"Outros funcion\xe1rios":e["Outros funcion\xe1rios"],"Quantidade de professores ind\xedgenas":e["Quantidade de professores ind\xedgenas"],"Quantidade de professores n\xe3o ind\xedgenas":e["Quantidade de professores n\xe3o ind\xedgenas"],"Professores falam a l\xedngua ind\xedgena?":e["Professores falam a l\xedngua ind\xedgena?"],"Forma\xe7\xe3o dos professores":e["Forma\xe7\xe3o dos professores"],"Forma\xe7\xe3o continuada oferecida":e["Forma\xe7\xe3o continuada oferecida"],"A escola possui PPP pr\xf3prio?":e["A escola possui PPP pr\xf3prio?"],"PPP elaborado com a comunidade?":e["PPP elaborado com a comunidade?"],"Projetos em andamento":e["Projetos em andamento"],"Parcerias com universidades?":e["Parcerias com universidades?"],"A\xe7\xf5es com ONGs ou coletivos?":e["A\xe7\xf5es com ONGs ou coletivos?"],"Desejos da comunidade para a escola":e["Desejos da comunidade para a escola"],"Escola utiliza redes sociais?":e["Escola utiliza redes sociais?"],"Links das redes sociais":e["Links das redes sociais"],historia_da_escola:e.historia_da_escola,Latitude:e.Latitude,Longitude:e.Longitude,links:e.links,link_para_videos:e.link_para_videos,logradouro:e.logradouro,numero:e.numero,complemento:e.complemento,bairro:e.bairro,cep:e.cep,estado:e.estado,nome_professor:e.nome_professor,professores_indigenas:e.professores_indigenas,professores_nao_indigenas:e.professores_nao_indigenas,professores_falam_lingua_indigena:e.professores_falam_lingua_indigena,formacao_professores:e.formacao_professores,visitas_supervisores_formacao:e.visitas_supervisores_formacao,outros_funcionarios:e.outros_funcionarios,gestao:e.gestao,merenda_diferenciada:e.merenda_diferenciada,cozinha:e.cozinha,merenda_escolar:e.merenda_escolar,diferenciada:e.diferenciada,activeTab:b};s(a)}}),(0,f.jsxs)("main",{className:"flex-1 p-6 overflow-y-auto h-screen bg-gray-950",children:[(0,f.jsx)("h1",{className:"text-2xl font-bold text-gray-100 mb-6",children:"Painel de Administra\xe7\xe3o"}),(0,f.jsx)(v,{searchTerm:T,setSearchTerm:O,selectedType:F,setSelectedType:z,onNovaEscola:W}),D&&(0,f.jsx)("div",{className:"text-center py-8",children:(0,f.jsx)("div",{className:"text-gray-400",children:"Carregando escolas..."})}),I&&(0,f.jsxs)("div",{className:"bg-red-900 border border-red-700 text-red-200 px-4 py-3 rounded mb-4",children:["Erro ao carregar escolas: ",I]}),a&&"object"===typeof a&&void 0!==a.Escola&&(0,f.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-lg p-6 max-h-[calc(100vh-200px)] overflow-hidden flex flex-col border border-gray-800",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[(0,f.jsx)("h2",{className:"text-lg font-semibold text-gray-100",children:a.id?"Editar Escola":"Nova Escola"}),(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("button",{onClick:async()=>{if(a){l(!0),g(null),p(!1);try{const e=await G(a);e.success?(p(!0),s(e.data),setTimeout((()=>{p(!1)}),3e3)):g(e.error)}catch(e){g(e.message)}finally{l(!1)}}},disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Salvando...":"Salvar"}),(0,f.jsx)("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-200",children:"Fechar"})]})]}),x&&(0,f.jsx)("div",{className:"mb-4 p-3 bg-green-900 border border-green-700 text-green-200 rounded-lg",children:"\u2705 Escola salva com sucesso!"}),d&&(0,f.jsxs)("div",{className:"mb-4 p-3 bg-red-900 border border-red-700 text-red-200 rounded-lg",children:["\u274c Erro ao salvar: ",d]}),(0,f.jsx)("div",{className:"border-b border-gray-800 mb-6 flex-shrink-0 bg-gray-800 rounded-t-lg",children:(0,f.jsx)("nav",{className:"-mb-px flex space-x-8 overflow-x-auto",children:m.map((e=>(0,f.jsx)("button",{type:"button",onClick:()=>s((0,r.A)((0,r.A)({},a),{},{activeTab:e.id})),className:"whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors ".concat((a.activeTab||b)===e.id?"border-green-400 text-green-300 bg-gray-900":"border-transparent text-gray-400 hover:text-green-200 hover:bg-gray-700"),children:e.label},e.id)))})}),(0,f.jsx)("div",{className:"flex-1 overflow-y-auto",children:(()=>{const e=(null===a||void 0===a?void 0:a.activeTab)||b;switch(e){case"dados-basicos":return(0,f.jsx)(N,{editingLocation:a,setEditingLocation:s});case"povos-linguas":return(0,f.jsx)(w,{editingLocation:a,setEditingLocation:s});case"modalidades":return(0,f.jsx)(j,{editingLocation:a,setEditingLocation:s});case"infraestrutura":return(0,f.jsx)(A,{editingLocation:a,setEditingLocation:s});case"gestao-professores":return(0,f.jsx)(E,{editingLocation:a,setEditingLocation:s});case"material-pedagogico":return(0,f.jsx)(_,{editingLocation:a,setEditingLocation:s});case"projetos-parcerias":return(0,f.jsx)(k,{editingLocation:a,setEditingLocation:s});case"redes-sociais":return(0,f.jsx)(C,{editingLocation:a,setEditingLocation:s});case"video":return(0,f.jsx)(M,{editingLocation:a});case"historias":return(0,f.jsx)(q,{editingLocation:a,setEditingLocation:s});case"historia-professores":return(0,f.jsx)(B,{editingLocation:a,setEditingLocation:s});case"coordenadas":return(0,f.jsx)(ae,{editingLocation:a,setEditingLocation:s});case"tabelas-integrais":return(0,f.jsx)(ge,{});case"imagens-escola":return xe?(0,f.jsx)(xe,{editingLocation:a}):(0,f.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Componente em carregamento..."});case"imagens-professores":return pe?(0,f.jsx)(pe,{editingLocation:a}):(0,f.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Componente em carregamento..."});case"documentos":return be?(0,f.jsx)(be,{editingLocation:a}):(0,f.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Componente em carregamento..."});default:return(0,f.jsxs)("div",{className:"text-gray-400 text-center py-8",children:['Aba "',e,'" em desenvolvimento...']})}})()})]}),!a&&!D&&(0,f.jsxs)("div",{className:"text-center py-12",children:[(0,f.jsx)("div",{className:"text-gray-400 text-lg mb-4",children:"Selecione uma escola para editar ou crie uma nova"}),(0,f.jsx)("button",{onClick:W,className:"px-6 py-3 bg-green-700 text-white rounded-lg hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors",children:"+ Criar Nova Escola"})]})]})]})},fe=()=>(0,f.jsx)(he,{})},2092:(e,a,s)=>{s.d(a,{A:()=>u});var o=s(5043),r=s(6478),t=s(256),n=s(7991),i=s(7669),l=s(2349),d=s(5118),c=s(579);const m=e=>{let{onUploadComplete:a,onRemove:s,existingUrls:m=[]}=e;const[u,g]=(0,o.useState)(!1),[x,p]=(0,o.useState)(null),[b,h]=(0,o.useState)([]),[f,y]=(0,o.useState)(m);return(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("label",{className:"block font-medium text-gray-800",children:["Documentos PDF",(0,c.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:["(M\xe1x. ",d.vM.PDF.MAX_SIZE/1048576,"MB cada arquivo)"]})]}),x&&(0,c.jsxs)("div",{className:"flex items-center text-red-500 text-sm",children:[(0,c.jsx)(r.A,{size:16,className:"mr-1"}),x]})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,c.jsxs)("label",{className:"cursor-pointer",children:[(0,c.jsx)("input",{type:"file",accept:".pdf",multiple:!0,onChange:async e=>{const a=Array.from(e.target.files);if(0===a.length)return;const s=a.filter((e=>{const a=d.vM.PDF.ALLOWED_TYPES.includes(e.type),s=e.size<=d.vM.PDF.MAX_SIZE;return a&&s}));s.length!==a.length&&p("Alguns arquivos foram ignorados. Use apenas PDFs at\xe9 10MB."),h((e=>[...e,...s]))},className:"hidden",disabled:u}),(0,c.jsxs)("div",{className:"flex items-center justify-center gap-2 border-2 border-dashed rounded-lg p-4 \n            ".concat(u?"border-gray-300 bg-gray-50":"border-blue-300 hover:border-blue-400 bg-blue-50"),children:[(0,c.jsx)(t.A,{size:20,className:u?"text-gray-400":"text-blue-500"}),(0,c.jsx)("span",{className:u?"text-gray-500":"text-blue-600",children:u?"Fazendo upload...":"Selecionar PDFs"})]})]}),b.length>0&&(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("h4",{className:"font-medium text-sm text-gray-700",children:"Arquivos selecionados:"}),(0,c.jsx)("div",{className:"grid grid-cols-1 gap-2",children:b.map(((e,a)=>(0,c.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(n.A,{size:16,className:"text-gray-500"}),(0,c.jsx)("span",{className:"text-sm text-gray-700",children:e.name})]}),(0,c.jsx)("button",{type:"button",onClick:()=>h((e=>e.filter(((e,s)=>s!==a)))),className:"text-gray-500 hover:text-red-500",children:(0,c.jsx)(i.A,{size:16})})]},a)))}),(0,c.jsx)("button",{type:"button",onClick:async()=>{if(0===b.length)return;g(!0),p(null);const e=[];try{for(const a of b){const s=await(0,l.GP)(a);e.push(s)}const s=[...f,...e];y(s),a(s),h([])}catch(s){p("Erro ao fazer upload dos arquivos. Tente novamente."),console.error("Erro no upload:",s)}finally{g(!1)}},disabled:u,className:"w-full py-2 px-4 rounded-lg text-white font-medium\n                ".concat(u?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"),children:u?"Enviando...":"Fazer Upload"})]}),f.length>0&&(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("h4",{className:"font-medium text-sm text-gray-700",children:"Documentos enviados:"}),(0,c.jsx)("div",{className:"grid grid-cols-1 gap-2",children:f.map(((e,a)=>(0,c.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(n.A,{size:16,className:"text-gray-500"}),(0,c.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:["Documento ",a+1]})]}),(0,c.jsx)("button",{type:"button",onClick:()=>(e=>{const a=f.filter(((a,s)=>s!==e));y(a),s(a)})(a),className:"text-gray-500 hover:text-red-500",children:(0,c.jsx)(i.A,{size:16})})]},a)))})]})]})]})},u=e=>{let{editingLocation:a}=e;const s=null===a||void 0===a?void 0:a.id,[r,t]=(0,o.useState)((null===a||void 0===a?void 0:a.documentos)||[]);if(!s)return(0,c.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,c.jsx)("p",{children:"Selecione uma escola para gerenciar seus documentos"})});return(0,c.jsx)("div",{className:"space-y-6",children:(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Documentos da Escola"}),(0,c.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Fa\xe7a upload de documentos da escola em formato PDF. N\xe3o h\xe1 limite no n\xfamero de documentos."}),(0,c.jsx)(m,{onUploadComplete:e=>{t(e),console.log("Documentos atualizados:",e)},onRemove:e=>{t(e),console.log("Documentos ap\xf3s remo\xe7\xe3o:",e)},existingUrls:r})]})})}},2097:(e,a,s)=>{s.d(a,{A:()=>b});var o=s(5043),r=s(9379),t=s(6464),n=s(6478),i=s(193),l=s(256),d=s(7669),c=s(1184),m=s(4488),u=s(1440),g=s(237),x=s(579);const p=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[p,b]=(0,o.useState)([]),[h,f]=(0,o.useState)(!1),[y,v]=(0,o.useState)(0),[j,N]=(0,o.useState)(""),[w,A]=(0,o.useState)(""),[E,_]=(0,o.useState)([]),[k,C]=(0,o.useState)(!0),[P,S]=(0,o.useState)(null),[L,D]=(0,o.useState)(""),I=(0,o.useCallback)((async()=>{if(a)try{C(!0);const e=await(0,u.Gw)(a,"imagens-das-escolas");_(e)}catch(e){console.error("Erro ao buscar imagens:",e),N("Erro ao carregar imagens existentes")}finally{C(!1)}}),[a]);(0,o.useEffect)((()=>{I()}),[I]),(0,o.useEffect)((()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos..."),(0,g.iy)())}),[a]),(0,o.useEffect)((()=>{(async()=>{if(!E.length)return;console.log("Buscando legendas para",E.length,"imagens");const e={};for(const s of E){console.log("Buscando legenda para imagem:",s.url);const o=await(0,g.qP)(s.url,a,"escola");console.log("Legenda encontrada:",o),e[s.url]=o}_((a=>a.map((a=>(0,r.A)((0,r.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[E.length,a]),(0,o.useEffect)((()=>{if(j||w){const e=setTimeout((()=>{N(""),A("")}),5e3);return()=>clearTimeout(e)}}),[j,w]);const M=(0,o.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(b((e=>[...e,...s])),N(""))}),[]),T=(0,o.useCallback)((e=>{e.preventDefault()}),[]),O=(e,a,s)=>{_((o=>o.map((o=>o.id===e?(0,r.A)((0,r.A)({},o),{},{legendaData:(0,r.A)((0,r.A)({},o.legendaData),{},{[a]:s})}):o))))};return k?(0,x.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,x.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,x.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens..."})]})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(t.A,{className:"w-5 h-5 text-blue-600"}),(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens da Escola"})]}),(0,x.jsxs)("div",{className:"text-sm text-gray-500",children:[E.length," imagens"]})]}),j&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,x.jsx)(n.A,{className:"w-5 h-5 text-red-600"}),(0,x.jsx)("span",{className:"text-red-700",children:j})]}),w&&(0,x.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,x.jsx)(i.A,{className:"w-5 h-5 text-green-600"}),(0,x.jsx)("span",{className:"text-green-700",children:w})]}),(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(h?"border-gray-300 bg-gray-50":"border-blue-300 bg-blue-50 hover:border-blue-400 hover:bg-blue-100"),onDrop:M,onDragOver:T,children:[(0,x.jsx)(l.A,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),(0,x.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens aqui ou clique para selecionar"}),(0,x.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo"}),(0,x.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,x.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||N('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||N('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(b((e=>[...e,...s])),N(""))},className:"hidden",disabled:h}),"Selecionar Arquivos"]})]}),h&&(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,x.jsx)("span",{children:"Fazendo upload..."}),(0,x.jsxs)("span",{children:[Math.round(y),"%"]})]}),(0,x.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,x.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(y,"%")}})})]}),p.length>0&&(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",p.length,")"]}),(0,x.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:p.map(((e,a)=>(0,x.jsxs)("div",{className:"relative group",children:[(0,x.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,x.jsx)("button",{onClick:()=>(e=>{b((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,x.jsx)(d.A,{className:"w-3 h-3"})}),(0,x.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,x.jsx)("button",{onClick:async()=>{if(0!==p.length){f(!0),v(0),N("");try{const e=[];for(let s=0;s<p.length;s++){const o=p[s],r=(s+1)/p.length*100;v(r);const t=await(0,u.gE)(o,a);e.push(t)}_((a=>[...a,...e])),b([]),v(0),A("".concat(e.length," imagem(ns) carregada(s) com sucesso!")),s&&s()}catch(e){console.error("Erro no upload:",e),N("Erro ao fazer upload: ".concat(e.message))}finally{f(!1),v(0)}}},disabled:h,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Fazendo Upload...":"Fazer Upload"})]})]}),")}",E.length>0&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens da Escola (",E.length,")"]}),(0,x.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map((e=>{var o,t,n,i,l;return(0,x.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,x.jsxs)("div",{className:"relative group",children:[(0,x.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem da escola",className:"w-full h-48 object-cover"}),(0,x.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,x.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,x.jsx)("button",{onClick:()=>(async(e,a)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem?"))try{await(0,u.vS)(e,a,"imagens-das-escolas"),_((a=>a.filter((a=>a.id!==e)))),A("Imagem exclu\xedda com sucesso!"),s&&s()}catch(o){console.error("Erro ao deletar imagem:",o),N("Erro ao excluir imagem: ".concat(o.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,x.jsx)(c.A,{className:"w-5 h-5"})})})})]}),(0,x.jsxs)("div",{className:"p-4 space-y-2",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(o=e.legendaData)||void 0===o?void 0:o.legenda)||"",onChange:a=>O(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,x.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(t=e.legendaData)||void 0===t?void 0:t.descricao_detalhada)||"",onChange:a=>O(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(n=e.legendaData)||void 0===n?void 0:n.autor_foto)||"",onChange:a=>O(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,x.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(i=e.legendaData)||void 0===i?void 0:i.data_foto)||"",onChange:a=>O(e.id,"data_foto",a.target.value)}),(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,x.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===(l=e.legendaData)||void 0===l?void 0:l.categoria)||"",onChange:a=>O(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,x.jsx)("div",{className:"flex gap-2 pt-2",children:(0,x.jsxs)("button",{onClick:()=>(async e=>{console.log("=== DEBUG: Salvando legenda ==="),console.log("Imagem completa:",e);const o=e.url,t=e.legendaData;console.log("URL relativa:",o),console.log("Dados da legenda:",t),console.log("Escola ID:",a);try{console.log("Buscando legenda existente...");let e=await(0,g.qP)(o,a,"escola");if(console.log("Legenda existente encontrada:",e),e){console.log("Atualizando legenda existente...");const a=(0,r.A)((0,r.A)({},t),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",a);const s=await(0,g.w_)(e.id,a);console.log("Legenda atualizada com sucesso:",s)}else{console.log("Criando nova legenda...");const e=(0,r.A)((0,r.A)({escola_id:a,imagem_url:o},t),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"escola"});console.log("Dados para nova legenda:",e);const s=await(0,g.eP)(e);console.log("Nova legenda criada:",s)}A("Legenda salva com sucesso!"),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(n){console.error("=== ERRO ao salvar legenda ==="),console.error("Erro completo:",n),console.error("Mensagem de erro:",n.message),console.error("Stack trace:",n.stack),N("Erro ao salvar legenda: "+n.message)}})(e),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",type:"button",children:[(0,x.jsx)(m.A,{className:"w-5 h-5"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===E.length&&!h&&(0,x.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,x.jsx)(t.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,x.jsx)("p",{children:"Nenhuma imagem adicionada ainda."}),(0,x.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar a escola."})]})]})},b=e=>{let{editingLocation:a}=e;const s=null===a||void 0===a?void 0:a.id;return s?(0,x.jsx)("div",{className:"space-y-6",children:(0,x.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Imagens da Escola"}),(0,x.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Fa\xe7a upload de imagens da escola. N\xe3o h\xe1 limite no n\xfamero de imagens."}),(0,x.jsx)(p,{escolaId:s,onImagesUpdate:()=>{console.log("Imagens da escola atualizadas")}})]})}):(0,x.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,x.jsx)("p",{children:"Selecione uma escola para gerenciar suas imagens"})})}},2349:(e,a,s)=>{s.d(a,{GP:()=>n,V6:()=>i});var o=s(2880),r=s(5118);const t=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.GJ.PDFS;try{const s=(0,r.ti)(e);if(!s)throw new Error("Tipo de arquivo n\xe3o suportado");const t=(0,r.nJ)(e,s);if(!t.isValid)throw new Error(t.error);const n=(0,r.wh)(e,"".concat(s.toLowerCase(),"_")),i="".concat(r.AP[s],"/").concat(n),{error:l}=await o.N.storage.from(a).upload(i,e,{cacheControl:"3600",upsert:!1});if(l)throw l;const{data:{publicUrl:d}}=o.N.storage.from(a).getPublicUrl(i);return d}catch(s){throw console.error("Erro ao fazer upload:",s),s}},n=async e=>t(e,r.GJ.PDFS),i=async e=>t(e,r.GJ.MEDIA)},3113:(e,a,s)=>{s.d(a,{A:()=>f});var o=s(5043),r=s(9379),t=s(4562),n=s(6478),i=s(193),l=s(256),d=s(7669),c=s(1184),m=s(4488),u=s(1440),g=s(237),x=s(2880);const p=async e=>{const{data:a,error:s}=await x.N.from("imagens_professores").insert([e]).select().single();if(s)throw s;return a};var b=s(579);const h=e=>{let{escolaId:a,onImagesUpdate:s}=e;const[h,f]=(0,o.useState)([]),[y,v]=(0,o.useState)(!1),[j,N]=(0,o.useState)(0),[w,A]=(0,o.useState)(""),[E,_]=(0,o.useState)(""),[k,C]=(0,o.useState)([]),[P,S]=(0,o.useState)(!0),[L,D]=(0,o.useState)(null),[I,M]=(0,o.useState)(""),[T,O]=(0,o.useState)("professor"),[F,z]=(0,o.useState)(""),U=(0,o.useCallback)((async()=>{if(a)try{S(!0);const e=await(0,u.Gw)(a,"imagens-professores");C(e)}catch(e){console.error("Erro ao buscar imagens dos professores:",e),A("Erro ao carregar imagens dos professores")}finally{S(!1)}}),[a]);(0,o.useEffect)((()=>{U()}),[U]),(0,o.useEffect)((()=>{a&&(console.log("Testando estrutura da tabela legendas_fotos (professores)..."),(0,g.iy)())}),[a]),(0,o.useEffect)((()=>{(async()=>{if(!k.length)return;console.log("Buscando legendas para",k.length,"imagens de professores");const e={};for(const s of k){console.log("Buscando legenda para imagem de professor:",s.url);const o=await(0,g.qP)(s.url,a,"professor");console.log("Legenda encontrada para professor:",o),e[s.url]=o}C((a=>a.map((a=>(0,r.A)((0,r.A)({},a),{},{legendaData:e[a.url]||{legenda:"",descricao_detalhada:"",autor_foto:"",data_foto:"",categoria:"geral"}})))))})()}),[k.length,a]),(0,o.useEffect)((()=>{if(w||E){const e=setTimeout((()=>{A(""),_("")}),5e3);return()=>clearTimeout(e)}}),[w,E]);const q=(0,o.useCallback)((e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files);if(0===a.length)return;const s=a.filter((e=>e.type.startsWith("image/")));s.length>0&&(f((e=>[...e,...s])),A(""))}),[]),G=(0,o.useCallback)((e=>{e.preventDefault()}),[]),B=(e,a,s)=>{C((o=>o.map((o=>o.id===e?(0,r.A)((0,r.A)({},o),{},{legendaData:(0,r.A)((0,r.A)({},o.legendaData),{},{[a]:s})}):o))))},R=async e=>{console.log("=== DEBUG: Salvando legenda de professor ==="),console.log("Imagem completa:",e);const o=e.url,t=e.legendaData;console.log("URL relativa:",o),console.log("Dados da legenda:",t),console.log("Escola ID:",a);try{console.log("Buscando legenda existente...");let n=await(0,g.qP)(o,a,"professor");if(console.log("Legenda existente encontrada:",n),n){console.log("Atualizando legenda existente...");const e=(0,r.A)((0,r.A)({},t),{},{updated_at:(new Date).toISOString()});console.log("Dados para atualiza\xe7\xe3o:",e);const a=await(0,g.w_)(n.id,e);console.log("Legenda de professor atualizada com sucesso:",a)}else{console.log("Criando nova legenda...");const e=(0,r.A)((0,r.A)({escola_id:a,imagem_url:o},t),{},{ativo:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),tipo_foto:"professor"});console.log("Dados para nova legenda:",e);const s=await(0,g.eP)(e);console.log("Nova legenda de professor criada:",s)}console.log("Atualizando metadados da imagem...");let i=await(async(e,a)=>{const{data:s,error:o}=await x.N.from("imagens_professores").select("*").eq("imagem_url",e).eq("escola_id",a).eq("ativo",!0).single();if(o&&"PGRST116"!==o.code)throw o;return s||null})(e.publicUrl,a);i?(console.log("Metadados encontrados:",i),await(async(e,a)=>{const{data:s,error:o}=await x.N.from("imagens_professores").update(a).eq("id",e).select().single();if(o)throw o;return s})(i.id,{autor:t.autor_foto,updated_at:(new Date).toISOString()}),console.log("Metadados atualizados com sucesso")):console.log("Nenhum metadado encontrado para atualizar"),_("Legenda salva com sucesso!"),s&&(console.log("Chamando onImagesUpdate..."),s())}catch(n){console.error("=== ERRO ao salvar legenda de professor ==="),console.error("Erro completo:",n),console.error("Mensagem de erro:",n.message),console.error("Stack trace:",n.stack),A("Erro ao salvar legenda: "+n.message)}};return P?(0,b.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,b.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando imagens dos professores..."})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t.A,{className:"w-5 h-5 text-green-600"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens dos Professores"})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:[k.length," imagens"]})]}),w&&(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsx)(n.A,{className:"w-5 h-5 text-red-600"}),(0,b.jsx)("span",{className:"text-red-700",children:w})]}),E&&(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,b.jsx)(i.A,{className:"w-5 h-5 text-green-600"}),(0,b.jsx)("span",{className:"text-green-700",children:E})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(y?"border-gray-300 bg-gray-50":"border-green-300 bg-green-50 hover:border-green-400 hover:bg-green-100"),onDrop:q,onDragOver:G,children:[(0,b.jsx)(l.A,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-gray-600 mb-2",children:"Arraste imagens dos professores aqui ou clique para selecionar"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"JPG, PNG, WEBP, GIF \u2022 M\xe1ximo 5MB por arquivo \u2022 M\xe1ximo 5 imagens"}),(0,b.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer transition-colors",children:[(0,b.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{const a=Array.from(e.target.files);if(0===a.length)return;const s=a.filter((e=>{const a=["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),s=e.size<=5242880;return a||A('Arquivo "'.concat(e.name,'" n\xe3o \xe9 uma imagem v\xe1lida. Use apenas JPG, PNG, WEBP ou GIF.')),s||A('Arquivo "'.concat(e.name,'" \xe9 muito grande. Tamanho m\xe1ximo: 5MB.')),a&&s}));s.length>0&&(f((e=>[...e,...s])),A(""))},className:"hidden",disabled:y}),"Selecionar Arquivos"]})]}),y&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,b.jsx)("span",{children:"Fazendo upload das imagens dos professores..."}),(0,b.jsxs)("span",{children:[Math.round(j),"%"]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(j,"%")}})})]}),h.length>0&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("h4",{className:"font-medium text-gray-900",children:["Arquivos selecionados (",h.length,")"]}),(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:h.map(((e,a)=>(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-24 object-cover rounded-lg border"}),(0,b.jsx)("button",{onClick:()=>(e=>{f((a=>a.filter(((a,s)=>s!==e))))})(a),className:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsx)(d.A,{className:"w-3 h-3"})}),(0,b.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name})]},a)))}),(0,b.jsx)("button",{onClick:async()=>{if(0!==h.length){v(!0),N(0),A("");try{const e=[];for(let s=0;s<h.length;s++){const o=h[s],r=(s+1)/h.length*100;N(r);const t=await(0,u.wG)(o,a,"",T,F);e.push(t),await p({escola_id:a,imagem_url:t.url,nome_arquivo:o.name,autor:"",ativo:!0})}C((a=>[...a,...e])),f([]),N(0),_("".concat(e.length," imagem(ns) do(s) professor(es) carregada(s) com sucesso!")),s&&s()}catch(e){console.error("Erro no upload:",e),A("Erro ao fazer upload: ".concat(e.message))}finally{v(!1),N(0)}}},disabled:y,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Fazendo Upload...":"Fazer Upload"})]})]}),")}",k.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("h4",{className:"font-medium text-gray-900",children:["Imagens dos Professores (",k.length,")"]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map((e=>{var a,o,r,t,n;return(0,b.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("img",{src:e.publicUrl,alt:e.descricao||"Imagem do professor",className:"w-full h-48 object-cover"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,b.jsx)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsx)("button",{onClick:()=>(async(e,a)=>{if(window.confirm("Tem certeza que deseja excluir esta imagem do professor?"))try{await(0,u.vS)(e,a,"imagens-professores"),C((a=>a.filter((a=>a.id!==e)))),_("Imagem do professor exclu\xedda com sucesso!"),s&&s()}catch(o){console.error("Erro ao deletar imagem:",o),A("Erro ao excluir imagem: ".concat(o.message))}})(e.id,e.url),className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Excluir imagem",children:(0,b.jsx)(c.A,{className:"w-5 h-5"})})})})]}),(0,b.jsxs)("div",{className:"p-4 space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Legenda"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(a=e.legendaData)||void 0===a?void 0:a.legenda)||"",onChange:a=>B(e.id,"legenda",a.target.value),placeholder:"Digite a legenda da imagem..."}),(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o Detalhada"}),(0,b.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(o=e.legendaData)||void 0===o?void 0:o.descricao_detalhada)||"",onChange:a=>B(e.id,"descricao_detalhada",a.target.value),placeholder:"Descri\xe7\xe3o detalhada da imagem..."}),(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autor da Foto"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(r=e.legendaData)||void 0===r?void 0:r.autor_foto)||"",onChange:a=>B(e.id,"autor_foto",a.target.value),placeholder:"Nome do fot\xf3grafo"}),(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Foto"}),(0,b.jsx)("input",{type:"date",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(t=e.legendaData)||void 0===t?void 0:t.data_foto)||"",onChange:a=>B(e.id,"data_foto",a.target.value)}),(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",value:(null===(n=e.legendaData)||void 0===n?void 0:n.categoria)||"",onChange:a=>B(e.id,"categoria",a.target.value),placeholder:"Digite a categoria da imagem..."}),(0,b.jsx)("div",{className:"flex gap-2 pt-2",children:(0,b.jsxs)("button",{onClick:()=>R(e),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",type:"button",children:[(0,b.jsx)(m.A,{className:"w-5 h-5"})," Salvar Legenda"]})})]})]},e.id)}))})]}),0===k.length&&!y&&(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(t.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,b.jsx)("p",{children:"Nenhuma imagem dos professores adicionada ainda."}),(0,b.jsx)("p",{className:"text-sm",children:"Adicione imagens para mostrar os professores da escola."})]})]})},f=e=>{let{editingLocation:a}=e;const s=null===a||void 0===a?void 0:a.id;return s?(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Imagens dos Professores"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Fa\xe7a upload de imagens dos professores da escola. N\xe3o h\xe1 limite no n\xfamero de imagens."}),(0,b.jsx)(h,{escolaId:s,onImagesUpdate:()=>{console.log("Imagens dos professores atualizadas")}})]})}):(0,b.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,b.jsx)("p",{children:"Selecione uma escola para gerenciar as imagens dos professores"})})}},5118:(e,a,s)=>{s.d(a,{AP:()=>t,GJ:()=>o,nJ:()=>i,ti:()=>n,vM:()=>r,wh:()=>l});const o={PDFS:"pdfs",MEDIA:"media"},r={PDF:{MAX_SIZE:10485760,ALLOWED_TYPES:["application/pdf"],MAX_FILES:1/0},IMAGE:{MAX_SIZE:5242880,ALLOWED_TYPES:["image/jpeg","image/png","image/jpg"],MAX_FILES:10},AUDIO:{MAX_SIZE:20971520,ALLOWED_TYPES:["audio/wav","audio/mpeg","audio/mp3"],MAX_FILES:1}},t={PDF:"documents",IMAGE:"images",AUDIO:"audio"},n=e=>r.PDF.ALLOWED_TYPES.includes(e.type)?"PDF":r.IMAGE.ALLOWED_TYPES.includes(e.type)?"IMAGE":r.AUDIO.ALLOWED_TYPES.includes(e.type)?"AUDIO":null,i=(e,a)=>{const s=r[a];return s?s.ALLOWED_TYPES.includes(e.type)?e.size>s.MAX_SIZE?{isValid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(s.MAX_SIZE/1048576,"MB")}:{isValid:!0}:{isValid:!1,error:"Tipo de arquivo n\xe3o permitido. Use apenas ".concat("PDF"===a?"PDF":"IMAGE"===a?"JPG/PNG":"WAV/MP3")}:{isValid:!1,error:"Tipo de arquivo n\xe3o suportado"}},l=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=Date.now(),o=Math.random().toString(36).substring(2,8),r=e.name.split(".").pop();return"".concat(a).concat(s,"_").concat(o,".").concat(r)}}}]);
//# sourceMappingURL=357.b606240f.chunk.js.map