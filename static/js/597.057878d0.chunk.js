"use strict";(self.webpackChunkopin_observatorio_professores_indigenas=self.webpackChunkopin_observatorio_professores_indigenas||[]).push([[597],{8327:(e,a,o)=>{o.r(a),o.d(a,{default:()=>qa});var s=o(5043),t=o(1642),n=o(5351),r=o(6528),l=o(9468),i=o(2463),c=o(1060),d=o(9333),u=o(9826),m=(o(3976),o(5366)),g=o(495),h=o(3104),x=o(3241),p=o(5921),f=o(5263),b=o(3361),v=o(1247),w=o(7790);const j="".concat("/escolasindigenas","/map-marker.svg"),y=function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=e.get("markerData")||e.get("schoolData"),s=e.get("isNearbyPair");if(!o)return null;const t=new p.Ay({image:new f.A({src:j,scale:s?1.2:1,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction"}),geometry:e.getGeometry()});if(a&&o.titulo){return[t,new p.Ay({text:new b.A({text:o.titulo,font:"12px Arial",fill:new v.A({color:"#1F2937"}),stroke:new w.A({color:"#FFFFFF",width:2}),offsetY:-15,textAlign:"center"}),geometry:e.getGeometry()})]}return t};var N=o(9379);const k=()=>{const e=window.innerWidth<=768,a="ontouchstart"in window||navigator.maxTouchPoints>0,o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),s=void 0!==window.orientation,t=[e,a,o,s].filter(Boolean).length;return console.log("[mobileUtils] Crit\xe9rios de mobile:",{isMobileWidth:e,hasTouch:a,isMobileUserAgent:o,isMobileOrientation:s,mobileCriteria:t,userAgent:navigator.userAgent}),t>=2};class C{constructor(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.map=e,this.options=(0,N.A)({enableHover:!1!==a.enableHover,enableClick:!1!==a.enableClick,enableDoubleClick:!1!==a.enableDoubleClick,enableTouch:!1!==a.enableTouch,hoverDelay:a.hoverDelay||200,clickDelay:a.clickDelay||300},a),this.eventHandlers=new Map,this.hoveredFeature=null,this.clickedFeature=null,this.clickTimeout=null,this.hoverTimeout=null,this.tooltipElement=null,console.log("[OpenLayersInteractions] Intera\xe7\xf5es inicializadas"),this.initializeInteractions()}isMobile(){const e=k(),a="ontouchstart"in window||navigator.maxTouchPoints>0;return console.log("[OpenLayersInteractions] Detec\xe7\xe3o de mobile:",{mobile:e,hasTouch:a,windowWidth:window.innerWidth,userAgent:navigator.userAgent}),e||a}initializeInteractions(){this.options.enableHover&&this.setupHoverInteraction(),this.options.enableClick&&this.setupClickInteraction(),this.options.enableDoubleClick&&this.setupDoubleClickInteraction(),this.options.enableTouch&&this.isMobile()&&this.setupTouchInteraction()}setupHoverInteraction(){this.map.on("pointermove",(e=>{this.handlePointerMove(e)})),this.map.on("pointerleave",(()=>{this.handlePointerLeave()}))}setupClickInteraction(){this.map.on("click",(e=>{this.handleClick(e)}))}setupDoubleClickInteraction(){this.map.on("dblclick",(e=>{this.handleDoubleClick(e)}))}setupTouchInteraction(){console.log("[OpenLayersInteractions] Touch interaction configurada para mobile")}handlePointerMove(e){if(this.isMobile())return;const a=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));a&&!this.hoveredFeature&&console.log("[OpenLayersInteractions] Feature detectado:",{type:a.get("type"),schoolData:a.get("schoolData"),terraIndigenaInfo:a.get("terraIndigenaInfo")}),a!==this.hoveredFeature&&(this.hoveredFeature&&this.clearHover(),a&&this.applyHover(a,e))}handlePointerLeave(){this.clearHover()}handleClick(e){const a=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));a&&(this.isMobile()?this.handleMobileClick(a,e):this.clickedFeature!==a?(this.clickedFeature=a,this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout((()=>{this.clickedFeature=null}),this.options.clickDelay),this.executeClickHandler(a,e)):this.handleDoubleClick(e))}handleDoubleClick(e){const a=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));a&&(this.clickTimeout&&(clearTimeout(this.clickTimeout),this.clickTimeout=null),this.clickedFeature=null,this.executeDoubleClickHandler(a,e))}handleTouchEnd(e){const a=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));a&&this.executeClickHandler(a,e)}handleMobileClick(e,a){if(this.clickedFeature===e)return console.log("[OpenLayersInteractions] Segundo clique em mobile - abrindo painel"),this.forceHideTooltip(),void this.executeClickHandler(e,a);console.log("[OpenLayersInteractions] Primeiro clique em mobile - mostrando tooltip"),this.clickedFeature=e,this.options.showTooltip&&this.showTooltip(e,a),this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout((()=>{console.log("[OpenLayersInteractions] Timeout mobile - escondendo tooltip e resetando"),this.forceHideTooltip()}),3e3),this.executeHoverHandler(e,a)}applyHover(e,a){this.hoveredFeature=e,this.applyHoverStyle(e),this.options.showTooltip&&!this.isMobile()&&this.showTooltip(e,a),this.executeHoverHandler(e,a)}clearHover(){this.hoveredFeature&&(this.clearHoverStyle(this.hoveredFeature),this.isMobile()||this.hideTooltip(),this.executeHoverOutHandler(this.hoveredFeature),this.hoveredFeature=null)}applyHoverStyle(e){this.options.hoverStyleFunction&&this.options.hoverStyleFunction(e,!0)}clearHoverStyle(e){this.options.hoverStyleFunction&&this.options.hoverStyleFunction(e,!1)}showTooltip(e,a){this.tooltipElement&&this.hideTooltip();const o=this.getTooltipContent(e);console.log("[OpenLayersInteractions] Conte\xfado do tooltip:",o),o?(this.tooltipElement=this.createTooltipElement(o,a),this.map.getTargetElement().appendChild(this.tooltipElement),console.log("[OpenLayersInteractions] Tooltip criado e adicionado ao DOM")):console.log("[OpenLayersInteractions] Sem conte\xfado para tooltip")}hideTooltip(){this.tooltipElement&&(this.tooltipElement.remove(),this.tooltipElement=null,console.log("[OpenLayersInteractions] Tooltip escondido"))}forceHideTooltip(){this.hideTooltip(),this.clickTimeout&&(clearTimeout(this.clickTimeout),this.clickTimeout=null),this.clickedFeature=null,console.log("[OpenLayersInteractions] Tooltip for\xe7adamente escondido e estado resetado")}createTooltipElement(e,a){const o=document.createElement("div");o.className="ol-tooltip";const s=e.includes("Terra Ind\xedgena");if(this.isMobile()){const t='<span class="tooltip-clickable">'.concat(e,"</span>");o.innerHTML=t;const n=s?{backgroundColor:"#fef2f2",borderColor:"rgba(239, 68, 68, 0.3)"}:{backgroundColor:"#bbf7d0",borderColor:"rgba(34, 197, 94, 0.3)"};Object.assign(o.style,(0,N.A)({position:"absolute",padding:"8px 12px",borderRadius:"8px",fontSize:"14px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontWeight:"700",color:"#000000",pointerEvents:"auto",zIndex:"1000",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",border:"2px solid ".concat(n.borderColor),cursor:"default"},n));const r=o.querySelector(".tooltip-clickable");r&&(Object.assign(r.style,{cursor:"pointer",textDecoration:"underline",textDecorationColor:"#3B82F6",textDecorationThickness:"2px",transition:"all 0.2s ease",display:"inline-block",padding:"2px 4px",borderRadius:"4px",fontWeight:"800"}),r.addEventListener("click",(()=>{console.log("[OpenLayersInteractions] Nome clicado no tooltip mobile");const e=this.map.forEachFeatureAtPixel(a.pixel,(e=>e));e&&this.executeClickHandler(e,a)})),r.addEventListener("mouseenter",(()=>{r.style.backgroundColor="rgba(59, 130, 246, 0.1)",r.style.textDecorationColor="#1D4ED8",r.style.transform="scale(1.05)"})),r.addEventListener("mouseleave",(()=>{r.style.backgroundColor="transparent",r.style.textDecorationColor="#3B82F6",r.style.transform="scale(1)"})))}else{o.innerHTML=e;const a=s?{backgroundColor:"#fef2f2"}:{backgroundColor:"#bbf7d0"};Object.assign(o.style,(0,N.A)({position:"absolute",padding:"6px 10px",borderRadius:"6px",fontSize:"12px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontWeight:"700",color:"#000000",pointerEvents:"none",zIndex:"1000",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},a))}const t=a.coordinate,n=this.map.getPixelFromCoordinate(t);return o.style.left=n[0]+10+"px",o.style.top=n[1]-10+"px",o}getTooltipContent(e){if(console.log("[OpenLayersInteractions] Obtendo conte\xfado do tooltip para feature:",{type:e.get("type"),schoolData:e.get("schoolData"),terraIndigenaInfo:e.get("terraIndigenaInfo")}),this.options.tooltipContentFunction){const a=this.options.tooltipContentFunction(e);return console.log("[OpenLayersInteractions] Conte\xfado do tooltip (fun\xe7\xe3o customizada):",a),a}const a=e.get("schoolData");if(a){const e=a.titulo||"Escola Ind\xedgena";return console.log("[OpenLayersInteractions] T\xedtulo extra\xeddo (padr\xe3o):",e),console.log("[OpenLayersInteractions] Conte\xfado do tooltip (padr\xe3o escola - FOR\xc7ADO apenas t\xedtulo):",e),e}const o=e.get("terraIndigenaInfo");if(o){const e="Terra Ind\xedgena ".concat(o.titulo||"Ind\xedgena");return console.log("[OpenLayersInteractions] Conte\xfado do tooltip (padr\xe3o terra ind\xedgena):",e),e}return console.log("[OpenLayersInteractions] Nenhum conte\xfado encontrado para tooltip"),null}executeClickHandler(e,a){const o=this.eventHandlers.get("click");o&&"function"===typeof o&&o(e,a)}executeDoubleClickHandler(e,a){const o=this.eventHandlers.get("doubleClick");o&&"function"===typeof o&&o(e,a)}executeHoverHandler(e,a){const o=this.eventHandlers.get("hover");o&&"function"===typeof o&&o(e,a)}executeHoverOutHandler(e){const a=this.eventHandlers.get("hoverOut");a&&"function"===typeof a&&a(e)}on(e,a){this.eventHandlers.set(e,a)}off(e){this.eventHandlers.delete(e)}clearHandlers(){this.eventHandlers.clear()}updateOptions(e){this.options=(0,N.A)((0,N.A)({},this.options),e),e.enableHover,e.enableClick}destroy(){this.clickTimeout&&clearTimeout(this.clickTimeout),this.hoverTimeout&&clearTimeout(this.hoverTimeout),this.hideTooltip(),this.clearHover(),this.clearHandlers()}}function A(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new C(e,(0,N.A)((0,N.A)({},{enableHover:!0,enableClick:!0,enableDoubleClick:!0,enableTouch:!0,showTooltip:!0,hoverDelay:200,clickDelay:300}),a))}const I={center:[-48.4129,-22.3794],zoom:7.63,maxZoom:18,minZoom:4,mobile:{center:[-48.5935,-21.9212],zoom:5.7},clusterDistance:15,clusterMinDistance:3,clusterAnimationDuration:300,proximityThreshold:5e-5,disableClusteringAtZoom:12,tooltipOffset:10,tooltipDelay:200,interaction:{enableHover:!0,enableClick:!0,enableDoubleClick:!0,enableTouch:!0,clickDelay:300,hoverDelay:200},performance:{enableLazyLoading:!0,maxFeaturesPerTile:1e3,enableFeatureCulling:!0,enableTileCaching:!0},ANIMATION_CONFIG:{duration:{marker:300,cluster:500,zoom:800,pan:600},easing:{marker:"ease-out",cluster:"ease-in-out",zoom:"ease-out",pan:"ease-out"}}},E={small:"#60A5FA",medium:"#3B82F6",large:"#2563EB",xlarge:"#1E40AF"},L={min:11,max:20,size:52},S={min:21,max:50,size:56},_={min:51,max:100,size:64},M="EPSG:4326",P="EPSG:3857",z="EPSG:4674",T={url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:'\xa9 <a href="https://www.esri.com/">Esri</a>',maxZoom:19,wrapX:!1,tilePixelRatio:1,tileSize:256};E.small,L.size,E.medium,S.size,E.large,_.size,E.xlarge;var D=o(579);const F=e=>{let{dataPoints:a=[],onPainelOpen:o,showMarcadores:t=!0,showNomesEscolas:n=!1,map:r,className:l="h-full w-full"}=e;const c=(0,s.useRef)(null),d=(0,s.useRef)(null),[u,b]=s.useState(null),[v,w]=s.useState(null),N=((0,s.useMemo)((()=>k()),[]),(0,s.useCallback)((()=>{r&&(console.log("[OpenLayersMarkers] Inicializando marcadores individuais..."),c.current=new g.A,d.current=new m.A({source:c.current,style:e=>y(e,n),zIndex:100}),r.addLayer(d.current),C())}),[r,n])),C=(0,s.useCallback)((()=>{if(!r||!d.current)return;console.log("[OpenLayersMarkers] Configurando intera\xe7\xf5es com tooltips...");const e=function(e,a,o){console.log("[createMarkerInteractions] Criando intera\xe7\xf5es para marcadores...");const s=A(e,{showTooltip:!0,tooltipContentFunction:e=>{console.log("[createMarkerInteractions] Fun\xe7\xe3o de conte\xfado do tooltip chamada para:",e);const a=e.get("schoolData");if(a){const e=a.titulo||"Escola Ind\xedgena";return console.log("[createMarkerInteractions] T\xedtulo extra\xeddo:",e),console.log("[createMarkerInteractions] Conte\xfado do tooltip gerado (FOR\xc7ADO apenas t\xedtulo):",e),e}return console.log("[createMarkerInteractions] Sem dados de escola para tooltip"),null}});return a&&(console.log("[createMarkerInteractions] Configurando handler de clique personalizado"),s.on("click",a)),o&&s.on("hover",o),console.log("[createMarkerInteractions] Intera\xe7\xf5es criadas com sucesso"),s}(r,I,E);e.on("click",I),e.on("hover",E),e.on("hoverOut",L),console.log("[OpenLayersMarkers] Intera\xe7\xf5es configuradas e integradas com o mapa")}),[r]),I=(0,s.useCallback)(((e,a)=>{const s=e.get("schoolData");s&&o&&(console.log("[OpenLayersMarkers] Marcador clicado:",s.titulo),o(s))}),[o]),E=(0,s.useCallback)(((e,a)=>{b(e),d.current&&(d.current.setStyle((a=>a===e?((e,a)=>{if(!a)return null;const o=new p.Ay({image:new f.A({src:j,scale:1.3,anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction"}),geometry:e.getGeometry()});return Array.isArray(a)?[...a,o]:[a,o]})(a,y(a,n)):y(a,n))),d.current.changed())}),[n]),L=(0,s.useCallback)((()=>{b(null),d.current&&(d.current.setStyle((e=>y(e,n))),d.current.changed())}),[n]),S=(0,s.useCallback)((()=>{if(!c.current||!a)return;if(console.log("[OpenLayersMarkers] Atualizando marcadores...",a.length,"showMarcadores:",t),c.current.clear(),!t)return void console.log("[OpenLayersMarkers] Marcadores desabilitados, removendo todos");const e=a.filter((e=>{if(!e.latitude||!e.longitude)return!1;const a=parseFloat(e.latitude),o=parseFloat(e.longitude);return!isNaN(a)&&!isNaN(o)&&a>=-90&&a<=90&&o>=-180&&o<=180}));console.log("[OpenLayersMarkers] Pontos v\xe1lidos:",e.length),e.forEach(((e,a)=>{if(e.latitude&&e.longitude){const o=new h.A({geometry:new x.A((0,i.Rb)([e.longitude,e.latitude]))});o.set("markerData",e),o.set("schoolData",e),o.set("markerId","marker_".concat(a)),o.set("type","marker"),console.log("[OpenLayersMarkers] Marcador ".concat(a,":"),{titulo:e.titulo,municipio:e.municipio||e.Municipio,uf:e.uf||e.UF}),c.current.addFeature(o)}})),console.log("[OpenLayersMarkers] ".concat(e.length," marcadores individuais adicionados"))}),[a,t]),_=(0,s.useCallback)((()=>{d.current&&(d.current.setStyle((e=>y(e,n))),d.current.changed())}),[n]);return(0,s.useEffect)((()=>(r&&N(),()=>{d.current&&r&&r.removeLayer(d.current)})),[r,N]),(0,s.useEffect)((()=>{S()}),[S]),(0,s.useEffect)((()=>{_()}),[_]),(0,D.jsx)("div",{className:l})};var O=o(3908);const H={terrasIndigenas:{regularizada:{fill:"rgba(220, 20, 60, 0.3)",stroke:"#B22222",hover:{fill:"rgba(220, 20, 60, 0.45)",stroke:"#FF0000"}},declarada:{fill:"rgba(139, 0, 0, 0.25)",stroke:"#B22222",hover:{fill:"rgba(139, 0, 0, 0.4)",stroke:"#FF0000"}}},estadoSP:{fill:"rgba(0, 0, 0, 0.3)",stroke:"#000000",hover:{fill:"rgba(0, 0, 0, 0.4)",stroke:"#333333"}}},R=function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||!e.properties)return new p.Ay({fill:new v.A({color:H.terrasIndigenas.regularizada.fill}),stroke:new w.A({color:H.terrasIndigenas.regularizada.stroke,width:2})});const o="Regularizada"===e.properties.fase_ti?H.terrasIndigenas.regularizada:H.terrasIndigenas.declarada,s=a?o.hover:o;return new p.Ay({fill:new v.A({color:s.fill}),stroke:new w.A({color:s.stroke,width:a?3:2,lineDash:a?[]:[3,3]})})};const W=e=>{let{data:a,onPainelOpen:o,showTerrasIndigenas:t=!0,map:n,className:r="h-full w-full"}=e;const l=(0,s.useRef)(null),i=(0,s.useRef)(null),c=(0,s.useRef)(null),[d,u]=s.useState(null),[h,x]=s.useState(null),[f,b]=s.useState([]),j=(0,s.useMemo)((()=>k()),[]),y=(0,s.useCallback)((()=>{if(n&&a)if(a.features&&Array.isArray(a.features)&&0!==a.features.length)try{const e=new O.A({dataProjection:z||M,featureProjection:P}).readFeatures(a);b(e),l.current=new g.A({features:e}),i.current=new m.A({source:l.current,style:e=>R(e,!1),zIndex:10}),e.forEach((e=>{const a=e.getProperties();e.set("terraIndigenaInfo",{titulo:a.terrai_nom,tipo:"terra_indigena",etnia:a.etnia_nome,municipio:a.municipio_,uf:a.uf_sigla,superficie:a.superficie,fase:a.fase_ti,modalidade:a.modalidade,reestudo:a.reestudo_t,cr:a.cr,faixa_fron:a.faixa_fron,undadm_nom:a.undadm_nom,undadm_sig:a.undadm_sig,dominio_un:a.dominio_un,data_atual:a.data_atual,terrai_cod:a.terrai_cod,undadm_cod:a.undadm_cod})})),n.addLayer(i.current),N(),console.log("[OpenLayersTerrasIndigenas] Camada criada com ".concat(e.length," features"))}catch(e){console.error("[OpenLayersTerrasIndigenas] Erro ao criar camada:",e)}else console.warn("[OpenLayersTerrasIndigenas] Dados inv\xe1lidos ou vazios:",a)}),[n,a]),N=(0,s.useCallback)((()=>{n&&i.current&&(c.current=function(e,a,o){const s=A(e,{showTooltip:!0,tooltipContentFunction:e=>{const a=e.get("terraIndigenaInfo");return a?"Terra Ind\xedgena ".concat(a.titulo||"Ind\xedgena"):null}});return a&&s.on("click",a),o&&s.on("hover",o),s}(n,C,E),c.current.on("click",C),c.current.on("hover",E),c.current.on("hoverOut",L))}),[n]),C=(0,s.useCallback)(((e,a)=>{if(!e)return;const s=e.get("terraIndigenaInfo");if(s)if(j)o&&o(s);else if(h===e)o&&o(s),x(null);else{x(e);const a=e.getGeometry();if(a){const e=a.getExtent();n.getView().fit(e,{duration:I.ANIMATION_CONFIG.duration.zoom,padding:[50,50,50,50],maxZoom:15})}}}),[j,o,h,n]),E=(0,s.useCallback)(((e,a)=>{j||(u(e),i.current&&(i.current.setStyle((a=>R(a,a===e))),i.current.changed()))}),[j]),L=(0,s.useCallback)((e=>{u(null),i.current&&(i.current.setStyle((e=>R(e,!1))),i.current.changed())}),[]),S=(0,s.useCallback)((e=>{i.current&&(i.current.setStyle((a=>{if(a===e){return function(e,a){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{fillColor:s="rgba(59, 130, 246, 0.3)",strokeColor:t="#1E40AF",strokeWidth:n=3,lineDash:r=[5,5]}=o,l=new p.Ay({fill:new v.A({color:s}),stroke:new w.A({color:t,width:n,lineDash:r})});return Array.isArray(a)?[...a,l]:[a,l]}(a,R(a,!1))}return R(a,!1)})),i.current.changed())}),[]),_=(0,s.useCallback)((e=>{i.current&&(i.current.setStyle((e=>R(e,!1))),i.current.changed())}),[]);return(0,s.useEffect)((()=>(n&&a&&t&&y(),()=>{c.current&&c.current.destroy(),i.current&&n&&n.removeLayer(i.current)})),[n,a,t,y]),(0,s.useEffect)((()=>{h?S(h):i.current&&_()}),[h,S,_]),(0,s.useEffect)((()=>{if(h){const e=setTimeout((()=>{x(null)}),I.interaction.clickDelay);return()=>clearTimeout(e)}}),[h]),t&&a?(0,D.jsx)("div",{className:r}):null},B=e=>{let{data:a,showEstadoSP:o=!0,map:t,className:n="h-full w-full"}=e;const r=(0,s.useRef)(null),l=(0,s.useRef)(null),i=(0,s.useCallback)((()=>{if(t&&a)if(a.features&&Array.isArray(a.features)&&0!==a.features.length)try{const e=new O.A({dataProjection:z||M,featureProjection:P}).readFeatures(a);r.current=new g.A({features:e}),l.current=new m.A({source:r.current,style:e=>function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=a?H.estadoSP.hover:H.estadoSP;return new p.Ay({fill:new v.A({color:o.fill}),stroke:new w.A({color:o.stroke,width:a?2:1})})}(e,!1),zIndex:5,interactive:!1}),t.addLayer(l.current),console.log("[OpenLayersEstadoSP] Camada criada com ".concat(e.length," features"))}catch(e){console.error("[OpenLayersEstadoSP] Erro ao criar camada:",e)}else console.warn("[OpenLayersEstadoSP] Dados inv\xe1lidos ou vazios:",a)}),[t,a]);return(0,s.useEffect)((()=>(t&&a&&o&&i(),()=>{l.current&&t&&t.removeLayer(l.current)})),[t,a,o,i]),o&&a?(0,D.jsx)("div",{className:n}):null},U=e=>{let{terrasIndigenasData:a,estadoSPData:o,showTerrasIndigenas:t=!0,showEstadoSP:n=!0,onPainelOpen:r,map:l,className:i="h-full w-full"}=e;const c=(0,s.useRef)(null),d=(0,s.useRef)(null),[u,m]=s.useState({terrasIndigenas:{visible:t,loaded:!1,error:null},estadoSP:{visible:n,loaded:!1,error:null}}),g=(0,s.useMemo)((()=>({terrasIndigenas:a&&a.features&&a.features.length>0,estadoSP:o&&o.features&&o.features.length>0})),[a,o]),h=(0,s.useCallback)(((e,a)=>{m((o=>(0,N.A)((0,N.A)({},o),{},{[e]:(0,N.A)((0,N.A)({},o[e]),a)})))}),[]),x=((0,s.useCallback)(((e,a)=>{h(e,{visible:a})}),[h]),(0,s.useCallback)(((e,a)=>{console.error("[OpenLayersLayers] Erro na camada ".concat(e,":"),a),h(e,{error:a.message})}),[h])),p=(0,s.useCallback)((e=>{h(e,{loaded:!0,error:null})}),[h]),f=(0,s.useCallback)((()=>{const e={total:0,visible:0,loaded:0,errors:0};return Object.values(u).forEach((a=>{e.total++,a.visible&&e.visible++,a.loaded&&e.loaded++,a.error&&e.errors++})),e}),[u]),b=(0,s.useCallback)((()=>({terrasIndigenas:(0,N.A)((0,N.A)({},u.terrasIndigenas),{},{hasData:g.terrasIndigenas,featureCount:g.terrasIndigenas?a.features.length:0}),estadoSP:(0,N.A)((0,N.A)({},u.estadoSP),{},{hasData:g.estadoSP,featureCount:g.estadoSP?o.features.length:0})})),[u,g,a,o]);return(0,s.useEffect)((()=>{const e=f(),a=b();console.log("[OpenLayersLayers] Status das camadas:",{stats:e,info:a,hasValidData:g})}),[u,f,b,g]),(0,s.useEffect)((()=>{m((e=>({terrasIndigenas:(0,N.A)((0,N.A)({},e.terrasIndigenas),{},{visible:t}),estadoSP:(0,N.A)((0,N.A)({},e.estadoSP),{},{visible:n})})))}),[t,n]),g.terrasIndigenas||g.estadoSP?(0,D.jsxs)("div",{className:i,children:[g.terrasIndigenas&&(0,D.jsx)(W,{ref:c,data:a,onPainelOpen:r,showTerrasIndigenas:t,map:l,onLoad:()=>p("terrasIndigenas"),onError:e=>x("terrasIndigenas",e)}),g.estadoSP&&(0,D.jsx)(B,{ref:d,data:o,showEstadoSP:n,map:l,onLoad:()=>p("estadoSP"),onError:e=>x("estadoSP",e)})]}):(0,D.jsx)("div",{className:i,children:(0,D.jsx)("div",{className:"text-center text-gray-500 p-4",children:"Nenhuma camada GeoJSON dispon\xedvel"})})},V=s.forwardRef(((e,a)=>(0,D.jsx)("div",(0,N.A)({id:"map",className:"w-full h-full",ref:a},e))));u.A.defs("EPSG:4674","+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs"),(0,d.kz)(u.A);const G=e=>{let{dataPoints:a=[],onPainelOpen:o,center:d=I.center,zoom:u=I.zoom,className:m="h-screen w-full",terrasIndigenasData:g=null,estadoSPData:h=null,showTerrasIndigenas:x=!0,showEstadoSP:p=!0,showMarcadores:f=!0,showNomesEscolas:b=!1}=e;const v=(0,s.useRef)(null),w=(0,s.useRef)(null),j=(0,s.useRef)(null),[y,N]=(0,s.useState)({lng:d[0],lat:d[1],zoom:u}),C=(0,s.useMemo)((()=>k()),[]),A=C?I.mobile.center:d,E=C?I.mobile.zoom:u,L=(0,s.useCallback)((()=>({satelliteLayer:new r.A({source:new l.A({url:T.url,attributions:T.attributions,maxZoom:T.maxZoom,wrapX:T.wrapX,tilePixelRatio:T.tilePixelRatio,tileSize:T.tileSize}),preload:1,useInterimTilesOnError:!1})})),[]),S=(0,s.useCallback)((()=>{if(w.current)return;const{satelliteLayer:e}=L();j.current=e,w.current=new t.A({target:v.current,layers:[j.current],view:new n.Ay({center:(0,i.Rb)(A),zoom:E,maxZoom:I.maxZoom,minZoom:I.minZoom,enableRotation:!1}),controls:(0,c.N)()}),w.current.on("moveend",(()=>{const e=w.current.getView(),a=(0,i.WP)(e.getCenter()),o={lng:a[0].toFixed(4),lat:a[1].toFixed(4),zoom:e.getZoom().toFixed(2)};N(o)})),console.log("[OpenLayersMap] Mapa inicializado com sucesso")}),[A,E,L]),_=(0,s.useCallback)((()=>{if(!w.current)return;const e=k(),a=e?I.mobile.center:d,o=e?I.mobile.zoom:u,s=w.current.getView(),t=(0,i.WP)(s.getCenter()),n=s.getZoom();t[0]===a[0]&&t[1]===a[1]&&n===o||(s.setCenter((0,i.Rb)(a)),s.setZoom(o))}),[d,u]);return(0,s.useEffect)((()=>(S(),()=>{w.current&&(w.current.setTarget(void 0),w.current=null)})),[S]),(0,s.useEffect)((()=>{_()}),[_]),(0,D.jsx)(V,{ref:v,children:w.current&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(F,{dataPoints:a,onPainelOpen:o,showMarcadores:f,showNomesEscolas:b,map:w.current}),(0,D.jsx)(U,{terrasIndigenasData:g,estadoSPData:h,showTerrasIndigenas:x,showEstadoSP:p,onPainelOpen:o,map:w.current})]})})},q={},Z=e=>{const[a,o]=(0,s.useState)(null),[t,n]=(0,s.useState)(!1),[r,l]=(0,s.useState)(null);return(0,s.useEffect)((()=>{if(!e)return;(async()=>{if(q[e])return console.log("useGeoJSONCache: Dados de ".concat(e," encontrados no cache")),void o(q[e]);n(!0);try{var a,s;const t="".concat("/escolasindigenas","/").concat(e,".geojson");console.log("useGeoJSONCache: Carregando ".concat(e," de:"),t);const n=await fetch(t);if(!n.ok)throw new Error("Erro ao buscar GeoJSON (".concat(n.status,")"));const r=await n.json();console.log("useGeoJSONCache: ".concat(e," carregado com sucesso:"),{type:r.type,features:(null===(a=r.features)||void 0===a?void 0:a.length)||0,crs:r.crs,firstFeature:null!==(s=r.features)&&void 0!==s&&s[0]?{type:r.features[0].type,properties:r.features[0].properties?Object.keys(r.features[0].properties):"Sem propriedades",geometry:r.features[0].geometry?{type:r.features[0].geometry.type,coordinates:r.features[0].geometry.coordinates?"".concat(r.features[0].geometry.coordinates.length," arrays"):"Sem coordenadas"}:"Sem geometria"}:"Nenhum feature"}),q[e]=r,o(r)}catch(t){console.error("useGeoJSONCache: Erro ao carregar ".concat(e,":"),t),l(t)}finally{n(!1)}})()}),[e]),{data:a,loading:t,error:r}},K=e=>{let{dataPoints:a,onPainelOpen:o,painelAberto:t=!1,className:n="h-screen w-full"}=e;const{data:r,loading:l,error:i}=Z("terras_indigenas"),{data:c,loading:d,error:u}=Z("SP"),[m,g]=(0,s.useState)(!0),[h,x]=(0,s.useState)(!0),[p,f]=(0,s.useState)(!0),[b,v]=(0,s.useState)(!1),[w,j]=(0,s.useState)(!1),y=(0,s.useCallback)((()=>{v(window.innerWidth<=768)}),[]);(0,s.useEffect)((()=>(y(),window.addEventListener("resize",y),()=>{window.removeEventListener("resize",y)})),[y]);const N=(0,s.useCallback)((()=>j((e=>!e))),[]);(0,s.useEffect)((()=>{var e,a,o,s;console.log("MapSelector: Status das camadas GeoJSON:",{terrasIndigenas:{loading:l,error:i,hasData:!!r,features:(null===r||void 0===r||null===(e=r.features)||void 0===e?void 0:e.length)||0,type:null===r||void 0===r?void 0:r.type,firstFeature:null!==r&&void 0!==r&&null!==(a=r.features)&&void 0!==a&&a[0]?{type:r.features[0].type,properties:r.features[0].properties?Object.keys(r.features[0].properties):"Sem propriedades"}:"Nenhum feature"},estadoSP:{loading:d,error:u,hasData:!!c,features:(null===c||void 0===c||null===(o=c.features)||void 0===o?void 0:o.length)||0,type:null===c||void 0===c?void 0:c.type,firstFeature:null!==c&&void 0!==c&&null!==(s=c.features)&&void 0!==s&&s[0]?{type:c.features[0].type,properties:c.features[0].properties?Object.keys(c.features[0].properties):"Sem propriedades"}:"Nenhum feature"}})}),[r,c,l,d,i,u]),(0,s.useEffect)((()=>{console.log("MapSelector: useEffect painelAberto mudou:",{painelAberto:t,isMobile:b,showMarcadores:p,shouldReactivate:!t&&b}),!t&&b&&(console.log("MapSelector: Painel fechado em mobile, reativando marcadores"),f(!0))}),[t,b]),(0,s.useEffect)((()=>{console.log("MapSelector: showMarcadores mudou para:",p)}),[p]);const k=e=>{let{onMinimize:a,isMobile:o,isMinimized:s}=e;return(0,D.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-green-700 to-green-800 text-white",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"})}),(0,D.jsx)("h3",{className:"text-sm font-semibold tracking-wide",children:"Camadas do Mapa"})]}),(0,D.jsx)("button",{onClick:a,className:"text-green-100 hover:text-white hover:bg-green-600 transition-all duration-200 p-1.5 rounded-md","aria-label":s?"Expandir":"Minimizar",type:"button",children:s?(0,D.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):(0,D.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})})]})},C=e=>{let{id:a,label:o,checked:s,onChange:t,disabled:n=!1,loading:r=!1,error:l=!1,total:i,color:c,subItems:d=null}=e;return(0,D.jsxs)("button",{type:"button",onClick:t,disabled:n,className:"group w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 ".concat(s?"bg-green-50 shadow-sm":"bg-white hover:bg-green-50/50"," ").concat(n?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:[(0,D.jsx)("div",{className:"flex-shrink-0",children:d?(0,D.jsx)("div",{className:"flex flex-col gap-1.5",children:d.map(((e,a)=>(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:e.color}}),(0,D.jsx)("span",{className:"text-xs font-medium text-gray-700",children:e.label})]},a)))}):(0,D.jsx)("div",{className:"w-4 h-4 rounded-full shadow-sm ".concat(s?"ring-2 ring-green-200":""),style:{backgroundColor:c}})}),(0,D.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("span",{className:"text-sm font-medium ".concat(s?"text-green-900":"text-gray-800"),children:o}),void 0!==i&&(0,D.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(s?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"),children:i})]}),(0,D.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[r&&(0,D.jsxs)("div",{className:"flex items-center gap-1 text-blue-600",children:[(0,D.jsxs)("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,D.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,D.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,D.jsx)("span",{className:"text-xs",children:"Carregando..."})]}),l&&(0,D.jsxs)("div",{className:"flex items-center gap-1 text-red-600",children:[(0,D.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,D.jsx)("span",{className:"text-xs",children:"Erro"})]})]})]}),(0,D.jsx)("div",{className:"flex-shrink-0",children:(0,D.jsx)("div",{className:"w-3 h-3 rounded-full transition-colors duration-200 ".concat(s?"bg-green-600":"bg-gray-300")})})]})},A=b?I.mobile.center:I.center,E=b?I.mobile.zoom:I.zoom;return console.log("MapSelector - Debug zoom:",{isMobile:b,mobileZoom:I.mobile.zoom,desktopZoom:I.zoom,selectedZoom:E,mobileCenter:I.mobile.center,desktopCenter:I.center,selectedCenter:A}),(0,D.jsxs)("div",{className:n,style:{position:"relative"},children:[b?(0,D.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-20",children:(0,D.jsxs)("div",{className:"bg-white shadow-2xl rounded-t-2xl",children:[(0,D.jsx)(k,{onMinimize:N,isMobile:!0,isMinimized:w}),!w&&(0,D.jsxs)("div",{className:"p-4 flex flex-col gap-3 max-h-80 overflow-y-auto",children:[(0,D.jsx)(C,{id:"estado-sp",label:"Estado de S\xe3o Paulo",checked:h,onChange:()=>x(!h),loading:d,error:u,color:"#10B981"}),(0,D.jsx)(C,{id:"marcadores",label:"Escolas Ind\xedgenas",checked:p,onChange:()=>f(!p),total:null===a||void 0===a?void 0:a.length,color:"#3B82F6"}),(0,D.jsx)(C,{id:"terras-indigenas",label:"Terras Ind\xedgenas",checked:m,onChange:()=>g(!m),loading:l,error:i,subItems:[{label:"Regularizadas",color:"#DC143C"},{label:"Declaradas",color:"#8B0000"}]})]})]})}):(0,D.jsxs)("div",{className:"fixed top-24 right-4 w-72 bg-white rounded-2xl shadow-2xl z-20 overflow-hidden",children:[(0,D.jsx)(k,{onMinimize:N,isMobile:!1,isMinimized:w}),!w&&(0,D.jsxs)("div",{className:"p-4 flex flex-col gap-3 max-h-96 overflow-y-auto",children:[(0,D.jsx)(C,{id:"estado-sp",label:"Estado de S\xe3o Paulo",checked:h,onChange:()=>x(!h),loading:d,error:u,color:"#10B981"}),(0,D.jsx)(C,{id:"marcadores",label:"Escolas Ind\xedgenas",checked:p,onChange:()=>f(!p),total:null===a||void 0===a?void 0:a.length,color:"#3B82F6"}),(0,D.jsx)(C,{id:"terras-indigenas",label:"Terras Ind\xedgenas",checked:m,onChange:()=>g(!m),loading:l,error:i,subItems:[{label:"Regularizadas",color:"#DC143C"},{label:"Declaradas",color:"#8B0000"}]})]})]}),(0,D.jsx)(G,{dataPoints:p?a:[],onPainelOpen:o,className:"h-full w-full",center:A,zoom:E,terrasIndigenasData:r,estadoSPData:c,showTerrasIndigenas:m,showEstadoSP:h,showMarcadores:p})]})},J=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").trim();var X=o(2880);const Y=e=>{const[a,o]=(0,s.useState)([]),[t,n]=(0,s.useState)(!0),[r,l]=(0,s.useState)(null);return(0,s.useEffect)((()=>{(async()=>{if(console.log("\ud83d\udd04 Iniciando busca de documentos para escola:",e,"tipo:",typeof e),!e)return console.log("\u26a0\ufe0f Nenhum ID de escola fornecido, retornando array vazio"),o([]),void n(!1);try{n(!0),console.log("\ud83d\udce1 Consultando tabela documentos_escola...");const{data:a,error:s}=await X.N.auth.getSession();console.log("\ud83d\udd10 Estado da autentica\xe7\xe3o:",{temSessao:!(null===a||void 0===a||!a.session),error:s});const{data:t,error:r}=await X.N.from("documentos_escola").select("count").limit(1);console.log("\ud83d\udd11 Verifica\xe7\xe3o de permiss\xf5es:",{podeAcessar:!r,error:r?{code:r.code,message:r.message,details:r.details,hint:r.hint}:null});const{data:l,error:i}=await X.N.from("documentos_escola").select("*");i?console.error("\u274c Erro ao buscar todos os documentos:",{code:i.code,message:i.message,details:i.details,hint:i.hint}):(console.log("\ud83d\udcca Todos os documentos na tabela:",l),l&&l.length>0?(console.log("\ud83d\udcca Exemplo de documento:",l[0]),console.log("\ud83d\udcca Tipos de escola_id encontrados:",l.map((e=>({id:e.id,escola_id:e.escola_id,tipo_escola_id:typeof e.escola_id,valor_escola_id:e.escola_id}))))):console.log("\u26a0\ufe0f Tabela est\xe1 vazia ou n\xe3o temos permiss\xe3o para ver os dados")),console.log("\ud83d\udd0d Buscando documentos para escola_id:",e);const{data:c,error:d}=await X.N.from("documentos_escola").select("*").eq("escola_id",e.toString()).order("created_at",{ascending:!1});if(d)throw console.error("\u274c Erro na consulta Supabase:",{code:d.code,message:d.message,details:d.details,hint:d.hint}),d;if(console.log("\u2705 Documentos encontrados:",(null===c||void 0===c?void 0:c.length)||0),0===(null===c||void 0===c?void 0:c.length)){console.log("\u2139\ufe0f Nenhum documento encontrado para a escola ID:",e),console.log("\u2139\ufe0f Tentando buscar com diferentes formatos de escola_id...");const{data:a,error:o}=await X.N.from("documentos_escola").select("*").eq("escola_id",Number(e)),{data:s,error:t}=await X.N.from("documentos_escola").select("*").eq("escola_id",String(e));console.log("Resultados com escola_id como n\xfamero:",{count:(null===a||void 0===a?void 0:a.length)||0,error:o}),console.log("Resultados com escola_id como string:",{count:(null===s||void 0===s?void 0:s.length)||0,error:t})}else console.log("\ud83d\udcc4 Dados dos documentos:",c);o(c||[])}catch(s){console.error("\u274c Erro ao buscar documentos:",s),l(s.message)}finally{n(!1),console.log("\ud83c\udfc1 Estado final:",{documentos:a.length,isLoading:t,error:r||"nenhum"})}})()}),[e]),{documentos:a,isLoading:t,error:r}};var $=o(193),Q=o(7669),ee=o(1209),ae=o(4387),oe=o(9816),se=o(225),te=o(9769),ne=o(6863),re=o(6093),le=o(4183);const ie=(0,s.memo)((e=>{let{children:a,columns:o="auto-fit",gap:s=4,className:t=""}=e;return(0,D.jsx)("div",{className:"grid ".concat({"auto-fit":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",2:"grid-cols-1 sm:grid-cols-2",3:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4"}[o]," gap-").concat(s," ").concat(t," [&>*]:bg-green-100"),children:a})})),ce=(0,s.memo)((e=>{let{data:a,className:o=""}=e;return a&&0!==a.length?(0,D.jsx)("div",{className:"bg-green-100 rounded-lg overflow-hidden ".concat(o),children:(0,D.jsx)("table",{className:"w-full",children:(0,D.jsx)("tbody",{children:a.map(((e,a)=>(0,D.jsxs)("tr",{className:a%2===0?"bg-white":"bg-green-50",children:[(0,D.jsx)("td",{className:"px-4 py-3 text-sm font-medium text-gray-700 border-r border-green-200",children:e.label}),(0,D.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.value})]},a)))})})}):null})),de=(0,s.memo)((e=>{let{stats:a,className:o=""}=e;return a&&0!==a.length?(0,D.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 ".concat(o," [&>*]:border-b [&>*]:border-gray-200 [&>*]:pb-2 [&>*]:mb-2"),children:a.map(((e,a)=>(0,D.jsxs)("div",{className:"text-center rounded-lg p-4",children:[(0,D.jsx)("div",{className:"flex justify-center mb-2",children:e.icon&&(0,D.jsx)(e.icon,{className:"w-6 h-6 text-green-600"})}),(0,D.jsx)("div",{className:"text-2xl font-bold text-green-800",children:e.value}),(0,D.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:e.label})]},a)))}):null})),ue=(0,s.memo)((e=>{let{title:a,icon:o,children:t,description:n,defaultCollapsed:r=!1,className:l="",layout:i="default",layoutProps:c={}}=e;const[d,u]=(0,s.useState)(r);return(0,D.jsxs)("section",{className:"\n        bg-white rounded-2xl p-5 \n        shadow-sm transition-all duration-200\n        ".concat(l,"\n      "),children:[(0,D.jsx)("button",{onClick:()=>u(!d),className:" w-full flex items-center justify-between  text-base font-semibold mb-4 text-gray-900 hover:text-gray-800  transition-colors focus:outline-none ","aria-expanded":!d,"aria-controls":"".concat(a,"-content"),children:(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[o&&(0,D.jsx)(o,{className:"w-5 h-5 text-green-600"}),(0,D.jsx)("span",{className:"tracking-wide",children:a})]})}),!d&&(0,D.jsxs)("div",{id:"".concat(a,"-content"),className:"space-y-4",role:"region","aria-labelledby":"".concat(a,"-button"),children:[n&&(0,D.jsx)("div",{className:"bg-green-100 rounded-lg p-4",children:(0,D.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed",children:n})}),(()=>{if(!t)return null;switch(i){case"grid":return(0,D.jsx)(ie,(0,N.A)((0,N.A)({},c),{},{children:t}));case"table":return(0,D.jsx)(ce,{data:c.data,className:c.className});case"stats":return(0,D.jsx)(de,{stats:c.stats,className:c.className});default:return(0,D.jsx)("div",{className:"space-y-4",children:t})}})()]})]})})),me=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():"",ge=e=>{let{icon:a,label:o,value:s,type:t="text"}=e;return(0,D.jsxs)("div",{className:"p-1 rounded-md transition-all",children:[(0,D.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,D.jsx)(a,{className:"w-5 h-5 text-gray-600"}),(0,D.jsx)("span",{className:"text-xs text-gray-500 font-medium",children:o})]}),"boolean"===t?s?(0,D.jsxs)("span",{className:"flex items-center gap-1 text-green-600 text-sm",children:[(0,D.jsx)($.A,{className:"w-5 h-5"}),"Sim"]}):(0,D.jsxs)("span",{className:"flex items-center gap-1 text-red-500 text-sm",children:[(0,D.jsx)(Q.A,{className:"w-5 h-5"}),"N\xe3o"]}):(0,D.jsx)("span",{className:"text-sm text-gray-800 truncate",children:s})]})},he=e=>{let{icon:a,label:o,value:s}=e;return(0,D.jsxs)("div",{className:"flex items-center gap-2 bg-green-100 p-1.5 rounded-md text-xs",children:[(0,D.jsx)(a,{className:"w-5 h-5 text-green-600"}),(0,D.jsxs)("span",{className:"text-gray-700 font-medium",children:[o,":"]}),(0,D.jsx)("span",{className:"font-semibold text-green-800",children:me(s)})]})},xe=e=>{let{escola:a}=e;if(!(a.logradouro||a.numero||a.bairro||a.cep))return(0,D.jsx)("div",{className:"mt-2 p-2 bg-green-100 rounded-md",children:(0,D.jsx)("p",{className:"text-xs text-gray-700 leading-snug",children:me(a.endereco)})});return(0,D.jsxs)("div",{className:"mt-2 space-y-1",children:[[{field:"logradouro",label:"Logradouro"},{field:"numero",label:"N\xfamero"},{field:"complemento",label:"Complemento"},{field:"bairro",label:"Bairro"}].map((e=>{let{field:o,label:s}=e;return a[o]&&(0,D.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 rounded-md",children:[(0,D.jsx)(ee.A,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-0.5",children:s}),(0,D.jsx)("div",{className:"text-xs text-gray-800 leading-snug",children:a[o]})]})]},o)})),(a.cep||a.estado)&&(0,D.jsxs)("div",{className:"flex items-start gap-2 p-1.5 bg-green-100 rounded-md",children:[(0,D.jsx)(ee.A,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-0.5",children:"Localiza\xe7\xe3o"}),(0,D.jsx)("div",{className:"text-xs text-gray-800 leading-snug",children:[a.municipio,a.estado,a.cep].filter(Boolean).join(", ")})]})]})]})},pe=e=>{let{escola:a}=e;if(!(a.Latitude&&a.Longitude))return null;return(0,D.jsxs)("button",{onClick:()=>{window.open("https://www.google.com/maps?q=".concat(a.Latitude,",").concat(a.Longitude),"_blank")},className:"mt-2 w-full flex items-center justify-center gap-2 p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors text-xs font-medium",children:[(0,D.jsx)(ae.A,{className:"w-5 h-5"}),"Ver no Google Maps"]})},fe=e=>{let{links:a,expanded:o,onToggle:s}=e;const t=(a||"").split(",").map((e=>e.trim())).filter(Boolean);return 0===t.length?null:(0,D.jsxs)("div",{className:"bg-green-100 rounded-md",children:[(0,D.jsxs)("button",{onClick:()=>s("social"),className:"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs","aria-expanded":o.social,children:[(0,D.jsxs)("span",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,D.jsx)(oe.A,{className:"w-5 h-5 text-blue-600"}),"Redes sociais (",t.length,")"]}),(0,D.jsx)(se.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(o.social?"rotate-90":"")})]}),o.social&&(0,D.jsx)("div",{className:"px-2 pb-2 border-t border-green-200 bg-white",children:(0,D.jsx)("div",{className:"mt-1 space-y-1",children:t.map(((e,a)=>(0,D.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 p-1.5 bg-green-100 rounded-md hover:bg-green-200 group text-xs",children:[(0,D.jsx)(te.A,{className:"w-5 h-5 text-blue-600"}),(0,D.jsx)("span",{className:"truncate flex-1 text-gray-700",children:e}),(0,D.jsx)(ne.A,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600"})]},a)))})})]})},be=(0,s.memo)((e=>{let{escola:a}=e;const[o,t]=(0,s.useState)({});if(!a)return null;const n=e=>{t((a=>(0,N.A)((0,N.A)({},a),{},{[e]:!a[e]})))},r=[{icon:re.A,label:"Munic\xedpio",value:me(a.municipio)},{icon:le.A,label:"Funda\xe7\xe3o",value:a.ano_criacao},{icon:oe.A,label:"Redes sociais",value:a.usa_redes_sociais,type:"boolean"}].filter((e=>e.value));return(0,D.jsxs)(D.Fragment,{children:[a.povos_indigenas&&(0,D.jsx)("div",{className:"mb-4",children:(0,D.jsxs)("div",{className:"text-lg sm:text-xl font-bold text-green-800",children:["Povos Ind\xedgenas: ",(0,D.jsx)("span",{className:"font-semibold text-black",children:a.povos_indigenas})]})}),(0,D.jsxs)(ue,{title:"Localiza\xe7\xe3o",icon:ee.A,children:[(0,D.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mb-3 [&>*]:bg-green-100",children:r.map(((e,a)=>(0,D.jsx)(ge,(0,N.A)({},e),a)))}),(0,D.jsxs)("div",{className:"space-y-1.5",children:[a.diretoria_ensino&&(0,D.jsx)(he,{icon:re.A,label:"Diretoria de ensino",value:a.diretoria_ensino}),a.endereco&&(0,D.jsxs)("div",{className:"bg-green-100 rounded-md",children:[(0,D.jsxs)("button",{onClick:()=>n("endereco"),className:"w-full flex justify-between items-center p-1.5 hover:bg-green-200 text-xs","aria-expanded":o.endereco,children:[(0,D.jsxs)("span",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,D.jsx)(re.A,{className:"w-5 h-5"}),"Endere\xe7o"]}),(0,D.jsx)(se.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(o.endereco?"rotate-90":"")})]}),o.endereco&&(0,D.jsxs)("div",{className:"px-2 pb-2 border-t border-green-200 bg-white",children:[(0,D.jsx)(xe,{escola:a}),(0,D.jsx)(pe,{escola:a})]})]}),(0,D.jsx)(fe,{links:a.links_redes_sociais,expanded:o,onToggle:n})]})]})]})}));var ve=o(5349),we=o(237);const je=e=>{let{escola_id:a,refreshKey:o=0}=e;const[t,n]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(""),m=(0,s.useRef)({}),[g,h]=(0,s.useState)(0);(0,s.useEffect)((()=>{o>0&&(console.log("ImagensdasEscolas: refreshKey mudou, for\xe7ando recarga"),p())}),[o]);const x=(0,s.useCallback)((()=>{c(null),document.body.style.overflow="auto"}),[]);(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&x()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[x]);const p=(0,s.useCallback)((()=>{console.log("Limpando cache e recarregando imagens..."),m.current={},h((e=>e+1)),n([]),l(!0),u("")}),[]);return(0,s.useEffect)((()=>{if(!a)return void l(!1);const e="".concat(a,"_v").concat(g);if(m.current[e])return console.log("Usando cache para escola",a),n(m.current[e]),void l(!1);(async()=>{console.log("Buscando imagens para escola",a);try{const{data:o,error:s}=await X.N.storage.from("imagens-das-escolas").list("".concat(a,"/"));if(s)throw s;if(!o||0===o.length)return console.log("Nenhum arquivo encontrado para escola",a),n([]),void l(!1);console.log("Arquivos encontrados:",o.length);const t=await Promise.all(o.map((async(e,o)=>{var t,n,r,l,i;const c="".concat(a,"/").concat(e.name),{data:{publicUrl:d}}=X.N.storage.from("imagens-das-escolas").getPublicUrl(c);let u=null;try{console.log("Buscando legenda para:",c),u=await(0,we.qP)(c,a,"escola"),console.log("Legenda encontrada:",u)}catch(s){console.warn("Erro ao buscar legenda para",c,":",s)}return{id:"".concat(a,"-").concat(e.name),publicURL:d,descricao:(null===(t=u)||void 0===t?void 0:t.legenda)||"Imagem ".concat(o+1),descricaoDetalhada:null===(n=u)||void 0===n?void 0:n.descricao_detalhada,autor:null===(r=u)||void 0===r?void 0:r.autor_foto,dataFoto:null===(l=u)||void 0===l?void 0:l.data_foto,categoria:null===(i=u)||void 0===i?void 0:i.categoria,urlError:null}})));console.log("Imagens processadas:",t.length),m.current[e]=t,n(t),0===t.length&&u("Nenhuma imagem encontrada para esta escola.")}catch(d){console.error("Erro ao processar imagens:",d),u("Erro ao carregar imagens da escola.")}finally{l(!1)}})()}),[a,g]),r?(0,D.jsxs)("div",{className:"text-gray-500 flex items-center gap-2",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Carregando imagens da escola..."]}):d?(0,D.jsxs)("div",{className:"text-red-600 flex items-center gap-2",children:[(0,D.jsx)("span",{children:d}),(0,D.jsx)("button",{onClick:p,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:(0,D.jsx)(ve.A,{className:"w-5 h-5"})})]}):t.length?(0,D.jsxs)("section",{className:"my-6",children:[(0,D.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:t.map((e=>(0,D.jsxs)("figure",{className:"rounded-lg overflow-hidden border bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md",onClick:()=>e.publicURL&&c(e),children:[(0,D.jsx)("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:(0,D.jsx)("img",{src:e.publicURL,alt:e.descricao,className:"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105",loading:"lazy",style:{maxHeight:"350px"}})}),e.descricao&&(0,D.jsxs)("figcaption",{className:"p-3 bg-white",children:[(0,D.jsx)("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:e.descricao}),(0,D.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.categoria&&(0,D.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:e.categoria}),e.autor&&(0,D.jsxs)("span",{children:["Por: ",e.autor]}),e.dataFoto&&(0,D.jsx)("span",{children:new Date(e.dataFoto).toLocaleDateString("pt-BR")})]}),e.descricaoDetalhada&&(0,D.jsx)("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:e.descricaoDetalhada})]})]},e.id)))}),i&&(0,D.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4 cursor-zoom-out",onClick:x,children:[(0,D.jsx)("button",{onClick:x,className:"absolute top-4 right-4 text-white hover:text-red-400 transition","aria-label":"Fechar",children:(0,D.jsx)(Q.A,{size:32})}),(0,D.jsxs)("div",{className:"max-w-4xl max-h-full",children:[(0,D.jsx)("img",{src:i.publicURL,alt:i.descricao,className:"max-w-full max-h-full rounded-lg shadow-2xl border-4 border-white",onClick:e=>e.stopPropagation()}),i.descricao&&(0,D.jsxs)("div",{className:"mt-4 bg-white rounded-lg p-4 shadow-lg",children:[(0,D.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:i.descricao}),(0,D.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[i.categoria&&(0,D.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:i.categoria}),i.autor&&(0,D.jsxs)("span",{children:["Fot\xf3grafo: ",i.autor]}),i.dataFoto&&(0,D.jsxs)("span",{children:["Data: ",new Date(i.dataFoto).toLocaleDateString("pt-BR")]})]}),i.descricaoDetalhada&&(0,D.jsx)("p",{className:"text-gray-700 leading-relaxed",children:i.descricaoDetalhada})]})]})]})]}):(0,D.jsxs)("div",{className:"text-yellow-700 flex items-center gap-2",children:[(0,D.jsx)("span",{children:"Nenhuma imagem encontrada para esta escola."}),(0,D.jsx)("button",{onClick:p,className:"text-blue-600 hover:text-blue-800",title:"Tentar novamente",children:(0,D.jsx)(ve.A,{className:"w-5 h-5"})})]})},ye=s.memo(je),Ne=(0,s.memo)((e=>{let{escola:a,refreshKey:o=0}=e;return null!==a&&void 0!==a&&a.historia_da_escola?(0,D.jsxs)("article",{className:"\n        mt-8 mb-12\n        max-w-4xl mx-auto\n        prose\n        prose-sm sm:prose-base md:prose-lg lg:prose-xl\n        prose-headings:text-green-900\n        prose-p:text-green-800\n        prose-p:leading-relaxed\n        prose-p:text-justify\n        prose-img:rounded-xl\n        prose-img:shadow-lg\n        prose-a:text-green-700\n        prose-a:no-underline\n        prose-a:border-b-2\n        prose-a:border-green-100\n        prose-a:transition-colors\n        hover:prose-a:border-green-600\n        bg-white\n        rounded-2xl\n        px-4 sm:px-6 md:px-8 py-6\n        shadow-lg\n      ",children:[(0,D.jsxs)("header",{className:"mb-6 sm:mb-8",children:[(0,D.jsxs)("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[(0,D.jsx)("span",{className:"bg-green-300 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:(0,D.jsx)("img",{src:"".concat("/escolasindigenas","/onca.svg"),alt:"\xcdcone de on\xe7a",className:"w-32 h-32 sm:w-36 sm:h-36",style:{filter:"none",borderRadius:"0",boxShadow:"none",marginTop:"80px"},"aria-hidden":"true"})}),(0,D.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-900 m-0",children:"Hist\xf3ria da Escola"})]}),(0,D.jsx)("div",{className:"h-1 w-20 sm:w-24 bg-green-300 rounded-full"})]}),(0,D.jsx)("div",{className:"text-base sm:text-lg leading-relaxed text-neutral-800",children:a.historia_da_escola}),(0,D.jsx)(ye,{escola_id:a.id,refreshKey:o})]}):null}));var ke=o(8242),Ce=o(6735),Ae=o(2065),Ie=o(3531),Ee=o(197);const Le=(0,s.memo)((e=>{let{value:a}=e;return void 0===a||null===a?null:(0,D.jsx)("span",{className:"font-medium ".concat(a?"text-green-600":"text-neutral-400"),children:a?"Sim":"N\xe3o"})}));const Se=e=>{let{items:a,maxVisible:o=3}=e;return a&&0!==a.length?(0,D.jsx)("div",{className:"-mt-1",children:(0,D.jsx)("ul",{className:"list-none text-gray-800 text-xs pl-0 ml-0",children:a.map(((e,a)=>(0,D.jsxs)("li",{className:"leading-tight m-0 p-0 pl-0 ml-0 flex items-start",children:[(0,D.jsx)("span",{className:"mr-1 text-green-700 select-none",style:{minWidth:"1em",display:"inline-block"},children:"\u2022"}),(0,D.jsx)("span",{children:e})]},a)))})}):null},_e=e=>{let{icon:a,label:o,value:s}=e;return(0,D.jsxs)("div",{className:"flex items-start rounded-lg p-2 text-sm",children:[(0,D.jsx)(a,{className:"w-6 h-6 text-gray-600 mt-0.5 flex-shrink-0"}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("div",{className:"text-xs text-gray-500",children:o}),(0,D.jsx)("div",{className:"text-gray-800 font-medium p-0 m-0",children:s})]})]})},Me=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const o=a.turnos_funcionamento||a.turnos_funcionamento||"",s=(t=a.modalidade_ensino)&&"string"===typeof t?t.split("\u2013").map((e=>e.trim())).filter(Boolean):[];var t;ke.A;const n=[o&&{icon:Ce.A,label:"Turnos de Funcionamento",value:o},{icon:Ae.A,label:"N\xfamero de Alunos",value:a.numero_alunos},{icon:Ie.A,label:"L\xednguas Faladas",value:a.linguas_faladas}].filter(Boolean),r=[{icon:Ee.A,label:"Material Pedag\xf3gico N\xe3o Ind\xedgena",value:(0,D.jsx)(Le,{value:a.material_nao_indigena})},{icon:Ee.A,label:"Material Pedag\xf3gico Ind\xedgena",value:(0,D.jsx)(Le,{value:a.material_indigena})}];return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(ue,{title:"Modalidades",icon:ke.A,children:[(0,D.jsx)("div",{className:"mb-4 bg-green-100 rounded-lg p-2",children:(0,D.jsx)(Se,{items:s,maxVisible:3})}),(0,D.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mt-1 [&>*]:bg-green-100",children:n.map(((e,a)=>(0,D.jsx)(_e,{icon:e.icon,label:e.label,value:e.value},a)))})]}),(0,D.jsx)(ue,{title:"Materiais Pedag\xf3gicos",icon:Ee.A,description:"Diferenciados e n\xe3o diferenciados, produzidos dentro e fora da comunidade.",children:(0,D.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mt-1 [&>*]:bg-green-100",children:r.map(((e,a)=>(0,D.jsx)(_e,{icon:e.icon,label:e.label,value:e.value},a)))})})]})}));var Pe=o(2499),ze=o(1184),Te=o(6920),De=o(1799),Fe=o(4758),Oe=o(8493),He=o(141),Re=o(1441);const We=e=>{let{icon:a,label:o,value:s}=e;return(0,D.jsxs)("div",{className:"flex items-start gap-2 rounded-lg p-2 text-sm",children:[(0,D.jsx)(a,{className:"w-6 h-6 text-gray-600 mt-0.5 flex-shrink-0"}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("div",{className:"text-gray-500",children:o}),(0,D.jsx)("div",{className:"text-gray-800 font-medium",children:s})]})]})},Be=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const o=[{icon:Pe.A,label:"Acesso \xe0 \xc1gua",value:a.acesso_agua},{icon:ze.A,label:"Coleta de Lixo",value:a.coleta_lixo},{icon:Te.A,label:"Acesso \xe0 Internet",value:(0,D.jsx)(Le,{value:a.acesso_internet})},{icon:De.A,label:"Equipamentos Tecnol\xf3gicos",value:a.equipamentos},{icon:ee.A,label:"Modo de Acesso \xe0 Escola",value:a.modo_acesso},{icon:Fe.A,label:"Cozinha",value:(0,D.jsx)(Le,{value:a.cozinha})},{icon:Oe.A,label:"Merenda Escolar",value:(0,D.jsx)(Le,{value:a.merenda_escolar})},{icon:He.A,label:"Merenda Diferenciada",value:(0,D.jsx)(Le,{value:a.diferenciada})}];return(0,D.jsxs)(ue,{title:"Infraestrutura",icon:Re.A,children:[a.espaco_escolar&&(0,D.jsx)("div",{className:"p-2 text-sm text-gray-800 border-b border-gray-200 whitespace-pre-wrap",children:a.espaco_escolar}),(0,D.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] gap-2 mt-3 [&>*]:bg-green-100",children:o.map(((e,a)=>(0,D.jsx)(We,{icon:e.icon,label:e.label,value:e.value},a)))})]})}));var Ue=o(1172),Ve=o(2427),Ge=o(6635),qe=o(9449),Ze=o(4562),Ke=o(3626);const Je=e=>{let{icon:a,label:o,value:s,description:t}=e;return(0,D.jsxs)("div",{className:"flex items-start gap-2 rounded-lg p-2 text-sm",children:[(0,D.jsx)(a,{className:"w-6 h-6 text-gray-600 mt-0.5 flex-shrink-0"}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("div",{className:"text-xs text-gray-500",children:o}),(0,D.jsx)("div",{className:"text-gray-800 font-medium mt-0.5",children:s}),t&&(0,D.jsx)("div",{className:"text-xs text-gray-600 mt-1 whitespace-pre-line",children:t})]})]})},Xe=e=>{const a=String(e).trim().toLowerCase();return"sim"===a?(0,D.jsxs)("div",{className:"flex items-center gap-1 text-green-700",children:[(0,D.jsx)($.A,{className:"w-5 h-5"}),"Sim"]}):"n\xe3o"===a||"nao"===a?(0,D.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,D.jsx)(Q.A,{className:"w-5 h-5"}),"N\xe3o"]}):e},Ye=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const o=(e=>{if(!e)return null;const[a,...o]=e.split("/"),s=o.join("/").trim();return{status:"sim"===a.trim().toLowerCase()?"Sim":a.trim(),descricao:s||null}})(a.formacao_professores),s=(e=>{if(!e)return null;const[a,...o]=e.split("/"),s=o.join("/").trim();return{status:"sim"===a.trim().toLowerCase()?"Sim":a.trim(),descricao:s||null}})(a.formacao_continuada);return(0,D.jsxs)(ue,{title:"Gestores",icon:Ue.A,children:[(0,D.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mt-1 [&>*]:bg-green-100",children:[(0,D.jsx)(Je,{icon:Ve.A,label:"Professores Ind\xedgenas",value:a.professores_indigenas}),(0,D.jsx)(Je,{icon:Ge.A,label:"Professores N\xe3o Ind\xedgenas",value:a.professores_nao_indigenas}),(0,D.jsx)(Je,{icon:Ie.A,label:"Professores que falam l\xedngua ind\xedgena",value:Xe(a.professores_falam_lingua)}),(null===o||void 0===o?void 0:o.status)&&(0,D.jsx)(Je,{icon:qe.A,label:"Forma\xe7\xe3o dos Professores",value:Xe(o.status),description:o.descricao})]}),(0,D.jsxs)("div",{className:"space-y-2 mt-4 [&>*]:bg-green-100",children:[(0,D.jsx)(Je,{icon:Ze.A,label:"Gest\xe3o/Nome",value:a.gestao}),(0,D.jsx)(Je,{icon:Ue.A,label:"Outros Funcion\xe1rios",value:a.outros_funcionarios}),(null===s||void 0===s?void 0:s.status)&&(0,D.jsx)(Je,{icon:Ke.A,label:"Visitas de Supervisores e Forma\xe7\xe3o Continuada",value:Xe(s.status),description:s.descricao})]})]})}));var $e=o(6192),Qe=o(4621),ea=o(1204);const aa=e=>{let{icon:a,label:o,value:s}=e;const t="n\xe3o"===(null===s||void 0===s?void 0:s.trim().toLowerCase());return(0,D.jsxs)("div",{className:"flex items-start gap-4 rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,D.jsx)("div",{className:"mt-1",children:(0,D.jsx)(a,{className:"w-5 h-5 text-green-600 flex-shrink-0"})}),(0,D.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,D.jsx)("div",{className:"text-sm font-semibold text-gray-800",children:o}),t?(0,D.jsxs)("div",{className:"text-sm text-gray-400 flex items-center gap-1",children:[(0,D.jsx)(Q.A,{className:"w-5 h-5 text-gray-400"}),"N\xe3o"]}):(0,D.jsx)("div",{className:"text-sm text-gray-700 leading-relaxed",children:s})]})]})},oa=(0,s.memo)((e=>{let{escola:a}=e;if(!a)return null;const o=[{field:"projetos_andamento",icon:Ee.A,label:"Projetos em andamento"},{field:"parcerias_universidades",icon:$e.A,label:"Parcerias com universidades"},{field:"acoes_ongs",icon:Ae.A,label:"A\xe7\xf5es com ONGs ou coletivos"},{field:"desejos_comunidade",icon:Qe.A,label:"Desejos da comunidade para a escola"},{field:"parcerias_municipio",icon:ea.A,label:"Parcerias com o munic\xedpio"}].filter((e=>a[e.field]&&a[e.field].trim()));return 0===o.length?null:(0,D.jsx)(ue,{title:"Projetos e Parcerias",icon:ea.A,children:(0,D.jsx)("div",{className:"grid grid-cols-1 gap-3 [&>*]:bg-green-100",children:o.map((e=>(0,D.jsx)(aa,{icon:e.icon,label:e.label,value:a[e.field]},e.field)))})})})),sa=e=>{let{escola_id:a,refreshKey:o=0}=e;const[t,n]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),m=(0,s.useCallback)((()=>u(null)),[]);return(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&m()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[m]),(0,s.useEffect)((()=>{o>0&&(console.log("ImagemHistoriadoProfessor: refreshKey mudou, for\xe7ando recarga"),n([]),l(!0),c(null))}),[o]),(0,s.useEffect)((()=>{a&&(l(!0),c(null),X.N.storage.from("imagens-professores").list("".concat(a,"/")).then((async e=>{let{data:o,error:s}=e;if(s)return c(s.message),void l(!1);if(o&&o.length>0){console.log("Arquivos de professores encontrados:",o.length);const e=await Promise.all(o.map((async(e,o)=>{var t,n,r,l,i;const{data:{publicUrl:c}}=X.N.storage.from("imagens-professores").getPublicUrl("".concat(a,"/").concat(e.name));let d="professor";e.name.startsWith("professora_")?d="professora":e.name.startsWith("professor_")&&(d="professor");let u=null;try{const o="".concat(a,"/").concat(e.name);console.log("Buscando legenda para professor:",o),u=await(0,we.qP)(o,a,"professor"),console.log("Legenda encontrada para professor:",u)}catch(s){console.warn("Erro ao buscar legenda:",s)}return{id:o+1,publicURL:c,genero:d,nome:e.name,created_at:e.created_at||"",legenda:(null===(t=u)||void 0===t?void 0:t.legenda)||"Imagem do ".concat(d),descricaoDetalhada:null===(n=u)||void 0===n?void 0:n.descricao_detalhada,autor:null===(r=u)||void 0===r?void 0:r.autor_foto,dataFoto:null===(l=u)||void 0===l?void 0:l.data_foto,categoria:null===(i=u)||void 0===i?void 0:i.categoria}})));n(e)}else n([]);l(!1)})).catch((e=>{c("Erro inesperado: ".concat(e.message)),l(!1)})))}),[a]),r?(0,D.jsx)("div",{className:"text-gray-500",children:"Carregando imagens do professor..."}):i?(0,D.jsxs)("div",{className:"text-red-600",children:["Erro ao carregar imagens: ",i]}):t.length?(0,D.jsxs)("section",{className:"my-6",children:[(0,D.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:t.map((e=>(0,D.jsxs)("figure",{className:"rounded-lg overflow-hidden border bg-white shadow-sm flex flex-col cursor-pointer transition hover:shadow-md",onClick:()=>e.publicURL&&u(e),children:[(0,D.jsx)("div",{className:"w-full aspect-[4/3] bg-gray-100 flex items-center justify-center",children:(0,D.jsx)("img",{src:e.publicURL,alt:e.legenda,className:"w-full h-full object-cover object-center transition-transform duration-200 hover:scale-105",loading:"lazy",style:{maxHeight:"350px"}})}),e.legenda&&(0,D.jsxs)("figcaption",{className:"p-3 bg-white",children:[(0,D.jsx)("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:e.legenda}),(0,D.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.categoria&&(0,D.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:e.categoria}),e.autor&&(0,D.jsxs)("span",{children:["Por: ",e.autor]}),e.dataFoto&&(0,D.jsx)("span",{children:new Date(e.dataFoto).toLocaleDateString("pt-BR")})]}),e.descricaoDetalhada&&(0,D.jsx)("p",{className:"text-xs text-gray-600 mt-2 line-clamp-2",children:e.descricaoDetalhada})]})]},e.id)))}),d&&(0,D.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4 cursor-zoom-out",onClick:m,children:[(0,D.jsx)("button",{onClick:m,className:"absolute top-4 right-4 text-white hover:text-red-400 transition","aria-label":"Fechar",children:(0,D.jsx)(Q.A,{size:32})}),(0,D.jsxs)("div",{className:"max-w-4xl max-h-full",children:[(0,D.jsx)("img",{src:d.publicURL,alt:d.legenda,className:"max-w-full max-h-full rounded-lg shadow-2xl border-4 border-white",onClick:e=>e.stopPropagation()}),d.legenda&&(0,D.jsxs)("div",{className:"mt-4 bg-white rounded-lg p-4 shadow-lg",children:[(0,D.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:d.legenda}),(0,D.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[d.categoria&&(0,D.jsx)("span",{className:"capitalize bg-gray-100 px-2 py-1 rounded",children:d.categoria}),d.autor&&(0,D.jsxs)("span",{children:["Fot\xf3grafo: ",d.autor]}),d.dataFoto&&(0,D.jsxs)("span",{children:["Data: ",new Date(d.dataFoto).toLocaleDateString("pt-BR")]})]}),d.descricaoDetalhada&&(0,D.jsx)("p",{className:"text-gray-700 leading-relaxed",children:d.descricaoDetalhada})]})]})]})]}):null},ta=s.memo(sa);var na=o(8438),ra=o(2006);const la=(0,s.memo)((e=>{let{escola:a,refreshKey:o=0}=e;const[t,n]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(0),[m,g]=(0,s.useState)(null),h=(0,s.useCallback)((()=>g(null)),[]);(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&h()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[h]),(0,s.useEffect)((()=>{if(null===a||void 0===a||!a.id)return void l(!1);(async()=>{try{l(!0),c(null);const e=await(0,ra.Y8)(a.id);n(e||[]),u(0)}catch(e){c(e.message)}finally{l(!1)}})()}),[null===a||void 0===a?void 0:a.id,o]);const x=(0,s.useCallback)((()=>{u((e=>e<t.length-1?e+1:0))}),[t.length]),p=(0,s.useCallback)((()=>{u((e=>e>0?e-1:t.length-1))}),[t.length]);if((0,s.useEffect)((()=>{const e=e=>{t.length<=1||("ArrowRight"===e.key?x():"ArrowLeft"===e.key&&p())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[t.length,x,p]),r)return(0,D.jsx)("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-green-100/50",children:(0,D.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,D.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando hist\xf3rias do professor..."})]})});if(i)return(0,D.jsx)("div",{className:"mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg border border-red-100/50",children:(0,D.jsx)("div",{className:"text-center py-8",children:(0,D.jsxs)("p",{className:"text-red-600",children:["Erro ao carregar hist\xf3rias do professor: ",i]})})});if(!t.length)return null;const f=t[d],b=t.length>1;return(0,D.jsxs)("article",{className:" mt-8 mb-12 max-w-4xl mx-auto px-4 sm:px-6 md:px-8 py-6 bg-white rounded-2xl shadow-lg prose prose-sm sm:prose-base md:prose-lg lg:prose-xl prose-headings:text-green-900 prose-p:text-black prose-p:leading-relaxed prose-p:text-justify prose-img:rounded-xl prose-img:shadow-lg prose-a:text-green-700 prose-a:no-underline prose-a:border-b-2 prose-a:border-green-100 hover:prose-a:border-green-600 ",children:[(0,D.jsxs)("header",{className:"mb-6 sm:mb-8",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)("span",{className:"bg-green-300 rounded-full flex items-center justify-center w-16 h-16 sm:w-28 sm:h-28",children:(0,D.jsx)("img",{src:"".concat("/escolasindigenas","/passaro.svg"),alt:"\xcdcone de p\xe1ssaro",className:"w-12 h-12 sm:w-24 sm:h-24",style:{filter:"none",borderRadius:"0",boxShadow:"none",margin:"0",padding:"0",border:"none",outline:"none"},"aria-hidden":"true"})}),(0,D.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-black m-0",children:"Depoimento dos Professores"})]}),b&&(0,D.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:(0,D.jsxs)("span",{children:[d+1," de ",t.length]})})]}),(0,D.jsx)("div",{className:"h-1 w-20 sm:w-24 bg-green-300 rounded-full"})]}),(0,D.jsxs)("section",{className:"text-base sm:text-lg leading-relaxed text-neutral-800",children:[f.nome_professor&&(0,D.jsx)("h3",{className:"text-lg sm:text-xl font-semibold text-green-800 mb-4",children:f.nome_professor}),(0,D.jsx)("div",{className:"historia-professor-content",dangerouslySetInnerHTML:{__html:f.historia}}),f.imagem_public_url&&(0,D.jsx)("figure",{className:"my-6",children:(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("img",{src:f.imagem_public_url,alt:f.descricao_imagem||"Imagem da hist\xf3ria do professor",className:"w-full max-w-2xl mx-auto rounded-xl shadow-lg cursor-pointer transition-transform duration-200 hover:scale-105",onClick:()=>g(f),loading:"lazy"}),f.descricao_imagem&&(0,D.jsx)("figcaption",{className:"text-center text-sm text-gray-600 mt-2",children:f.descricao_imagem})]})})]}),b&&(0,D.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200",children:[(0,D.jsxs)("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Hist\xf3ria anterior",children:[(0,D.jsx)(na.A,{className:"w-5 h-5"}),(0,D.jsx)("span",{className:"hidden sm:inline",children:"Anterior"})]}),(0,D.jsx)("div",{className:"flex gap-2",children:t.map(((e,a)=>(0,D.jsx)("button",{onClick:()=>u(a),className:"w-3 h-3 rounded-full border-2 ".concat(a===d?"bg-green-600 border-green-600":"bg-white border-gray-300"," transition-colors"),"aria-label":"Ir para hist\xf3ria ".concat(a+1)},a)))}),(0,D.jsxs)("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 text-green-700 hover:text-green-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Pr\xf3xima hist\xf3ria",children:[(0,D.jsx)("span",{className:"hidden sm:inline",children:"Pr\xf3xima"}),(0,D.jsx)(se.A,{className:"w-5 h-5"})]})]}),m&&(0,D.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",onClick:h,children:(0,D.jsxs)("div",{className:"relative max-w-3xl w-full p-4",onClick:e=>e.stopPropagation(),children:[(0,D.jsx)("button",{className:"absolute top-2 right-2 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-80",onClick:h,"aria-label":"Fechar zoom",children:(0,D.jsx)(Q.A,{className:"w-6 h-6"})}),(0,D.jsx)("img",{src:m.imagem_public_url,alt:m.descricao_imagem||"Imagem da hist\xf3ria do professor",className:"w-full max-h-[80vh] object-contain rounded-xl shadow-2xl"}),m.descricao_imagem&&(0,D.jsx)("figcaption",{className:"text-center text-base text-gray-200 mt-4",children:m.descricao_imagem})]})}),(0,D.jsx)(ta,{escola_id:a.id,refreshKey:o})]})})),ia=(0,s.memo)((e=>{let{children:a,shouldUseGrid:o}=e;const s=o?"masonry-grid":"space-y-4";return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("style",{children:"\n  .masonry-grid {\n    column-count: 1;\n    column-gap: 1.5rem;\n    column-fill: balance;\n  }\n  \n  .masonry-grid > * {\n    display: block;\n    break-inside: avoid;\n    page-break-inside: avoid;\n    margin-bottom: 1.5rem;\n  }\n  \n  /* Mobile: 1 coluna */\n  @media (max-width: 767px) {\n    .masonry-grid {\n      column-count: 1;\n    }\n  }\n  \n  /* Tablet e Desktop: 2 colunas */\n  @media (min-width: 768px) {\n    .masonry-grid {\n      column-count: 2;\n    }\n  }\n"}),(0,D.jsx)("div",{className:"".concat(s," transition-all duration-300 ease-in-out"),children:a})]})})),ca=(0,s.memo)((e=>{let{escola:a,shouldUseGrid:o=!1,refreshKey:s=0}=e;if(console.log("EscolaInfo recebeu:",a),!a)return console.log("EscolaInfo: escola \xe9 null ou undefined"),null;const t=[{Component:be,props:{escola:a}},{Component:Me,props:{escola:a}},{Component:Be,props:{escola:a}},{Component:Ye,props:{escola:a}},{Component:oa,props:{escola:a}}];return(0,D.jsxs)("div",{className:"space-y-8",children:[(0,D.jsx)(ia,{shouldUseGrid:o,children:t.map(((e,a)=>{let{Component:o,props:s}=e;return(0,D.jsx)(o,(0,N.A)({},s),a)}))}),(0,D.jsx)(Ne,{escola:a,refreshKey:s}),(0,D.jsx)(la,{escola:a,refreshKey:s})]})}));var da=o(3986);const ua=["className"],ma=e=>{let{className:a="w-5 h-5"}=e,o=(0,da.A)(e,ua);return(0,D.jsx)("svg",(0,N.A)((0,N.A)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",fill:"currentColor",className:a},o),{},{children:(0,D.jsx)("path",{d:"M200,80H184V64a32,32,0,0,0-56-21.13A32,32,0,0,0,72.21,60.42,32,32,0,0,0,24,88v40a104,104,0,0,0,208,0V112A32,32,0,0,0,200,80ZM152,48a16,16,0,0,1,16,16V80H136V64A16,16,0,0,1,152,48ZM88,64a16,16,0,0,1,32,0v40a16,16,0,0,1-32,0ZM40,88a16,16,0,0,1,32,0v16a16,16,0,0,1-32,0Zm176,40a88,88,0,0,1-175.92,3.75A31.93,31.93,0,0,0,80,125.13a31.93,31.93,0,0,0,44.58,3.35,32.21,32.21,0,0,0,11.8,11.44A47.88,47.88,0,0,0,120,176a8,8,0,0,0,16,0,32,32,0,0,1,32-32,8,8,0,0,0,0-16H152a16,16,0,0,1-16-16V96h64a16,16,0,0,1,16,16Z"})}))},ga=(0,s.memo)((e=>{let{label:a,value:o,className:s="",isTextArea:t=!1}=e;if(!o)return null;const n=s.includes("flex flex-col")?"flex flex-col gap-1 text-sm py-0.5":"grid grid-cols-[auto,1fr] gap-x-2 text-sm py-0.5";return(0,D.jsxs)("div",{className:"".concat(n," ").concat(s),children:[(0,D.jsxs)("span",{className:"font-medium text-neutral-800",children:[a,":"]}),t?(0,D.jsx)("div",{className:"text-neutral-600",children:(0,D.jsx)("div",{className:"whitespace-pre-wrap break-words text-sm leading-relaxed",children:o})}):(0,D.jsx)("span",{className:"text-neutral-600 break-words",children:o})]})})),ha=e=>(0,D.jsx)(ma,(0,N.A)({className:"w-8 h-8"},e)),xa=(0,s.memo)((e=>{let{terraIndigena:a}=e;if(!a)return console.log("TerraIndigenaInfo: terraIndigena \xe9 null ou undefined"),null;return(0,D.jsxs)(ue,{title:"Informa\xe7\xf5es da Terra Ind\xedgena",icon:ha,children:[(0,D.jsx)(ga,{label:"Povos Ind\xedgenas",value:a.etnia}),(0,D.jsx)(ga,{label:"Localiza\xe7\xe3o",value:"".concat(a.municipio||"",", ").concat(a.uf||"").trim()}),(0,D.jsx)(ga,{label:"Superf\xedcie",value:a.superficie?"Superf\xedcie: ".concat(parseFloat(a.superficie).toFixed(2)," ha"):null}),(0,D.jsx)(ga,{label:"Fase",value:a.fase}),(0,D.jsx)(ga,{label:"Modalidade",value:a.modalidade}),(0,D.jsx)(ga,{label:"Reestudo",value:a.reestudo}),(0,D.jsx)(ga,{label:"Coordena\xe7\xe3o Regional",value:a.cr}),(0,D.jsx)(ga,{label:"Faixa de Fronteira",value:a.faixa_fron}),(0,D.jsx)(ga,{label:"Unidade Administrativa",value:a.undadm_nom}),(0,D.jsx)(ga,{label:"Sigla Unidade",value:a.undadm_sig}),(0,D.jsx)(ga,{label:"Dom\xednio",value:a.dominio_un}),(0,D.jsx)(ga,{label:"Data de Atualiza\xe7\xe3o",value:a.data_atual}),(0,D.jsx)(ga,{label:"C\xf3digo Terra Ind\xedgena",value:a.terrai_cod}),(0,D.jsx)(ga,{label:"C\xf3digo Unidade Administrativa",value:a.undadm_cod})]})}));var pa=o(519),fa=o(9501),ba=o(5410),va=o(2291),wa=o(5481);const ja=e=>{let{children:a,text:o,position:t="top"}=e;const[n,r]=(0,s.useState)(!1);return(0,D.jsxs)("div",{className:"relative inline-block",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onFocus:()=>r(!0),onBlur:()=>r(!1),children:[a,n&&(0,D.jsxs)("div",{className:"\n          absolute z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-xl whitespace-nowrap\n          ".concat({top:"bottom-full left-1/2 transform -translate-x-1/2 mb-3",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-3"}[t],"\n          animate-in fade-in-0 zoom-in-95 duration-200\n        "),children:[o,(0,D.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},ya=e=>{let{onClick:a,url:o,title:t,description:n=""}=e;const[r,l]=(0,s.useState)(!1),[i,c]=(0,s.useState)(!1),d=["Conhe\xe7a a escola ind\xedgena: ".concat(t),"Descubra esta escola ind\xedgena: ".concat(t),"Escola ind\xedgena incr\xedvel: ".concat(t),"Educa\xe7\xe3o ind\xedgena em destaque: ".concat(t),"Conhe\xe7a esta escola: ".concat(t),"Escola ind\xedgena que inspira: ".concat(t),"Educa\xe7\xe3o que transforma: ".concat(t),"Escola ind\xedgena de refer\xeancia: ".concat(t)],u=d[Math.floor(Math.random()*d.length)],m=o||window.location.href,g=[{name:"WhatsApp",icon:(0,D.jsx)(Ie.A,{className:"w-5 h-5"}),color:"bg-green-500 hover:bg-green-600",component:pa.Kz,props:{url:m,title:u}},{name:"Facebook",icon:(0,D.jsx)(fa.A,{className:"w-5 h-5"}),color:"bg-blue-600 hover:bg-blue-700",component:pa.uI,props:{url:m,quote:u}},{name:"Twitter",icon:(0,D.jsx)(ba.A,{className:"w-5 h-5"}),color:"bg-sky-500 hover:bg-sky-600",component:pa.r6,props:{url:m,title:u}},{name:"LinkedIn",icon:(0,D.jsx)(va.A,{className:"w-5 h-5"}),color:"bg-blue-700 hover:bg-blue-800",component:pa.wk,props:{url:m,title:t,summary:n}}];return(0,D.jsx)("div",{className:"px-4 py-6 border-t border-green-200 bg-gradient-to-b from-white to-green-50",children:(0,D.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,D.jsx)("div",{className:"text-center mb-4",children:(0,D.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Compartilhe esta escola"})}),(0,D.jsx)("div",{className:"mb-4",children:(0,D.jsx)(ja,{text:r?"Link copiado com sucesso!":"Copiar link para clipboard",children:(0,D.jsxs)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(o),l(!0),setTimeout((()=>l(!1)),3e3)}catch(e){const a=document.createElement("input");a.value=o,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),l(!0),setTimeout((()=>l(!1)),3e3)}},className:"\n                w-full flex items-center justify-center gap-3 p-4 rounded-xl transition-all duration-300\n                focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2\n                transform hover:scale-105 active:scale-95\n                ".concat(r?"bg-green-100 border-2 border-green-300 text-green-800":"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg hover:shadow-xl","\n              "),"aria-label":"Copiar link para clipboard",children:[r?(0,D.jsx)($.A,{className:"w-6 h-6"}):(0,D.jsx)(te.A,{className:"w-6 h-6"}),(0,D.jsx)("span",{className:"font-semibold",children:r?"Link Copiado!":"Copiar Link"})]})})}),(0,D.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:g.map(((e,a)=>{const o=e.component;return(0,D.jsx)(ja,{text:"Compartilhar no ".concat(e.name),children:(0,D.jsx)(o,(0,N.A)((0,N.A)({},e.props),{},{className:"w-full transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 active:scale-95","aria-label":"Compartilhar no ".concat(e.name),children:(0,D.jsxs)("div",{className:"\n                    w-full flex items-center justify-center gap-2 p-3 rounded-lg text-white font-medium\n                    ".concat(e.color," shadow-md hover:shadow-lg\n                  "),children:[e.icon,(0,D.jsx)("span",{className:"text-sm",children:e.name})]})}))},a)}))}),navigator.share&&(0,D.jsx)("div",{className:"text-center",children:(0,D.jsx)(ja,{text:"Compartilhar usando op\xe7\xf5es do sistema",children:(0,D.jsxs)("button",{onClick:a,className:"w-full flex items-center justify-center gap-2 p-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 active:scale-95","aria-label":"Compartilhar usando op\xe7\xf5es do sistema",children:[(0,D.jsx)(wa.A,{className:"w-5 h-5"}),(0,D.jsx)("span",{className:"font-medium",children:"Mais op\xe7\xf5es"})]})})})]})})},Na=s.memo(ya),ka=(0,s.memo)((e=>{let{copiarLink:a,compartilhar:o,painelInfo:t}=e;const n=(0,s.useMemo)((()=>{if(null===t||void 0===t||!t.titulo)return window.location.href;return window.location.origin+window.location.pathname+"?panel="+t.titulo.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}),[null===t||void 0===t?void 0:t.titulo]),r=(0,s.useMemo)((()=>{if(!t)return"Confira informa\xe7\xf5es sobre esta escola ind\xedgena no Observat\xf3rio de Professores Ind\xedgenas.";let e="Escola Ind\xedgena: ".concat(t.titulo);return t["Munic\xedpio"]&&(e+=" - ".concat(t["Munic\xedpio"])),t["Povos indigenas"]&&(e+=" | Povos: ".concat(t["Povos indigenas"])),t["Linguas faladas"]&&(e+=" | L\xednguas: ".concat(t["Linguas faladas"])),e+=" | Observat\xf3rio de Professores Ind\xedgenas",e}),[t]),l=(0,s.useMemo)((()=>null!==t&&void 0!==t&&t.titulo?"".concat(t.titulo," - Escola Ind\xedgena"):"Escola Ind\xedgena - Observat\xf3rio de Professores Ind\xedgenas"),[null===t||void 0===t?void 0:t.titulo]);return(0,D.jsx)(Na,{onClick:o,url:n,title:l,description:r})}));var Ca=o(7977);const Aa=e=>{let{descricao:a,className:o=""}=e;const t=(0,s.useMemo)((()=>a?Ca.A.sanitize((e=>{if(!e)return"";let a=e.replace(/\n\n+/g,"</p><p>");return a=a.replace(/\n/g,"<br>"),a.startsWith("<p>")||(a="<p>"+a),a.endsWith("</p>")||(a+="</p>"),a=a.replace(/>\s+</g,"><"),a})(a),{ALLOWED_TAGS:["b","i","em","strong","a","p","br","ul","ol","li","div","span","img","h1","h2","h3","h4","h5","h6","center","blockquote","code","pre","hr","table","thead","tbody","tr","th","td"],ALLOWED_ATTR:["href","target","rel","class","style","src","alt","width","height","id","title","aria-label","aria-describedby"],ADD_TAGS:["center","blockquote"],ADD_ATTR:["target","className","title"],KEEP_CONTENT:!0,ALLOW_DATA_ATTR:!1}):""),[a]);return a?(0,D.jsx)("div",{className:"mb-6 ".concat(o),children:(0,D.jsx)("div",{className:"prose prose-lg lg:prose-xl max-w-none px-1",style:{"--tw-prose-body":"#1f2937","--tw-prose-headings":"#111827","--tw-prose-links":"#059669","--tw-prose-bold":"#111827","--tw-prose-counters":"#1f2937","--tw-prose-bullets":"#4b5563","--tw-prose-hr":"#e5e7eb","--tw-prose-quotes":"#111827","--tw-prose-quote-borders":"#10b981","--tw-prose-captions":"#6b7280","--tw-prose-code":"#111827","--tw-prose-pre-code":"#e5e7eb","--tw-prose-pre-bg":"#1f2937","--tw-prose-th-borders":"#d1d5db","--tw-prose-td-borders":"#e5e7eb",lineHeight:"1.8",fontSize:"1.125rem",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',letterSpacing:"0.015em"},dangerouslySetInnerHTML:{__html:t},"aria-live":"polite"})}):null},Ia=s.memo(Aa),Ea=(0,s.memo)((e=>{let{painelInfo:a}=e;return(0,D.jsxs)("div",{className:"space-y-6",children:[(0,D.jsx)("div",{className:"prose prose-lg lg:prose-xl max-w-none",children:(0,D.jsx)("div",{className:"bg-green-100 rounded-lg p-6",children:(0,D.jsx)(Ia,{descricao:a.descricao_detalhada})})}),a.audioUrl&&(0,D.jsx)("div",{className:"mt-6",children:(0,D.jsxs)("audio",{controls:!0,className:"w-full",children:[(0,D.jsx)("source",{src:a.audioUrl,type:"audio/mpeg"}),"Seu navegador n\xe3o suporta o elemento de \xe1udio."]})})]})}));var La=o(2922),Sa=o(4224);const _a=["EE","EEI"],Ma=e=>{if(!e||"string"!==typeof e)return"";return e.split(/\s+/).map((e=>_a.includes(e.toUpperCase())?e.toUpperCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(" ")},Pa=e=>{let{titulo:a,closePainel:o,toggleMaximize:s,isMaximized:t}=e;const n=window.innerWidth<=768,r=n&&window.innerWidth>window.innerHeight,l=r&&window.innerWidth<=850;return(0,D.jsxs)("header",{className:"relative px-3 sm:px-4 md:px-6 lg:px-8 py-3 sm:py-4 md:py-6 border-b border-green-100 ".concat(r?"min-h-[60px]":""),children:[(0,D.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between pr-12",children:(0,D.jsx)("h2",{id:"painel-titulo",className:"font-semibold text-gray-900 leading-tight tracking-normal break-words ".concat(l?"text-base":r?"text-lg sm:text-xl":"text-xl sm:text-2xl md:text-3xl"),style:l?{fontSize:"clamp(1rem, 4vw, 1.25rem)"}:{},children:Ma(a)})}),(0,D.jsxs)("div",{className:"absolute top-2 sm:top-4 right-2 sm:right-4 flex items-center gap-2",children:[!n&&(0,D.jsx)("button",{onClick:s,className:"p-2 text-green-700 hover:text-green-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":t?"Restaurar painel":"Maximizar painel",title:t?"Restaurar":"Maximizar",children:t?(0,D.jsx)(La.A,{size:18,className:"stroke-2","aria-hidden":"true"}):(0,D.jsx)(Sa.A,{size:18,className:"stroke-2","aria-hidden":"true"})}),(0,D.jsx)("button",{onClick:o,className:"text-gray-700 hover:text-gray-900 hover:bg-green-100 transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ".concat(r?"p-1.5":"p-2"),"aria-label":"Fechar painel",children:(0,D.jsx)(Q.A,{size:r?18:20,"aria-hidden":"true",className:"stroke-2"})})]})]})},za=e=>{const[a,o]=(0,s.useState)(!1),[t,n]=(0,s.useState)(window.innerWidth<=768);return console.log("usePainelVisibility - painelInfo:",e),(0,s.useEffect)((()=>{const e=()=>{const e=window.innerWidth<=768,a=window.innerWidth>window.innerHeight&&window.innerWidth<=1024;n(e||a)};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}),[]),(0,s.useEffect)((()=>(console.group("usePainelVisibility - Effect"),console.log("painelInfo recebido:",e),e&&"object"===typeof e?(console.log("painelInfo v\xe1lido, definindo visibilidade como true"),o(!0),document.body.style.overflow="hidden"):(console.log("painelInfo inv\xe1lido ou undefined, definindo visibilidade como false"),o(!1),document.body.style.overflow=""),console.log("Estado atual:",{isVisible:a,isMobile:t}),console.groupEnd(),()=>{document.body.style.overflow=""})),[e]),console.log("usePainelVisibility - returning state:",{isVisible:a,isMobile:t}),{isVisible:a,isMobile:t}},Ta=e=>{let{painelInfo:a,closePainel:o,children:t,isMaximized:n,onToggleMaximize:r}=e;const{isVisible:l,isMobile:i}=za(a),c=((e,a)=>{const[o,t]=(0,s.useState)(window.innerWidth),[n,r]=(0,s.useState)(window.innerHeight),l={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};(0,s.useEffect)((()=>{const e=()=>{t(window.innerWidth),r(window.innerHeight)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const i=(0,s.useMemo)((()=>{const s=e&&o>n,t="calc(100vh - ".concat(s?48:e?56:72,"px)"),r=o>=l.md;let i;return i=e||a?"100%":o>=l.lg?"49%":"75%",{height:t,maxHeight:e?"96vh":"92vh",width:i,isDesktop:r,isMobileLandscape:s,shouldUseGrid:r&&a,breakpoints:l,zIndex:1e3}}),[e,a,o,n]);return i})(i,n);if(!a)return null;const d=i&&window.innerWidth>window.innerHeight?48:i?56:72,u="\n    fixed\n    ".concat(i?"inset-x-0 top-0 w-full h-full":"top-30 bottom-0 right-0 w-full sm:w-3/4 lg:w-[49%] h-auto","\n    rounded-t-xl shadow-xl z-[9999] transform transition-all duration-500 ease-in-out\n    bg-white border-t-4 border-white\n  "),m=l?"translate-y-0 opacity-100":"translate-y-full opacity-0";return(0,D.jsxs)("div",{role:"dialog","aria-labelledby":"painel-titulo","aria-describedby":"painel-descricao","aria-modal":"true",className:"".concat(u," ").concat(m).concat(i?" painel-informacoes-mobile":""),style:(0,N.A)({height:c.height,maxHeight:c.maxHeight,width:i?"100%":c.width,top:i?"".concat(d,"px"):72,display:"flex",flexDirection:"column"},i&&{borderRadius:c.isMobileLandscape?"0":"1rem 1rem 0 0",boxShadow:c.isMobileLandscape?"0 0 0 0":"0 -4px 6px -1px rgba(0, 0, 0, 0.1), 0 -2px 4px -1px rgba(0, 0, 0, 0.06)"}),children:[(0,D.jsx)(Pa,{titulo:a.titulo,closePainel:o,toggleMaximize:r,isMaximized:n}),(0,D.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-green-600/40 scrollbar-track-green-50/20",children:(0,D.jsx)("div",{className:"".concat(i?"p-3 sm:p-4":"p-6"," space-y-6 sm:space-y-8"),children:(0,D.jsx)("div",{className:"prose prose-sm sm:prose-base md:prose-lg lg:prose-xl max-w-none",children:t})})})]})},Da=s.memo(Ta),Fa=e=>{if(!e||"string"!==typeof e)return null;const a=e.match(/\/d\/([a-zA-Z0-9-_]+)/);if(!a)return null;const o=a[1];return"https://docs.google.com/gview?url=https://drive.google.com/uc?id=".concat(o,"&embedded=true")},Oa=e=>{let{viewMode:a,setViewMode:o}=e;return(0,D.jsxs)("div",{className:"flex items-center gap-2",role:"tablist","aria-label":"Modos de visualiza\xe7\xe3o dos documentos",children:[(0,D.jsxs)("button",{type:"button",role:"tab","aria-selected":"list"===a,"aria-label":"Visualizar em lista","aria-pressed":"list"===a,onClick:()=>o("list"),className:"p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ".concat("list"===a?"bg-green-100 text-green-800 font-semibold":"text-gray-600 hover:bg-gray-100"),tabIndex:0,children:[(0,D.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),(0,D.jsx)("span",{className:"hidden sm:inline",children:"Lista"})]}),(0,D.jsxs)("button",{type:"button",role:"tab","aria-selected":"grid"===a,"aria-label":"Visualizar em grade","aria-pressed":"grid"===a,onClick:()=>o("grid"),className:"p-2 rounded-lg flex items-center gap-1 transition-colors focus:outline-none focus:ring-2 focus:ring-green-600 ".concat("grid"===a?"bg-green-100 text-green-800 font-semibold":"text-gray-600 hover:bg-gray-100"),tabIndex:0,children:[(0,D.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),(0,D.jsx)("span",{className:"hidden sm:inline",children:"Grade"})]})]})},Ha=e=>{let{documentos:a,title:o="Documentos"}=e;const[t,n]=(0,s.useState)(null),[r,l]=(0,s.useState)("list"),i=(0,s.useRef)(null),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1);if((0,s.useEffect)((()=>{t&&(d(!1),m(!1))}),[t]),(0,s.useEffect)((()=>{!t&&(null===a||void 0===a?void 0:a.length)>0&&n(a[0])}),[a,t]),(0,s.useEffect)((()=>{const e=i.current;if(!e||!t)return;const a=()=>{d(!1)},o=()=>{d(!0),m(!0)};return e.addEventListener("load",a),e.addEventListener("error",o),()=>{e.removeEventListener("load",a),e.removeEventListener("error",o)}}),[t]),!a||0===a.length)return null;return(0,D.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsxs)("h3",{className:"text-xl font-semibold text-green-800",children:[o,":"]}),a.length>1&&(0,D.jsx)(Oa,{viewMode:r,setViewMode:l})]}),a.length>1&&(0,D.jsx)("div",{className:"mb-6",children:"grid"===r?(0,D.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:a.map((e=>(0,D.jsx)("div",{className:"\n              flex flex-col justify-between h-full max-w-xs mx-auto\n              rounded-2xl transition-all duration-200 cursor-pointer\n              shadow-sm hover:shadow-lg\n              ".concat((null===t||void 0===t?void 0:t.id)===e.id?"bg-green-100 scale-[1.03]":"bg-white hover:bg-green-50","\n            "),onClick:()=>{n(e)},tabIndex:0,"aria-label":"Selecionar documento: ".concat(e.titulo),children:(0,D.jsxs)("div",{className:"p-5 flex-1 flex flex-col justify-between",children:[(0,D.jsx)("h4",{className:"font-semibold text-green-800 mb-2 line-clamp-2 text-lg",children:e.titulo}),e.autoria&&(0,D.jsxs)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-1",children:["Por: ",e.autoria]}),e.tipo&&(0,D.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full",children:e.tipo})]})},e.id)))}):(0,D.jsx)("div",{className:"space-y-2",children:a.map((e=>(0,D.jsxs)("button",{onClick:()=>{n(e)},className:"w-full text-left p-3 rounded-lg transition-colors duration-200 ".concat((null===t||void 0===t?void 0:t.id)===e.id?"bg-green-100":"hover:bg-green-50"),children:[(0,D.jsx)("h4",{className:"font-medium text-green-800",children:e.titulo}),e.autoria&&(0,D.jsxs)("p",{className:"text-sm text-gray-600",children:["Por: ",e.autoria]}),e.tipo&&(0,D.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-medium bg-green-200 text-green-800 rounded-full",children:e.tipo})]},e.id)))})}),(()=>{if(!t)return null;const e=t.link_pdf.includes("drive.google.com/file/d/");return(0,D.jsx)("div",{className:"rounded-lg overflow-hidden shadow-lg bg-white",children:e?(0,D.jsxs)(D.Fragment,{children:[u?(0,D.jsx)("iframe",{ref:i,src:Fa(t.link_pdf),width:"100%",height:"500px",allow:"autoplay",loading:"lazy",title:"".concat(t.titulo," (Google Docs Viewer)"),sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",className:"bg-white"}):(0,D.jsx)("iframe",{ref:i,src:t.link_pdf.replace("/view?usp=sharing","/preview"),width:"100%",height:"500px",allow:"autoplay",loading:"lazy",title:t.titulo,sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",className:"bg-white"}),c&&(0,D.jsxs)("div",{className:"p-6 text-center text-gray-600 bg-green-100",children:[(0,D.jsx)("p",{className:"mb-3 text-lg",children:"N\xe3o foi poss\xedvel carregar o documento diretamente."}),(0,D.jsxs)("a",{href:t.link_pdf,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[(0,D.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Abrir em nova aba"]})]})]}):(0,D.jsx)("div",{className:"flex justify-center p-6",children:(0,D.jsxs)("a",{href:t.link_pdf,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[(0,D.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Ver documento PDF"]})})})})()]})},Ra=s.memo(Ha),Wa=e=>{let{videoUrl:a,title:o="V\xeddeo",escolaId:t}=e;const[n,r]=(0,s.useState)(null),[l,i]=(0,s.useState)(!1);if((0,s.useEffect)((()=>{(async()=>{if(a&&t)try{i(!0);const e=await(0,we.jW)(a,t);r(e)}catch(e){console.warn("Erro ao buscar t\xedtulo personalizado:",e)}finally{i(!1)}})()}),[a,t]),!a)return null;const c=(e=>{if(!e||"string"!==typeof e)return null;const a=e.split("?")[0],o=[/youtube\.com\/embed\/([^/?&]+)/,/youtube\.com\/watch\?v=([^&]+)/,/youtu\.be\/([^?&]+)/,/youtube\.com\/v\/([^?&]+)/];for(const s of o){const e=a.match(s);if(e&&e[1])return e[1]}return null})(a);return c?(0,D.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,D.jsxs)("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[(null===n||void 0===n?void 0:n.titulo)||o,":"]}),n&&(0,D.jsxs)("div",{className:"mb-4 p-4 bg-green-100 rounded-lg",children:[n.descricao&&(0,D.jsx)("p",{className:"text-gray-700 mb-2",children:n.descricao}),(0,D.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.categoria&&(0,D.jsx)("span",{className:"capitalize bg-green-200 text-green-800 px-2 py-1 rounded",children:n.categoria}),n.plataforma&&(0,D.jsx)("span",{className:"capitalize",children:n.plataforma}),n.duracao&&(0,D.jsxs)("span",{children:["Dura\xe7\xe3o: ",n.duracao]})]})]}),(0,D.jsx)("div",{className:"rounded-lg overflow-hidden shadow-lg bg-white",children:(0,D.jsx)("div",{className:"relative pb-[56.25%] h-0",children:(0,D.jsx)("iframe",{className:"absolute top-0 left-0 w-full h-full",src:"https://www.youtube.com/embed/".concat(c),title:(null===n||void 0===n?void 0:n.titulo)||o,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy",referrerPolicy:"origin"})})})]}):(0,D.jsxs)("div",{className:"mt-8 max-w-4xl mx-auto",children:[(0,D.jsxs)("h3",{className:"text-xl font-semibold text-green-800 mb-4",children:[(null===n||void 0===n?void 0:n.titulo)||o,":"]}),(0,D.jsxs)("div",{className:"p-6 text-center text-gray-600 bg-gray-50 rounded-lg",children:[(0,D.jsx)("p",{className:"mb-3 text-lg",children:"Link do v\xeddeo inv\xe1lido ou n\xe3o suportado."}),(0,D.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-base font-medium text-white bg-green-700 hover:bg-green-800 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg",children:[(0,D.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Tentar abrir no YouTube"]})]})]})},Ba=s.memo(Wa),Ua=e=>{let{painelInfo:a,closePainel:o,escola_id:t,refreshKey:n=0}=e;const r=(0,s.useRef)(null),[l,i]=(0,s.useState)(!1),{gerarLinkCustomizado:c,copiarLink:d,compartilhar:u}=(e=>{const a=()=>window.location.origin+window.location.pathname+"?panel="+J(e.titulo);return{gerarLinkCustomizado:a,copiarLink:async()=>{const e=a();try{await navigator.clipboard.writeText(e),alert("Link copiado!")}catch(o){const a=document.createElement("input");a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),alert("Link copiado!")}},compartilhar:()=>{const o=a(),s="Confira este painel: ".concat(e.titulo);navigator.share?navigator.share({title:e.titulo,text:s,url:o}):window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(s),"&url=").concat(encodeURIComponent(o)),"_blank")}}})(a),{documentos:m}=Y(null===a||void 0===a?void 0:a.id);var g,h;if(((e,a)=>{const o=(0,s.useRef)(null),t=(0,s.useRef)(null);(0,s.useEffect)((()=>{if(e)return t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{const e=a();if(e!==o.current)try{window.history.replaceState({},"",e),o.current=e}catch(s){console.warn("Erro ao atualizar URL:",s)}}),300),()=>{t.current&&clearTimeout(t.current)}}),[e,a])})(a,c),g=r,h=o,(0,s.useEffect)((()=>{const e=e=>{const a=e.target;a.classList&&a.classList.contains("openlayers-container")||g.current&&!g.current.contains(e.target)&&h(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[g,h]),(0,s.useEffect)((()=>{console.log("PainelInformacoes: refreshKey mudou para",n)}),[n]),!a)return null;const x="terra_indigena"===a.tipo,p="Sobre o site"===a.titulo;return(0,D.jsx)("div",{ref:r,children:(0,D.jsxs)(Da,{painelInfo:a,closePainel:o,isMaximized:l,onToggleMaximize:()=>i((e=>!e)),children:[p?(0,D.jsx)(Ea,{painelInfo:a}):x?(0,D.jsx)(xa,{terraIndigena:a}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ca,{escola:a,shouldUseGrid:!0,refreshKey:n}),m&&m.length>0&&(0,D.jsx)(Ra,{documentos:m,title:"Produ\xe7\xf5es e materiais da escola"}),a.link_para_videos&&(0,D.jsx)(Ba,{videoUrl:a.link_para_videos,title:"V\xeddeo da escola",escolaId:a.id})]}),(0,D.jsx)(ka,{copiarLink:d,compartilhar:u,painelInfo:a})]})})},Va=s.memo(Ua);var Ga=o(3303);const qa=e=>{let{dataPoints:a,onPainelOpen:o}=e;console.log("DataPoints recebidos no MapaEscolasIndigenas:",a?{quantidade:a.length,exemplo:a[0]?{titulo:a[0].titulo,latitude:a[0].Latitude,longitude:a[0].Longitude,tipo:a[0].tipo}:"Nenhum ponto"}:"Nenhum dataPoint");const{refreshKey:t}=(0,Ga.b)(),n=(0,s.useMemo)((()=>new URLSearchParams(window.location.search)),[]).get("panel"),r=(0,s.useMemo)((()=>{if(n&&""!==n&&a&&a.length>0){return a.find((e=>J(e.titulo)===n))||null}return null}),[n,a]),[l,i]=(0,s.useState)(r),[c,d]=(0,s.useState)(!!r),u=(0,s.useMemo)((()=>a?a.filter((e=>e.pontuacao>=0)):[]),[a]);(0,s.useMemo)((()=>u.length),[u]);(0,s.useEffect)((()=>{!r||l||c||(console.log("MapaEscolasIndigenas: Abrindo painel automaticamente para:",r.titulo),i(r),d(!0))}),[r,l,c]),(0,s.useEffect)((()=>{console.group("MapaEscolasIndigenas - painelInfo state changed"),console.log("Novo valor de painelInfo:",{titulo:null===l||void 0===l?void 0:l.titulo,tipo:null===l||void 0===l?void 0:l.tipo,hasLink:!(null===l||void 0===l||!l.link_para_documentos),linkValue:null===l||void 0===l?void 0:l.link_para_documentos,isInitialPanel:l===r,isNull:null===l,isUndefined:void 0===l}),console.groupEnd()}),[l,r]);const m=(0,s.useCallback)((e=>{e&&i(e)}),[]),g=(0,s.useCallback)((()=>{console.log("For\xe7ando refresh do painel de informa\xe7\xf5es")}),[]);(0,s.useEffect)((()=>{console.log("MapaEscolasIndigenas: onPainelOpen dispon\xedvel:",!!o),console.log("MapaEscolasIndigenas: abrirPainel dispon\xedvel:",!!m),o&&"function"===typeof o&&(console.log("MapaEscolasIndigenas: Expondo fun\xe7\xe3o abrirPainel e refreshPainel"),o(m,g))}),[m,o,g]);const h=(0,s.useCallback)((()=>{i(null)}),[]);return(0,D.jsxs)("div",{className:"relative h-screen w-full overflow-hidden",children:[(0,D.jsx)(K,{dataPoints:u,onPainelOpen:m,painelAberto:!!l,className:"h-full w-full"}),l&&(0,D.jsxs)(D.Fragment,{children:[console.log("MapaEscolasIndigenas - Renderizando PainelInformacoes com:",{painelInfo:l,hasLink:null===l||void 0===l?void 0:l.link_para_documentos,linkValue:null===l||void 0===l?void 0:l.link_para_documentos}),(0,D.jsx)(Va,{painelInfo:l,closePainel:h,refreshKey:t})]})]})}}}]);
//# sourceMappingURL=597.057878d0.chunk.js.map